[{"tags": ["json", "perl", "hash-of-hashes"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537399836, "post_id": 52415381, "comment_id": 91774524, "body": "<code>[ ... ]</code> creates an <i>array</i>. Please <code>use Data::Dumper</code> and <code>print Dumper \\%obj</code> so that we can see what you actually have. Also, in Perl an &quot;object&quot; is a data item that has been blessed into a class. What you have here is just a data structure."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537400873, "post_id": 52415381, "comment_id": 91774713, "body": "Is this (a representation of) what JSON returns? That would be a hashref, <code>my $hr = {...}</code>. You are showing an arrayref <code>[...]</code>, asigned to a hash (<code>%</code>) variable."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1537405326, "post_id": 52415381, "comment_id": 91775599, "body": "Edited the OP. No reason to downvote over a simple typo.  I cannot give you a dump because it contains thousands of lines of information, most of which is sensitive. Take the example as I gave it as that is all I can provide.  @zdim yes its a representation of the JSON data. I manually typed the example and used the wrong notation. My bad. Can we focus on the actual question now?"}, {"owner": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537405435, "post_id": 52415381, "comment_id": 91775625, "body": "@Speeddymon which key value should persist, or are all the values, with dup keys, the same?"}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537405548, "post_id": 52415381, "comment_id": 91775649, "body": "@Rafael All of the keys I&#39;m trying to delete have different values, however I do want every instance of the given key to be blown away, there is no reason to keep this particular key, and no way to filter it out before it&#39;s given to my script as JSON data."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537406316, "post_id": 52415381, "comment_id": 91775809, "body": "Thank you for your update, but the data structure that you show is impossible, and if you tried to compile it you would see <code>Odd number of elements in anonymous hash</code> errors. Please dump your <i>real data</i>, otherwise we cannot help you,"}, {"owner": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 1, "creation_date": 1537406550, "post_id": 52415381, "comment_id": 91775854, "body": "The OP can certainly use improvement, but it&#39;s not difficult to understand what he&#39;s trying to do, for he has JSON and he wants to remove entries with duplicate keys found <i>anywhere</i> in the JSON data."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537406564, "post_id": 52415381, "comment_id": 91775857, "body": "<i>&quot;No reason to downvote over a simple typo&quot;</i> It is much more likely that the downvote was because you haven&#39;t made any effort at all to solve this problem yourself. <i>&quot;Can we focus on the actual question now?&quot;</i> Don&#39;t be so rude to people who are offering you programming solutions for free, or you will quickly find that no one wants to help you."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537406745, "post_id": 52415381, "comment_id": 91775895, "body": "@Rafael: <i>&quot;it&#39;s not difficult to understand what he&#39;s trying to do&quot;</i> I think it&#39;s pretty much impossible. If you want to take a chance and guess what the data structure really looks like then do so, but don&#39;t criticise those of us who don&#39;t like writing answers based on wild guesses."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537409060, "post_id": 52415381, "comment_id": 91776395, "body": "@Rafael: You know that the data you&#39;ve edited into the question is invalid Perl, right?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537409144, "post_id": 52415381, "comment_id": 91776432, "body": "@Speeddymon: <i>&quot;In my example below, I&#39;m going to only list out hashes, not arrays, but please note that arrayrefs are in there too with some hashes inside of them&quot;</i> So you can&#39;t be bothered to write some representative data. Don&#39;t you think that&#39;s a bit cheeky when you&#39;re asking for help for free? You&#39;ve shown illegal Perl syntax that doesn&#39;t even try to represent your real data properly. That&#39;s terrible."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537413496, "post_id": 52415381, "comment_id": 91777328, "body": "@Speeddymon -- I asked for clarification merely so that I know what data I am looking at. If I don&#39;t know whether it&#39;s a hash (the variable) or an arrayref (the structure) or a hashref (expected) I can&#39;t take the question. Thank you for clarification. Btw, I didn&#39;t downvote."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537457894, "post_id": 52415381, "comment_id": 91800872, "body": "Understood @zdim, apologies for my misunderstanding your intent."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537458277, "post_id": 52415381, "comment_id": 91801082, "body": "@Borodin sensitive data is sensitive data. I cannot and will not lose my job. You want representative data, which is fine. I&#39;ll attempt to make a better representation in the question. <b>haven&#39;t made any effort at all to solve this problem yourself</b> really? I said I have a big complicated nested loop doing the work now. I&#39;m trying to simplify it and I even said I was fairly sure the <code>map</code> function was what I needed, but I hadn&#39;t grasped how to use it properly yet."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537464645, "post_id": 52415381, "comment_id": 91804247, "body": "@Speeddymon: <i>&quot;I cannot and will not lose my job. You want representative data, which is fine&quot;</i> Uh, so which is it? It sounds like your real data is too big to be useful anyway. I think I&#39;ve been clear from the start that all we need is something that we can work with, but you have yet to post anything that is even valid Perl. Surely you&#39;re not beyond testing what you post? We have no code or useful data and still you rail at us for asking for something useful."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537465633, "post_id": 52415381, "comment_id": 91804755, "body": "@Speeddymon: If your most recent edit is your latest stab at writing representative data then thank you for showing something that compiles, but it <i>still</i> contains no arrays, while you say that the real data does, and I don&#39;t understand why elements with key <code>b</code> shouldn&#39;t be deleted as well as those with <code>a</code>. And where is the desired result that you want? At this point I&#39;m bailing out. You refuse to put in enough effort to explain your problem properly, and just get angry with people who point out that your post is inadequate and unanswerable. There&#39;s nothing more I can do for you."}], "answers": [{"comments": [{"owner": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537407111, "post_id": 52416224, "comment_id": 91775954, "body": "I&#39;d do something similar, iterate the JSON twice: 1) build a hash with key/occurrences 2) create a hash, or delete from the source, keep entries that only appear once."}, {"owner": {"reputation": 6606, "user_id": 4135670, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mArsS.jpg?s=128&g=1", "display_name": "Rafael", "link": "https://stackoverflow.com/users/4135670/rafael"}, "edited": false, "score": 0, "creation_date": 1537407473, "post_id": 52416224, "comment_id": 91776016, "body": "Implementation has a depth or breadth descent, takes a function ref arg to call on hash entry, pass func ref that constructs key/occur hash, iterate again, pass entry removal func --- presto, O(n)."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537457883, "post_id": 52416224, "comment_id": 91800867, "body": "Thank you @Shawn, I&#39;ll give this a try and update if I run into trouble."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537465836, "post_id": 52416224, "comment_id": 91804864, "body": "It&#39;s best to use <code>Scalar::Util::reftype</code> in preference to <code>ref</code>, as the latter will return the package name if the reference is to blessed data."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537740239, "post_id": 52416224, "comment_id": 91883336, "body": "I&#39;ve gone and updated the OP taking your &quot;After&quot; hash as a great example of how my data is formatted (with minor tweaking) -- Can you have a look at the output I&#39;m getting after adding your code? I need to account for the anonymous hashes in the &#39;dog&#39; array having the same (undefined value for a) name."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537742947, "post_id": 52416224, "comment_id": 91883780, "body": "@Speeddymon When I tested with your new data and my code, I got the desired output"}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537757042, "post_id": 52416224, "comment_id": 91886100, "body": "Hi @Shawn what perl version are you running? I&#39;m using 5.10.1 (the bundled version for RHEL 6.9) -- maybe a quirk of us using different versions? I ran into a similar issue when the data comes through as a more shallow hash of hashes, where $obj-&gt;{foo} is a list of anonymous hashes. Since all of the anonymous hash &quot;names&quot; are the same (I assume <code>undef</code>) then it deletes the contents of those hashes. I&#39;ll update the OP momentarily to help explain"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537758725, "post_id": 52416224, "comment_id": 91886333, "body": "@Speeddymon 5.10? Wow. That&#39;s ancient. I don&#39;t even know if it supports things like hash slices or defined-or."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537823033, "post_id": 52416224, "comment_id": 91915917, "body": "It just about does. The <code>&#47;&#47;=</code> was introduced in 5.10(.1?). I think that hash slices were in a lot longer."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537848448, "post_id": 52416224, "comment_id": 91921555, "body": "@zdim yep, it has both. I had to look up the defined-or operator as I hadn&#39;t seen it before, but I&#39;ve seen (and used) hash slices in your code before! Thanks btw! I owe you a few rounds of your favorite drink/soda/coffee/etc ! \ud83d\ude42"}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537848550, "post_id": 52416224, "comment_id": 91921591, "body": "Oh before I forget, it doesn&#39;t have JSON::XS nor JSON::MaybeXS so I suspect if not a difference between perl versions, then between JSON implementations. I would just grab it from CPAN but it&#39;s blocked by our proxy, and not in our (highly) filtered private mirrors of public repos. TBH I&#39;m surprised SO isn&#39;t blocked."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537851450, "post_id": 52416224, "comment_id": 91922320, "body": "@Speeddymon You should post your current version of the code. Plus it looks like the actual problem is different from just &#39;remove all duplicate keys&#39;? (I think the only JSON parsing module that comes with Perl is JSON::PP, and that wasn&#39;t added until long after 5.10)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537904255, "post_id": 52416224, "comment_id": 91951638, "body": "@Speeddymon  I don&#39;t know what you&#39;d owe me for but I&#39;d be sure good to get some drinks/etc together :).  I dropped this once Shawn answered but I&#39;ll look into it if the problem persist  (time&#39;s a &quot;little&quot; tight right now)"}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537913225, "post_id": 52416224, "comment_id": 91955031, "body": "@Shawn added. Sorry I still had to strip a lot but hopefully the example is usable enough."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537913273, "post_id": 52416224, "comment_id": 91955040, "body": "@zdim should be ok, but yes lets do if ever we are in the same city together. :-)"}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537914792, "post_id": 52416224, "comment_id": 91955411, "body": "@Shawn went ahead and restructured the whole post to be more concise and clear about the current issue. It is still related to removing duplicate keys, but turns into a new challenge when the keys are the pseudo-name of an anonymous hash."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 1, "creation_date": 1537953682, "post_id": 52416224, "comment_id": 91968133, "body": "@Speeddymon  I take this (Shawn&#39;s) answer to have done the job (had +1-ed it), and it&#39;s nicely accepted -- I posted only for the follow-up issue of empty structures."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1537408163, "last_edit_date": 1537408163, "creation_date": 1537406778, "answer_id": 52416224, "question_id": 52415381, "link": "https://stackoverflow.com/questions/52415381/remove-duplicate-keys-from-a-hash-of-hashes-and-arrays-and-ensure-any-resulting/52416224#52416224", "title": "Remove duplicate keys from a hash of hashes and arrays (and ensure any resulting empty hashs are also removed)", "body": "<p>I think this does what you want:</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse feature qw/say/;\nuse JSON::XS; # Better than JSON; also see JSON::MaybeXS\n\nmy $j = &lt;&lt;EOJSON;\n{\n  \"foo\": 1,\n  \"bar\": {\n      \"foo\": true,\n      \"baz\": false\n      },\n  \"dog\": \"woof\",\n  \"cat\": [ { \"foo\": 3 } ]\n}\nEOJSON\n\nsub count_keys {\n  my ($j, $seen) = @_;\n  my $type = ref $j;\n  if ($type eq \"ARRAY\") {\n    count_keys($_, $seen) for @$j;\n  } elsif ($type eq \"HASH\") {\n    while (my ($key, $val) = each %$j) {\n      $seen-&gt;{$key}++;\n      count_keys($val, $seen) if ref $val;\n    }\n  }\n  return $seen;\n}\n\nsub remove_dups {\n  my ($j, $seen) = @_;\n  $seen //= count_keys($j, {});\n\n  my $type = ref $j;\n  if ($type eq \"ARRAY\") {\n    return [ map { remove_dups($_, $seen) } @$j ];\n  } elsif ($type eq \"HASH\") {\n    my %obj = %$j;\n    delete @obj{grep { $seen-&gt;{$_} &gt; 1 } keys %obj};\n    while (my ($key, $val) = each %obj) {\n      $obj{$key} = remove_dups($val, $seen) if ref $val;\n    }\n    return \\%obj;\n  } else {\n    return $j;\n  }\n}\n\nmy $parsed = decode_json $j;\nmy $printer = JSON::XS-&gt;new-&gt;pretty-&gt;canonical;\nsay \"Before:\";\nprint $printer-&gt;encode($parsed);\nsay \"After:\";\nmy $dedup = remove_dups $parsed;\nprint $printer-&gt;encode($dedup);\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>Before:\n{\n   \"bar\" : {\n      \"baz\" : false,\n      \"foo\" : true\n   },\n   \"cat\" : [\n      {\n         \"foo\" : 3\n      }\n   ],\n   \"dog\" : \"woof\",\n   \"foo\" : 1\n}\nAfter:\n{\n   \"bar\" : {\n      \"baz\" : false\n   },\n   \"cat\" : [\n      {}\n   ],\n   \"dog\" : \"woof\"\n}\n</code></pre>\n\n<p>Edit for explanation:</p>\n\n<p>The first time <code>remove_dups</code> is called on a perl data structure representing a json value (Which doesn't have to be a json object), it calls <code>count_keys</code> to recursively walk the structure and create a hash of all the keys and the number of times each one occurs. Then it again recursively walks the structure, returning a deep copy without keys that appeared more than once in the original.</p>\n\n<p>This line is the real magic:</p>\n\n<pre><code>delete @obj{grep { $seen-&gt;{$_} &gt; 1 } keys %obj};\n</code></pre>\n\n<p>It uses a <em>hash slice</em> to delete a bunch of keys all at once, with the grep bit returning a list of keys that appeared more than once. <a href=\"https://perldoc.perl.org/perldata.html#Slices\" rel=\"nofollow noreferrer\">More information</a> on slices.</p>\n"}, {"comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537983626, "post_id": 52513670, "comment_id": 91986277, "body": "@Speeddymon  Updated, as it downed on me that there is no good reason to first check and remove empty things, before recursion. The recursion on the empty data structure is quick, so all empty ones can be removed after it.  This lightened the code."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1537995180, "post_id": 52513670, "comment_id": 91991590, "body": "Thank you @zdim. One question... Shawn&#39;s code traverses the hash once, and this appears to be an additional function to add alongside his code. Am I interpreting correctly that the hash would be traversed once by his code and then a second time by yours? Or am I just that dense and missing something totally obvious?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1538007070, "post_id": 52513670, "comment_id": 91994814, "body": "@Speeddymon Yes, that is correct: This would go over the hashref as it remains after Shawn&#39;s code did its thing (which traverses it <i>twice</i> -- once to scoop up dupes and then to remove them).  This could be made so to find and delete dupes as well but it would considerably expand it, while that you have.  Or, you could merge this into Shawn&#39;s second pass? I think that having two subs isn&#39;t too bad to start with for this job -- just how big is data?  If there <i>is</i> a problem with time then that&#39;s a different matter. Having separate subs for this is reasonable in principle, too."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1538097172, "post_id": 52513670, "comment_id": 92033514, "body": "Okay yes you&#39;re right, it would be a third traversal. The data set&#39;s size varies. The largest output I got in limited testing was less than 1mb, but it could theoretically send out much much more, as the webapp&#39;s output depends on the options passed to the script, and the webapp interfaces with an oracle db. I don&#39;t mind traversing the hash a thousand times as long as it doesn&#39;t add a <i>noticeable</i> delay. Of course, how noticeable the delay is, depends on the output of the webapp."}, {"owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1538097562, "post_id": 52513670, "comment_id": 92033582, "body": "Something I thought of that I can look into that will help speed in the case of a larger dataset is to implement threading, but I have no idea if perl 5.10 even has a notion of threads."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "edited": false, "score": 0, "creation_date": 1538102395, "post_id": 52513670, "comment_id": 92034476, "body": "@Speeddymon Okay. I&#39;ll look into efficiency (as time permits though), as it may matter by what you&#39;re saying.  You can absolutely implement this in parallel -- if it comes to that.  I don&#39;t know whether threads would be th better choice though, compared with forking.  This would depend on the whole setup."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": false, "score": 1, "last_activity_date": 1595697861, "last_edit_date": 1595697861, "creation_date": 1537951928, "answer_id": 52513670, "question_id": 52415381, "link": "https://stackoverflow.com/questions/52415381/remove-duplicate-keys-from-a-hash-of-hashes-and-arrays-and-ensure-any-resulting/52513670#52513670", "title": "Remove duplicate keys from a hash of hashes and arrays (and ensure any resulting empty hashs are also removed)", "body": "<p>I take it that <a href=\"https://stackoverflow.com/a/52416224/4653379\">Shawn's answer</a> works for removing duplicates, what it looks good for.</p>\n<p>The follow up problem is that we may end up with empty structures and those need be removed as well.  But then there may also be structures that contain only empty structures, etc, and I assume that all such need be gone.</p>\n<p>I use the desired-result-hashref from the question (from which I remove one <code>name=&gt;...</code> so that there are no duplicates) and add some empty trouble.</p>\n<pre><code>use warnings;\nuse strict;\nuse feature 'say';\nuse Data::Dump qw(dd pp);\n\nmy $hr = {\n    'cat' =&gt; 'meow',\n    'dog' =&gt; [\n        { 'a' =&gt; { 'chow' =&gt;  { 'name' =&gt; 'barney' } }  },\n        { 'b' =&gt; { 'lab' =&gt; 'betty' }, 'c' =&gt; 'pebbles' },\n        { 'd' =&gt; { 'shihtzu' =&gt; 'bambam' }              },\n        {   # all of the following need to go, and this hashref\n            'e' =&gt; { },  \n            'f' =&gt; { noval =&gt; { } },\n            'g' =&gt; [ { }, { nada =&gt; { } }, [ ] ],\n        },\n    ],  \n};\ndd $hr; say '';\n\nfor my $k (sort keys %$hr) {\n    next_level($hr, $k, $hr-&gt;{$k}, 'key');\n}\n\n# Takes: data structure (reference), key/index at which it is found, \n# its value for it, and description string of which it is, 'key|idx'\nsub next_level {\n    my ($ds, $index, $val, $kind) = @_;\n    my $type = ref $val;\n\n    if ($type eq 'ARRAY') {\n        for my $i (0..$#$val) {\n            next_level(\n                ( $kind eq 'key' ? $ds-&gt;{$index} : $ds-&gt;[$index] ),\n                $i, $val-&gt;[$i], 'idx' \n            );\n        }\n\n        # Collect indices for and delete elements that are empty\n        my @to_delete;\n        for my $i (0..$#$val) {\n            if ( (ref $val-&gt;[$i] eq 'HASH'  and not keys %{$val-&gt;[$i]}) or\n                 (ref $val-&gt;[$i] eq 'ARRAY' and not      @{$val-&gt;[$i]})  )\n            {\n                say &quot;No value/empty for index $i, record for deletion&quot;;\n                push @to_delete, $i;\n            }\n        }\n        if (@to_delete) { \n            my %ref_idx = map { $_ =&gt; 1 } @to_delete;\n            @$val = @$val[ grep { not exists $ref_idx{$_} } 0..$#$val ];\n        }\n    }\n    elsif ($type eq 'HASH') {\n        for my $k (sort keys %{$val}) {\n            my $ds_next_level = \n                ($kind eq 'key') ? $ds-&gt;{$index} : $ds-&gt;[$index];\n\n            next_level( $ds_next_level, $k, $val-&gt;{$k}, 'key' );\n\n            # Delete if empty \n            if ( (ref $val-&gt;{$k} eq 'HASH'  and not keys %{$val-&gt;{$k}}) or\n                 (ref $val-&gt;{$k} eq 'ARRAY' and not      @{$val-&gt;{$k}})  )\n            {\n                say &quot;No value/empty for key $k, delete&quot;;\n                delete $ds_next_level-&gt;{$k}\n            }\n        }\n    }\n    #elsif (not $type) { say &quot;A value: &quot;, $val }\n}\nsay ''; dd $hr;\n</code></pre>\n<p>This is a normal recursive traversal of a complex data structure but with a twist: in order to be able to delete components the recursive sub also needs the data structure itself, at which key (in a hashref) or index (in an arrayref) it is found, and which of the two it was, a key or an index.</p>\n<p>After the recursion the target is deleted if it is empty, if it's in a hashref. An arrayref is scanned for all empty elements first and then they are removed by overwriting the arrayref, with an array slice that excludes indices for elements that contain only empty data structures.</p>\n<p>For the exclusion of &quot;bad&quot; indices a reference hash is used for efficiency. Overwriting the array may be faster using <code>map</code> (see <a href=\"https://stackoverflow.com/a/36003013/4653379\">this post</a>), or it may not be if slicing allows specific (interpreter) optimizations.</p>\n<p>The output</p>\n<pre>\n{\n  cat => \"meow\",\n  dog => [\n           { a => { chow => { name => \"barney\" } } },\n           { b => { lab => \"betty\" }, c => \"pebbles\" },\n           { d => { shihtzu => \"bambam\" } },\n           { e => {}, f => { noval => {} }, g => [{}, { nada => {} }, []] },\n         ],\n}\n\nNo value/empty for key e, delete\nNo value/empty for key noval, delete\nNo value/empty for key f, delete\nNo value/empty for key nada, delete\nNo value/empty for index 0, record for deletion\nNo value/empty for index 1, record for deletion\nNo value/empty for index 2, record for deletion\nNo value/empty for key g, delete\nNo value/empty for index 3, record for deletion\n\n{\n  cat => \"meow\",\n  dog => [\n           { a => { chow => { name => \"barney\" } } },\n           { b => { lab => \"betty\" }, c => \"pebbles\" },\n           { d => { shihtzu => \"bambam\" } },\n         ],\n}\n</pre>\n"}], "owner": {"reputation": 393, "user_id": 1437387, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87d4eb36e3cc1e8104979974f0c616d9?s=128&d=identicon&r=PG", "display_name": "Speeddymon", "link": "https://stackoverflow.com/users/1437387/speeddymon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 52416224, "answer_count": 2, "score": 0, "last_activity_date": 1595697861, "creation_date": 1537398979, "last_edit_date": 1537915145, "question_id": 52415381, "link": "https://stackoverflow.com/questions/52415381/remove-duplicate-keys-from-a-hash-of-hashes-and-arrays-and-ensure-any-resulting", "title": "Remove duplicate keys from a hash of hashes and arrays (and ensure any resulting empty hashs are also removed)", "body": "<p>I have a data stream in JSON format that my script accesses from an internal website. My script converts the JSON to a perl hash using JSON.pm (I'm using perl 5.10.1 on RHEL 6.9)</p>\n\n<p>Within this hash are multiple nested hashes, and nested arrays, some of which are nested within other hashes/arrays inside of the big hash.</p>\n\n<p>I need to walk the entire structure of the hash, including all of the arrays and nested hashes, and remove any keys anywhere in the entire structure, which share the same name as any other key (only for a specific key name though).</p>\n\n<p><strong>Additionally, because of how the data is structured, some nested hashes have ONLY keys that are now deleted, leaving the value for some keys as an empty hash. I also need to remove those keys which have an empty hash for its value</strong></p>\n\n<p>Here is my data after its conversion to perl:</p>\n\n<pre><code>$VAR1 = {\n          'cat' =&gt; 'meow',\n          'dog' =&gt; [\n                     {\n                        'a' =&gt; {\n                                  'husky' =&gt; {\n                                                'name' =&gt; 'fred'\n                                             },\n                                  'chow' =&gt; {\n                                               'name' =&gt; 'barney'\n                                            }\n                               },\n                     },\n                     {\n                        'b' =&gt; {\n                                  'husky' =&gt; 'wilma',\n                                  'lab' =&gt; 'betty'\n                               },\n                        'c' =&gt; 'pebbles' # yes this is intentionally a scalar in the example\n                     },\n                     {\n                        'd' =&gt; {\n                                  'shihtzu' =&gt; 'bambam'\n                               },\n                     },\n                     {\n                        'e' =&gt; {\n                                  'husky' =&gt; 'dino'\n                               },\n                     },\n                   ],\n        }\n</code></pre>\n\n<p>We want to remove all keys named 'husky'</p>\n\n<p>Here is what it should look like:</p>\n\n<pre><code>$VAR1 = {\n          'cat' =&gt; 'meow',\n          'dog' =&gt; [\n                     {\n                        'a' =&gt; {\n                                  'chow' =&gt; {\n                                               'name' =&gt; 'barney'\n                                            }\n                               },\n                     },\n                     {\n                        'b' =&gt; {\n                                  'labrador' =&gt; 'betty'\n                               },\n                        'c' =&gt; 'pebbles'\n                     },\n                     {\n                        'd' =&gt; {\n                                  'shihtzu' =&gt; 'bambam'\n                               },\n                     },\n                   ],\n        }\n</code></pre>\n\n<p>Here is what I get after I added @Shawn's code and made a tweak to it (this is very close, but we need to account for the empty hashes:</p>\n\n<pre><code>$VAR1 = {\n          'cat' =&gt; 'meow',\n          'dog' =&gt; [\n                     {\n                        'a' =&gt; {\n                                  'chow' =&gt; {\n                                               'name' =&gt; 'barney'\n                                            }\n                               },\n                     },\n                     {\n                        'b' =&gt; {\n                                  'lab' =&gt; 'betty'\n                               },\n                        'c' =&gt; 'pebbles' # yes this is intentionally a scalar in the example\n                     },\n                     {\n                        'd' =&gt; {\n                                  'shihtzu' =&gt; 'bambam'\n                               },\n                     },\n                     {\n                        'e' =&gt; {},\n                     },\n                   ]\n        }\n</code></pre>\n\n<p>I've tried a few variations found elsewhere on SO and on perlmonks. <code>keys %$_ == 0</code>, <code>!%$_</code> to name a few. But none seem to work with this hash slice.</p>\n\n<p>Code:</p>\n\n<pre><code>use 5.008008;\nuse strict;\nuse warnings;\nuse English; # I know I know, don't use English...\nuse JSON;\nuse YAML::Tiny qw(Dump);\n# proprietary modules I wrote added here, which themselves load in LWP, HTTP::Cookie and others, and they do the bulk of building and sending the request. They are the back end to this script's front end.\n\n[-snipped a ton of code-]\n\nsub _count_keys\n{\n    my ($j, $seen) = @ARG;\n    my $type = ref $j;\n    if ($type eq \"ARRAY\")\n    {\n        for (@{$j})\n        {\n            _count_keys($ARG, $seen);\n        }\n    }\n    elsif ($type eq \"HASH\")\n    {\n        while (my ($key, $val) = each %{$j})\n        {\n            $seen-&gt;{$key}++;\n            if (ref $val)\n            {\n                _count_keys($val, $seen);\n            }\n        }\n    }\n    return $seen;\n}\n\nsub _remove_duplicate_keys\n{\n    my ($j, $seen) = @ARG;\n    $seen //= _count_keys($j, {});\n\n    my $type = ref $j;\n    if ($type eq \"ARRAY\")\n    {\n        return [ map { _remove_duplicate_keys($ARG, $seen) } @{$j} ];\n    }\n    elsif ($type eq \"HASH\")\n    {\n        my %obj = %{$j};\n        delete @obj{grep { $seen-&gt;{$ARG} &gt; 1 and $ARG eq 'keyNameToBeExcluded'} keys %obj};\n# Here is where I have been putting another delete line but I can't seem to find the right parameters for the grep to make it delete the empty anon hashes. Example of what I tried is the next comment below\n#        delete @obj{grep { $seen-&gt;{$ARG} &gt; 1 and keys $ARG{assetDetails} == 0 } keys %obj};\n\n        while (my ($key, $val) = each %obj)\n        {\n            if (ref $val)\n            {\n                $obj{$key} = _remove_duplicate_keys($val, $seen);\n            }\n        }\n        return \\%obj;\n    }\n    else\n    {\n        return $j;\n    }\n}\n\nsub _process_json\n{\n    my $JSONOUTPUT   = shift;\n    my $OPTIONS      = shift;\n\n    # Change true to 1 and false to 0 to prevent blessed objects from appearing in the JSON, which prevents the YAML::Tiny module from barfing\n    foreach (@{$JSONOUTPUT})\n    {\n        s{true(,\\n)}{1$1}gxms;\n        s{false(,\\n)}{0$1}gxms;\n    }\n\n    my $JSONPERLOBJ  = JSON-&gt;new-&gt;utf8-&gt;decode(@{$JSONOUTPUT});\n\n# Test code below here; real code not in use while I test getting the output right.\nuse Data::Dumper;\nmy $BEFORE = $JSONPERLOBJ;\nmy $AFTER = _remove_duplicate_keys($JSONPERLOBJ);\n#    $JSONPERLOBJ = _remove_duplicate_keys($JSONPERLOBJ);\n#print Dumper $BEFORE;\nprint Dumper $AFTER;\nexit 1;\n# End test code\n}\nsub _main\n{\n    [-snip private code-]\n    my @JSONOUTPUT = $RESPONSE-&gt;decoded_content;\n    my $RC = _process_json(\\@JSONOUTPUT, $OPTIONS);\n\n    exit ($RC == 1)?0:1;\n}\n</code></pre>\n"}, {"tags": ["regex", "python-2.7", "perl", "m3u", "iptv"], "comments": [{"owner": {"reputation": 481636, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537395864, "post_id": 52414701, "comment_id": 91773651, "body": "<code>c = b.group()</code> should be <code>c = b.group(1)</code> but even if you used <code>group()</code> you should have received <code>tvg-logo=&quot;http:&#47;&#47;someprovider.tv&#47;logos&#47;sky%20sports%20action&zwnj;&#8203;%20hd.png&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537395426, "post_id": 52414858, "comment_id": 91773532, "body": "that is not printing the desired sub string..it is printing the entire string"}, {"owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537395560, "post_id": 52414858, "comment_id": 91773573, "body": "i had to remove the &#39;g&#39; on the end though as it was throwing an error at execution..."}, {"owner": {"reputation": 169, "user_id": 4792892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WceSz.jpg?s=128&g=1", "display_name": "lucas_7_94", "link": "https://stackoverflow.com/users/4792892/lucas-7-94"}, "reply_to_user": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537395807, "post_id": 52414858, "comment_id": 91773633, "body": "So, to be clear, you want to get  &#39;tvg-logo=&quot;http//somelinkwithapicture.png&quot; &#39;?"}, {"owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537395885, "post_id": 52414858, "comment_id": 91773657, "body": "yes...each instance of it in the text file...i am then going to replace it with an empty string"}, {"owner": {"reputation": 169, "user_id": 4792892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WceSz.jpg?s=128&g=1", "display_name": "lucas_7_94", "link": "https://stackoverflow.com/users/4792892/lucas-7-94"}, "reply_to_user": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537396013, "post_id": 52414858, "comment_id": 91773688, "body": "check now the edit, sorry for not asking before, still i&#39;m not able to comment, only add answers :/ thanks for not downvoting"}, {"owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537396937, "post_id": 52414858, "comment_id": 91773913, "body": "your regex works against the isolated string in your answer above, but parsing my .m3u file, it is not returning the required subset, but the full file"}, {"owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "edited": false, "score": 0, "creation_date": 1537397784, "post_id": 52414858, "comment_id": 91774130, "body": "i used to be sh*t hot with regexes as well...not used them much for a good while now and forgot most of what i knew..."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537399409, "post_id": 52414858, "comment_id": 91774454, "body": "The non-capturing group <code>(?:tvg-logo=\\&quot;)</code> is pointless; with <code>re.DOTALL</code> enabled you may as well replace <code>[\\w\\W]</code> with a dot <code>.</code>; it is better to use the closing double quote as the delimiter rather than a negative look-behind <code>(?&lt;=.png)</code>; and the dot in that look-behind needs to be escaped."}], "tags": [], "owner": {"reputation": 169, "user_id": 4792892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WceSz.jpg?s=128&g=1", "display_name": "lucas_7_94", "link": "https://stackoverflow.com/users/4792892/lucas-7-94"}, "is_accepted": false, "score": 0, "last_activity_date": 1537395976, "last_edit_date": 1537395976, "creation_date": 1537395054, "answer_id": 52414858, "question_id": 52414701, "link": "https://stackoverflow.com/questions/52414701/python-2-7-regex-not-matching-desired-pattern/52414858#52414858", "title": "Python 2.7 Regex not matching desired pattern", "body": "<p>Check <code>(?:tvg-logo=\\\")[\\w\\W]*(?&lt;=.png)</code></p>\n\n<pre><code>import re\nreg = '(?:tvg-logo=\\\")[\\w\\W]*(?&lt;=.png)'\n\nstring = '#EXTINF:-1 catchup=\"default\" catchup-source=\"http://someprovider.tv/play/dvr/${start}/2480.m3u8?token=%^%=&amp;duration=3600\" catchup-days=5 tvg-name=\"Sky Sports Action HD\" tvg-id=\"SkySportsAction.uk\" tvg-logo=\"http://someprovider.tv/logos/sky%20sports%20action%20hd.png\" group-title=\"Sports\",Sky Sports Action HD http://someprovider.tv/play/2480.m3u8?token=465454='\n\nprint re.findall(reg,string, re.DOTALL)[0]\n\n$python main.py\ntvg-logo=\"http://someprovider.tv/logos/sky%20sports%20action%20hd.png\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "is_accepted": false, "score": 0, "last_activity_date": 1537397284, "creation_date": 1537397284, "answer_id": 52415168, "question_id": 52414701, "link": "https://stackoverflow.com/questions/52414701/python-2-7-regex-not-matching-desired-pattern/52415168#52415168", "title": "Python 2.7 Regex not matching desired pattern", "body": "<p>This worked in the end:</p>\n\n<pre><code>import re\n\nclass iptv_cleanup():\n\n    filepath = 'C:\\\\Users\\\\cg371\\\\Downloads\\\\vget.m3u'\n\n    with open(filepath, \"r\") as text_file:\n        a = text_file.read()\n        b = re.findall(r'tvg-logo=\"(.*?)\"', a)\n\n        for i in b:\n\n            print i\n\n\n    text_file.close\n\niptv_cleanup()\n</code></pre>\n\n<p>Thanks you for your input all...</p>\n"}], "owner": {"reputation": 3210, "user_id": 3045351, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/QvwUz.jpg?s=128&g=1", "display_name": "gdogg371", "link": "https://stackoverflow.com/users/3045351/gdogg371"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537397284, "creation_date": 1537394109, "question_id": 52414701, "link": "https://stackoverflow.com/questions/52414701/python-2-7-regex-not-matching-desired-pattern", "title": "Python 2.7 Regex not matching desired pattern", "body": "<p>I am parsing all the rows of a .m3u file containing my IPTV playlist data. I am looking to isolate and print string sections within the file of the format:</p>\n\n<pre><code>tvg-logo=\"http//somelinkwithapicture.png\"\n</code></pre>\n\n<p>..within a string that looks like:</p>\n\n<pre><code>#EXTINF:-1 catchup=\"default\" catchup-source=\"http://someprovider.tv/play/dvr/${start}/2480.m3u8?token=%^%=&amp;duration=3600\" catchup-days=5 tvg-name=\"Sky Sports Action HD\" tvg-id=\"SkySportsAction.uk\" tvg-logo=\"http://someprovider.tv/logos/sky%20sports%20action%20hd.png\" group-title=\"Sports\",Sky Sports Action HD\nhttp://someprovider.tv/play/2480.m3u8?token=465454=\n</code></pre>\n\n<p>My class looks like this:</p>\n\n<pre><code>import re\n\nclass iptv_cleanup():\n\n    filepath = 'C:\\\\Users\\\\cg371\\\\Downloads\\\\vget.m3u'\n\n    with open(filepath, \"r\") as text_file:\n        a = text_file.read()\n        b = re.search(r'tvg-logo=\"(.*?)\"', a)\n        c = b.group()\n        print c\n\n    text_file.close\n\niptv_cleanup()\n</code></pre>\n\n<p>All I am getting returned though is a string like this:</p>\n\n<pre><code>tvg-logo=\"\"\n</code></pre>\n\n<p>I am a bit rusty with regexes, but I cannot see anything obviously wrong with this.</p>\n\n<p>Can anyone assist?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1537389920, "post_id": 52413598, "comment_id": 91771642, "body": "If you need to parse XML, use an XML parsing library like <a href=\"https://metacpan.org/pod/XML::Parser\" rel=\"nofollow noreferrer\">XML::Parser</a> or one of the many alternatives. <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\">Classic answer about why you don&#39;t want to use res</a>"}, {"owner": {"reputation": 115, "user_id": 4721213, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/704c1669981d2d0ee1f53d958caaf756?s=128&d=identicon&r=PG&f=1", "display_name": "Aswanikumar", "link": "https://stackoverflow.com/users/4721213/aswanikumar"}, "edited": false, "score": 0, "creation_date": 1537391271, "post_id": 52413598, "comment_id": 91772174, "body": "The code is already implemented and i am trying to remove the legacy system and re implemented in the new technology . so i need some help on understanding this regular expression for the above input."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1537392721, "post_id": 52413598, "comment_id": 91772672, "body": "See <a href=\"https://perldoc.perl.org/perlretut.html#Grouping-things-and-hierarchical-matching\" rel=\"nofollow noreferrer\">perldoc perlretut</a> for more information about capture groups and the capture variables <code>$1</code>, <code>$2</code>, ..."}], "answers": [{"comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537392594, "post_id": 52414258, "comment_id": 91772625, "body": "Just a suggestion: Maybe also mention that a capture group is created by enclosing a regex or part of regex in parenthesis?"}, {"owner": {"reputation": 481, "user_id": 8807682, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhGg6arUEVo/AAAAAAAAAAI/AAAAAAAAAA0/fpq6TX1FQEI/photo.jpg?sz=128", "display_name": "YOGO", "link": "https://stackoverflow.com/users/8807682/yogo"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537392933, "post_id": 52414258, "comment_id": 91772735, "body": "Yes , you are right . I just explained it with this example"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537393094, "post_id": 52414258, "comment_id": 91772788, "body": "Yes that was a good example. My only suggestion is to be even more explicit about it.. A newcomer might not understand everything as easily as we."}, {"owner": {"reputation": 481, "user_id": 8807682, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhGg6arUEVo/AAAAAAAAAAI/AAAAAAAAAA0/fpq6TX1FQEI/photo.jpg?sz=128", "display_name": "YOGO", "link": "https://stackoverflow.com/users/8807682/yogo"}, "edited": false, "score": 0, "creation_date": 1537421107, "post_id": 52414258, "comment_id": 91779308, "body": "Thanks, but you deleted the explanation about the lazy quantifier. There is a different result if you use *? Or just *"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537430343, "post_id": 52414258, "comment_id": 91783647, "body": "@Borodin It looks great!"}], "tags": [], "owner": {"reputation": 481, "user_id": 8807682, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zhGg6arUEVo/AAAAAAAAAAI/AAAAAAAAAA0/fpq6TX1FQEI/photo.jpg?sz=128", "display_name": "YOGO", "link": "https://stackoverflow.com/users/8807682/yogo"}, "is_accepted": false, "score": 2, "last_activity_date": 1537436366, "last_edit_date": 1592644375, "creation_date": 1537391427, "answer_id": 52414258, "question_id": 52413598, "link": "https://stackoverflow.com/questions/52413598/variable-interpolation-in-regular-expressions-substitutions/52414258#52414258", "title": "Variable interpolation in regular expressions substitutions", "body": "<p>When you use a regex pattern there is something called <em>capturing groups</em>, which are delimited by parentheses <code>(...)</code> in the pattern. They are numbered in the order that their opening parentheses appear in the pattern, and are used to save parts of a string to the built-in Perl variables <code>$1</code>, <code>$2</code> etc.</p>\n<p>For example <code>/(Hello?)(goo?d)/</code> captures <code>hello</code> or <code>hell</code> in <code>$1</code>, and <code>good</code> or <code>god</code> in <code>$2</code></p>\n<hr />\n<h3>About your example</h3>\n<pre><code>$Str =~ s|&lt;Hyperlink\\b[^\\&gt;]*?&gt;([^\\xFF]*?)([12][890][0-9]{2})([^\\xFF]*?)&lt;/Hyperlink&gt;|&lt;Emph Emph.Type=&quot;Italic&quot;&gt;$1&lt;/Emph&gt;$2$3|g;\n</code></pre>\n<ul>\n<li><p><code>([^\\xFF]*?)</code> will capture any character not equal to FF (hexadecimal) from 0 to infinite amount of times. It can capture 0 characters or more not equal to <code>&quot;\\xFF&quot;</code></p>\n</li>\n<li><p><code>([12][890][0-9]{2})</code> will capture a digit <code>1</code> or <code>2</code>, followed by a digit <code>8</code> <code>9</code> or <code>0</code>, followed by two digits from <code>0</code> to <code>9</code>.</p>\n</li>\n<li><p><code>([^\\xFF]*?)</code> is the same as the first capturing group</p>\n</li>\n</ul>\n"}], "owner": {"reputation": 115, "user_id": 4721213, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/704c1669981d2d0ee1f53d958caaf756?s=128&d=identicon&r=PG&f=1", "display_name": "Aswanikumar", "link": "https://stackoverflow.com/users/4721213/aswanikumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537436366, "creation_date": 1537388189, "last_edit_date": 1592644375, "question_id": 52413598, "link": "https://stackoverflow.com/questions/52413598/variable-interpolation-in-regular-expressions-substitutions", "title": "Variable interpolation in regular expressions substitutions", "body": "\n<p>I am working on Perl programs to parse XML and do regex string replacements on the data. I read a couple of articles on string substitution using Perl.</p>\n<p>While replacing the source value with the target string they are using some <code>$</code> variables(<code>$1</code> ,<code>$2</code>, <code>$3</code> and <code>$4</code> etc.). How does the pattern store the values while doing the string comparison?</p>\n<p>Please find some sample code which am looking for.</p>\n<h3>Sample XML file</h3>\n<pre class=\"lang-xml prettyprint-override\"><code>  &lt;Para&gt;\n    &lt;Hyperlink Display=&quot;hide&quot; Protocol=&quot;http&quot; URN=&quot;https://www.basicurl.org/oid/10.1161/RIA.0000abc&quot;&gt;\n      AHA\n    &lt;/Hyperlink&gt;\n    (Free)\n  &lt;/Para&gt;\n  &lt;Para&gt;\n    &lt;Hyperlink Display=&quot;hide&quot; Protocol=&quot;http&quot; URN=&quot;https://www.abcd.com&quot;&gt;\n      Background: some text with multiple lines\n    &lt;/Hyperlink&gt;\n    (i have three lines of code)\n  &lt;/Para&gt;\n&lt;/Comment&gt;\n</code></pre>\n<h3>Target achievement</h3>\n<pre class=\"lang-perl prettyprint-override\"><code>$Str =~ s|&lt;Hyperlink\\b[^\\&gt;]*?&gt;([^\\xFF]*?)([12][890][0-9]{2})([^\\xFF]*?)&lt;/Hyperlink&gt;|&lt;Emph Emph.Type=&quot;Italic&quot;&gt;$1&lt;/Emph&gt;$2$3|g;\n</code></pre>\n<p>To my understanding, we are selecting hyperlink data and replacing the value in <code>$str</code>. The <code>/g</code> represents a global substitution. What are the values of <code>$1</code>, <code>$2</code>, and <code>$3</code> from the above input file?</p>\n"}, {"tags": ["perl", "arguments", "named"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1531971"}, "edited": false, "score": 0, "creation_date": 1537386706, "post_id": 52412591, "comment_id": 91770288, "body": "<a href=\"https://stackoverflow.com/q/12962461/1531971\">stackoverflow.com/q/12962461/1531971</a>"}, {"owner": {"reputation": 6258, "user_id": 82262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce15931410b388a52eb2df4a864137f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jacob", "link": "https://stackoverflow.com/users/82262/matt-jacob"}, "edited": false, "score": 1, "creation_date": 1537388877, "post_id": 52412591, "comment_id": 91771184, "body": "What have you tried so far? What isn&#39;t working about what you&#39;ve tried so far?"}, {"owner": {"reputation": 9, "user_id": 10307726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f1ed33fdfa0d585655b02a4cdec52f?s=128&d=identicon&r=PG&f=1", "display_name": "jtech", "link": "https://stackoverflow.com/users/10307726/jtech"}, "edited": false, "score": 0, "creation_date": 1537390268, "post_id": 52412591, "comment_id": 91771791, "body": "It is working so far, I just want to replace the positional arguments to named arguments and keep the original structure as much as possible."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537390458, "post_id": 52412591, "comment_id": 91771869, "body": "What on earth is <code>chomp $!</code> for?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537390690, "post_id": 52412591, "comment_id": 91771953, "body": "Stack Overflow is a repository for answers to specific programming questions, not a place to get programming effort for free. Make your genuinely best attempt at writing the code yourself\u2014it&#39;s not at all hard\u2014and in the unlikely event that you cannot get it working then post your code here and ask for help to fix it."}, {"owner": {"reputation": 9, "user_id": 10307726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f1ed33fdfa0d585655b02a4cdec52f?s=128&d=identicon&r=PG&f=1", "display_name": "jtech", "link": "https://stackoverflow.com/users/10307726/jtech"}, "edited": false, "score": 0, "creation_date": 1537391860, "post_id": 52412591, "comment_id": 91772381, "body": "If I understood correctly this is a place for asking for help for a specific question but, can&#39;t ask for help for a specific question here, is that right? btw: I have used chomp $! to avoid creation of blank lines from the output in the array."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537395706, "post_id": 52412591, "comment_id": 91773607, "body": "@jtech: Stack Overflow is a <i>question and answer site</i>, and your problem is too broad, especially without any attempt at solving the problem yourself. I suggest you take a look at <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>."}, {"owner": {"reputation": 6258, "user_id": 82262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ce15931410b388a52eb2df4a864137f?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jacob", "link": "https://stackoverflow.com/users/82262/matt-jacob"}, "edited": false, "score": 0, "creation_date": 1537399891, "post_id": 52412591, "comment_id": 91774535, "body": "@jtech I get that it&#39;s working right now, but you said you want to make changes so that the code does something else. What have you tried in order to effect those changes, and how has that failed to work?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537404065, "post_id": 52412591, "comment_id": 91775359, "body": "While the title of the question that this is a duplicate of has &quot;object&quot; in it the answers discuss and show you exactly what you ask."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 3, "creation_date": 1537436371, "post_id": 52412591, "comment_id": 91787072, "body": "I rolled back your edit to the question that was defacing it. Even if your question is a duplicate and there is a good answer already, someone else might come across this answer by looking for the question you asked. You didn&#39;t find the right answer on your own, but the next person now can, because of the duplicate."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1537436580, "post_id": 52412591, "comment_id": 91787216, "body": "The answer in the duplicate target looks like it is talking about something else, but it actually tells you exactly what you need to do, even if it&#39;s in a different context. Essentially, you want a to assign your <code>@_</code> to a hash in your function. That&#39;s all there is to it. Please note that variable names like <code>$array_ref</code> and <code>$hash_ref</code> are really confusing, because they don&#39;t say anything about the kind of data that&#39;s in them. It&#39;s obvious from the way the var is used that it&#39;s an array reference, but <i>what does it contain</i>? If you want positional parameters, you need to think about that."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1537478771, "post_id": 52412591, "comment_id": 91810785, "body": "@simbabque  Thank you for rolling it back and for offering clarifications.  A note: I edited the title of the duplicate target, adding &quot;named parameters&quot; to it. It&#39;s choke full of useful stuff about that topic (and I quoted it a few times already) but it could not be found easily since the title gave no clue."}], "owner": {"reputation": 9, "user_id": 10307726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f1ed33fdfa0d585655b02a4cdec52f?s=128&d=identicon&r=PG&f=1", "display_name": "jtech", "link": "https://stackoverflow.com/users/10307726/jtech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1537404024, "answer_count": 0, "score": 0, "last_activity_date": 1537436264, "creation_date": 1537383613, "last_edit_date": 1537436264, "question_id": 52412591, "link": "https://stackoverflow.com/questions/52412591/how-can-i-change-the-positional-arguments-to-named-arguments-in-this-code-pleas", "closed_reason": "Duplicate", "title": "How can I change the positional arguments to named arguments in this code, please?", "body": "<p>I would appreciate it if someone can tell me how can I change the positional arguments to named arguments in this Perl code, please?</p>\n\n<pre><code>#!/usr/bin/perl -w\n\nsub diskUsageMon {\n    my ($hash_ref, $array_ref) = @_;\n\n    unless ( open(DF, \"df -kh 2&gt;&amp;1 |\") ) {\n        chomp $!;\n        push $array_ref, \"Failed to start command df\", \"Reason: $!\";\n        return 1;\n    }; # Unless\n\n    while ( &lt;DF&gt; ) {\n        next if /^Filesystem/;\n        @df = split;\n        my ($mount, $use) = @df[5,4];\n        $hash_ref-&gt;{$mount} = $use;\n    }; # While\n\n    close DF;\n\n    return 0;\n}; # sub\n\n#---------------------------------------------------------#\n\n%hash_ref = ();\n@array_ref = ();\n\nif ( &amp;diskUsageMon(\\%hash_ref, \\@array_ref) ) {\n    die \"Error detected!\\n\", \"Reason: \", join(\"\\n\", @array_ref), \"\\n\";\n};\n</code></pre>\n"}, {"tags": ["bash", "perl"], "comments": [{"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 0, "creation_date": 1537383566, "post_id": 52411626, "comment_id": 91768795, "body": "Please edit your question to include what output you&#39;re getting currently. Also, consider adding some more echo statements to confirm it&#39;s getting as far as you think it is. e.g. first thing in the loop, the result of the match, etc. That should lead you to where it is breaking down quickly."}, {"owner": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "reply_to_user": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "edited": false, "score": 0, "creation_date": 1537384149, "post_id": 52411626, "comment_id": 91769056, "body": "Hi David, not sure how can I answer this , but in fact I don<code>t get any output . It does not run and does not produce an error.Something is missing and me not being so keen on coding , I just don</code>t know how to debug it in such scenario."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1537407901, "post_id": 52411626, "comment_id": 91776121, "body": "Two great suggestions: David Hempy&#39;s <code>echo</code> (which apparently failed to echo <i>ANYTHING</i>) and Mike Q&#39;s a) <code>First, check that your input and output is working correctly</code>, then b) <code>instead of a function first try to make it work as a script</code>.  PLEASE TRY REMOVING <code>ping() { ...}</code>: just make it a &quot;script&quot; (instead of a &quot;scription function&quot;) and see what happens."}, {"owner": {"reputation": 4966, "user_id": 1618630, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0OfVn.jpg?s=128&g=1", "display_name": "Mike Q", "link": "https://stackoverflow.com/users/1618630/mike-q"}, "edited": false, "score": 0, "creation_date": 1537564058, "post_id": 52411626, "comment_id": 91845419, "body": "@REX kindly have a look at my answer"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "edited": false, "score": 0, "creation_date": 1537386168, "post_id": 52412911, "comment_id": 91770010, "body": "No output in any of the test lines :                                                                                                                    REX@Lenovo-PC:/mnt/c/Users/REX$ ./pingme.sh     REX@Lenovo-PC:/mnt/c/Users/REX$ ./pingme.sh DL11     REX@Lenovo-PC:/mnt/c/Users/REX$ ./pingme.sh DL12     REX@Lenovo-PC:/mnt/c/Users/REX$ ./pingme.sh DL13     REX@Lenovo-PC:/mnt/c/Users/REX$ ./pingme.sh DL14     REX@Lenovo-PC:/mnt/c/Users/REXi$"}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "reply_to_user": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "edited": false, "score": 0, "creation_date": 1537535122, "post_id": 52412911, "comment_id": 91831507, "body": "Excellent! Now you know the for loop is never entered. Now start inserting some echos between each of the lines above, and see which it the first one that doesn&#39;t do what you expect."}, {"owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "reply_to_user": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "edited": false, "score": 0, "creation_date": 1537535195, "post_id": 52412911, "comment_id": 91831555, "body": "BTW, where are you actually calling pingme() ? Can you edit your question to show that? Just defining a function won&#39;t run it."}], "tags": [], "owner": {"reputation": 3090, "user_id": 4454732, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-8OrTJkCtkn4/AAAAAAAAAAI/AAAAAAAAA4s/7jp2lrThK2k/photo.jpg?sz=128", "display_name": "David Hempy", "link": "https://stackoverflow.com/users/4454732/david-hempy"}, "is_accepted": false, "score": 1, "last_activity_date": 1537384914, "creation_date": 1537384914, "answer_id": 52412911, "question_id": 52411626, "link": "https://stackoverflow.com/questions/52411626/ping-script-with-filter/52412911#52412911", "title": "Ping Script with filter", "body": "<p>Try adding these two lines to your code:</p>\n\n<pre><code>pingme () {\nhostfile=\"/home/rex/u128789/hostfile.txt\"\nIFS= mapfile -t  hosts &lt; &lt;(cat $hostfile)\nfor host in \"${hosts[@]}\"; do\n    echo \"Hostname: $host\"                      # &lt;-------- ADD THIS LINE -------\n    match=$(echo \"$host\" | grep -o \"\\-$1_\" | sed 's/-//' | sed 's/_//')\n    echo \"...matched with $match\"               # &lt;-------- ADD THIS LINE -------\n    if [[ \"$match\" = \"$1\" ]]; then\n        hostname=$(echo \"$host\" | awk '{print $2}')\n        ping -c1 -W1 $(echo \"$host\" | awk '{print $1}') &gt; /dev/null\n        if [[ $? = 0 ]]; then\n            echo \"$hostname is alive\"\n        elif [[ $? = 1 ]]; then\n            echo \"$hostname is dead\"\n        fi\n    fi\ndone\n}\n</code></pre>\n\n<p>Then when you run it, you should see a list of your  hosts, at least. </p>\n\n<ul>\n<li>If you don't then you're not reading your file successfully.  </li>\n<li>If you do, there's a problem in your per-host logic.</li>\n</ul>\n\n<p>Congratulations! You've divided your problem into two smaller problems. Once you know which half has the problem, keep dividing the problem in half until the smallest possible problem is staring you in the face. You'll probably know the solution at that point. If not, add your findings to the question and we'll help out from there.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "edited": false, "score": 0, "creation_date": 1537391005, "post_id": 52413933, "comment_id": 91772072, "body": "Thanks for your reply. No results unfortunately . I will have a go on 2 other Linux systems to see if it would even budge. Surely must be something I am doing wrong- saving the file as .sh/ calling it as ./pingme.sh  or version of linux , or text file. Will explore.But at least produces an error = &gt;  ./pingme.sh DL14 ./pingme.sh: line 5: $/mnt/c/Users/REX/hostfile.txt: No such file or directory"}, {"owner": {"reputation": 2838, "user_id": 4154375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56dba9cd817fb4dfb662c6a91010fbb?s=128&d=identicon&r=PG&f=1", "display_name": "pjh", "link": "https://stackoverflow.com/users/4154375/pjh"}, "reply_to_user": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "edited": false, "score": 0, "creation_date": 1537398216, "post_id": 52413933, "comment_id": 91774217, "body": "The error message refers to a file <code>$&#47;mnt&#47;c&#47;Users&#47;REX&#47;hostfile.txt</code>.  With the leading <code>$</code>, that does&#39;t look like a valid path.  It&#39;s not the filename in the example code.  I guess that something went wrong when the code was modified.  Also, the error occurred on line 5, and the redirection in the example code is much later in the source file.  It looks like something other than the example code is in &#39;pingme.sh&#39;.  Check the contents of &#39;pingme.sh&#39;, and particularly check the path to &#39;hostfile.txt&#39;."}], "tags": [], "owner": {"reputation": 2838, "user_id": 4154375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56dba9cd817fb4dfb662c6a91010fbb?s=128&d=identicon&r=PG&f=1", "display_name": "pjh", "link": "https://stackoverflow.com/users/4154375/pjh"}, "is_accepted": false, "score": 1, "last_activity_date": 1537389782, "creation_date": 1537389782, "answer_id": 52413933, "question_id": 52411626, "link": "https://stackoverflow.com/questions/52411626/ping-script-with-filter/52413933#52413933", "title": "Ping Script with filter", "body": "<p>The original code doesn't handle the pipe separator or the possibly reversed hostname and IP address in the input file.  It also  makes a lot of unnecessary use of external programs (<code>grep</code>, <code>sed</code>, ...).</p>\n\n<p>Try this:</p>\n\n<pre><code># Enable extended glob patterns - e.g. +(pattern-list)\nshopt -s extglob\n\nfunction pingme\n{\n    local -r host_denom=$1\n\n    local -r hostfile=$HOME/u128789/hostfile.txt\n\n    local ipaddr host tmp\n    # (Add '|' to the usual characters in IFS)\n    while IFS=$'| \\t\\n' read -r ipaddr host ; do\n        # Swap host and IP address if necessary\n        if [[ $host == +([0-9]).+([0-9]).+([0-9]).+([0-9]) ]] ; then\n            tmp=$host\n            host=$ipaddr\n            ipaddr=$tmp\n        fi\n\n        # Ping the host if its name contains the \"denominator\"\n        if [[ $host == *-\"$host_denom\"_* ]] ; then\n            if ping -c1 -W1 -- \"$ipaddr\" &gt;/dev/null ; then\n                printf '%s is alive\\n' \"$host\"\n            else\n                printf '%s is dead\\n' \"$host\"\n            fi\n        fi\n    done &lt; \"$hostfile\"\n\n    return 0\n}\n\npingme DL13\n</code></pre>\n\n<p>The final line (call the <code>pingme</code> function) is just an example, but it's essential to make the code do something.</p>\n"}, {"tags": [], "owner": {"reputation": 4966, "user_id": 1618630, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0OfVn.jpg?s=128&g=1", "display_name": "Mike Q", "link": "https://stackoverflow.com/users/1618630/mike-q"}, "is_accepted": false, "score": 1, "last_activity_date": 1537407122, "last_edit_date": 1537407122, "creation_date": 1537406794, "answer_id": 52416225, "question_id": 52411626, "link": "https://stackoverflow.com/questions/52411626/ping-script-with-filter/52416225#52416225", "title": "Ping Script with filter", "body": "<p>REX, you need to be more specific about your what IP's you are trying to get from this example. You also don't ping enough times IMO and your script is case sensitive checking the string (not major). Anyway, </p>\n\n<p>First, check that your input and output is working correctly, in this example I'm just reading and printing, if this doesn't work fix permissions etc :</p>\n\n<pre><code>file=\"/tmp/hostfile.txt\"\nwhile IFS= read -r line ;do\n        echo $line\ndone &lt; \"${file}\"\n</code></pre>\n\n<p>Next, instead of a function first try to make it work as a script, in this example I manually set \"match\" to DL13, then I read each line (like before) and (1) match on $match, if found I remove the '|', and then read the line into an array of 2. if the first array item is an a IP (contains periods) set it as the IP the other as hostname, else set the opposite. Then run the ping test.</p>\n\n<pre><code># BASH4+ Example:\nfile=\"/tmp/hostfile.txt\"\nmatch=\"dl13\"\nwhile IFS= read -r line ;do\n\n        # -- check for matching string (e.g. dl13 --\n        [[ \"${line,,}\" =~ \"${match,,}\" ]] || continue\n\n        # -- We found a match, split out host/ip into vars --\n        line=$(echo ${line//|})\n        IFS=' ' read -r -a items &lt;&lt;&lt; \"$line\"\n        if [[ \"${items[0]}\" =~ '.' ]] ;then\n            host=\"${items[1]}\" ; ip=\"${items[0]}\"\n        else\n            host=\"${items[0]}\" ; ip=\"${items[1]}\"\n        fi\n\n        # -- Ping test --\n        ping -q -c3 \"${ip}\" &gt; /dev/null\n        if [ $? -eq 0 ] ;then\n            echo \"$host is alive!\"\n        else\n            echo \"$host is toast!\"\n        fi\n\ndone &lt; \"${file}\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10387253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e0f6bcce1db955cd67b1994959d429?s=128&d=identicon&r=PG&f=1", "display_name": "REX", "link": "https://stackoverflow.com/users/10387253/rex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1537407122, "creation_date": 1537379628, "last_edit_date": 1537380964, "question_id": 52411626, "link": "https://stackoverflow.com/questions/52411626/ping-script-with-filter", "title": "Ping Script with filter", "body": "<p>I have a text file with host names and IP addresses like so (one IP and one host name per row). The IP addresses and host names can be separated by a spaces and/or a pipe, and the host name may be before or after the IP address</p>\n\n<pre><code>10.10.10.10 HW-DL11_C023\n11.11.11.11 HW-DL11_C024\n10.10.10.13 | HW-DL12_C023\n11.11.11.12 | HW-DL12_C024\nHW-DL13_C023 11.10.10.10 \nHW-DL13_C024 21.11.11.11 \nHW-DL14_C023 | 11.10.10.10 \nHW-DL14_C024 | 21.11.11.11 \n</code></pre>\n\n<p>The script below should be able to ping hosts with a common denominator e.g. DL13 (there are two devices and it will ping only those two). What am I doing wrong, as I simply can`t make it work?</p>\n\n<p>The script is in the same directory as the data; I don`t get errors, and everything is formatted. The server is Linux.</p>\n\n<pre><code>pingme () {\nhostfile=\"/home/rex/u128789/hostfile.txt\"\nIFS= mapfile -t  hosts &lt; &lt;(cat $hostfile)\nfor host in \"${hosts[@]}\"; do\n    match=$(echo \"$host\" | grep -o \"\\-$1_\" | sed 's/-//' | sed 's/_//')\n    if [[ \"$match\" = \"$1\" ]]; then\n        hostname=$(echo \"$host\" | awk '{print $2}')\n        ping -c1 -W1 $(echo \"$host\" | awk '{print $1}') &gt; /dev/null\n        if [[ $? = 0 ]]; then\n            echo \"$hostname is alive\"\n        elif [[ $? = 1 ]]; then\n            echo \"$hostname is dead\"\n        fi\n    fi\ndone\n}\n</code></pre>\n"}, {"tags": ["linux", "perl", "sockets", "strace", "fstat"], "comments": [{"owner": {"reputation": 170445, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "edited": false, "score": 1, "creation_date": 1537380037, "post_id": 52411249, "comment_id": 91767120, "body": "Please include some of the Perl code you&#39;re using to read from the socket."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537448877, "post_id": 52411249, "comment_id": 91794753, "body": "I&#39;m pretty sure that means the process received a signal. This interrupted the <code>read</code> so the signal could be handled, after which the <code>read</code> was resumed."}], "owner": {"reputation": 21, "user_id": 10387096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff43490525e430f91038b3c5faedd3d?s=128&d=identicon&r=PG&f=1", "display_name": "MArk W.", "link": "https://stackoverflow.com/users/10387096/mark-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537428290, "creation_date": 1537377878, "last_edit_date": 1537428290, "question_id": 52411249, "link": "https://stackoverflow.com/questions/52411249/fstat64-in-a-strace-and-unfinished-read", "title": "fstat64 in a strace and unfinished read", "body": "<p>I have a small web app written in perl running mod_perl under apache. All it does is create a socket connection to a server and waits for an OK message before it sends a request. we only have max 10 children. At random times the reading of this Ok message fails. Other reads are fine at the same time.\nI have strace'd it with </p>\n\n<pre><code>sudo strace -x -o traceout.log -f -tt -s 1024 -p 23735\n</code></pre>\n\n<p>normal reads have:</p>\n\n<pre><code>31317 14:27:18.043630 alarm(30)         = 0\n31317 14:27:18.043722 read(17, \"OK nGSrv ready. $Revision: 1.59 $  Built: May  5 2017 11:17:19 - [1]\\r\\n\", 4096) = 70\n31317 14:27:18.043811 alarm(0)          = 30\n</code></pre>\n\n<p>but failures have:</p>\n\n<pre><code>31198 14:26:34.350791 alarm(30)         = 0\n31198 14:26:34.350836 fstat64(16, {st_mode=S_IFSOCK|0777, st_size=0, ...}) = 0\n31198 14:26:34.350934 read(16, \"OK nGSrv ready. $Revision: 1.59 $  Built: May  5 2017 11:17:19 - [3]\\r\\n\", 4096) = 70\n31198 14:26:34.351014 read(16,  &lt;unfinished ...&gt;\n:\n:\n31198 14:26:39.345766 &lt;... read resumed&gt; \"\", 4096) = 0\n31198 14:26:39.345829 alarm(0)          = 25\n</code></pre>\n\n<p>the 5 second alarm/timeout is the other end closing the connection as it has not received a request.</p>\n\n<p>Does anyone know why the fails have this extra fstat64 and the unfinished read? </p>\n\n<pre><code>$server = IO::Socket::INET-&gt;new(Proto =&gt; \"tcp\",\n                              PeerAddr  =&gt; $ip,\n                              PeerPort  =&gt; $port,\n                              Timeout   =&gt; $timeout);\nif( $server ) {\n    eval {\n      local $SIG{ALRM} = sub { die \"alarm\\n\" }; # \\n required!!!!\n      alarm $queuetimeout;\n      $greeting = &lt;$server&gt;;\n      alarm 0;\n  };\n  if($@) { # Something in the eval died\n      unless( $@ eq \"alarm\\n\" ) {\n        # Unexpected Error\n        $greeting = 'ERROR'; # Force an ERROR response\n      } else {\n        #  Timeout\n        $greeting = 'BUSY'; # Force a BUSY response\n      }\n  }\n</code></pre>\n\n<p>The line giving the 'extra' fstat64 and the unfinished read is:-  </p>\n\n<pre><code>$greeting = &lt;$server&gt;;\n</code></pre>\n\n<p>This works fine until some random event causes 1 in 10 to fail, for a random period of time, then they stop. This affects 6 web servers all on the same network, with common mounts and common DB. The only difference we can find is this fstat64. These 6 web servers (apache, mod_perl) connect to one of 2 other servers also on the same network.\nWe have tcpdump'ed both servers and can see that the \"OK nGSrv ready...\" message is sent immediately and received immediately, but somehow (only during these random periods) is not read fully/correctly by the client.  </p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 2, "creation_date": 1537371176, "post_id": 52409380, "comment_id": 91762594, "body": "A belated welcome to the site!  Check out the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  So that we can help you more effectively, would you please <a href=\"https://stackoverflow.com/posts/52409380/edit\">edit your question</a> to include a self-contained script that we can run that shows the problem?  For example, what is the <code>$cmd_list</code> you are using as input?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537373634, "post_id": 52409380, "comment_id": 91763999, "body": "Re &quot;<i>of the value &quot;network&quot; in a string array</i>&quot;, The are no arrays anywhere in your code. It&#39;s counting the matching strings in the <i>scalars</i> (aka <i>list of scalars</i> aka <i>list</i>) returned by <code>split</code>."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537391122, "post_id": 52409380, "comment_id": 91772117, "body": "Yet another problem that would probably have been a lot easier to track down if the program had included <code>use strict</code>."}, {"owner": {"reputation": 31, "user_id": 2835314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84284190f7e6bef07e56e3b77cb141c0?s=128&d=identicon&r=PG&f=1", "display_name": "user4711", "link": "https://stackoverflow.com/users/2835314/user4711"}, "edited": false, "score": 0, "creation_date": 1537423592, "post_id": 52409380, "comment_id": 91780280, "body": "I mean the value &#39;network&#39;. Seems like a copy &amp; paste error from the example."}, {"owner": {"reputation": 31, "user_id": 2835314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84284190f7e6bef07e56e3b77cb141c0?s=128&d=identicon&r=PG&f=1", "display_name": "user4711", "link": "https://stackoverflow.com/users/2835314/user4711"}, "edited": false, "score": 0, "creation_date": 1537423663, "post_id": 52409380, "comment_id": 91780307, "body": "$cmd_list is a string with values separated by spaces."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2835314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84284190f7e6bef07e56e3b77cb141c0?s=128&d=identicon&r=PG&f=1", "display_name": "user4711", "link": "https://stackoverflow.com/users/2835314/user4711"}, "edited": false, "score": 0, "creation_date": 1537427107, "post_id": 52409727, "comment_id": 91781948, "body": "The first any function call was just what I&#39;m looking for. Thanks a lot. :-)"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 31, "user_id": 2835314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84284190f7e6bef07e56e3b77cb141c0?s=128&d=identicon&r=PG&f=1", "display_name": "user4711", "link": "https://stackoverflow.com/users/2835314/user4711"}, "edited": false, "score": 1, "creation_date": 1537429962, "post_id": 52409727, "comment_id": 91783459, "body": "@user4711 You are welcome :)   Also keep in mind <a href=\"https://metacpan.org/pod/List::MoreUtils\" rel=\"nofollow noreferrer\">List::MoreUtils</a>, which has a lot more."}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 5, "last_activity_date": 1537431651, "last_edit_date": 1537431651, "creation_date": 1537372016, "answer_id": 52409727, "question_id": 52409380, "link": "https://stackoverflow.com/questions/52409380/replace-foreach-with-grep-in-perl/52409727#52409727", "title": "Replace foreach with grep in perl", "body": "<p>There seems to be a typo, as <code>$network</code> is a variable; you may mean <code>/^network$/</code>.  </p>\n\n<p>Having <code>use strict;</code> in your program would have alerted you to an untended (so undeclared) variable.  Having <code>use warnings;</code> would have alerted you to the use of an uninitialized variable in regex compilation.</p>\n\n<p>In the loop you only set the variable <code>$PRINT_TP</code> (to 1) if there are any elements that match. Then <a href=\"https://perldoc.perl.org/List/Util.html\" rel=\"nofollow noreferrer\">List::Util</a> has a function just for that</p>\n\n<pre><code>my $PRINT_IP = any { $_ eq 'network' } split ' ', $cmd_list;\n</code></pre>\n\n<p>or </p>\n\n<pre><code>my $PRINT_IP = any { /^network\\z/ } split ' ', $cmd_list;\n</code></pre>\n\n<p>if you need regex for more complex conditions.</p>\n\n<p>This returns <code>1</code> on the first match, the result that your <code>for</code> loop produces. If you actually need a count then indeed use <code>grep</code>.  When there's no match <code>$PRINT_IP</code> is set to <code>''</code>, an empty string.</p>\n\n<p>The library is more efficient, firstly since it stops processing once a match happens. You can also do that by adding <code>last</code> in your <code>if</code> condition but <code>List::Util</code> routines are generally more efficient. </p>\n\n<p>More importantly: please always have <code>use warnings;</code> and <code>use strict;</code> at the beginning.</p>\n"}], "owner": {"reputation": 31, "user_id": 2835314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84284190f7e6bef07e56e3b77cb141c0?s=128&d=identicon&r=PG&f=1", "display_name": "user4711", "link": "https://stackoverflow.com/users/2835314/user4711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 52409727, "answer_count": 1, "score": 0, "last_activity_date": 1537431651, "creation_date": 1537370868, "last_edit_date": 1537423740, "question_id": 52409380, "link": "https://stackoverflow.com/questions/52409380/replace-foreach-with-grep-in-perl", "title": "Replace foreach with grep in perl", "body": "<p>I'm new to perl and I tried to replace my foreach-statement (version 1): </p>\n\n<pre><code>use warnings;\nuse strict;\n\n$cmd_list = \"abc network xyz\";\nforeach my $item (split(\" \", $cmd_list)) {\nif( $item eq \"network\") {\n    $PRINT_IP = 1;\n    }\n}\n</code></pre>\n\n<p>with a grep (version 2, from some example in the internet) which should give me the count (because of scalar context) of the value \"network\" in a string array:</p>\n\n<pre><code>$PRINT_IP = grep(/^$network$/, split(\" \", $cmd_list));\n</code></pre>\n\n<p>for version 1 the if statement works as supposed, but for version 2 it always evaluates to false:</p>\n\n<pre><code>if($PRINT_IP) {\n    ...\n}\n</code></pre>\n\n<p>Where is my fault?</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 481636, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537367349, "post_id": 52408166, "comment_id": 91760155, "body": "<code>$3= USOC</code> or <code>$3=E8PAM</code>?"}, {"owner": {"reputation": 658023, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "edited": false, "score": 0, "creation_date": 1537367491, "post_id": 52408166, "comment_id": 91760252, "body": "Get next line after <code>ACTION</code> and split on whitespaces."}, {"owner": {"reputation": 313, "user_id": 3829086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15358ac3a1f4a45b835aea23ff065501?s=128&d=identicon&r=PG&f=1", "display_name": "user3829086", "link": "https://stackoverflow.com/users/3829086/user3829086"}, "edited": false, "score": 0, "creation_date": 1537367569, "post_id": 52408166, "comment_id": 91760304, "body": "I have tried to get the separate parameters, but I am getting  result as         Impact    1         E8PAM     /FIN QC , But I want it in separate parameter results.. I have edited my trial code in question. Please anyone can give me suggestion"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537368515, "post_id": 52408166, "comment_id": 91760861, "body": "Where does <code>@array</code> come from?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537368612, "post_id": 52408166, "comment_id": 91760924, "body": "You say &quot;Expression should return 3 parameters present in next line of pattern&quot; but then, later, you say &quot;Expression should return <code>$1 = Impact , $2= 1, $3= USOC , $4=&#47;FIN QC</code>&quot;, which is four values. You&#39;re not being very clear about what you want."}, {"owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1537368855, "post_id": 52408166, "comment_id": 91761081, "body": "Perhaps use capturing groups to get <code>$1</code> etc <a href=\"http://rextester.com/XFEFYQ87085\" rel=\"nofollow noreferrer\">rextester.com/XFEFYQ87085</a>"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "edited": false, "score": 0, "creation_date": 1537371813, "post_id": 52408166, "comment_id": 91762969, "body": "@Thefourthbird: Using <code>split()</code> would seem to be far simpler."}, {"owner": {"reputation": 91433, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "reply_to_user": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537381871, "post_id": 52408166, "comment_id": 91768026, "body": "@DaveCross Yes it is, the OP used a regex in the question so this is just a suggestion of how you might do it using capturing groups."}], "answers": [{"comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537368670, "post_id": 52408596, "comment_id": 91760951, "body": "What is <code>@array</code>? What is <code>@F</code>? How are those variables populated?"}], "tags": [], "owner": {"reputation": 313, "user_id": 3829086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15358ac3a1f4a45b835aea23ff065501?s=128&d=identicon&r=PG&f=1", "display_name": "user3829086", "link": "https://stackoverflow.com/users/3829086/user3829086"}, "is_accepted": false, "score": 0, "last_activity_date": 1537373642, "last_edit_date": 1537373642, "creation_date": 1537368415, "answer_id": 52408596, "question_id": 52408166, "link": "https://stackoverflow.com/questions/52408166/pattern-match-print-the-strings-in-next-line-of-pattern-in-perl/52408596#52408596", "title": "Pattern match : print the strings in next line of Pattern in perl", "body": "<p>I found the answer this question :</p>\n\n<pre><code>          if ($line =~ /ACTION(.*?)(\\s+?)$/) {      \n                my $action = $array[$i];\n                @actionArr=split(/\\s+/,$action);\n                $action = actionArr[0]; \n                $QUANTITY =actionArr[1]; \n\n            } \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 0, "last_activity_date": 1537368464, "creation_date": 1537368464, "answer_id": 52408611, "question_id": 52408166, "link": "https://stackoverflow.com/questions/52408166/pattern-match-print-the-strings-in-next-line-of-pattern-in-perl/52408611#52408611", "title": "Pattern match : print the strings in next line of Pattern in perl", "body": "<p>Your question really isn't very clear. But, perhaps, something like this:</p>\n\n<pre><code>my $action_seen;\nwhile (&lt;$input_fh&gt;) {\n  if (/ACTION/) {\n    $action_seen = 1;\n    next;/\n  }\n\n  if ($action_seen) {\n    $action_seen = 0;.\n    my @data = split;\n    # Do whatever you need to do with the data\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 3829086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15358ac3a1f4a45b835aea23ff065501?s=128&d=identicon&r=PG&f=1", "display_name": "user3829086", "link": "https://stackoverflow.com/users/3829086/user3829086"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1537373642, "creation_date": 1537367114, "last_edit_date": 1537368206, "question_id": 52408166, "link": "https://stackoverflow.com/questions/52408166/pattern-match-print-the-strings-in-next-line-of-pattern-in-perl", "title": "Pattern match : print the strings in next line of Pattern in perl", "body": "<p>Here is my pattern of string , 'ACTION' is my pattern. Expression should return 3 parameters present in next line of pattern:</p>\n\n<p>Here is the pattern :</p>\n\n<pre><code>ACTION    QUANTITY  USOC      DESCRIPTION                                      \nImpact    1         E8PAM     /FIN QC                                           \n</code></pre>\n\n<p>Expression should return <code>$1 = Impact , $2= 1, $3= USOC , $4=/FIN QC</code></p>\n\n<p>Here is my trial : </p>\n\n<pre><code> if ($line =~/ACTION(.*?)(\\s+?)$/) {      \n    print $array[$i];\n    } \n</code></pre>\n\n<p>This is giving output like : </p>\n\n<pre><code>Impact    1         E8PAM     /FIN QC\n</code></pre>\n"}, {"tags": ["perl", "unit-testing", "mocking"], "comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1537435977, "post_id": 52406103, "comment_id": 91786832, "body": "<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 307, "user_id": 6013979, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9a594885e641ccaa827d19d1ca303c4?s=128&d=identicon&r=PG&f=1", "display_name": "yulivee", "link": "https://stackoverflow.com/users/6013979/yulivee"}, "edited": false, "score": 1, "creation_date": 1537363660, "post_id": 52406761, "comment_id": 91757680, "body": "@yulivee: Well, I guess not reading the documentation was the cause of it :-)"}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": true, "score": 3, "last_activity_date": 1537362959, "creation_date": 1537362959, "answer_id": 52406761, "question_id": 52406103, "link": "https://stackoverflow.com/questions/52406103/mocking-git-module-that-is-internally-used-by-another-module/52406761#52406761", "title": "Mocking Git Module that is internally used by another Module", "body": "<p>This is just a guess and I don't have time to test it...</p>\n\n<p><a href=\"https://metacpan.org/pod/Test::MockObject\" rel=\"nofollow noreferrer\">The documentation</a> for the <code>fake_module()</code> method says this:</p>\n\n<blockquote>\n  <p>Beware that this must take place before the actual module has a chance to load. Either wrap it in a BEGIN block before a use or require or place it before a <code>use_ok()</code> or <code>require_ok()</code> call.</p>\n</blockquote>\n\n<p>I expect that your module (is it called <code>Import::Git</code> or <code>Importer::Git?) loads</code>Git.pm<code>, so you need to call</code>fake_module()` before loading your module. So something like this, perhaps:</p>\n\n<pre><code>use Test::More tests =&gt; 1;    # last test to print\nuse Test::Exception;\nuse Test::MockObject;\n\nmy $git;\n\nBEGIN {\n  # pretend to have loaded the Git Module.\n  $INC{'Git.pm'} = 1;\n  $git = Test::MockObject-&gt;new();\n  $git-&gt;fake_module('Git', repository =&gt; sub { $git } );\n  $git-&gt;set_true( qw(command command_oneline) );\n}\n\nuse Import::Git;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": false, "score": 1, "last_activity_date": 1537437456, "creation_date": 1537437456, "answer_id": 52422407, "question_id": 52406103, "link": "https://stackoverflow.com/questions/52406103/mocking-git-module-that-is-internally-used-by-another-module/52422407#52422407", "title": "Mocking Git Module that is internally used by another Module", "body": "<p>An alternative to <a href=\"https://stackoverflow.com/a/52406761/1331451\">Dave's excellent answer</a> is to not use the <code>fake_module</code> functionality at all, but instead temporarily overwrite the constructor using something like <a href=\"https://metacpan.org/pod/Sub::Override\" rel=\"nofollow noreferrer\">Sub::Override</a>. I feel that gives more granulated control.</p>\n\n<pre><code>use Test::More;\nuse Test::MockObject;\nuse Sub::Override;\nuse Git (); # we need this so we can override it in case it hasn't been loaded yet\n\n# test code ... \n\n{\n    # this is our faked module\n    my $git = Test::MockObject-&gt;new;\n    $git-&gt;set_true( qw(command command_oneline) );\n\n    # we will save the arguments to the constructor here for \n    # inspection in tests later\n    my @constructor_args;\n\n    # this will temporarily replace the constructor until $sub\n    # goes out of scope\n    my $sub = Sub::Override-&gt;new(\n        'Git::new' =&gt; sub {\n            @constructor_args = @_; # save args\n            return $git;            # return fake\n        }\n    );\n\n    is something_that_deals_with_git(), $what_you_expect, 'test stuff with git';\n    is scalar @constructor_args, 2, '... and Git constructor was called with 2 args';\n    # ...\n}\n</code></pre>\n\n<p>It has the drawback that you cannot use <a href=\"https://metacpan.org/pod/Test::MockObject#Checking-Your-Mocks\" rel=\"nofollow noreferrer\">Test::MockObject's facilities to look at the calls</a> to <code>new</code>, but there's an easy way to mitigate that with our <code>@constructor_args</code> variable. Everything else stays the same.</p>\n"}], "owner": {"reputation": 307, "user_id": 6013979, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9a594885e641ccaa827d19d1ca303c4?s=128&d=identicon&r=PG&f=1", "display_name": "yulivee", "link": "https://stackoverflow.com/users/6013979/yulivee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 52406761, "answer_count": 2, "score": 3, "last_activity_date": 1537437456, "creation_date": 1537360809, "last_edit_date": 1537363721, "question_id": 52406103, "link": "https://stackoverflow.com/questions/52406103/mocking-git-module-that-is-internally-used-by-another-module", "title": "Mocking Git Module that is internally used by another Module", "body": "<p>I am trying to Unit-Test my module <code>Importer::Git</code> that uses <code>Git.pm</code> from CPAN and I would like to mock the calls to <code>Git::command</code>,<code>Git::repository</code> and <code>Git::command_oneline</code> etc to not actually alter my filesystem. I tried to do this via Test::MockObject, but it seems I haven't fully understood the internal workings yet...</p>\n\n<p>Example:</p>\n\n<pre><code>package Importer::Git\n\n   sub create_repository {\n    my ( $rc, $repo );\n\n    $rc = Git::command_oneline( 'init', $self-&gt;targetdir . \"/\" . $self-&gt;name );                                                                                                                                                                                                      \n\n    $repo = Git-&gt;repository( Directory =&gt; $self-&gt;targetdir . \"/\" . $self-&gt;name );\n    $rc = $repo-&gt;command( 'config', 'user.name', $self-&gt;git_import_user-&gt;{ name } );\n\n      $self-&gt;_repo( $repo );\n\n      return $repo;\n   }\n</code></pre>\n\n<p>Testcase:</p>\n\n<pre><code>use Import::Git;\n\nuse Test::More tests =&gt; 1;    # last test to print\nuse Test::Exception;\nuse Test::MockObject;\n\n# pretend to have loaded the Git Module.\n$INC{'Git.pm'} = 1;\nmy $git = Test::MockObject-&gt;new();\n$git-&gt;fake_module('Git', repository =&gt; sub { $git } );\n$git-&gt;set_true( qw(command command_oneline) );\n\n\n$repo = Import::Git-&gt;init();\n$repo-&gt;targetdir('./');\n$repo-&gt;name('testrepo');\n$repo-&gt;git_import_user({ name =&gt; 'test', email =&gt; 'test@test.com', push_default =&gt; 'testpush' });\n$repo-&gt;create_repository();\n</code></pre>\n\n<p>But it does not seem to replace the git object in question as this test crashes with the messages from the actual Git.pm Module.</p>\n\n<pre><code>error: Malformed value for push.default: testpush\nerror: Must be one of nothing, matching, simple, upstream or current.\nfatal: bad config variable 'push.default' in file '/home/.../testrepo/.git/config' at line 10\ninit .//testrepo: command returned error: 128\n</code></pre>\n\n<p>I guess in those two lines from Importer::Git it doesnt replace $repo</p>\n\n<pre><code>    $repo = Git-&gt;repository( Directory =&gt; $self-&gt;targetdir . \"/\" . $self-&gt;name );\n    $rc = $repo-&gt;command( 'config', 'user.name', $self-&gt;git_import_user-&gt;{ name } );\n</code></pre>\n\n<p>So how would I mock that properly? I would like the <code>$repo-&gt;command</code> calls to just return 1.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Daves guess was right. Correcting the code to this solved it:</p>\n\n<pre><code>use Test::More tests =&gt; 1;    # last test to print\nuse Test::Exception;\nuse Test::MockObject;\n\nmy $git;\nBEGIN {\n# pretend to have loaded the Git Module.\n$DB::single=1;\n$INC{'Git.pm'} = 1;\n$git = Test::MockObject-&gt;new();\n$git-&gt;fake_module('Git', repository =&gt; sub { $git } );\n$git-&gt;set_true( qw(command command_oneline) );\n}\n\nuse Import::Git;\n\n my $real_repo = Import::Git-&gt;init();\n $real_repo-&gt;targetdir('./');\n $real_repo-&gt;name('testrepo');\n $real_repo-&gt;git_import_user({ name =&gt; 'test', email =&gt; 'test@test.com', push_default =&gt; 'testpush' }); \n $real_repo-&gt;create_repository();\n</code></pre>\n"}, {"tags": ["regex", "perl", "options"], "comments": [{"owner": {"reputation": 1035, "user_id": 5092659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hCBWY.png?s=128&g=1", "display_name": "Samuel Kirschner", "link": "https://stackoverflow.com/users/5092659/samuel-kirschner"}, "edited": false, "score": 1, "creation_date": 1537359434, "post_id": 52405476, "comment_id": 91755061, "body": "Have you tried storing it like this?: <code>regex =&gt; qr&#47;this is a regex&#47;i</code> (with qr, without quotes)"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 4409238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d909690953b5d3747471281d88061c1?s=128&d=identicon&r=PG&f=1", "display_name": "kimsay", "link": "https://stackoverflow.com/users/4409238/kimsay"}, "edited": false, "score": 0, "creation_date": 1537365687, "post_id": 52405760, "comment_id": 91759030, "body": "<code>regex =&gt; &#39;(?i:this is a regex)&#39;</code> did it for me. Thank you."}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 4, "last_activity_date": 1537359650, "creation_date": 1537359650, "answer_id": 52405760, "question_id": 52405476, "link": "https://stackoverflow.com/questions/52405476/perl-regex-option-stored-in-variable/52405760#52405760", "title": "Perl regex option stored in variable", "body": "<p>You can use <code>qr</code> with the modifier</p>\n\n<pre><code>regex =&gt; qr/this is a regex/i,\n</code></pre>\n\n<p>or you can inline the modifier via <code>?:</code></p>\n\n<pre><code>regex =&gt; '(?i:this is a regex)',\n# or\nregex =&gt; qr/(?i:this is a regex)/,\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 4409238, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d909690953b5d3747471281d88061c1?s=128&d=identicon&r=PG&f=1", "display_name": "kimsay", "link": "https://stackoverflow.com/users/4409238/kimsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1537360149, "accepted_answer_id": 52405760, "answer_count": 1, "score": 0, "last_activity_date": 1537365652, "creation_date": 1537358690, "last_edit_date": 1537365652, "question_id": 52405476, "link": "https://stackoverflow.com/questions/52405476/perl-regex-option-stored-in-variable", "closed_reason": "Duplicate", "title": "Perl regex option stored in variable", "body": "<p>Is there any way to store a regex with its options in a scalar? In my case I have this:</p>\n\n<pre><code>{\n  regex =&gt; 'this is'.CONSTANT_STRING'. a regex',\n  someOtherKey =&gt; someOtherValue\n}\n</code></pre>\n\n<p>when matching I do this:</p>\n\n<pre><code>if($line =~ m/$hash-&gt;{regex}/i) {\n...\n}\n</code></pre>\n\n<p>which works fine.</p>\n\n<p>But what I need is the option /i being stored in the regex itself so I can just do</p>\n\n<pre><code>if($line =~ $hash-&gt;{regex}) {\n...\n}\n</code></pre>\n\n<p>But when I try to store the regex in the hash like this:</p>\n\n<pre><code>regex =&gt; '/this is a regex/i',\n</code></pre>\n\n<p>it won't work. I have played around with </p>\n\n<blockquote>\n  <p>eval, qr</p>\n</blockquote>\n\n<p>and whatnot. Is this somehow possible to do?</p>\n"}, {"tags": ["python", "perl"], "comments": [{"owner": {"reputation": 703, "user_id": 5464989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bc201f02e3211cd830cc697bf2548f?s=128&d=identicon&r=PG&f=1", "display_name": "jeanggi90", "link": "https://stackoverflow.com/users/5464989/jeanggi90"}, "edited": false, "score": 1, "creation_date": 1537358113, "post_id": 52404173, "comment_id": 91754302, "body": "I am not familiar with shell. Do you need to compare every entry in file2 with every entry in file1 or do you only need to compare the ones, where <code>chr</code> match?"}, {"owner": {"reputation": 581, "user_id": 3074319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aca9a83bd3cb915fc45348cb13118bbf?s=128&d=identicon&r=PG&f=1", "display_name": "aksg24", "link": "https://stackoverflow.com/users/3074319/aksg24"}, "reply_to_user": {"reputation": 703, "user_id": 5464989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90bc201f02e3211cd830cc697bf2548f?s=128&d=identicon&r=PG&f=1", "display_name": "jeanggi90", "link": "https://stackoverflow.com/users/5464989/jeanggi90"}, "edited": false, "score": 0, "creation_date": 1537359272, "post_id": 52404173, "comment_id": 91754965, "body": "There is file1 which have chromosome_ID (chr) and a position (pos). So here I am trying to find this position from file2 in range of position_start - position_end and chromosome_ID (chr). Each entry in file1 (chr and pos) need to be compare once in file2."}, {"owner": {"reputation": 49378, "user_id": 6779307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7O3q.jpg?s=128&g=1", "display_name": "Patrick Haugh", "link": "https://stackoverflow.com/users/6779307/patrick-haugh"}, "edited": false, "score": 0, "creation_date": 1537363217, "post_id": 52404173, "comment_id": 91757372, "body": "Are they in the same order?  Each file has all the <code>a1</code> entries, then all the <code>a2</code> entries and so on?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1537390986, "post_id": 52404173, "comment_id": 91772060, "body": "Do your files have those header lines?"}], "answers": [{"tags": [], "owner": {"reputation": 144799, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1537368978, "last_edit_date": 1537368978, "creation_date": 1537368642, "answer_id": 52408663, "question_id": 52404173, "link": "https://stackoverflow.com/questions/52404173/how-to-search-the-numerical-range-where-a-given-numerical-digit-lies-in-between/52408663#52408663", "title": "How to search the numerical range where a given numerical digit lies in between?", "body": "<p>I think this does what you want with <code>awk</code>:</p>\n\n<pre><code>awk '\n   FNR==1  { next}\n   FNR==NR { chr[FNR]=$1; start[FNR]=$2; end[FNR]=$3; det[FNR]=$4; N=FNR; next}\n           { c=$1; p=$2;\n             for(i=2;i&lt;=N;i++){\n                if((c==chr[i]) &amp;&amp; (p&gt;=start[i]) &amp;&amp; (p&lt;=end[i])){\n                   print c, p, chr[i], start[i], end[i], det[i]\n                   next\n                }\n             }\n           }\n   ' file2 file1\n</code></pre>\n\n<p>So, firstly notice from the last line that a single invocation of <code>awk</code> is processing both files.</p>\n\n<p>Inside the processing, the first line of each file is ignored by checking whether the line number within the current file is 1, and skipping if so:</p>\n\n<pre><code>FNR==1  { next}\n</code></pre>\n\n<p>Then, if the record number in the current file is equal to the overall record number that <code>awk</code> has processed, it follows we must be reading the first file. So we save each field in an array indexed by the line number and avoid any further processing:</p>\n\n<pre><code>FNR==NR { chr[FNR]=$1; start[FNR]=$2; end[FNR]=$3; det[FNR]=$4; N=FNR; next}\n</code></pre>\n\n<p>Otherwise we must be processing the second file. In which case, we loop through all the arrays we saved from the first file to find a matching entry. If we find one in the correct range, we print the bits and pieces you want and move immediately to the next record:</p>\n\n<pre><code>{ c=$1; p=$2;\n  for(i=2;i&lt;=N;i++){\n     if((c==chr[i]) &amp;&amp; (p&gt;=start[i]) &amp;&amp; (p&lt;=end[i])){\n         print c, p, chr[i], start[i], end[i], det[i]\n         next\n     }\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 581, "user_id": 3074319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aca9a83bd3cb915fc45348cb13118bbf?s=128&d=identicon&r=PG&f=1", "display_name": "aksg24", "link": "https://stackoverflow.com/users/3074319/aksg24"}, "edited": false, "score": 0, "creation_date": 1537434816, "post_id": 52415029, "comment_id": 91786067, "body": "Perl script worked well. It processed all 4.5lacs entries in 16 minutes."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 581, "user_id": 3074319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aca9a83bd3cb915fc45348cb13118bbf?s=128&d=identicon&r=PG&f=1", "display_name": "aksg24", "link": "https://stackoverflow.com/users/3074319/aksg24"}, "edited": false, "score": 0, "creation_date": 1537509284, "post_id": 52415029, "comment_id": 91817748, "body": "@aksg24 Are these data files publicly available? I&#39;m curious to see if I can make it faster."}, {"owner": {"reputation": 581, "user_id": 3074319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aca9a83bd3cb915fc45348cb13118bbf?s=128&d=identicon&r=PG&f=1", "display_name": "aksg24", "link": "https://stackoverflow.com/users/3074319/aksg24"}, "edited": false, "score": 0, "creation_date": 1537610852, "post_id": 52415029, "comment_id": 91853598, "body": "@Shown, Sorry, these files are not publicly available. You can make similar data from following publicly available files for file 1 (<a href=\"ftp://ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b151_GRCh38p7/VCF/GATK/All_20180418.vcf.gz\" rel=\"nofollow noreferrer\">ftp.ncbi.nlm.nih.gov/snp/organisms/human_9606_b151_GRCh38p7&zwnj;&#8203;/VCF/&hellip;</a>) and file2 (<a href=\"ftp://ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/GFF/ref_GRCh38.p12_top_level.gff3.gz\" rel=\"nofollow noreferrer\">ftp.ncbi.nlm.nih.gov/genomes/Homo_sapiens/GFF/&hellip;</a>)."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1537509582, "last_edit_date": 1537509582, "creation_date": 1537396384, "answer_id": 52415029, "question_id": 52404173, "link": "https://stackoverflow.com/questions/52404173/how-to-search-the-numerical-range-where-a-given-numerical-digit-lies-in-between/52415029#52415029", "title": "How to search the numerical range where a given numerical digit lies in between?", "body": "<p>Here's a perl version. Basic idea is that it caches the gtf data into a hash table, and then for each line in the snp file, it only looks at gtf entries that match that chromosome.</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse feature qw/say/;\nuse autodie;\n\nmy $snp_file = \"file1.txt\";\nmy $gtf_file = \"file2.txt\";\n\n# Read the gtf data into a hash of arrays\nmy %gtf;\nopen my $file, \"&lt;\", $gtf_file;\nmy $hdr = &lt;$file&gt;; # Discard header line\nwhile (&lt;$file&gt;) {\n  chomp;\n  my @cols = split /\\s+/;\n  push @{$gtf{$cols[0]}}, \\@cols;\n}\nclose $file;\n\nopen $file, \"&lt;\", $snp_file;\n$hdr = &lt;$file&gt;; # Discard header line\nsay \"chr\\tpos\\tchr\\tstart\\tend\\tdetail\";\n# Read the snp data\n$\" = \"\\t\"; # Use tab for array element separator\nwhile (&lt;$file&gt;) {\n  chomp;\n  my ($chr, $pos) = split /\\s+/;\n  # Look up all matches of this chromosome in the gtf hash and filter just\n  # the ones where pos is in range.\n  my @matches = grep { $pos &gt;= $_-&gt;[1] &amp;&amp; $pos &lt;= $_-&gt;[2] } @{$gtf{$chr}};\n  # And print them out.\n  for my $match (@matches) {\n    say \"$chr\\t$pos\\t@$match\";\n  }\n}\nclose $file;\n</code></pre>\n\n<p>Another option, which I would pursue if you're going to be doing a lot with this data, is loading it all into sqlite or another database and looking up results using SQL. That way you don't have to keep reading the data files; you just look up things in a pre-populated table (with appropriate indexes to make things efficient).</p>\n"}], "owner": {"reputation": 581, "user_id": 3074319, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aca9a83bd3cb915fc45348cb13118bbf?s=128&d=identicon&r=PG&f=1", "display_name": "aksg24", "link": "https://stackoverflow.com/users/3074319/aksg24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 52415029, "answer_count": 2, "score": 0, "last_activity_date": 1537509582, "creation_date": 1537354249, "last_edit_date": 1537380087, "question_id": 52404173, "link": "https://stackoverflow.com/questions/52404173/how-to-search-the-numerical-range-where-a-given-numerical-digit-lies-in-between", "title": "How to search the numerical range where a given numerical digit lies in between?", "body": "<p>I have two files</p>\n\n<h3>file1</h3>\n\n<p>SNP data consisting of a chromosome and its position (approximately 400,000 entries)</p>\n\n<pre><code>chr pos\na1 456\na2 789\n . .\n . . \nso on\n</code></pre>\n\n<h3>file2</h3>\n\n<p>GTF data consisting of chromosome, position_start, position_end, and details (approximately 500,000 entries)</p>\n\n<pre><code>chr pos_start pos_end detail\na1 100 400 gene1\na1 401 700 gene2\na2 200 500 gene3\na2 501 900 gene4\n . .\n . . \nso on\n</code></pre>\n\n<h3>Desired result</h3>\n\n<pre><code>chr pos chr pos_start pos_end detail\na1 456 a1 401 700 gene2\na2 789 a2 501 900 gene4\n</code></pre>\n\n<p>I am getting this result using shell script: </p>\n\n<pre><code>(grep \"$chr\" file2.gtf | awk '{if($2 &lt;= '$pos' &amp;&amp; $3 &gt;= '$pos') print $0}') \n</code></pre>\n\n<p>in a while loop, but it takes too much time to process all digits in <code>file1</code>. </p>\n\n<p>Does anyone know a more efficient way in shell, Python, or Perl to accomplish this?</p>\n"}, {"tags": ["perl", "moose"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537354183, "post_id": 52402995, "comment_id": 91751938, "body": "Naw, no need to create an entire class. Just use the sub I posted. (Moved to an answer)"}], "answers": [{"tags": [], "owner": {"reputation": 3509, "user_id": 4243840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeabd769bae1bf82fd4b8882fed6653?s=128&d=identicon&r=PG", "display_name": "JGNI", "link": "https://stackoverflow.com/users/4243840/jgni"}, "is_accepted": false, "score": 1, "last_activity_date": 1537351904, "creation_date": 1537351904, "answer_id": 52403443, "question_id": 52402995, "link": "https://stackoverflow.com/questions/52402995/using-buildargs-to-substitute-a-class-in-a-role/52403443#52403443", "title": "Using BUILDARGS to substitute a class in a Role", "body": "<p><code>BUILDARGS</code> is used to manipulate the argument list you pass to the objects constructor before the object is created so will have no impact on what new returns. Instead of <code>around BUILDARGS</code> you might want to try <code>around new</code>, then you can replace the object returned by new with your dry run object.</p>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 6013979, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9a594885e641ccaa827d19d1ca303c4?s=128&d=identicon&r=PG&f=1", "display_name": "yulivee", "link": "https://stackoverflow.com/users/6013979/yulivee"}, "edited": false, "score": 0, "creation_date": 1537354642, "post_id": 52404118, "comment_id": 91752235, "body": "valid argument. That way someone could create an Import::Git(dryrun =&gt; 1) if desired. I like the instantiate subroutine :)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 307, "user_id": 6013979, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9a594885e641ccaa827d19d1ca303c4?s=128&d=identicon&r=PG&f=1", "display_name": "yulivee", "link": "https://stackoverflow.com/users/6013979/yulivee"}, "edited": false, "score": 0, "creation_date": 1537363270, "post_id": 52404118, "comment_id": 91757408, "body": "You could, but then you&#39;d lose the ability to do <code>Import::Git::Subclass-&gt;instantiate(...)</code>"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 2, "last_activity_date": 1537354096, "creation_date": 1537354096, "answer_id": 52404118, "question_id": 52402995, "link": "https://stackoverflow.com/questions/52402995/using-buildargs-to-substitute-a-class-in-a-role/52404118#52404118", "title": "Using BUILDARGS to substitute a class in a Role", "body": "<p>Having a constructor build a different class than the one requested is icky. I wouldn't take the approach you did even if it did work. I would use</p>\n\n<pre><code>sub factory {\n   my ($class, %opts) = @_;\n   return $opt{dryrun} ? $class.'::dryrun' : $class;\n}\n\nImport::Git-&gt;factory( dryrun =&gt; $dryrun )-&gt;new( ... )\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sub instantiate {\n   my ($class, %opts) = @_;\n   return ( delete($opt{dryrun}) ? $class.'::dryrun' : $class )-&gt;new(%opts);\n}\n\nImport::Git-&gt;instantiate( dryrun =&gt; $dryrun, ... )\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 6013979, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a9a594885e641ccaa827d19d1ca303c4?s=128&d=identicon&r=PG&f=1", "display_name": "yulivee", "link": "https://stackoverflow.com/users/6013979/yulivee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 52404118, "answer_count": 2, "score": 1, "last_activity_date": 1537354096, "creation_date": 1537350590, "question_id": 52402995, "link": "https://stackoverflow.com/questions/52402995/using-buildargs-to-substitute-a-class-in-a-role", "title": "Using BUILDARGS to substitute a class in a Role", "body": "<p>I use a Perl Moose Role (<code>Import::Git::Role</code>) as an Abstract Base Class to share common behaviour between a Class an actual implementation of functionality (<code>Import::Git</code>) and a Class that performs some logging instead (<code>Import::Git::dryrun</code>). </p>\n\n<p>I would like the dryrun class to be transparent. I want to create a object like this:</p>\n\n<pre><code>   my $git = Import::Git-&gt;new( dryrun =&gt; $dryrun );\n</code></pre>\n\n<p>The variable dryrun could be 0 or 1. If it is 1, I would like to construct an <code>Import::Git::dryrun</code> object instead, basically replacing the <code>Import::Git</code> object with it. Thats intended because they share all methods via the role.</p>\n\n<p>I have tried to exchange the Object during the BUILDARGS Method like this:</p>\n\n<pre><code>around BUILDARGS =&gt; sub {                                                                                                                                                                                                                                                           \n     my $orig  = shift;\n     my $class = shift;\n\n     my %args = ( @_ == 1 ? %{ $_[ 0 ] } : @_ );\n\n     if ( !%args || $args{ 'dryrun' } != 1 ) {\n         return $class-&gt;$orig( @_ );\n     }\n     else {\n         return Import::Git::dryrun-&gt;$orig( @_ );\n    }\n};\n</code></pre>\n\n<p>but this doesn't achieve what I am trying to do, it constructs the old class:</p>\n\n<pre><code>  DB&lt;1&gt; x Import::Git-&gt;new( dryrun =&gt; 1 )\n0  Import::Git=HASH(0x2fd9210)\n   'dryrun' =&gt; 1\n  DB&lt;2&gt; x Import::Git-&gt;new()\n0  Import::Git=HASH(0x301dbb8)\n   'dryrun' =&gt; 0\n  DB&lt;3&gt; \n</code></pre>\n\n<p>I thought I would probably have to call the new Method of the dryrun-method so I made the following exchange:</p>\n\n<pre><code>   # change this:\n   return Import::Git::dryrun-&gt;$orig( @_ );\n   # to this\n   return Import::Git::dryrun-&gt;new( @_ ); \n</code></pre>\n\n<p>But it returns <code>BUILDARGS did not return a HASH reference</code>.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["regex", "perl", "substitution"], "comments": [{"owner": {"reputation": 71380, "user_id": 3558960, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a98b52149d419c2aad558befe51c8cc5?s=128&d=identicon&r=PG", "display_name": "Robby Cornelissen", "link": "https://stackoverflow.com/users/3558960/robby-cornelissen"}, "edited": false, "score": 3, "creation_date": 1537347388, "post_id": 52401918, "comment_id": 91747672, "body": "Process the file line by line instead of slurping it all into memory."}, {"owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 1, "creation_date": 1537354948, "post_id": 52401918, "comment_id": 91752416, "body": "Do you mean that your script is over 1,000,000 lines long, with a million different  s/// patterns, or do you mean that the one single regex is applied to all 1 million lines?"}, {"owner": {"reputation": 91, "user_id": 8861632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3fdf68a4f20de07b5fc968b1be7cf2?s=128&d=identicon&r=PG", "display_name": "Izzy", "link": "https://stackoverflow.com/users/8861632/izzy"}, "reply_to_user": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 0, "creation_date": 1537355596, "post_id": 52401918, "comment_id": 91752720, "body": "@DaveMitchell The former. Each line has a different substitution pattern associated with it. Apologies for the ambiguity!"}, {"owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 1, "creation_date": 1537367247, "post_id": 52401918, "comment_id": 91760100, "body": "In that case the excessive memory usage probably comes from having a million separate regexes. Is the alphanumerical code on each line in a well-defined format? In which case you could store the codes and names in a hash, then have a single regex of the form, e.g.,  s/\\b(\\d+[a-z]+\\d\\w)\\b/$names{$1}/g"}, {"owner": {"reputation": 91, "user_id": 8861632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3fdf68a4f20de07b5fc968b1be7cf2?s=128&d=identicon&r=PG", "display_name": "Izzy", "link": "https://stackoverflow.com/users/8861632/izzy"}, "reply_to_user": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 0, "creation_date": 1537433339, "post_id": 52401918, "comment_id": 91785232, "body": "@DaveMitchell Ah, okay - I will give that a go, thanks! Just to double check would I make the codes the hash keys and then the associated names the hash values?"}, {"owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 1, "creation_date": 1537447843, "post_id": 52401918, "comment_id": 91794002, "body": "yes. The pattern should be such that it matches only codes and nothing else. If there is a chance that there will be matched things that aren&#39;t codes (i.e. don&#39;t exist in the hash), then the substitution needs to be more complex, e.g."}, {"owner": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 1, "creation_date": 1537447894, "post_id": 52401918, "comment_id": 91794038, "body": "(continued) s{....}{$names{$1}//$1}ge"}, {"owner": {"reputation": 91, "user_id": 8861632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3fdf68a4f20de07b5fc968b1be7cf2?s=128&d=identicon&r=PG", "display_name": "Izzy", "link": "https://stackoverflow.com/users/8861632/izzy"}, "reply_to_user": {"reputation": 1110, "user_id": 9749458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/001ed2d47a01593ee5c6463c2f5fe224?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Mitchell", "link": "https://stackoverflow.com/users/9749458/dave-mitchell"}, "edited": false, "score": 0, "creation_date": 1537533429, "post_id": 52401918, "comment_id": 91830519, "body": "@DaveMitchell Okay, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "is_accepted": true, "score": 6, "last_activity_date": 1537348189, "last_edit_date": 1537348189, "creation_date": 1537347515, "answer_id": 52401981, "question_id": 52401918, "link": "https://stackoverflow.com/questions/52401918/substituting-millions-of-regular-expressions-perl/52401981#52401981", "title": "Substituting millions of regular expressions (perl)", "body": "<p>Your problem is you're using a <code>foreach</code> loop. That needs you to load all the lines into memory, which is the root of your problem.</p>\n\n<p>Try it in a while loop:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>open ( my $file, '&lt;', 'names.txt' ) or die $!; \nopen ( my $output, '&gt;', 'names_edited.txt' ) or die $!;\nselect $output; #destination for print; \nwhile ( &lt;$file&gt; ) {  #reads one line at a time, sets $_\n    s/88tx0p/Author1/g;   #acts on $_ by default\n    print; #defaults to printing $_ to the selected filehandle $output\n}\n</code></pre>\n\n<p>That'll work line by line (as your initial code was) but will read only one line at a time, so the memory footprint will be vastly lower. </p>\n"}], "owner": {"reputation": 91, "user_id": 8861632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3fdf68a4f20de07b5fc968b1be7cf2?s=128&d=identicon&r=PG", "display_name": "Izzy", "link": "https://stackoverflow.com/users/8861632/izzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 52401981, "answer_count": 1, "score": 0, "last_activity_date": 1537348189, "creation_date": 1537347285, "question_id": 52401918, "link": "https://stackoverflow.com/questions/52401918/substituting-millions-of-regular-expressions-perl", "title": "Substituting millions of regular expressions (perl)", "body": "<p>I have a text file containing over one million lines of text. On each line, there is an alphanumerical code which needs to be substituted with a name. I have tried doing this using different Perl scripts, but each time the scripts die because they are using too many memory. I am new to Perl, so I imagine that I am doing something wrong, and it making the job too complex?\nSo far, I have tried:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy $filename = 'names.txt';\n\nmy $data = read_file($filename);\n\n$data =~ s/88tx0p/Author1/g;\n##and then there are 1,000,000+ other substitution regexes.\n\nwrite_file($filename, $data);\nexit;\n\nsub read_file {\nmy ($filename) = @_;\n\nopen my $in, '&lt;:encoding(UTF-8)', $filename or die \"Could not open \n'$filename' for reading $!\";\nlocal $/ = undef;\nmy $all = &lt;$in&gt;;\nclose $in;\n\nreturn $all;\n}\n\nsub write_file {\nmy ($filename, $content) = @_;\n\nopen my $out, '&gt;:encoding(UTF-8)', $filename or die \"Could not open \n'$filename' for writing $!\";;\nprint $out $content;\nclose $out;\n\nreturn;\n}\n</code></pre>\n\n<p>But then I realised that this script is trying to write the output to the original file, which I imagine uses more memory? So I tried the following:</p>\n\n<pre><code>use strict;\nuse utf8;\nuse warnings;\n\nopen(FILE, 'names.txt') || die \"File not found\";\nmy @lines = &lt;FILE&gt;;\nclose(FILE);\n\nmy @newlines;\nforeach(@lines) {\n$_ =~ s/88tx0p/Author1/g;\n##and then there are approximately 1,000,000 other substitution regexes.\npush(@newlines,$_);\n}\n\nopen(FILE, '&gt;names_edited.txt') || die \"File not found\";\n;\nprint FILE @newlines;\nclose(FILE);\n</code></pre>\n\n<p>But again, this used too much memory. Please could I get help with ways of doing this while using minimum amount of memory? Thank you all.</p>\n"}, {"tags": ["perl"], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537367623, "post_id": 52407164, "comment_id": 91760337, "body": "Hi, this worked for the inital problem, however it is still not creating the directory."}, {"owner": {"reputation": 4462, "user_id": 1018580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757fafb944d47f80a2336d097dcef7c5?s=128&d=identicon&r=PG", "display_name": "Trenton Trama", "link": "https://stackoverflow.com/users/1018580/trenton-trama"}, "reply_to_user": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537368695, "post_id": 52407164, "comment_id": 91760964, "body": "Is there a new error that&#39;s populated when you try to create the directory?"}, {"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537368960, "post_id": 52407164, "comment_id": 91761147, "body": "Nope, just my one that is printed &quot; cannot reach directory &quot;  which means it wasnt created,"}], "tags": [], "owner": {"reputation": 4462, "user_id": 1018580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757fafb944d47f80a2336d097dcef7c5?s=128&d=identicon&r=PG", "display_name": "Trenton Trama", "link": "https://stackoverflow.com/users/1018580/trenton-trama"}, "is_accepted": false, "score": 2, "last_activity_date": 1537364090, "creation_date": 1537364090, "answer_id": 52407164, "question_id": 52401392, "link": "https://stackoverflow.com/questions/52401392/perl-netsftpforeign/52407164#52407164", "title": "Perl - Net::SFTP::Foreign", "body": "<p>When you instantiated the Net::SFTP::Foreign object, you created it with <code>autodie  =&gt; 1</code>. </p>\n\n<p><a href=\"https://metacpan.org/pod/Net::SFTP::Foreign#autodie-mode\" rel=\"nofollow noreferrer\">Autodie</a> will \"promote non-recoverable errors to execptions automatically\".  </p>\n\n<p>You can remove the autodie line and be OK as long as you're checking for status  regularly throughout the script.</p>\n\n<p>If there are places you want to die at, you can use <a href=\"https://metacpan.org/pod/Net::SFTP::Foreign#die_on_error\" rel=\"nofollow noreferrer\">die_on_error</a> after you've made a request</p>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537368438, "post_id": 52408347, "comment_id": 91760805, "body": "Tried this, it says &quot;creating directory&quot; but no directory is created."}, {"owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "reply_to_user": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537369511, "post_id": 52408347, "comment_id": 91761502, "body": "print out $remote_path and see if you can CD to the directory."}, {"owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "reply_to_user": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537369581, "post_id": 52408347, "comment_id": 91761554, "body": "what is the value of $name?"}, {"owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "reply_to_user": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537370333, "post_id": 52408347, "comment_id": 91762062, "body": "Also print error see what the actial error is: print $ftp-&gt;error;"}, {"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537376829, "post_id": 52408347, "comment_id": 91765597, "body": "print $ftp-error just shows a 0.    the value of $name is is seen below in the full error , as I print out the full $remote_path in my error. I&#39;ve updated the main code to show what I&#39;m doing, Creating directory 0cannot reach directory /home/testuser/TESTING_MYTESTDIR/20180919_TESTING_MYTESTDIR. I have also tried just doing this -   $ftp-&gt;mkdir($remote_path);   and this does not error, but no directory is created. I feel like I&#39;m doing everything right..."}, {"owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "reply_to_user": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537378535, "post_id": 52408347, "comment_id": 91766422, "body": "Try to manually connect to FTP and manually create the directory to make sure you are able to do so. The code I provided definitely works. If it does not create the folder, either there is an issue with the path or permissions."}, {"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537379708, "post_id": 52408347, "comment_id": 91766945, "body": "I thought this, but I then tried it as root and same issue.  I am testing on locahost though,  I tried this - sftp testuser@localhost  and was able to &quot;mkdir test&quot; and this creates the test directory....... I&#39;ve tried just this &quot;$ftp-&gt;mkdir($remote_path);&quot; and even that does not work.  Update - $ftp-&gt;mkdir(&quot;testing12345&quot;);  working fine....doesn&#39;t seem to like the variable..?"}, {"owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "edited": false, "score": 0, "creation_date": 1537380233, "post_id": 52408347, "comment_id": 91767224, "body": "I&#39;ve figured out what the issue is..... You can create 1 directory, but can&#39;t create it two. e.g test/  works but test/test2  wont, until test/ exists.... Strange, i wonder if there is a max-depth option or something similar.  I have it to work by creating each directory individually however now its adding the below to the structure   - desired structure  /home/testuser/testing/testingdir/ actual structure /home/testuser/testing/testingdir/home/sftp/testing/testingd&zwnj;&#8203;ir  &#172;_&#172;"}], "tags": [], "owner": {"reputation": 1702, "user_id": 880797, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/bace3dcc4a83523d93399ab2bd1f3728?s=128&d=identicon&r=PG", "display_name": "Andrey", "link": "https://stackoverflow.com/users/880797/andrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1537384194, "last_edit_date": 1537384194, "creation_date": 1537367667, "answer_id": 52408347, "question_id": 52401392, "link": "https://stackoverflow.com/questions/52401392/perl-netsftpforeign/52408347#52408347", "title": "Perl - Net::SFTP::Foreign", "body": "<p>You can use the following logic to create the folder:</p>\n\n<pre><code>$ftp-&gt;find(\"$remote_path\", on_error =&gt; sub { print \"Creating directory\\n\"; $ftp-&gt;mkdir(\"$remote_path\") });\n</code></pre>\n\n<p>if you do not need print statement:</p>\n\n<pre><code>$ftp-&gt;find(\"$remote_path\", on_error =&gt; sub { $ftp-&gt;mkdir(\"$remote_path\") });\n</code></pre>\n\n<p>If you need to create all missing folders in the path, this should work (I cannot currently test it, but the idea seems correct).</p>\n\n<pre><code>my $home_directory =\"home/testuser\";\nmy $remote_path=$home_directory.\"/\".$name.\"/\".$destination_dir;\n\nmy $currentPath = '';\nforeach my $directory (split '/', $remote_path) {\n    $currentPath = \"$currentPath/$directory\";\n    $ftp-&gt;find(\"$currentPath\", on_error =&gt; sub { print \"Creating directory\\n\"; $ftp-&gt;mkdir(\"$currentPath\") });\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 8065247, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/aa4227e45bb23ef7647c9677350c6626?s=128&d=identicon&r=PG&f=1", "display_name": "TheOne745665", "link": "https://stackoverflow.com/users/8065247/theone745665"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1537384194, "creation_date": 1537345528, "last_edit_date": 1537376984, "question_id": 52401392, "link": "https://stackoverflow.com/questions/52401392/perl-netsftpforeign", "title": "Perl - Net::SFTP::Foreign", "body": "<p>I am trying to write an upload script in Perl , using Net::SFTP::Foreign.</p>\n\n<p>I am having issue with checking if the directory exists, and if it does not, creating it.</p>\n\n<p>Net::SFTP::Foreign seems to just error and close the connection if the directory doesn't exist, and never runs the \"else\"</p>\n\n<p>You can see the code below, can aanyone see where im going wrong?</p>\n\n<pre><code>sub uploadtoftp\n{\nuse Net::SFTP::Foreign;\nuse File::Basename;\nuse warnings;\n\n  my $host=$_[0];\n  my $user=$_[1];\n  my $pw=$_[2];\n\n\n   my $home_directory =\"/home/testuser\";\n  my $remote_path=$home_directory.\"/\".$name.\"/\".$destination_dir;\n\n\n\n  if (my $ftp = Net::SFTP::Foreign-&gt;new($host,\n                                   user =&gt; $user,\n                                   password =&gt; $pw,\n                                   autodie =&gt; 0))\n  {\n\n      my $destination_dir_proceed=0;\n\n\n        $ftp-&gt;find(\"$remote_path\", on_error =&gt; sub { print \"Creating directory\\n\"; $ftp-&gt;mkdir(\"$remote_path\")  });\n        print $ftp-&gt;error;\n\n\n        if($ftp-&gt;opendir($remote_path)) \n        {\n          $destination_dir_proceed=1;\n        }\n\n\n        if($destination_dir_proceed==1) \n        {\n        # --- loop through file list and upload all new files\n        foreach $filename (split(/ /, $file_list)) \n        {\n          $ftp-&gt;put($filename,$remote_path.$filename);\n\n        }\n\n\n        }\n\n      else\n      {\n        print \"cannot reach directory $remote_path\\n\";\n      }\n\n\n  }\n\n\n\n\n} # end subroutine uploadtoftp()\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537347290, "post_id": 52400738, "comment_id": 91747602, "body": "What is the purpose of the hash table? If you only want to modify lines in the file, why do you need it?"}, {"owner": {"reputation": 1, "user_id": 10336845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad29845f4a4ce04385163919da40454?s=128&d=identicon&r=PG&f=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/10336845/dan"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537348022, "post_id": 52400738, "comment_id": 91748056, "body": "Yes.Your query is absolutely valid. But my requirement demands me to use a hash table concept here. I have achieved output using shell script.But now its to be done with perl and hash concept. I am stuck with this :("}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1537348631, "post_id": 52400738, "comment_id": 91748412, "body": "The your question is then really about reading the config (input) file into a hash? And then modify the hash, and then printing the hash to a file? In that case I would recommend using JSON instead of a custom made input file format. In this way modification becomes much easier, since there alread exists modules for reading and writing JSON."}, {"owner": {"reputation": 1, "user_id": 10336845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad29845f4a4ce04385163919da40454?s=128&d=identicon&r=PG&f=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/10336845/dan"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537349338, "post_id": 52400738, "comment_id": 91748859, "body": "Okay.Thank you. I will try. But may i know where am i doing mistake in the above code?Just curious to know."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537350345, "post_id": 52400738, "comment_id": 91749507, "body": "You are welcome, and good luck! Regarding the output you show. I think there are many issues with the code. But one thing is why are the fruit information missing. I think it is because you split on white space, and the lines with fruit information starts with at least two spaces,  so maybe all these lines gets mapped to the line <code>&#39;&#39; =&gt; undef</code> in the output?"}, {"owner": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537369330, "post_id": 52400738, "comment_id": 91761390, "body": "Could you provide the output that you are expecting?"}, {"owner": {"reputation": 1, "user_id": 10336845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad29845f4a4ce04385163919da40454?s=128&d=identicon&r=PG&f=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/10336845/dan"}, "reply_to_user": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537421526, "post_id": 52400738, "comment_id": 91779449, "body": "@DiabJerius I have edited the post with the expected output. Pl check. Thanks"}, {"owner": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537805538, "post_id": 52400738, "comment_id": 91908166, "body": "@DAN, I think we have a miscommunication.  I was asking for the output of the code that you presented.  It outputs a hash that isn&#39;t correct.  Please provide the hash that you would like to be printed."}, {"owner": {"reputation": 1, "user_id": 10336845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad29845f4a4ce04385163919da40454?s=128&d=identicon&r=PG&f=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/10336845/dan"}, "reply_to_user": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537868177, "post_id": 52400738, "comment_id": 91930422, "body": "@DiabJerius Apologies. Edited the post with expected hash to be printed. Thanks"}, {"owner": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1538405576, "post_id": 52400738, "comment_id": 92122288, "body": "@DAN, sorry for the delay, but that still isn&#39;t something that can be output.  You can&#39;t have the same key twice in a single hash."}], "answers": [{"tags": [], "owner": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "is_accepted": false, "score": 2, "last_activity_date": 1538406823, "creation_date": 1538406823, "answer_id": 52594104, "question_id": 52400738, "link": "https://stackoverflow.com/questions/52400738/issue-in-printing-data-from-a-hash-table-in-perl/52594104#52594104", "title": "Issue in Printing data from a hash table in perl", "body": "<p>One word of advice before I continue:</p>\n\n<blockquote>\n  <p>Document your code</p>\n</blockquote>\n\n<p>There are several logic errors in your code which I think you would have recognized if you wrote down what you thought each line was supposed to do.  First, write down the algorithm that you would like to implement, then document how each step in the code implements a step in the algorithm.  At the end you'll be able to see what you missed, or what part is not working.</p>\n\n<p>Here are the errors that I see</p>\n\n<ol>\n<li>You aren't ignoring lines that you shouldn't be parsing.  For example, you're grabbing the '}' and '{' lines.</li>\n<li>You aren't actually storing the name of the fruit.  You grab it, but immediately start the next loop without storing it.</li>\n<li>You're not keeping track of each structure.  You need to start a new structure for each fruit.</li>\n<li>Do you really want to keep the double quotes in the values?</li>\n</ol>\n\n<p>Other things to worry about:</p>\n\n<ol>\n<li>Are you guaranteed that the list of attributes is in that order?  For example, can <code>Name</code> come last?</li>\n</ol>\n\n<p>Here's some code which does what I think you want.</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse Data::Dumper;\nmy %hash_table;\nmy $name;\n\nmy @fruit;\n\nmy $file = '/tmp/fruitdir/fruit1.txt';\nopen my $fh, \"&lt;\", $file or die \"Can't open $file: $!\";\nwhile (&lt;$fh&gt;) {\n    chomp;\n\n    # save hash table if there's a close bracket, but\n    # only if it has been filled\n    if ( /^\\s*}\\s*$/ ) {\n        next unless keys %hash_table;\n\n        # save COPY of hash table\n        push @fruit, { %hash_table };\n\n        # clear it out for the next iteration\n        %hash_table = ();\n    }\n\n    # only parse lines that start with Name or fruit\n    next unless\n      my ( $key, $value ) =\n      /^\n         # skip any leading spaces\n         \\s*\n\n         # parse a line beginning with Name or fruitXXXXX\n         (\n          Name\n          |\n          fruit[^\\s]+\n        )\n\n        # need space between key and value\n        \\s+\n\n        # everything that follows is a value. clean up\n        # double quotes in post processing\n        (.*)\n     /x;\n\n    # remove double quotes\n    $value =~ s/\"//g;\n\n    if ( $key eq 'Name' ) {\n        $name = $value;\n    }\n    else {\n        $key = \"${name}.${key}\";\n    }\n   $hash_table{$key} = $value;\n}\n\nprint Dumper \\@fruit;\n</code></pre>\n\n<p>and here's the output:</p>\n\n<pre><code>$VAR1 = [\n          {\n            'fruit 1.fruitValue' =&gt; '6',\n            'fruit 1.fruitName' =&gt; 'apple.fru',\n            'Name' =&gt; 'fruit 1',\n            'fruit 1.fruitCount' =&gt; '5',\n            'fruit 1.fruitId' =&gt; '0'\n          },\n          {\n            'fruit 2.fruitName' =&gt; 'orange.fru',\n            'fruit 2.fruitId' =&gt; '1',\n            'fruit 2.fruitCount' =&gt; '10',\n            'fruit 2.fruitValue' =&gt; '20',\n            'Name' =&gt; 'fruit 2'\n          }\n        ];\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10336845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad29845f4a4ce04385163919da40454?s=128&d=identicon&r=PG&f=1", "display_name": "DAN", "link": "https://stackoverflow.com/users/10336845/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538406823, "creation_date": 1537343239, "last_edit_date": 1537868120, "question_id": 52400738, "link": "https://stackoverflow.com/questions/52400738/issue-in-printing-data-from-a-hash-table-in-perl", "title": "Issue in Printing data from a hash table in perl", "body": "<p>I am trying to process the data in a single file . i have to read the file and create a hash structure,get the value of fruitname append it to fruitCount and fruitValue and delete the line fruitName and write the entire output after the change is done.Given below is the content of file.</p>\n\n<pre><code> # this is a new file\n{\ndate 14/07/2016\ntime 11:15\nend 11:20\ntotal 30\nNo    \"FRUITS\"\nFruit_class\n    {\n    Name    \"fruit 1\"\n    fruitName    \"apple.fru\"\n    fruitId    \"0\"\n    fruitCount    5\n    fruitValue    6\n    }\n{\n        Name    \"fruit 2\"\n        fruitName       \"orange.fru\"\n        fruitId \"1\"\n        fruitCount      10\n        fruitValue      20\n        }\n}\n</code></pre>\n\n<p>I tried with following code :</p>\n\n<pre><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\nuse Data::Dumper;\nmy %hash_table;\nmy $name;\nmy $file = '/tmp/fruitdir/fruit1.txt';\nopen my $fh, \"&lt;\", $file or die \"Can't open $file: $!\";\nwhile (&lt;$fh&gt;) {\n    chomp;\n    if (/^\\s*fruitName/) {\n        ($name) = /(\\\".+\\\")/;\n        next;\n   }\n   s/(fruitCount|fruitValue)/$name\\.$1/;\n   my ($key, $value) = split /\\s+/, $_, 2;\n   $hash_table{$key} = $value;\n}\nprint Dumper(\\%hash_table);\n</code></pre>\n\n<p>This is not working . I need to append the value of fruitname and print the the entire file content as output. Any help will be appreciated.Given below is the output that i got.</p>\n\n<pre><code>$VAR1 = {\n          '' =&gt; undef,\n          'time' =&gt; '11:15    ',\n          'date' =&gt; '14/07/2016',\n          '{' =&gt; undef,\n          '#' =&gt; 'this is a new file',\n          'total' =&gt; '30    ',\n          'end' =&gt; '11:20    ',\n          'No' =&gt; '\"FRUITS\"',\n          'Fruit_class' =&gt; undef,\n          '}' =&gt; undef\n        };\n</code></pre>\n\n<p>Expected hash as output:</p>\n\n<pre><code>$VAR1 = {\n          'Name' =&gt; '\"fruit 1\"',\n          'fruitId' =&gt; '\"0\"            ',\n          '\"apple_fru\".fruitValue' =&gt; '6            ',\n          '\"apple_fru\".fruitCount' =&gt; '5'\n\n          'Name' =&gt; '\"fruit 2\"',\n          'fruitId' =&gt; '\"0\"            ',\n          '\"orange_fru\".fruitValue' =&gt; '10            ',\n          '\"orange_fru\".fruitCount' =&gt; '20'\n\n\n        };\n</code></pre>\n"}, {"tags": ["regex", "perl", "multiline"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537342736, "post_id": 52400503, "comment_id": 91745069, "body": "Contrary to your claims, <code>s&#47;\\n\\@keyword\\n?\\{&#47;&#47;</code> works if <code>s&#47;\\n\\@keyword\\n\\{&#47;&#47;</code> works."}, {"owner": {"reputation": 1, "user_id": 10384146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f62b58e1c12d9c44647426db53005c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Anquetil", "link": "https://stackoverflow.com/users/10384146/nicolas-anquetil"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537433417, "post_id": 52400503, "comment_id": 91785281, "body": "When there are multiple occurrences of any of the 2 patterns, and perl is given the -0777 arguments it only works for the first instance of each pattern. The reason is obvious (once one understands the problem) and I gave it in my &quot;answer&quot;. But no, it does not work without the &#39;g&#39; at the end of the perl instruction."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537448611, "post_id": 52400503, "comment_id": 91794576, "body": "When there are multiple occurrences of any of the 2 pattern, both versions only do the first, so my comment stands."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1537343314, "post_id": 52400643, "comment_id": 91745368, "body": "SO is not a forum. In the future, if you have a new question, asked it as a question. /// <code>m</code> only affects what <code>^</code> and <code>$</code> match. It can&#39;t possibly cause the pattern <code>^\\@keyword\\n?\\{</code> to match the string <code>@keyword\u240a</code>."}, {"owner": {"reputation": 1, "user_id": 10384146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f62b58e1c12d9c44647426db53005c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Anquetil", "link": "https://stackoverflow.com/users/10384146/nicolas-anquetil"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537434091, "post_id": 52400643, "comment_id": 91785647, "body": "I don&#39;t quite understand this comment. I had a genuine question (as witnessed by the question marks at the end of the 1st message). It happened that right after asking the question, and still trying to solve the problem (I spent a full morning on it), I found the answer. But even then, this solution is not satisfactory because -0777 prevents me from doing any line based transformations (I have other transformations to apply). So I would like to know how I could do it. And, again, I asked a genuine question as why my tentative solution did not work."}, {"owner": {"reputation": 1, "user_id": 10384146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f62b58e1c12d9c44647426db53005c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Anquetil", "link": "https://stackoverflow.com/users/10384146/nicolas-anquetil"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537434524, "post_id": 52400643, "comment_id": 91785880, "body": "As for <code>&#47;&#47;&#47;m</code>, I understood that putting <code>\\n</code> in a regexp changes how <code>^</code> and <code>$</code> are interpreted and that <code>&#47;&#47;&#47;m</code> brings back the usual behavior. May be I am wrong? The question remains how I could do the transformations I need without invoking <code>perl -0777</code> ... ?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537448402, "post_id": 52400643, "comment_id": 91794419, "body": "Re &quot;<i>The question remains how I could do the transformations I need without invoking perl -0777 ... ?</i>&quot; This is the first time you&#39;ve asked this question, and it can&#39;t be answered in a comment. If you want to ask a new question, post a Question."}], "tags": [], "owner": {"reputation": 1, "user_id": 10384146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f62b58e1c12d9c44647426db53005c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Anquetil", "link": "https://stackoverflow.com/users/10384146/nicolas-anquetil"}, "is_accepted": false, "score": -1, "last_activity_date": 1537342841, "creation_date": 1537342841, "answer_id": 52400643, "question_id": 52400503, "link": "https://stackoverflow.com/questions/52400503/cant-get-perl-multi-line-substitution-right/52400643#52400643", "title": "can&#39;t get perl multi-line substitution right", "body": "<p>Ahhhhh !\njust got it.\nBecause of perl -p0777, the whole file is only one line,\nexpressions are matched once on the entire file, so each statement matched exactly one pattern.\nThe solution was to put 'g' at the end:</p>\n\n<pre><code>s/\\n\\@keyword\\n?\\{//g\n</code></pre>\n\n<p>But now another one.</p>\n\n<p>I first started without the -0777 option\nand I thought that</p>\n\n<pre><code>s/^\\@keyword\\n?\\{//m\n</code></pre>\n\n<p>would work.\nBut again it did not catch the second case (pattern on two lines).\nCan you explain why ?</p>\n"}], "owner": {"reputation": 1, "user_id": 10384146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f62b58e1c12d9c44647426db53005c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas Anquetil", "link": "https://stackoverflow.com/users/10384146/nicolas-anquetil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1537342841, "creation_date": 1537342376, "last_edit_date": 1537342400, "question_id": 52400503, "link": "https://stackoverflow.com/questions/52400503/cant-get-perl-multi-line-substitution-right", "title": "can&#39;t get perl multi-line substitution right", "body": "<p>I am having trouble understanding how multiline matching works in perl\nI have a file where I want to remove any appearance of:</p>\n\n<pre><code>@keyword{\n</code></pre>\n\n<p>or </p>\n\n<pre><code>@keyword\n{\n</code></pre>\n\n<p>in both case, @ is the first character of the line.</p>\n\n<p>I can do it with two separate instructions (with 'perl -p0777'):</p>\n\n<pre><code>s/\\n\\@keyword\\{//\ns/\\n\\@keyword\\n\\{//\n</code></pre>\n\n<p>but I thought the following would work too</p>\n\n<pre><code>s/\\n\\@keyword\\n?\\{//\n</code></pre>\n\n<p>and it does not. It does not catch the second case and I cannot understand why ???</p>\n\n<p>any explanation ?</p>\n"}, {"tags": ["regex", "perl", "unicode", "stdout", "stdin"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537313534, "post_id": 52394852, "comment_id": 91736755, "body": "<i>&quot;I can fix that with the addition of the <code>-CASD</code> command line switch&quot;</i> Your new command works because you have used <code>.+?</code> instead of <code>.+</code>. The output of both commands is correct."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537314041, "post_id": 52394852, "comment_id": 91736856, "body": "It&#39;s best not to habitually use &quot;magic&quot; command line options for any utility. In <code>perl -lanE</code>, <code>-a</code> unnecessarily autosplits each line into <code>@F</code>, which you never use, and <code>-l</code> strips the record separator from each line and puts it back on output, which is unnecessary if you&#39;re using <code>say</code>. Just <code>perl -nE</code> is all you need."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537314494, "post_id": 52394852, "comment_id": 91736940, "body": "I didn&#39;t claim that the output was correct whatever you do to the regex pattern. I am pretty sure that perl is behaving correctly and you are wrong to say <i>&quot;the word boundaries are not working&quot;</i>."}, {"owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537315822, "post_id": 52394852, "comment_id": 91737166, "body": "@Borodin: Eliminating <code>l</code> in the command line switches will result in the output being double spaced with <code>say</code>."}, {"owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537316026, "post_id": 52394852, "comment_id": 91737207, "body": "@Borodin: <i>I am pretty sure that perl is behaving correctly and you are wrong to say &quot;the word boundaries are not working&quot;</i> Please try the examples. choroba is correct - the <code>-CASD</code> causes the input stream to be decoded from the UTF-8 and the regex works as intended. Without that, it is just raw bytes and the <code>&#47;\\b{wb}</code> then has no meaning on raw bytes."}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537314571, "post_id": 52395045, "comment_id": 91736952, "body": "Are you sure? Certainly <code>\\b</code> will misbehave if it sees a UTF-8-encoded string, but it looks like most of the blame is on the use of <code>&#47;\\b(.+?)\\b&#47;g</code> instead of <code>&#47;\\b{wb}(.+)\\b{wb}&#47;g</code>."}, {"owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537316214, "post_id": 52395045, "comment_id": 91737249, "body": "@Borodin: I changed the regex to <code>&#47;\\b(.+?)\\b&#47;g</code> to show the issues in the post. Please actually try the examples."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "edited": false, "score": 0, "creation_date": 1537318646, "post_id": 52395045, "comment_id": 91737703, "body": "@dawg: I wrote my comment to <b>choroba</b> as I am particularly interested in what he has to say. I&#39;m not too disappointed to have no reply as it&#39;s 2:40am where he is, and I&#39;m happy to wait a while to see if he wants to respond. It would have been much better if you had <i>added</i> another test to your post, as editing the existing information renders all comments obsolete. It&#39;s now very unclear as the edits to your question are different from what you say you changed. I apologise, but I&#39;m unable to do any tests myself as I have only a phone and a tablet to work with for the next day or two."}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537338377, "post_id": 52395045, "comment_id": 91742805, "body": "@Borodin: Omitting the <code>?</code> consumes the whole lines. Using <code>\\b{wb}</code> doesn&#39;t help, as Perl still sees the octets, and their membership in word/non-word classes makes no sense with respect to the characters composed of them."}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 3, "last_activity_date": 1537307471, "last_edit_date": 1537307471, "creation_date": 1537307310, "answer_id": 52395045, "question_id": 52394852, "link": "https://stackoverflow.com/questions/52394852/perl-1-liner-can-print-unicode-input-but-regex-not-working-fancy-word-boundari/52395045#52395045", "title": "Perl 1 liner: Can print unicode input but regex not working; fancy word boundaries", "body": "<p>In the first case, you aren't reading and printing unicode, you're reading and printing UTF-8. For Perl, these strings consist of bytes (octets), not characters, so it can find word boundaries in the middle of a multibyte sequence. See <a href=\"http://p3rl.org/perlunicode\" rel=\"nofollow noreferrer\">perlunicode</a> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": -1, "last_activity_date": 1537320025, "creation_date": 1537320025, "answer_id": 52396652, "question_id": 52394852, "link": "https://stackoverflow.com/questions/52394852/perl-1-liner-can-print-unicode-input-but-regex-not-working-fancy-word-boundari/52396652#52396652", "title": "Perl 1 liner: Can print unicode input but regex not working; fancy word boundaries", "body": "<blockquote>\n  <p>Since I can read and print unicode in the first case, why does adding <code>-CASD</code> change the regex?</p>\n</blockquote>\n\n<p>That command-line option just makes perl decode incoming data as if it were UTF-8-encoded, and re-encode outgoing data as UTF-8</p>\n\n<p>Just reading text and printing the same text with the same encoding doesn't require the stream to be decoded and re-encoded, as the byte sequence is already encoded correctly</p>\n\n<p>If the input were, say, Windows-1255-encoded (Hebrew), while the output needed to be UTF-8-encoded, then the data would need to be <em>decoded</em> first to a character string and then <em>encoded</em> to a UTF-8 byte sequence</p>\n\n<p>It is only when the input and output require exavtly the same encoding, and there is no need to process the input as a character string, that the decoding and encoding can be dispensed with</p>\n"}], "owner": {"reputation": 79972, "user_id": 298607, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DVW9g.jpg?s=128&g=1", "display_name": "dawg", "link": "https://stackoverflow.com/users/298607/dawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "accepted_answer_id": 52395045, "answer_count": 2, "score": 1, "last_activity_date": 1537367238, "creation_date": 1537306188, "last_edit_date": 1537367238, "question_id": 52394852, "link": "https://stackoverflow.com/questions/52394852/perl-1-liner-can-print-unicode-input-but-regex-not-working-fancy-word-boundari", "title": "Perl 1 liner: Can print unicode input but regex not working; fancy word boundaries", "body": "<p>Suppose I have (in Bash):</p>\n\n<pre><code>txt=\"\u041d\u0430 \u0431\u0435\u0440\u0435\u0433\u0443 \u043f\u0443\u0441\u0442\u044b\u043d\u043d\u044b\u0445 \u0432\u043e\u043b\u043d\n\u0421\u0442\u043e\u044f\u043b \u043e\u043d, \u0434\u0443\u043c \u0432\u0435\u043b\u0438\u043a\u0438\u0445 \u043f\u043e\u043b\u043d,\n\u0418 \u0432\u0434\u0430\u043b\u044c \u0433\u043b\u044f\u0434\u0435\u043b.\"\n</code></pre>\n\n<p>If I pipe this to Perl, I can print no problem:</p>\n\n<pre><code>$ echo \"$txt\" | perl -lnE 'say \"$_\"'\n\u041d\u0430 \u0431\u0435\u0440\u0435\u0433\u0443 \u043f\u0443\u0441\u0442\u044b\u043d\u043d\u044b\u0445 \u0432\u043e\u043b\u043d\n\u0421\u0442\u043e\u044f\u043b \u043e\u043d, \u0434\u0443\u043c \u0432\u0435\u043b\u0438\u043a\u0438\u0445 \u043f\u043e\u043b\u043d,\n\u0418 \u0432\u0434\u0430\u043b\u044c \u0433\u043b\u044f\u0434\u0435\u043b.\n</code></pre>\n\n<p>But I am having issues with various regex on this text. Suppose I add the new <a href=\"https://www.effectiveperlprogramming.com/2016/06/perl-v5-22-adds-fancy-unicode-word-boundaries/\" rel=\"nofollow noreferrer\">Fancy Word Boundaries</a>:</p>\n\n<pre><code>$ echo \"$txt\" | perl -lnE 'while (/\\b{wb}(.+?)\\b{wb}/g) { print \"\\\"$1\\\"\" }'\n\"\u2013\"\n\"\u00f9\"\n\"\u2013\"\n\"\u221e\"\n\" \"\n\"\u2013\"\n\"\u00b1\"\n\"\u2013\u00b5\u2014\"\n\"\u00c4\"\n...\n# junk characters...\n</code></pre>\n\n<p>The word boundaries are not working and the input characters are altered.</p>\n\n<p>(If I change the regex to <code>/\\b{wb}(.+)\\b{wb}/g</code> the output is the same as the first. The <code>(.+)</code> consumes the entire line.)</p>\n\n<p>I can fix these issues with the addition of the <a href=\"https://perldoc.perl.org/perlrun.html#Command-Switches\" rel=\"nofollow noreferrer\">-CASD</a> command line switch and the fancy word boundaries work as designed:</p>\n\n<pre><code>$ echo \"$txt\" | perl -CSAD  -lnE 'while (/\\b{wb}(.+?)\\b{wb}/g) { print \"\\\"$1\\\"\" }'\n\"\u041d\u0430\"\n\" \"\n\"\u0431\u0435\u0440\u0435\u0433\u0443\"\n\" \"\n\"\u043f\u0443\u0441\u0442\u044b\u043d\u043d\u044b\u0445\"\n\" \"\n\"\u0432\u043e\u043b\u043d\"\n\"\u0421\u0442\u043e\u044f\u043b\"\n\" \"\n\"\u043e\u043d\"\n\",\"\n\" \"\n\"\u0434\u0443\u043c\"\n\" \"\n\"\u0432\u0435\u043b\u0438\u043a\u0438\u0445\"\n\" \"\n\"\u043f\u043e\u043b\u043d\"\n\",\"\n\"\u0418\"\n\" \"\n\"\u0432\u0434\u0430\u043b\u044c\"\n\" \"\n\"\u0433\u043b\u044f\u0434\u0435\u043b\"\n\".\"\n</code></pre>\n\n<p><strong>The question:</strong> The <code>-CASD</code> switches in <a href=\"https://perldoc.perl.org/perlrun.html#Command-Switches\" rel=\"nofollow noreferrer\">perlrun</a> seems to imply that the unicode features enabled are for <code>stdin</code> and <code>stdout</code> input streams. There is no mention of any internal differences that would change a regex. Since I can read and print unicode in the first case, why does adding <code>-CASD</code> change the regex? </p>\n\n<pre><code>$ perl -v\nThis is perl 5, version 28, subversion 0 (v5.28.0) built for darwin-thread-multi-2level\n</code></pre>\n"}, {"tags": ["multithreading", "perl", "promise", "subprocess", "mojolicious"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537302415, "post_id": 52393335, "comment_id": 91733381, "body": "I probably don&#39;t understanding something here -- why can you not throttle it by limiting <code>@numbers</code> submitted to the <code>map</code> (managing how they are submitted)?  Also, how exactly do you run all this?  It&#39;s crashing for me."}, {"owner": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537306474, "post_id": 52393335, "comment_id": 91734866, "body": "@zdim, You need to run it like <code>[02:54:26 abhasker@wsl -&gt; temp$ morbo bug.pl </code> OUTPUT: <code>Server available at http:&#47;&#47;127.0.0.1:3000</code> this."}, {"owner": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537306674, "post_id": 52393335, "comment_id": 91734955, "body": "@h-q, I ran this with around 5000 input numbers, It took some time but found no problem and user got this message: <b>Thank you! You will receive an email shortly with the results.</b>"}, {"owner": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "reply_to_user": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537335160, "post_id": 52393335, "comment_id": 91741462, "body": "@AbhiNickz, How can I can get the message &quot;<b>Thank you! You will receive an email...</b>&quot; immediately, and not after some time? Also for the sake of testing, I used 11-digit numbers, for example use &#39;99999999977&#39; 10,000 times."}, {"owner": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537335212, "post_id": 52393335, "comment_id": 91741478, "body": "@zdim, would you provide an example of how to throttle <code>@numbers</code> submitted to <code>map</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "edited": false, "score": 0, "creation_date": 1537338558, "post_id": 52395495, "comment_id": 91742885, "body": "thanks for the insight. I was using Mojolicious 7.61 &amp; 7.75, and just upgraded to 8.0. It no longer crashes, but times out instead and I&#39;m still unable to handle large sets. Would you kindly provide a working example of your suggestion using Future::Utils fmap_concat &amp; Mojo::Promise::Role::Futurify ? Thank you!!"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "reply_to_user": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "edited": false, "score": 0, "creation_date": 1537376722, "post_id": 52395495, "comment_id": 91765550, "body": "I&#39;ve added an example and also mentioned Minion as an alternative for this use case."}, {"owner": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "edited": false, "score": 0, "creation_date": 1537442174, "post_id": 52395495, "comment_id": 91790499, "body": "Heavens. Thank you @Grinnz, well written example. I&#39;ll leave the Minion research for another day. Now the real challenge is trying to find the ideal <code>concurrent</code> value to use :-)"}], "tags": [], "owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "is_accepted": true, "score": 2, "last_activity_date": 1537545524, "last_edit_date": 1537545524, "creation_date": 1537310121, "answer_id": 52395495, "question_id": 52393335, "link": "https://stackoverflow.com/questions/52393335/mojolicous-limiting-number-of-promises-ioloop-subprocess/52395495#52395495", "title": "Mojolicous: Limiting number of Promises / IOLoop-&gt;subprocess", "body": "<p>The problem isn't the number of promises but the number of subprocesses. One way to limit this is to simply limit how many you create at a time in your program logic. Instead of spawning them all at once in a map, set a limit and retrieve that many from @numbers (perhaps using <a href=\"https://perldoc.pl/functions/splice\" rel=\"nofollow noreferrer\">splice</a>) and spawn those subprocesses; create an ->all promise that waits on those and attach a ->then to that promise to retrieve your next chunk of numbers, and so on.</p>\n\n<p>Another option is to use <a href=\"https://metacpan.org/pod/Future::Utils\" rel=\"nofollow noreferrer\">Future::Utils</a> fmap_concat which can take care of the rate-limiting code by have you provide a number of the maximum outstanding Futures. Your promise-returning function can apply <a href=\"https://metacpan.org/pod/Mojo::Promise::Role::Futurify\" rel=\"nofollow noreferrer\">Mojo::Promise::Role::Futurify</a> to chain a following Future to use in this manner.</p>\n\n<pre><code>#!/usr/bin/env perl\n\nuse Mojolicious::Lite;\nuse Mojo::File 'path';\nuse Mojo::IOLoop;\nuse Mojo::Promise;\nuse Future::Utils 'fmap_concat';\n\nget '/' =&gt; sub {\n  my $c = shift;\n  my $count = $c-&gt;param('count') // 0;\n  my @numbers = 1..$count;\n\n  if (@numbers) {\n    my $result_f = fmap_concat {\n      my $number = shift;\n      my $p = Mojo::Promise-&gt;new;\n      Mojo::IOLoop-&gt;subprocess(sub {\n        sleep 2;\n        return $number+1;\n      }, sub {\n        my ($subprocess, $err, @result) = @_;\n        return $p-&gt;reject($err) if $err;\n        $p-&gt;resolve(@result);\n      });\n      return $p-&gt;with_roles('Mojo::Promise::Role::Futurify')-&gt;futurify;\n    } foreach =&gt; \\@numbers, concurrent =&gt; 20;\n\n    $result_f-&gt;on_done(sub {\n      my @values = @_;\n      foreach my $response (@values) {\n        $c-&gt;app-&gt;log-&gt;info($response);\n      }\n    })-&gt;on_fail(sub {\n      my $error = shift;\n      $c-&gt;app-&gt;log-&gt;fatal($error);\n    })-&gt;retain;\n\n    $c-&gt;stash(done =&gt; 1);\n  }\n  $c-&gt;render(text =&gt; \"Processing $count numbers\\n\");\n};\n\napp-&gt;start;\n</code></pre>\n\n<p>As for the wait method, this does nothing when the event loop is already running, which in a webapp response handler it will be, if you started the application in a Mojolicious daemon (as opposed to a PSGI or CGI server which don't support asynchronous responses). The ->stash and ->render calls outside of the callbacks will be run immediately after setting up the subprocesses. Then the response handler will complete, and the event loop will have control again, which will fire the appropriate ->then callbacks once the promises resolve. The render should not be waiting for anything beyond the setting up of subprocesses; since you said there may be hundreds, that could be the slowdown you're experiencing. Make sure you are using Mojolicious 7.86 or newer as Subprocess was changed so the fork will not happen until the next tick of the event loop (after your response handler has completed).</p>\n\n<p>I'll also note that Subprocesses aren't really designed for this; they're designed for executing slow code that still returns an eventual result to the browser in a response (and <a href=\"https://metacpan.org/pod/Mojolicious::Plugin::Subprocess\" rel=\"nofollow noreferrer\">Mojolicious::Plugin::Subprocess</a> is nice for this use case). One problem I can see is that if you restart the application, any still pending subprocesses will just be ignored. For jobs that you want to set off and forget, you might consider a job queue like <a href=\"https://metacpan.org/pod/Minion\" rel=\"nofollow noreferrer\">Minion</a> which has great integration into Mojolicious apps, and runs via a separate worker process.</p>\n"}], "owner": {"reputation": 510, "user_id": 2035207, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23407540c4b23ef4f9b4ef62677576ae?s=128&d=identicon&r=PG", "display_name": "h q", "link": "https://stackoverflow.com/users/2035207/h-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 2, "accepted_answer_id": 52395495, "answer_count": 1, "score": 3, "last_activity_date": 1537545524, "creation_date": 1537298598, "question_id": 52393335, "link": "https://stackoverflow.com/questions/52393335/mojolicous-limiting-number-of-promises-ioloop-subprocess", "title": "Mojolicous: Limiting number of Promises / IOLoop-&gt;subprocess", "body": "<p>I'm using Mojolicious non-blocking methods (Promises) to request data from external systems. 1) I'd like to notify the user immediately that the process has started; 2) I'd like to scale this program.</p>\n\n<p>The code below works for a small set of numbers (few hundreds), with more numbers, I get an error <code>[error] Can't create pipe: Too many open files at /path/lib/perl5/Mojo/IOLoop.pm line 156.</code> <em>Question 1</em>) How can I limit the number of Promises I spawn (<code>map</code> in my code below):</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/env perl\n\nuse Mojolicious::Lite;\nuse Mojolicious::Plugin::TtRenderer;\n\nsub isPrime\n{\n    my ($n) = @_;\n    my $e = sqrt($n);\n    for (my $i=2; $i&lt;$e; $i++) {\n        return 0 if $n%$i==0;\n    }\n    return 1;\n}\n\nsub makeApromise\n{\n    my ($number) = @_;\n\n    my $promise = Mojo::Promise-&gt;new;\n    Mojo::IOLoop-&gt;subprocess(\n    sub {  # first callback is executed in subprocess\n        my %response;\n        # Simulate a long computational process\n        $response{'number'}  = $number;\n        $response{'isPrime'} = isPrime($number);\n        return \\%response;\n    },\n        sub {  # second callback resolves promise with subprocess result\n            my ($self, $err, @result) = @_;\n            return $promise-&gt;reject($err) if $err;\n            $promise-&gt;resolve(@result);\n        },\n    );\n    return $promise;\n}\n\nplugin 'tt_renderer'; # automatically render *.html.tt templates\n\nany '/' =&gt; sub {\n    my ($self) = @_;\n    my $lines = $self-&gt;param( 'textarea' );\n\n    if ($lines) {\n    my @numbers;\n    foreach my $number (split(/\\r?\\n/, $lines)) {\n        push(@numbers, $number) if $number =~ /^\\d+$/;\n    }\n    if (@numbers) {\n        ####################################\n        ### This is the problem below... ###\n        my @promises = map { makeApromise($_) } @numbers;\n        ####################################\n        # MojoPromise Wait\n        Mojo::Promise-&gt;all(@promises)\n        -&gt;then(sub {\n            my @values = map { $_-&gt;[0] } @_;\n            foreach my $response (@values) {\n            #print STDERR $response-&gt;{'number'}, \" =&gt; \", $response-&gt;{'isPrime'}, \"\\n\";\n            # Prepare email...\n            }\n            # Send an email...\n               })\n        #-&gt;wait # Don't wait? I want to tell the user to wait for an email as quickly as possible...\n        if @promises;\n    }\n    $self-&gt;stash(done =&gt; \"1\",);\n    }\n    $self-&gt;render(template =&gt; 'index', format =&gt; 'html', handler =&gt; 'tt');\n};\n\napp-&gt;start;\n__DATA__\n\n@@ index.html.tt\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;title&gt;Make A Promise&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    [% IF done %]\n    &lt;h3&gt;Thank you! You will receive an email shortly with the results.&lt;/h3&gt;\n    [% ELSE %]\n    &lt;h3&gt;Enter numbers...&lt;/h3&gt;\n    &lt;form role=\"form\" action=\"/\" method=\"post\"&gt;\n      &lt;textarea name=\"textarea\" rows=\"5\" autofocus required&gt;&lt;/textarea&gt;\n      &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n    &lt;/form&gt;\n    [% END %]\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I commented out the <code>wait</code>; however, it appears the code is still blocking. <em>Question 2</em>) How can I notify the user immediately that the process has already started? (i.e. when I <code>stash</code> the <code>done</code> variable)</p>\n"}, {"tags": ["perl", "perl-core"], "answers": [{"comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1537295060, "post_id": 52392414, "comment_id": 91730154, "body": "<code>main::join()</code> (or whatever namespace we happen to be in the scope of) unambiguously calls the subroutine without overriding the prototype. But the best way is to find a better name."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1537294381, "creation_date": 1537294381, "answer_id": 52392414, "question_id": 52392330, "link": "https://stackoverflow.com/questions/52392330/ambiguous-call-resolved-as-corejoin-qualify-as-such-or-use-at/52392414#52392414", "title": "Ambiguous call resolved as CORE::join(), qualify as such or use &amp; at", "body": "<p>You're getting that warning because you've defined a subroutine called <code>join</code>. Now Perl isn't sure whether <code>join( ', ', @$args )</code> is supposed to call the built-in function or your subroutine.</p>\n\n<p><code>CORE::join</code> unambiguously calls the built-in <a href=\"https://perldoc.pl/functions/join\" rel=\"noreferrer\"><code>join</code></a>.</p>\n\n<p><code>&amp;join(...)</code> unambiguously calls your subroutine (and overrides any prototype it may have). As for why your subroutine throws bizarre errors about a package called <code>,</code> and <code>_make_instance</code>, we can't answer that if you don't show us the code.</p>\n"}, {"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": true, "score": 6, "last_activity_date": 1537334220, "last_edit_date": 1537334220, "creation_date": 1537294555, "answer_id": 52392444, "question_id": 52392330, "link": "https://stackoverflow.com/questions/52392330/ambiguous-call-resolved-as-corejoin-qualify-as-such-or-use-at/52392444#52392444", "title": "Ambiguous call resolved as CORE::join(), qualify as such or use &amp; at", "body": "<p>You are getting the error because you have a sub named join, so you need to disambiguate it.  To make it call the built-in, prepend <code>CORE::</code>.  To make it call the sub, prepend <code>&amp;</code>. </p>\n\n<p>The error is because you are calling the sub and <strong>it is actually a method that is expecting an object or class as the first parameter</strong>, which would happen implicitly when you use the method call syntax.</p>\n"}], "owner": {"reputation": 15304, "user_id": 4632019, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8937eb40752cf51c7da61bd4a322a4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Eugen Konkov", "link": "https://stackoverflow.com/users/4632019/eugen-konkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 52392444, "answer_count": 2, "score": 3, "last_activity_date": 1537334220, "creation_date": 1537294001, "question_id": 52392330, "link": "https://stackoverflow.com/questions/52392330/ambiguous-call-resolved-as-corejoin-qualify-as-such-or-use-at", "title": "Ambiguous call resolved as CORE::join(), qualify as such or use &amp; at", "body": "<p>I have got the error:</p>\n\n<pre><code>Ambiguous call resolved as CORE::join(), qualify as such or use &amp; at\n</code></pre>\n\n<p>When I fix error as:</p>\n\n<pre><code>$args =  CORE::join( ', ', @$args );\n</code></pre>\n\n<p>everything works fine.</p>\n\n<p>But when I fix it as:</p>\n\n<pre><code>$args =  &amp;join( ', ', @$args );\n</code></pre>\n\n<p>As suggested by error message, I got different error:</p>\n\n<pre><code>Can't locate object method \"_make_instance\" via package \", \" (perhaps you forgot to load \", \"?) at\n</code></pre>\n\n<p>why second fix does not work?</p>\n"}, {"tags": ["perl", "hash"], "answers": [{"tags": [], "owner": {"reputation": 45481, "user_id": 197758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628da6ba2a6c70e35c009b7e3c3a430a?s=128&d=identicon&r=PG", "display_name": "toolic", "link": "https://stackoverflow.com/users/197758/toolic"}, "is_accepted": true, "score": 4, "last_activity_date": 1537284259, "last_edit_date": 1537284259, "creation_date": 1537278256, "answer_id": 52388006, "question_id": 52387910, "link": "https://stackoverflow.com/questions/52387910/print-lowest-value-in-hash-of-hashes/52388006#52388006", "title": "print lowest value in hash of hashes", "body": "<p>Loop through the people.  Then, dereference each person hash to get a list of the years:</p>\n\n<pre><code>use warnings;\nuse strict;\nuse List::Util qw(min);\n\nmy %people = (\npersonA =&gt; {\n    2017   =&gt; 1,\n    2018   =&gt; 2,\n},\npersonB =&gt; {\n    2015   =&gt; 4,\n    2013   =&gt; 28,\n    2014   =&gt; 1,\n},\npersonC =&gt; {\n    2013   =&gt; 3,\n    2011   =&gt; 2,\n    2012   =&gt; 45,\n},\n);\n\nfor my $person (sort keys %people) {\n    my $min = min(keys %{ $people{$person} });\n    print \"$person $min\\n\";\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>personA 2017\npersonB 2013\npersonC 2011\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 2, "creation_date": 1537293003, "post_id": 52388256, "comment_id": 91729198, "body": "Probably rather <code>sort { $a &lt;=&gt; $b }</code> for the second sort. On this precise example, it doesn&#39;t change anything (and since the keys look like somewhat recent dates, it probably won&#39;t change anything with any data this program could run on), but comparing number with a string comparison doesn&#39;t sound like a good idea."}], "tags": [], "owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "is_accepted": false, "score": 3, "last_activity_date": 1537278993, "creation_date": 1537278993, "answer_id": 52388256, "question_id": 52387910, "link": "https://stackoverflow.com/questions/52387910/print-lowest-value-in-hash-of-hashes/52388256#52388256", "title": "print lowest value in hash of hashes", "body": "<p>You can avoid using any module at all while keeping the simplicity.</p>\n\n<pre><code>use warnings;\nuse strict;\n\nmy %hash = (\n    personA =&gt; {\n        2017 =&gt; 1,\n        2018 =&gt; 2,\n    },\n    personB =&gt; {\n        2015 =&gt; 4,\n        2013 =&gt; 28,\n        2014 =&gt; 1,\n    },\n    personC =&gt; {\n        2013 =&gt; 3,\n        2011 =&gt; 2,\n        2012 =&gt; 45,\n    },\n);\n\nforeach my $person ( sort keys %hash ) {\n    printf( \"%s %d\\n\", $person, ( sort keys %{ $hash{$person} } )[0] );\n}\n</code></pre>\n\n<p><em>( sort keys %{ $hash{$person} } )[0]</em> - sorts the keys in a ascending order (which is by default) and then get the first one.</p>\n"}], "owner": {"reputation": 91, "user_id": 8861632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e3fdf68a4f20de07b5fc968b1be7cf2?s=128&d=identicon&r=PG", "display_name": "Izzy", "link": "https://stackoverflow.com/users/8861632/izzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 52388006, "answer_count": 2, "score": 2, "last_activity_date": 1585250811, "creation_date": 1537277926, "last_edit_date": 1585250811, "question_id": 52387910, "link": "https://stackoverflow.com/questions/52387910/print-lowest-value-in-hash-of-hashes", "title": "print lowest value in hash of hashes", "body": "<p>I am experiencing issues completing a simple task. I have the following hash of hashes:</p>\n\n<pre><code>%hash = (\npersonA =&gt; {\n    2017   =&gt; 1,\n    2018   =&gt; 2,\n},\npersonB =&gt; {\n    2015   =&gt; 4,\n    2013   =&gt; 28,\n    2014   =&gt; 1, .\n},\npersonC =&gt; {\n    2013   =&gt; 3,\n    2011   =&gt; 2,\n    2012   =&gt; 45,\n},\n);\n</code></pre>\n\n<p>I am trying to print out the earliest year for each person, e.g. something like: </p>\n\n<p>personA 2017</p>\n\n<p>personB 2013</p>\n\n<p>personC 2011</p>\n\n<p>It seems that <code>List::Util</code> is the best tool for this, but I cannot find an example to adapt for my data. I am having trouble because the solutions I have found are trying to sort/print the first level of the hash (i.e., <code>personA</code>, etc.), as opposed to the years.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy %hash;\nmy $hash; \n\n%hash = (\npersonA =&gt; {\n    2017   =&gt; 1,\n    2018   =&gt; 2,\n},\npersonB =&gt; {\n    2015   =&gt; 4,\n    2013   =&gt; 28,\n    2014   =&gt; 1,\n},\npersonC =&gt; {\n    2013   =&gt; 3,\n    2011   =&gt; 2,\n    2012   =&gt; 45,\n},\n);\n\nuse List::Util qw(min);\nmy $min = min keys %hash;\n$hash = {$min =&gt; $hash-&gt;{$min}};\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 18344, "user_id": 119326, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b29825e83c1da695da0e22b4198a0105?s=128&d=identicon&r=PG", "display_name": "Cfreak", "link": "https://stackoverflow.com/users/119326/cfreak"}, "edited": false, "score": 1, "creation_date": 1537275378, "post_id": 52387003, "comment_id": 91718621, "body": "Define &quot;didn&#39;t work&quot;. Did you get an error, if not what was the output instead of what you expected?"}], "answers": [{"comments": [{"owner": {"reputation": 727, "user_id": 2059832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8oSY3.gif?s=128&g=1", "display_name": "drmrgd", "link": "https://stackoverflow.com/users/2059832/drmrgd"}, "edited": false, "score": 0, "creation_date": 1537276329, "post_id": 52387253, "comment_id": 91719275, "body": "Oh!  I see how to do it now!  I had tried a similar approach, moving <code>split</code> inside the <code>map</code> in one of my other iterations, but was still trying to use <code>$_</code> and friends.  The other key to this is variable assignment inside the map.  Thanks @choroba!"}], "tags": [], "owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "is_accepted": true, "score": 3, "last_activity_date": 1537275835, "creation_date": 1537275835, "answer_id": 52387253, "question_id": 52387003, "link": "https://stackoverflow.com/questions/52387003/split-mutli-element-string-into-hash/52387253#52387253", "title": "Split mutli-element string into hash", "body": "<p>You can use map, but you need to move the split inside:</p>\n\n<pre><code>my %table = map { chomp; my @s = split /\\t/; $s[1], \\@s } &lt;DATA&gt;;\n</code></pre>\n"}], "owner": {"reputation": 727, "user_id": 2059832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8oSY3.gif?s=128&g=1", "display_name": "drmrgd", "link": "https://stackoverflow.com/users/2059832/drmrgd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 52387253, "answer_count": 1, "score": 1, "last_activity_date": 1537275835, "creation_date": 1537275020, "question_id": 52387003, "link": "https://stackoverflow.com/questions/52387003/split-mutli-element-string-into-hash", "title": "Split mutli-element string into hash", "body": "<p>I know that one can easily split a string into a hash using <code>map</code> like this question <a href=\"https://stackoverflow.com/questions/8223570/how-to-do-i-split-a-string-into-hash-keys-with-undef-values/8223593\">How to do I split a string into hash keys with undef values?</a>, or this <a href=\"https://www.perlmonks.org/?node_id=887343\" rel=\"nofollow noreferrer\">Perl Monks thread</a>.  So, something like this very easily works:</p>\n\n<pre><code>my %table = map { chomp; split(/\\t/) } &lt;DATA&gt;;\ndd \\%table;\n\n__DATA__\n#1245   banana\n#3499   cherry\n#5290   notebook\n#2112   compact_disc\n</code></pre>\n\n<p>Of course, this would result in:</p>\n\n<pre><code>{\n  \"#1245\" =&gt; \"banana\",\n  \"#2112\" =&gt; \"compact_disc\",\n  \"#3499\" =&gt; \"cherry\",\n  \"#5290\" =&gt; \"notebook\",\n}\n</code></pre>\n\n<p>If one had a more complicated table of data, though, and wanted to make a hash of arrays using the second column as the key, is this possible with map, or does one have to use the \"longer\" form:</p>\n\n<pre><code>my %table;\nwhile(&lt;DATA&gt;) {\n    chomp(my @elems = split(/\\t/));\n    $table{$elems[1]} = \\@elems;\n}\ndd \\%table;\n\n__DATA__\nshelf1  #1245   banana  Dole\nshelf1  #3499   cherry  Acme\nshelf2  #5290   notebook    Staples\nshelf3  #2112   compact_disc    Mercury_Records\n</code></pre>\n\n<p>to make:</p>\n\n<pre><code>{\n  \"#1245\" =&gt; [\"shelf1\", \"#1245\", \"banana\", \"Dole\"],\n  \"#2112\" =&gt; [\"shelf3\", \"#2112\", \"compact_disc\", \"Mercury_Records\"],\n  \"#3499\" =&gt; [\"shelf1\", \"#3499\", \"cherry\", \"Acme\"],\n  \"#5290\" =&gt; [\"shelf2\", \"#5290\", \"notebook\", \"Staples\"],\n}\n</code></pre>\n\n<p>I tried these two approaches, but neither seem to work, and I'm guessing it's not possible.  But, just out of curiosity (and education) was wondering if one can do it a similar way.</p>\n\n<pre><code>my %table = map{ $_-&gt;[1] =&gt; @$_ } split(/\\t/, &lt;DATA&gt;);\nmy %table = map{ split(/\\t/); $_-&gt;[1], @$_ } &lt;DATA&gt;;\n</code></pre>\n"}, {"tags": ["python", "perl", "replace", "combinations"], "comments": [{"owner": {"reputation": 123, "user_id": 9203347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c3354f54049f50894b5b5dfec245f?s=128&d=identicon&r=PG&f=1", "display_name": "Amol", "link": "https://stackoverflow.com/users/9203347/amol"}, "edited": false, "score": 0, "creation_date": 1537260263, "post_id": 52382444, "comment_id": 91709214, "body": "If single letter K present then it must have to replace A,J &amp; K on their own position. For example 27KBGCB5913L2ZF then Output should be as .. 27ABGCB5913L2ZF 27JBGCB5913L2ZF 27kBGCB5913L2ZF"}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537294530, "post_id": 52383460, "comment_id": 91729886, "body": "Forgive my prejudice, but <b><i>&quot;With a minor change, we can turn our function into a generator&quot;</i></b> (as well as the education about Cartesian products) smacks of someone fresh from college and desperate for points. There is no call for an iterator here: it will always be called to exhaustion and may as well be delivered as a simple list. Let&#39;s not turn acrobatic tricks to solve ordinary problems."}, {"owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 3, "creation_date": 1537297126, "post_id": 52383460, "comment_id": 91731094, "body": "@Borodin In Python 3, many functions that previously returned lists in early versions now return iterators. And for this task, I think an iterator is appropriate, since it doesn&#39;t take many key letters in the input string for the output to become quite large. FWIW, I&#39;m not desperate for points, and I left school decades ago. I was just trying to help the OP."}], "tags": [], "owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "is_accepted": true, "score": 3, "last_activity_date": 1537294333, "last_edit_date": 1537294333, "creation_date": 1537263270, "answer_id": 52383460, "question_id": 52382444, "link": "https://stackoverflow.com/questions/52382444/replace-combinations-of-characters/52383460#52383460", "title": "Replace combinations of characters", "body": "\n\n<p>The collection of combinations that you want of your key letters <code>A</code>, <code>J</code>, and <code>K</code> is called the\n<a href=\"https://en.wikipedia.org/wiki/Cartesian_product\" rel=\"nofollow noreferrer\"><em>Cartesian product</em></a>.\nIn Python, you can use\n<a href=\"https://docs.python.org/3/library/itertools.html#itertools.product\" rel=\"nofollow noreferrer\"><code>itertools.product</code></a> to generate them.</p>\n\n<p>Firstly, we need to find the positions of all of the key letters in the input string. The easy way to do that uses the built-in\n<a href=\"https://docs.python.org/3/library/functions.html#enumerate\" rel=\"nofollow noreferrer\"><code>enumerate</code></a>\nfunction. Once I know those positions, and how many key letters the string contains, we can generate each item of the Cartesian product, replace the key letters, and print the new string.</p>\n\n<p>In Python, strings are immutable (they can't be changed), so I convert the string to a list of characters, replace the characters in the key positions, and then build a new string from the list using the\n<a href=\"https://docs.python.org/3/library/stdtypes.html#str.join\" rel=\"nofollow noreferrer\"><code>str.join</code></a>\nmethod.</p>\n\n<p>The following code will work with both versions 2 and 3 of Python</p>\n\n<h3>Python</h3>\n\n<pre class=\"lang-python prettyprint-override\"><code>from itertools import product\n\ndef make_patterns(s):\n\n    keyletters = 'AJK'\n\n    # Convert input string into a list so we can easily substitute letters\n    seq = list(s)\n\n    # Find indices of key letters in seq\n    indices = [ i for i, c in enumerate(seq) if c in keyletters ]\n\n    # Generate key letter combinations &amp; place them into the list\n    for t in product(keyletters, repeat=len(indices)):\n        for i, c in zip(indices, t):\n            seq[i] = c\n        print(''.join(seq))\n\n# Test\n\ndata = (\n    '1ABC2',\n    '27AAGCB5913L2ZF',\n    '3A4J',\n    '5K67KA',\n)\n\nfor s in data:\n    print('\\nInput:', s)\n    make_patterns(s)\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Input: 1ABC2\n1ABC2\n1JBC2\n1KBC2\n\nInput: 27AAGCB5913L2ZF\n27AAGCB5913L2ZF\n27AJGCB5913L2ZF\n27AKGCB5913L2ZF\n27JAGCB5913L2ZF\n27JJGCB5913L2ZF\n27JKGCB5913L2ZF\n27KAGCB5913L2ZF\n27KJGCB5913L2ZF\n27KKGCB5913L2ZF\n\nInput: 3A4J\n3A4A\n3A4J\n3A4K\n3J4A\n3J4J\n3J4K\n3K4A\n3K4J\n3K4K\n\nInput: 5K67KA\n5A67AA\n5A67AJ\n5A67AK\n5A67JA\n5A67JJ\n5A67JK\n5A67KA\n5A67KJ\n5A67KK\n5J67AA\n5J67AJ\n5J67AK\n5J67JA\n5J67JJ\n5J67JK\n5J67KA\n5J67KJ\n5J67KK\n5K67AA\n5K67AJ\n5K67AK\n5K67JA\n5K67JJ\n5K67JK\n5K67KA\n5K67KJ\n5K67KK\n</code></pre>\n\n<hr>\n\n<p>With a minor change, we can turn our function into a generator. That lets you loop over the output strings easily, or turn them into a list if you want.</p>\n\n<h3>Python</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>from itertools import product\n\ndef make_patterns(s):\n\n    keyletters = 'AJK'\n\n    # Convert input string into a list so we can easily substitute letters\n    seq = list(s)\n\n    # Find indices of key letters in seq\n    indices = [i for i, c in enumerate(seq) if c in keyletters]\n\n    # Generate key letter combinations &amp; place them into the list\n    for t in product(keyletters, repeat=len(indices)):\n        for i, c in zip(indices, t):\n            seq[i] = c\n        yield ''.join(seq)\n\n# Test\n\nprint(list(make_patterns('A12K')))\n\nfor s in make_patterns('3KJ4'):\n    print(s)\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>['A12A', 'A12J', 'A12K', 'J12A', 'J12J', 'J12K', 'K12A', 'K12J', 'K12K']\n3AA4\n3AJ4\n3AK4\n3JA4\n3JJ4\n3JK4\n3KA4\n3KJ4\n3KK4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 3, "last_activity_date": 1537268515, "last_edit_date": 1537268515, "creation_date": 1537265555, "answer_id": 52384216, "question_id": 52382444, "link": "https://stackoverflow.com/questions/52382444/replace-combinations-of-characters/52384216#52384216", "title": "Replace combinations of characters", "body": "\n\n<p>This can be done in Perl by using the <code>glob</code> operator. <code>glob</code> is intended for finding matching files, but if no generic wildcard characters (<code>*</code>, <code>?</code> or <code>[...]</code>) are included in the pattern then it will simply return all possible matches, whether they exist as files or not</p>\n\n<p>This Perl code uses a substitution to form a glob pattern by replacing all occurrences of <code>A</code>, <code>J</code>, or <code>K</code> with the multiple pattern <code>{A,J,K}</code>. Submitting the result to <code>glob</code> gives us the required output</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\nuse feature 'say';\n\nfor my $s ( qw/ 27AAGCB5913L2ZF 27KBGCB5913L2ZF / ) {\n\n    (my $patt = $s) =~ s/[AJK]/{A,J,K}/g;\n\n    say for glob $patt;\n    say \"\";\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>27AAGCB5913L2ZF\n27AJGCB5913L2ZF\n27AKGCB5913L2ZF\n27JAGCB5913L2ZF\n27JJGCB5913L2ZF\n27JKGCB5913L2ZF\n27KAGCB5913L2ZF\n27KJGCB5913L2ZF\n27KKGCB5913L2ZF\n\n27ABGCB5913L2ZF\n27JBGCB5913L2ZF\n27KBGCB5913L2ZF\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 0, "last_activity_date": 1537278642, "last_edit_date": 1537278642, "creation_date": 1537267506, "answer_id": 52384810, "question_id": 52382444, "link": "https://stackoverflow.com/questions/52382444/replace-combinations-of-characters/52384810#52384810", "title": "Replace combinations of characters", "body": "<p>Here is a recursive solution in Perl:</p>\n\n<pre><code>my $str = '27AAGCB5913L2ZF';\nmy @replace = qw (A J K);\nprint_string( $str);\n\nsub print_string {\n    my ( $str, $replace, $start) = @_;\n\n    if (defined $replace) {\n        substr( $str, $start, 1) = $replace;\n    }\n    else {\n        $start = -1;\n    }\n    pos( $str) = $start +1;\n    if ($str =~ /\\G.*?(A|J|K)/g) {\n        my $cur_start = $-[-1];\n        print_string( $str, $_, $cur_start) for @replace;\n    }\n    else {\n        say $str;\n    }\n}\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>27AAGCB5913L2ZF\n27AJGCB5913L2ZF\n27AKGCB5913L2ZF\n27JAGCB5913L2ZF\n27JJGCB5913L2ZF\n27JKGCB5913L2ZF\n27KAGCB5913L2ZF\n27KJGCB5913L2ZF\n27KKGCB5913L2ZF\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13367, "user_id": 2084384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h5lY8.jpg?s=128&g=1", "display_name": "BoarGules", "link": "https://stackoverflow.com/users/2084384/boargules"}, "is_accepted": false, "score": 0, "last_activity_date": 1537267868, "creation_date": 1537267868, "answer_id": 52384917, "question_id": 52382444, "link": "https://stackoverflow.com/questions/52382444/replace-combinations-of-characters/52384917#52384917", "title": "Replace combinations of characters", "body": "<p>A short solution:</p>\n\n<p>Start by splitting the string into tuples of characters that may appear at each position</p>\n\n<pre><code>&gt;&gt;&gt; s = \"27AAGCB5913L2ZF\"\n&gt;&gt;&gt; p2 = [(\"A\",\"J\",\"K\") if c in \"AJK\" else (c,) for c in s]\n&gt;&gt;&gt; p2\n[('2',), ('7',), ('A', 'J', 'K'), ('A', 'J', 'K'), ('G',), ('C',), ('B',), ('5',), ('9',), ('1',), ('3',), ('L',), ('2',), ('Z',), ('F',)]\n</code></pre>\n\n<p>Then this function will assemble the list of tuples back into a string:</p>\n\n<pre><code>def assemble(t, s=''):\n    if t:\n        for c in t[0]:\n            assemble(t[1:], s+c)\n    else:\n        print(s)\n\n&gt;&gt;&gt; assemble(p2)\n27AAGCB5913L2ZF\n27AJGCB5913L2ZF\n27AKGCB5913L2ZF\n27JAGCB5913L2ZF\n27JJGCB5913L2ZF\n27JKGCB5913L2ZF\n27KAGCB5913L2ZF\n27KJGCB5913L2ZF\n27KKGCB5913L2ZF\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 9203347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/770c3354f54049f50894b5b5dfec245f?s=128&d=identicon&r=PG&f=1", "display_name": "Amol", "link": "https://stackoverflow.com/users/9203347/amol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1562, "favorite_count": 0, "accepted_answer_id": 52383460, "answer_count": 4, "score": 2, "last_activity_date": 1537294333, "creation_date": 1537260157, "last_edit_date": 1537266628, "question_id": 52382444, "link": "https://stackoverflow.com/questions/52382444/replace-combinations-of-characters", "title": "Replace combinations of characters", "body": "\n\n<p>I have a string <code>27AAGCB5913L2ZF</code>. If any of <code>A</code> or <code>J</code> or <code>K</code> appear in the string then it I need to change them to all possible combinations of the three letters. If I pass the above string input to the program then the output should be like this</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>27AAGCB5913L2ZF\n27AJGCB5913L2ZF\n27AKGCB5913L2ZF\n27JAGCB5913L2ZF\n27KAGCB5913L2ZF\n27KJGCB5913L2ZF\n27JKGCB5913L2ZF\n27JJGCB5913L2ZF\n27KKGCB5913L2ZF\n</code></pre>\n\n<p>The letters may be present anywhere in string. If just a single letter is present then it must be replaced by <code>A</code>, <code>J</code> and <code>K</code> in turn. For example the output for the string <code>27ABGCB5913L2ZF</code> should be as follows</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>27ABGCB5913L2ZF\n27JBGCB5913L2ZF\n27kBGCB5913L2ZF\n</code></pre>\n\n<p>I can search for a given character with code like this</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>while ( $string =~ /(B)/g ) {\n    say $1, ' at ', pos $string;\n}\n</code></pre>\n\n<p>How can I produce all possible strings if there could be any number of <code>A</code>, <code>J</code>, or <code>K</code> in any positions?</p>\n"}, {"tags": ["perl", "syntax-highlighting", "nicedit"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1537293012, "post_id": 52379409, "comment_id": 91729201, "body": "knb is saying your question might be more appropriate for <a href=\"https://softwarerecs.stackexchange.com/\">softwarerecs.stackexchange.com</a>, though I don&#39;t agree. You are asking for help editing <code>ne</code>&#39;s syntax definition file (which is on topic), not looking for an editor recommendation (which isn&#39;t). Now, I don&#39;t know <code>ne</code>, but it seems to me that you should show what you&#39;ve attempted so far, or at least the relevant part of the existing file."}, {"owner": {"reputation": 1818, "user_id": 4021251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808129eeb69813286f32266f535b2a34?s=128&d=identicon&r=PG&f=1", "display_name": "nega", "link": "https://stackoverflow.com/users/4021251/nega"}, "edited": false, "score": 1, "creation_date": 1537295164, "post_id": 52379409, "comment_id": 91730201, "body": "<code>ne</code> uses syntax highlighting from <a href=\"https://joe-editor.sourceforge.io/\" rel=\"nofollow noreferrer\"><code>joe</code></a>. Searching based on that should give you some leads."}, {"owner": {"reputation": 63, "user_id": 2604248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a59ce1b87e08f5fd744efc3c74fb7a?s=128&d=identicon&r=PG", "display_name": "Peyo61", "link": "https://stackoverflow.com/users/2604248/peyo61"}, "reply_to_user": {"reputation": 1818, "user_id": 4021251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808129eeb69813286f32266f535b2a34?s=128&d=identicon&r=PG&f=1", "display_name": "nega", "link": "https://stackoverflow.com/users/4021251/nega"}, "edited": false, "score": 0, "creation_date": 1537366097, "post_id": 52379409, "comment_id": 91759298, "body": "@nega: indeed I rapidly came to looking at Joe&#39;s help pages and user comments. Before coming here to ask for help !"}, {"owner": {"reputation": 63, "user_id": 2604248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a59ce1b87e08f5fd744efc3c74fb7a?s=128&d=identicon&r=PG", "display_name": "Peyo61", "link": "https://stackoverflow.com/users/2604248/peyo61"}, "edited": false, "score": 0, "creation_date": 1537366850, "post_id": 52379409, "comment_id": 91759810, "body": "@knb I edited the question to ask more details (including the file itself, to show the extent of the mess)."}, {"owner": {"reputation": 1818, "user_id": 4021251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/808129eeb69813286f32266f535b2a34?s=128&d=identicon&r=PG&f=1", "display_name": "nega", "link": "https://stackoverflow.com/users/4021251/nega"}, "edited": false, "score": 0, "creation_date": 1537370622, "post_id": 52379409, "comment_id": 91762237, "body": "<a href=\"https://joe-editor.sourceforge.io/4.6/man.html#how-joe-syntax-highlighting-works\" rel=\"nofollow noreferrer\"><code>joe</code>&#39;s manual</a> isn&#39;t great on the subject. Have you looked at <code>joe</code>&#39;s <a href=\"http://joe-editor.hg.sourceforge.net/hgweb/joe-editor/joe-editor/file/tip/syntax/c.jsf.in\" rel=\"nofollow noreferrer\"><i>c.jsf</i></a>. It seems to have a fairly complete description. Look especially at lines 181-188."}], "owner": {"reputation": 63, "user_id": 2604248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a59ce1b87e08f5fd744efc3c74fb7a?s=128&d=identicon&r=PG", "display_name": "Peyo61", "link": "https://stackoverflow.com/users/2604248/peyo61"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537366654, "creation_date": 1537247940, "last_edit_date": 1537366654, "question_id": 52379409, "link": "https://stackoverflow.com/questions/52379409/ne-nice-editor-syntax-highlighting-perl-variables-not-highlighted", "title": "ne nice editor syntax highlighting - Perl variables not highlighted", "body": "<p>I sometimes need to use the <strong>ne</strong> nice editor on a terminal to modify Perl files.</p>\n\n<p>I can't find a way to get Perl variables (you know, anything starting with <strong>$</strong>, <strong>@</strong> or <strong>%</strong>) to highlight at all.</p>\n\n<p>The syntax definition file is extremely complex and hacking it with my extremely limited understanding of the file syntax gets me nowhere.</p>\n\n<p>Also: I would like to use more colors than the <strong>red/blue/yellow/green/cyan/magenta/white/black</strong>, but did not find a way either to use RGB syntax for that. </p>\n\n<p>NB: my terminal emulator allows for 256 colors.</p>\n\n<p>Any pointers appreciated.</p>\n\n<p>I am pasting below the Perl syntax def file content: I tried to play with various RGB syntaxes (blind, since I'm unable to find a definite spec, or if it is at all possible): #rrggbb, @rrggbb, %rrggbb, etc. That's for the colors part.</p>\n\n<p>As for detecting variables: the file clearly spells out a color for variables (\"=Var magenta\"). This works for other languages, I could successfully play with variable colors and get variables highlighted.</p>\n\n<p>But on Perl files, zero variable detection takes place, no matter which color is used. There should be a way to enforce that variables start with $/@/%, but I don't even know where to start to specify this...</p>\n\n<p>Def file for Perl below the line. Which is horribly convoluted compared to other languages syntax files, and I guess that's my problem: too complex to hack.</p>\n\n<hr>\n\n<pre><code># JOE syntax highlight file for Perl\n\n# Define colors\n\n=Idle\n=Preproc blue\n=Comment dim yellow\n=POD green\n=Constant green\n=String green\n=Escape bold green\n=Type bold\n=Keyword bold blue\n=Bad bold red\n=Var magenta\n\n\n:begin Idle\n        *               begin noeat call=.perl()\n\n#\n# Perl as a subroutine for Mason\n#\n\n.subr perl\n\n# Detect pod\n\n:idle Idle\n        *               idle1           noeat\n.ifdef mason_line\n        \"\\n\"            idle return\n.else\n        \"\\n\"            idle\n.endif\n        \"=\"             pod_start\n\n# allow keywords\n\n:idle1 Idle\n        *               idle1\n        \"#\"             line_comment_i  recolor=-1\n        \"\\n\"            idle noeat\n        \"0\"             first_digit     recolor=-1\n        \"1-9\"           decimal recolor=-1\n        \".\"             maybe_float\n        \"\\\"\"            string          recolor=-1\n        \"'\"             char            recolor=-1\n        \"`\"             backtick        recolor=-1\n        \"&lt;\"             maybe_inc\n        \"$\"             not_string      buffer\n.ifdef mason_block\n        \"&amp;%\"            perl_maybe_done buffer\n        \"-a-zA-Z_@\"     ident           buffer\n.else\n        \"/\"             regex           recolor=-1\n        \"-a-zA-Z_@%&amp;\"   ident           buffer\n.endif\n\n:perl_maybe_done Idle\n        *               ident noeat\n        \"&gt;\"             idle1   recolor=-2 return\n\n# prevent keywords\n\n:rest Idle\n        *               rest\n        \"({;~\"          idle1\n        \"#\"             line_comment    recolor=-1\n        \"\\n\"            idle noeat\n        \"0\"             first_digit     recolor=-1\n        \"1-9\"           decimal recolor=-1\n        \".\"             maybe_float\n        \"\\\"\"            string          recolor=-1\n        \"'\"             char            recolor=-1\n        \"`\"             backtick        recolor=-1\n        \"$\"             not_string      buffer\n        \"&lt;\"             maybe_inc\n.ifdef mason_block\n        \"&amp;%\"            perl_maybe_done buffer\n        \"a-zA-Z_@\"      maybe_string    buffer\n.else\n        \"a-zA-Z_@%&amp;\"    maybe_string    buffer\n.endif\n\n:pod_start Idle\n        *               pod_start\n        \"\\n\"            pod_block\n\n:pod_block POD\n        *               pod_block\n        \"=\"             pod_ident       buffer\n\n:pod_ident POD\n        *               pod_block       noeat strings\n        \"=cut\"          rest\ndone\n        \"a-zA-Z0-9_\"    pod_ident\n\n:maybe_inc Idle\n        *               rest            noeat\n.ifdef mason_block\n        \"/\"             perl_maybe_done_2\n.endif\n        \"&lt;\"             maybe_inc1\n\n:perl_maybe_done_2 Idle\n        *               perl_idle       noeat\n        \"a-z\"           perl_maybe_done_2\n        \"&gt;\"             idle\n\n\n:maybe_inc1 Idle\n        *               rest            noeat\n        \"       \"       maybe_inc1\n        \"'\\\"\"           quoted_inc_start        save_c recolor=-1\n        \"A-Za-z_\"       inc             buffer noeat\n\n:quoted_inc_start Var\n        *               quoted_inc      buffer\n\n:quoted_inc Var\n        *               quoted_inc\n        &amp;               skipline        save_s\n\n:inc Var\n        *               skipline        save_s noeat\n        \"A-Za-z0-9_\"    inc\n\n# Should be treated as a normal line here...\n\n:skipline Idle\n        *               skipline\n        \"\\n\"            next_line\n\n:todelim Constant\n        *               todelim\n        \"\\n\"            next_line       strings\n        \"&amp;\"             founddelim\ndone\n\n# eat \\n so it's not in string.\n:next_line Constant\n        *               todelim         buffer\n        \"\\n\"            next_line\n\n:founddelim Var\n        *               idle            noeat\n\n:regex Constant\n        *               regex\n        \"\\\\\"            regex_quote     recolor=-1\n        \"/\"             rest\n\n:regex_quote Escape\n        *               regex\n\n:not_string Idle\n        *               rest noeat\n        \"A-Za-z_\"       ident\n        \"\\\"'`#\"         rest\n\n:line_comment Comment\n        *               line_comment\n        \"\\n\"            rest\n\n:line_comment_i Comment\n        *               line_comment_i\n        \"\\n\"            idle noeat\n\n:end_of_file_comment Comment\n        *               end_of_file_comment\n\n:first_digit Constant\n        *               rest    noeat\n        \"x\"             hex\n        \"b\"             binary\n        \"b\"             binary\n        \".\"             float\n        \"eE\"            epart\n        \"0-7\"           octal\n        \"89\"            bad_number      recolor=-1\n\n:bad_number Bad\n        *               rest    noeat\n        \"0-9\"           bad_number\n\n:octal Constant\n        *               rest    noeat\n        \"0-7_\"          octal\n        \"89\"            bad_number      recolor=-1\n\n:binary Constant\n        *               rest    noeat\n        \"01_\"           binary\n        \"2-9\"           bad_number      recolor=-1\n\n:hex Constant\n        *               rest    noeat\n        \"0-9A-Fa-f_\"    hex\n\n:decimal Constant\n        *               rest    noeat\n        \"0-9_\"          decimal\n        \"eE\"            epart\n        \".\"             float\n\n:maybe_float Constant\n        *               rest    recolor=-2      noeat\n        \"0-9\"           float           recolor=-2\n\n:float Constant\n        *               rest    noeat\n        \"eE\"            epart\n        \"0-9_\"          float\n\n:epart Constant\n        *               rest    noeat\n        \"0-9+\\-\"        enum\n\n:enum Constant\n        *               rest    noeat\n        \"0-9_\"          enum\n\n:string Constant\n        *               string\n        \"\\\"\"            rest\n        \"\\\\\"            string_escape   recolor=-1\n        \"$@\"            string_subst    recolor=-1\n\n:string_subst Escape\n        *               string  noeat recolor=-1\n        \"a-zA-Z_0-9\"    string_subst\n\n:string_escape Escape\n        *               string\n        \"x\"             string_hex1\n        \"c\"             string_ctrl\n        \"N\"             string_named\n        \"0-7\"           string_octal2\n        \"\\n\"            string          recolor=-2\n\n:string_named Escape\n        *               string\n        \"{\"             string_named_rest\n\n:string_named_rest Escape\n        *               string_named_rest\n        \"}\"             string\n\n:string_ctrl Escape\n        *               string\n\n:string_hex1 Escape\n        *               string          noeat\n        \"{\"             string_unicode\n        \"0-9a-fA-F\"     string_hex2\n\n:string_unicode Escape\n        *               string_unicode\n        \"}\"             string\n\n:string_hex2 Escape\n        *               string          noeat\n        \"0-9a-fA-F\"     string\n\n:string_octal2 Escape\n        *               string          noeat\n        \"0-7\"           string_octal3\n\n:string_octal3 Escape\n        *               string          noeat\n        \"0-7\"           string\n\n:char Constant\n        *               char\n#       \"\\n\"            idle noeat\n        \"'\"             rest\n        \"\\\\\"            char_escape     recolor=-1\n\n:char_escape    Escape\n        *               char            recolor=-2\n        \"\\\\'\"   char\n\n:backtick       Constant\n        *               backtick\n        \"`\"             rest\n        \"\\\\\"            backtick_escape recolor=-1\n        \"$@\"            backtick_subst recolor=-1\n\n:backtick_subst Escape\n        *               backtick        noeat recolor=-1\n        \"a-zA-Z_0-9\"    backtick_subst\n\n:backtick_escape Escape\n        *               backtick\n        \"x\"             backtick_hex1\n        \"c\"             backtick_ctrl\n        \"N\"             backtick_named\n        \"0-7\"           backtick_octal2\n        \"\\n\"            backtick                recolor=-2\n\n:backtick_named Escape\n        *               backtick\n        \"{\"             backtick_named_rest\n\n:backtick_named_rest Escape\n        *               backtick_named_rest\n        \"}\"             backtick\n\n\n:backtick_ctrl Escape\n        *               backtick\n\n:backtick_hex1 Escape\n        *               backtick                noeat\n        \"{\"             backtick_unicode\n        \"0-9a-fA-F\"     backtick_hex2\n\n:backtick_unicode Escape\n        *               backtick_unicode\n        \"}\"             backtick\n\n:backtick_hex2 Escape\n        *               backtick                noeat\n        \"0-9a-fA-F\"     backtick\n\n:backtick_octal2 Escape\n        *               backtick                noeat\n        \"0-7\"           backtick_octal3\n\n:backtick_octal3 Escape\n        *               backtick                noeat\n        \"0-7\"           backtick\n\n:ident  Idle\n        *               rest            noeat strings\n        \"BEGIN\"         kw\n        \"END\"           kw\n        \"if\"            kw\n        \"unless\"        kw\n        \"while\"         kw\n        \"until\"         kw\n        \"foreach\"       kw\n        \"sub\"           kw\n        \"my\"            kw\n        \"our\"           kw\n        \"do\"            kw\n        \"if\"            kw\n        \"else\"          kw\n        \"elsif\"         kw\n        \"for\"           kw\n        \"continue\"      kw\n        \"last\"          kw\n        \"print\"         kw\n        \"reset\"         kw\n        \"die\"           kw\n        \"goto\"          kw\n        \"require\"       kw\n        \"use\"           kw\n        \"eval\"          kw\n        \"redo\"          kw\n        \"next\"          kw\n        \"warn\"          kw\n        \"return\"        kw\n        \"printf\"        kw\n        \"close\"         kw\n        \"package\"       kw\n        \"m\"             match\n        \"qr\"            match\n        \"qq\"            match\n        \"qx\"            match\n        \"qw\"            match\n        \"q\"             match\n        \"s\"             subst\n        \"tr\"            subst\n        \"y\"             subst\n        \"__END__\"       end_of_file_comment\n        \"__DATA__\"      end_of_file_comment\ndone\n        \"a-zA-Z0-9_\"    ident\n\n:maybe_string Idle\n        *               rest            noeat strings\n        \"qr\"            match\n        \"qq\"            match\n        \"qx\"            match\n        \"qw\"            match\n        \"q\"             match\ndone\n        \"a-zA-Z0-9_\"    maybe_string\n\n:type Type\n        *       rest    noeat\n\n:kw Keyword\n        *       rest    noeat\n\n:match Idle\n        *               inmatch         save_c recolor=-1\n        \"       \"       match\n\n:inmatch Constant\n        *               inmatch\n        &amp;               rest\n        \"\\\\\"            inmatch_quote   recolor=-1\n\n:inmatch_quote Escape\n        *               inmatch\n\n:subst Idle\n        *               insubst         save_c recolor=-1\n        \"&lt;([{`\"         delim_insubst   save_c recolor=-1\n        \"       \"       subst\n\n:insubst Constant\n        *               insubst\n        &amp;               inrepl\n        \"\\\\\"            insubst_quote   recolor=-1\n\n:insubst_quote Escape\n        *               insubst\n\n:inrepl Constant\n        *               inrepl\n        &amp;               rest\n        \"\\\\\"            inrepl_quote\n\n:inrepl_quote Escape\n        *               inrepl\n\n:delim_insubst Constant\n        *               delim_insubst\n        &amp;               delim_repl\n        \"\\\\\"            delim_quote\n\n:delim_quote Escape\n        *               delim_insubst\n\n:delim_repl Constant\n        *               repl            save_c recolor=-1\n        \"       \"       delim_repl\n\n L:      441 C:        1  97%  i-----pvurT------@A perl.jsf                                                                            \n        *               inmatch\n\n:subst Idle\n        *               insubst         save_c recolor=-1\n        \"&lt;([{`\"         delim_insubst   save_c recolor=-1\n        \"       \"       subst\n\n:insubst Constant\n        *               insubst\n        &amp;               inrepl\n        \"\\\\\"            insubst_quote   recolor=-1\n\n:insubst_quote Escape\n        *               insubst\n\n:inrepl Constant\n        *               inrepl\n        &amp;               rest\n        \"\\\\\"            inrepl_quote\n\n:inrepl_quote Escape\n        *               inrepl\n\n:delim_insubst Constant\n        *               delim_insubst\n        &amp;               delim_repl\n        \"\\\\\"            delim_quote\n\n:delim_quote Escape\n        *               delim_insubst\n\n:delim_repl Constant\n        *               repl            save_c recolor=-1\n        \"       \"       delim_repl\n\n:repl Constant\n        *               repl\n        &amp;               rest\n        \"\\\\\"            repl_quote\n\n:repl_quote Escape\n        *               repl\n\n.end\n</code></pre>\n"}, {"tags": ["perl", "mojolicious"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1537211717, "post_id": 52374255, "comment_id": 91693439, "body": "Your Mojolicious is too old. <code>insecure</code> <a href=\"https://metacpan.org/changes/release/SRI/Mojolicious-8.0#L135-141\" rel=\"nofollow noreferrer\">was only added in version 7.80</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1537214522, "post_id": 52374255, "comment_id": 91694585, "body": "At this point I&#39;d like to give kudos to Perl modules for having actual usable change logs. This isn&#39;t the first time I&#39;ve identified a problem just by reading through a list of changes in each version of some module."}, {"owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537218525, "post_id": 52374255, "comment_id": 91696271, "body": "@melpomene how is it possible that an older version apparently installed itself (without me doing anything) over a newer version? <code>insecure</code> worked this afternoon. Also, according to my package manager, Mojolicious 6.64 is the newest version available... This is very odd..."}, {"owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537218909, "post_id": 52374255, "comment_id": 91696418, "body": "Wait, now I&#39;m no longer sure <code>insecure</code> <i>ever</i> worked on my local machine."}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537214928, "post_id": 52374855, "comment_id": 91694753, "body": "It&#39;s probably best just to <code>use Mojo::UserAgent 7.80</code> rather than have it fail silently."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537215006, "post_id": 52374855, "comment_id": 91694793, "body": "@Borodin In this case it would succeed silently. Older versions were insecure by default; <code>$ua-&gt;insecure(1)</code> is the backwards compatibility hack in newer versions."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1537214276, "creation_date": 1537214276, "answer_id": 52374855, "question_id": 52374255, "link": "https://stackoverflow.com/questions/52374255/mojolicious-suddenly-stopped-working-from-one-minute-to-the-next/52374855#52374855", "title": "Mojolicious suddenly stopped working from one minute to the next", "body": "<p>From <a href=\"https://metacpan.org/changes/release/SRI/Mojolicious-8.0#L135-141\" rel=\"noreferrer\">the Mojolicious change log</a>:</p>\n\n<blockquote>\n  <p>7.80&nbsp;&nbsp;2018-05-20</p>\n  \n  <ul>\n  <li><p>Many users expected that Mojo::UserAgent would verify all TLS certificates\n  by default. Unfortunately that has not been the case so far, but will change\n  with this release in an effort to strengthen security. By default\n  Mojo::UserAgent will now reject all invalid TLS certificates. To return to\n  the previous behavior you can use the new <code>insecure</code> attribute.</p>\n\n<pre><code>$ua-&gt;insecure(1);\n</code></pre></li>\n  </ul>\n</blockquote>\n\n<p><code>insecure</code> is new in 7.80. Your Mojolicious 6.64 is too old.</p>\n\n<p>You said</p>\n\n<blockquote>\n  <p>I reinstalled Mojolicious a few times, but each time I got this error when I ran the script.</p>\n</blockquote>\n\n<p>Either you didn't install the latest version or your script somehow still picked up the old version (a directory search order problem?).</p>\n\n<p>If you want to keep your code compatible (and insecure) between both old and new versions,</p>\n\n<pre><code>$ua-&gt;insecure(1) if $ua-&gt;can('insecure');\n</code></pre>\n\n<p>should work.</p>\n"}], "owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537214276, "creation_date": 1537211103, "last_edit_date": 1537213171, "question_id": 52374255, "link": "https://stackoverflow.com/questions/52374255/mojolicious-suddenly-stopped-working-from-one-minute-to-the-next", "title": "Mojolicious suddenly stopped working from one minute to the next", "body": "<p>A few days ago, I installed the Mojolicious package on my local machine because I needed to implement a websocket in one of my Perl programs on my production server. It installed without a problem and I was able to run a simple test script:</p>\n\n\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\n\nuse Mojo::UserAgent;\nuse Mojo::IOLoop;\n\n# Open WebSocket\nmy $ua = Mojo::UserAgent-&gt;new;\n\n$ua-&gt;insecure(1); # Otherwise the handshake will fail\n\n$ua-&gt;websocket('wss://some.server.com' =&gt; sub {\n  my ($ua, $tx) = @_;\n\n  # Check if WebSocket handshake was successful\n  unless( $tx-&gt;is_websocket ) {\n    print \"Handshake failed!\\n\";\n    return;\n  }\n\n  # Wait for WebSocket to be closed\n  $tx-&gt;on(finish =&gt; sub {\n    my ($tx, $code, $reason) = @_;\n    print \"WebSocket closed with status $code.\\n\";\n  });\n\n  # Close WebSocket after receiving one message\n  $tx-&gt;on(message =&gt; sub {\n    my ($tx, $msg) = @_;\n    print \"WebSocket message: $msg\\n\";\n    $tx-&gt;finish;\n  });\n\n  # Send a message to the server\n  print \"Sending...\\n\";\n  $tx-&gt;send(\"Hi there!\");\n\n});\n\n# Start event loop if necessary\nMojo::IOLoop-&gt;start unless Mojo::IOLoop-&gt;is_running;\n\nprint \"Done!\\n\";\n</code></pre>\n\n<p>I was testing this on a server which had a small problem with its certificate which is the reason I added this line:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>$ua-&gt;insecure(1); # Otherwise the handshake will fail\n</code></pre>\n\n<p>When I finally got it working by adding this line, I installed Mojolicious on my production server, copied over the above perl script, and it ran perfectly fine there also.</p>\n\n<p>I then went back to my script on my local machine and ran it again. Much to my surprise, I now got an error message saying:</p>\n\n<blockquote>\n  <p>Can't locate object method \"insecure\" via package \"Mojo::UserAgent\" at test009.pl line 14,  line 2231.</p>\n</blockquote>\n\n<p>I reinstalled Mojolicious a few times, but each time I got this error when I ran the script. Removing the line just causes the script to do nothing at all. It doesn't print the \"Handshake failed\" message, nor any other message. Not even the \"Done!\" message.</p>\n\n<p>It looks like it simply stops right after <code>websocket()</code> is called...</p>\n\n<p>I'm at a loss now. I have absolutely no clue why it isn't working anymore. Nothing changed to my Perl environment on my local machine...</p>\n\n<p>Here is some more info on my local machine</p>\n\n<ul>\n<li>Windows 7 Pro 64bit SP1</li>\n<li>ActivePerl 5.16.2</li>\n<li>Mojolicious 6.64</li>\n</ul>\n\n<p>Can anyone offer some tips as to what has happened? Or preferably, how to get it working again?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1537203019, "post_id": 52372412, "comment_id": 91689403, "body": "Unless it&#39;s documented it&#39;s anyone&#39;s guess. Since you&#39;ve given zero source code for context this question will likely be closed as off-topic. I don&#39;t know why you&#39;re worried about vulnerabilities. Use the latest version of Perl. If that doesn&#39;t work, find someone who can fix the code. Perl usually avoids making substantial breaking changes so backwards compatibility with older versions is often great."}, {"owner": {"reputation": 21, "user_id": 9104202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d47ab4ace82678b92c8c0fa02ad012?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/9104202/lac"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1537203534, "post_id": 52372412, "comment_id": 91689643, "body": "The code is restricted, so I cannot publish it. I am worried about vulnerabilities because I am responsible for software assurance. I need to know the version because most CVEs apply to certain versions."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1537203644, "post_id": 52372412, "comment_id": 91689694, "body": "If this is of critical importance to you, sounds like you need to hire a security expert to review the code and make recommendations. Out-sourcing this to Stack Overflow is not the best way to do it. Perl itself is far less likely to be a liability than the code written for it, <i>especially</i> if you&#39;ve lost contact with the original developer(s)."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1537203741, "post_id": 52372412, "comment_id": 91689743, "body": "There&#39;s no &quot;version&quot; for Perl code. Most require versions of <i>at least X</i> in order to make use of particular features, but you don&#39;t see code that requires <i>exactly version X</i>. Get the latest, 5.28.0, and try your code out. If it breaks find out why."}, {"owner": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 1, "creation_date": 1537203852, "post_id": 52372412, "comment_id": 91689792, "body": "&quot;Most perl-related vulnerabilities only apply to certain versions&quot;. No, most vulnerabilities/bugs/issues comes from the program itself in my experience, the way it&#39;s writted, and to a lesser extent from outdated Perl-versions. Given that, separating between major versions like 4, 5 and 6 don&#39;t require much knowledge about Perl, separating between say 5.22 and 5.24 require deeper knowledge. Unless the source code have plain giveaways like <code>use v5.22;</code> or <code>use v6;</code> somewhere. Most perl code out there are version 5. Look at <a href=\"https://perldoc.perl.org/index-history.html\" rel=\"nofollow noreferrer\">perldoc.perl.org/index-history.html</a> and the changes documents."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1537204299, "post_id": 52372412, "comment_id": 91690012, "body": "There&#39;s <a href=\"https://metacpan.org/pod/Perl::MinimumVersion\" rel=\"nofollow noreferrer\">Perl::MinimumVersion</a>"}, {"owner": {"reputation": 21, "user_id": 9104202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d47ab4ace82678b92c8c0fa02ad012?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/9104202/lac"}, "edited": false, "score": 0, "creation_date": 1537204421, "post_id": 52372412, "comment_id": 91690081, "body": "Kjetil....I&#39;m looking at CVEs to get a list of known vulnerabilities for perl. Most say something like, &quot;Heap-based buffer overflow in the Perl_repeatcpy function in util.c in Perl 5.12.x before 5.12.5...&quot; If I can identify the version of my perl code, then I can rule out vulnerabilities that do not apply to my version."}, {"owner": {"reputation": 21, "user_id": 9104202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d47ab4ace82678b92c8c0fa02ad012?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/9104202/lac"}, "edited": false, "score": 0, "creation_date": 1537204572, "post_id": 52372412, "comment_id": 91690141, "body": "ikegami....thank you, that will help."}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 2, "creation_date": 1537205145, "post_id": 52372412, "comment_id": 91690414, "body": "You need to determine which version(s) of perl are installed on your system(s)."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537205874, "post_id": 52372412, "comment_id": 91690772, "body": "<i>&quot;If I can identify the version of my perl code, then I can rule out vulnerabilities that do not apply to my version&quot;</i> It has already been said that Perl code doesn&#39;t have a &quot;version&quot;: it&#39;s not like Python where a program written for Python 2 is unlikely to run under Python 3. The safest approach is to run it using the most recent Perl available; it is extremely unlikely that there will be problems. I don&#39;t see any point in picking an arbitrary release of Perl before the current one, unless you really don&#39;t want to update your installed interpreter."}, {"owner": {"reputation": 21, "user_id": 9104202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d47ab4ace82678b92c8c0fa02ad012?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/9104202/lac"}, "edited": false, "score": 0, "creation_date": 1537207466, "post_id": 52372412, "comment_id": 91691540, "body": "All I have is the piece of code. I do not know anything about the OS, perl version, or any other (useful) information. This is not at all uncommon in software assurance. Yes, I wish I had all that information, but, alas, I do not. (I was assigned this code because I once used perl many, many years ago, which made me the perl SME on the team.) :-) Thank you all for the ideas and the education."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537207869, "post_id": 52372412, "comment_id": 91691738, "body": "@lac: Please be assured that the version of perl that the code was written for is <i>irrelevant</i> except insofar as it may need a feature that was introduced later on to run at all. Suppose you found that a program was &quot;written for&quot; perl v5.10 but was currently being executed by perl v5.24. Surely you can see that the value <code>v5.10</code> would be of no use to you whatsoever and is completely irrelevant?"}, {"owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "edited": false, "score": 0, "creation_date": 1537208843, "post_id": 52372412, "comment_id": 91692200, "body": "@lac Looking at the CVEs for old perl interpreters (without knowing which version) is like looking up CVEs of different C compilers to find vulnerabilities in a C program (without knowing which compiler is used). This is not <i>completely</i> pointless, but still <i>largely</i> so. In either case, these vulnerabilities are not in the source code which you are reviewing, but possibly in the deployed software system (which you have no information about)."}], "answers": [{"tags": [], "owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "is_accepted": false, "score": 5, "last_activity_date": 1537205640, "last_edit_date": 1537205640, "creation_date": 1537204749, "answer_id": 52372841, "question_id": 52372412, "link": "https://stackoverflow.com/questions/52372412/which-version-of-perl-was-a-perl-script-written-for/52372841#52372841", "title": "Which version of perl was a perl script written for?", "body": "<p>There can be some indications as to the minimum Perl version that a given script is targeting. For example:</p>\n\n<ul>\n<li><p>When an explicit version requirement is declared, e.g. <code>use v5.12</code>.</p></li>\n<li><p>When explicit features are used, e.g. <code>use feature 'say'</code>. See <code>perldoc feature</code> for the relationship between Perl versions and available features.</p></li>\n<li><p>When particular syntax is used. For example:</p>\n\n<ul>\n<li>the <code>//</code> defined-or operator makes it easy notice post-5.10 code.</li>\n<li><code>push</code> or <code>pop</code> with a scalar argument signify 5.14 to 5.24.</li>\n<li>Regex syntax also tends to have occasional changes, like <code>/d</code>, <code>/u</code>, <code>/a</code>, <code>/l</code> modifiers in 5.14 or <code>/n</code> in 5.22.<br>\n&nbsp;</li>\n</ul>\n\n<p>You will have to read the perldelta documents for the list of relevant changes.</p></li>\n</ul>\n\n<p>The Perl::MinimumVersion module can help with automating some of those checks.</p>\n\n<p>However, the presence or absence of such features has <em>nothing</em> to do with the vulnerabilities of the given program. Instead:</p>\n\n<ul>\n<li><p>Make sure that you are <em>running</em> the script with an up to date Perl interpreter. Do not keep running unsupported old versions.</p>\n\n<p>Except for rare edge cases, new Perl versions are extremely backwards compatible and should work without any issue.  But note that upgrading Perl involves reinstalling all modules (in particular, any XS modules <em>must</em> be recompiled).</p></li>\n<li><p>Make sure you are also looking at the dependencies of the script. Are they also up to date? Whether new versions are similarly compatible will depend on the specific module.</p></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 9104202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d47ab4ace82678b92c8c0fa02ad012?s=128&d=identicon&r=PG&f=1", "display_name": "lac", "link": "https://stackoverflow.com/users/9104202/lac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1537206417, "answer_count": 1, "score": -1, "last_activity_date": 1537205640, "creation_date": 1537202919, "question_id": 52372412, "link": "https://stackoverflow.com/questions/52372412/which-version-of-perl-was-a-perl-script-written-for", "closed_reason": "Not suitable for this site", "title": "Which version of perl was a perl script written for?", "body": "<p>I am checking an existing perl script for vulnerabilities. Most perl-related vulnerabilities only apply to certain versions. Is there a way to determine which version was used to write the perl script? (I cannot ask the developer.) Thank you!</p>\n"}, {"tags": ["perl", "hpc", "pbs"], "comments": [{"owner": {"reputation": 19868, "user_id": 786542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dOO4N.jpg?s=128&g=1", "display_name": "Tung", "link": "https://stackoverflow.com/users/786542/tung"}, "edited": false, "score": 0, "creation_date": 1537195824, "post_id": 52367708, "comment_id": 91685368, "body": "I don&#39;t think this is correct <code>$module load &quot;&#47;usr&#47;bin&#47;perl&quot;</code>"}, {"owner": {"reputation": 19868, "user_id": 786542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dOO4N.jpg?s=128&g=1", "display_name": "Tung", "link": "https://stackoverflow.com/users/786542/tung"}, "edited": false, "score": 1, "creation_date": 1537195863, "post_id": 52367708, "comment_id": 91685390, "body": "Can you see Perl if you do <code>perl --version</code>?"}, {"owner": {"reputation": 19868, "user_id": 786542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dOO4N.jpg?s=128&g=1", "display_name": "Tung", "link": "https://stackoverflow.com/users/786542/tung"}, "edited": false, "score": 0, "creation_date": 1537195937, "post_id": 52367708, "comment_id": 91685436, "body": "<a href=\"https://metacpan.org/pod/Parallel::MPI::Simple\" rel=\"nofollow noreferrer\">metacpan.org/pod/Parallel::MPI::Simple</a>"}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1537208935, "post_id": 52367708, "comment_id": 91692238, "body": "Let&#39;s learn to crawl before we try to run. Can you get a perl script that writes &quot;Hello world&quot; to standard output or to a file working? How about a script that writes &quot;Hello world&quot; and loads one or more of your desired modules? It&#39;s way too early to bother your admin."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1537214582, "post_id": 52367708, "comment_id": 91694611, "body": "I&#39;d suggest to first find detailed examples of how to use the local <code>qsub</code> (unless what you show follows one of those). Admins normally post them. Then go as mob says, step at a time.  Once you are sure it&#39;s all working check with your admin whether it&#39;s OK to run threads there; also, be very careful how you use them, lest you overload the system."}, {"owner": {"reputation": 582, "user_id": 1862330, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2c38f99284fc1d1f9b30bd359bec95e5?s=128&d=identicon&r=PG", "display_name": "BioDeveloper", "link": "https://stackoverflow.com/users/1862330/biodeveloper"}, "reply_to_user": {"reputation": 19868, "user_id": 786542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dOO4N.jpg?s=128&g=1", "display_name": "Tung", "link": "https://stackoverflow.com/users/786542/tung"}, "edited": false, "score": 0, "creation_date": 1537768933, "post_id": 52367708, "comment_id": 91888536, "body": "@Tung I requested admin to install higher perl version as module=perl5.16.3 with required perl modules installed. Now I simply need to &#39;load module perl5.16.3&#39; and then regular perl command &#39;perl code.pl&#39; The perl module Threads ran the code using multiple threads."}, {"owner": {"reputation": 582, "user_id": 1862330, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2c38f99284fc1d1f9b30bd359bec95e5?s=128&d=identicon&r=PG", "display_name": "BioDeveloper", "link": "https://stackoverflow.com/users/1862330/biodeveloper"}, "reply_to_user": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1537769338, "post_id": 52367708, "comment_id": 91888671, "body": "@mob The code runs fine but no file gets created in write mode that I tried inside perl code. &#39;open FOUT, &quot;&gt;file.txt&quot;;&#39; did not create any file. but the output can be printed to pbs output file or terminal. Why is that happening ?"}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1537812298, "post_id": 52367708, "comment_id": 91911429, "body": "What directory do you think the remote script is trying to create the <code>file.txt</code> file in? Try writing to <code>&#47;path&#47;visible&#47;on&#47;local&#47;machinefile.txt</code>"}], "owner": {"reputation": 582, "user_id": 1862330, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/2c38f99284fc1d1f9b30bd359bec95e5?s=128&d=identicon&r=PG", "display_name": "BioDeveloper", "link": "https://stackoverflow.com/users/1862330/biodeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537350580, "creation_date": 1537187085, "last_edit_date": 1537350580, "question_id": 52367708, "link": "https://stackoverflow.com/questions/52367708/how-to-run-a-perl-script-using-pbs-on-a-hpc-cluster", "title": "How to run a perl script using PBS on a HPC cluster?", "body": "<p>I am struggling with running perl script which needs several required modules (perl modules). The only way I can submit this job is through:</p>\n\n<pre><code>qsub my_code.pbs\n</code></pre>\n\n<p>Directly submitted shell commands are not allowed by root admin.<br>\nperl is present by default as version 5.10 but I may need perl 5.16 or above and have no root privileges. I know so far that PBS scripts expects any program to be loaded as a PBS module<br>\nThis is what I tried using mpirun  </p>\n\n<pre><code>#!/bin/csh\n#PBS -l walltime=10:00:00\n#PBS -N hello_world1\n#PBS -q workq\n#PBS -l select=4:ncpus=16:mpiprocs=16\n#PBS -l place=scatter:excl\n#PBS -V\n\nmodule load \"/usr/bin/perl\"\ncmd=\"perl t2.pl\"\nmpirun -np 2 $cmd\n# Go to the directory from which you submitted the job\necho PBS working directory is $PBS_O_WORKDIR\n# echo PBS default server is $PBS_DEFAULT\necho $PBS_NODEFILE  \n</code></pre>\n\n<p>I am not sure if I should directly include this    </p>\n\n<pre><code>perl t2.pl  \n</code></pre>\n\n<p>instead of mpirun.<br>\nperl is not listed in available modules. Even if I get it done by requesting the root admin, I am still unsure if the required <em>perl modules</em> shall work or not?  </p>\n\n<p>My perl code requires:  </p>\n\n<pre><code>use threads;\nuse threads::shared;\n\nuse List::Util qw( sum );\nuse YAML;\n</code></pre>\n\n<blockquote>\n  <p>Note:   Perl module is the cpan modules that I use and call inside perl code.<br>\n  PBS Module refers to software modules loaded via module script on HPC cluster.   </p>\n</blockquote>\n"}, {"tags": ["perl", "awk", "sed"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1537188344, "post_id": 52367262, "comment_id": 91680329, "body": "Looks like you are trying to parse a <a href=\"https://en.wikipedia.org/wiki/Domain-specific_language\" rel=\"nofollow noreferrer\">DSL</a>? I would recommend using <a href=\"https://docs.perl6.org/language/grammar_tutorial\" rel=\"nofollow noreferrer\">Perl 6 grammars</a> in that case."}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537191870, "post_id": 52367262, "comment_id": 91682703, "body": "Thanks @ H&#229;kon H&#230;gland I will surely try ."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 1, "creation_date": 1537191207, "post_id": 52368168, "comment_id": 91682262, "body": "Thanks a ton ,its working .I tried for 3rd pin say pin (z) ,please check the below command and let me know whether its correct?                                ----- sed &#39;1{x;s/^/;,/;x};/^cell (a)/I,/^}/{/pin (q)/I{x;s/;/&amp;q/;/;q\\{2\\},/{x;p;s/pin.*/class ;/;x};x};/pin (y)/I{x;s/;/&amp;y/;/;y\\{2\\},/{x;p;s/pin.*/board ;/;x};x};/pin (z)/I{x;s/,/&amp;z/;/,z\\{2\\}$/{x;p;s/pin.*/board2 ;/;x};x}}&#39; file ----. @potong"}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537193891, "post_id": 52368168, "comment_id": 91684091, "body": "@Anthonyj each pin needs its own area in the hold space i.e. a delimiter. For pin q I used <code>;</code> for pin y I used <code>,</code> so for pin z use say <code>:</code>. Then later on when you are counting look for <code>:</code> and append <code>z</code> after it. Hope this helps."}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537245559, "post_id": 52368168, "comment_id": 91702334, "body": "@ potong Thanks again it worked . I was trying to write for file which has additional cells i.e cell(b), cell (c) whose body is same as cell (a) . I listed all cell names in list file and then tried  -------                                                                                                   foreach c (<code>cat list</code>){ sed -i &#39;1{x;s/^/;,/;x};/\\s*cell (${c})/I,/^}/{/pin (q)/I{x;s/;/&amp;q/;/;q\\{2\\},/{x;p;s/pin.*/class ;/;x};x};/pin (y)/I{x;s/,/&amp;y/;/,y\\{2\\}$/{x;p;s/pin.*/board ;/;x};x}}&#39; file  end . &#39;  BUT its not working Please help me to know where im wrong . Thanks in advance"}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537253374, "post_id": 52368168, "comment_id": 91705245, "body": "@ potong Please help me how I should search for pin (ab) ,I have tried this but i am unable to search cell --- sed &#39;/\\spin\\s(ab)/{p;s/.*/1/;H;g;/^&#40;\\n1&#41;\\{2\\}$/s// class;/p;d}&#39; file.   Thanks in advance"}, {"owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537260893, "post_id": 52368168, "comment_id": 91709548, "body": "@Anthonyj it is not clear to me what you really want to achieve. Perhaps you should ask a new question with <i>one</i> clear objective, using the most pared down example."}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537264499, "post_id": 52368168, "comment_id": 91711744, "body": "@ potong I apologies for the confusion caused , I have manipulated my question Please glance once. Thanks"}], "tags": [], "owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "is_accepted": true, "score": 0, "last_activity_date": 1537291645, "last_edit_date": 1537291645, "creation_date": 1537188538, "answer_id": 52368168, "question_id": 52367262, "link": "https://stackoverflow.com/questions/52367262/search-a-keyword-in-a-file-and-then-add-line-after-finding-keyword-in-a-body-usi/52368168#52368168", "title": "Search a keyword in a file and then add line after finding keyword in a body using perl or sed", "body": "<p>This might work for you (GNU sed):</p>\n\n<pre><code>sed '1{x;s/^/;,/;x};/^cell (a)/I,/^}/{/pin (q)/I{x;s/;/&amp;q/;/;q\\{2\\},/{x;p;s/pin.*/class ;/;x};x};/pin (y)/I{x;s/,/&amp;y/;/,y\\{2\\}$/{x;p;s/pin.*/board ;/;x};x}}' file\n</code></pre>\n\n<p>Prime the hold space with a couple of delimiters (<code>;</code> for <code>pin (q)</code> counter and <code>,</code> for <code>pin (y)</code> counter). Restrict the processing to the <code>cell (a)</code>. Each time a <code>pin (q)</code> or a <code>pin (y)</code> is encountered, add one to its respective counter in the hold space. If the counter is 2 (may be any number) print the current line and then amend the current line to reflect the appended string.</p>\n\n<p>EDIT:\nSince the original question has changed:</p>\n\n<pre><code>sed '/cell ([^)]*)/{h;x;s/^/;:,/;x};G;/cell (edit[ab])/{/pin (q)/I{x;s/;/&amp;q/;/;q\\{2\\}:/{x;P;s/\\S.*/\"class\";/;x};x};/pin (yz)/I{x;s/:/&amp;y/;/:y\\{2\\},/{x;P;s/\\S.*/board/;x};x}};P;d' file\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537246027, "post_id": 52371102, "comment_id": 91702488, "body": "Please help me as I dont know much about awk , should we invoke something before using your code ? As im unable to use your code ,the output generated is same as input itself ,there is no error genertaed.Thanks in advance"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537277524, "post_id": 52371102, "comment_id": 91720118, "body": "No, that code will work as-is using any awk in any shell on any UNIX box and as you can see in my answer when it&#39;s run against the sample input you provided it produces the expected output you provided. If it&#39;s not doing that for you then either you aren&#39;t just using it as shown in my answer or your real input doesn&#39;t match the sample input you provided."}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537342113, "post_id": 52371102, "comment_id": 91744710, "body": "@ Ed Morton yeah there were extra spaces in my input so it wasnt working . Thanks"}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537362838, "post_id": 52371102, "comment_id": 91757150, "body": "So it&#39;s working now? Great. See <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> for what to do next. And if you have multiple answers that produce the output you want I highly recommend you consider which one you want to be the one you need to be faced with enhancing in future when your requirements change."}], "tags": [], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "is_accepted": false, "score": 1, "last_activity_date": 1537201470, "last_edit_date": 1537201470, "creation_date": 1537197900, "answer_id": 52371102, "question_id": 52367262, "link": "https://stackoverflow.com/questions/52367262/search-a-keyword-in-a-file-and-then-add-line-after-finding-keyword-in-a-body-usi/52371102#52371102", "title": "Search a keyword in a file and then add line after finding keyword in a body using perl or sed", "body": "<p>idk about perl but sed is for doing s/old/new <strong>that is all</strong> and for anything else the standard UNIX tool to use is awk for clarity, simplicity, efficiency, portability, etc. etc. From your example it looks like this is all you're trying to do:</p>\n\n<pre><code>$ cat tst.awk\nBEGIN {\n    map[\"pin (Q)\"] = \"class ;\"\n    map[\"pin (y)\"] = \"board ;\"\n}\n{ print }\n$1 == \"cell\" { cell = \"$2\" }\ncell == \"(a)\" {\n    for (pin in map) {\n        if ( (s=index($0,pin)) &amp;&amp; (++cnt[pin]==2) ) {\n            print substr($0,1,s-1) map[pin]\n        }\n    }\n}\n\n$ awk -f tst.awk file\ncell (a)  {\n    test{\n         pin (Q) {\n         zzzzzz\n        }\n        pin (y) {\n        zzzzz\n        }\n        }\n         pin (Q) {\n         class ;\n         add\n         }\n         pin (y) {\n         board ;\n         add\n     }\n}\n</code></pre>\n\n<p>If that's not it then edit your question to clarify your requirements and provide more truly representative sample input output.</p>\n\n<p>I see from your comment under @potong's answer that you want to add a 3rd pin - to do that in  the above script you just add the new mapping under the existing 2 <code>map[]</code> assignments:</p>\n\n<pre><code>BEGIN {\n    map[\"pin (Q)\"] = \"class ;\"\n    map[\"pin (y)\"] = \"board ;\"\n    map[\"pin (z)\"] = \"board2 ;\"\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537244945, "post_id": 52371141, "comment_id": 91702186, "body": "Thanks its working  . But if I have more cells say cell (b) ,cell (c) then this will be lengthy code . Please suggest me how can I proceed with this. Thanks @  Dave Cross"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537256294, "post_id": 52371141, "comment_id": 91706892, "body": "@Anthonyj If there were more options to deal with, then I&#39;d use a more data-driven approach. Define a hash that contains details of the various lines you need to match and the text that you need to add for them. And also to store the various flags. I might have time to look at this later today, but I can&#39;t make any promises."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537264067, "post_id": 52371141, "comment_id": 91711464, "body": "@Anthonyj: Of course, that shouldn&#39;t stop you from looking at the problem yourself :-)"}, {"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537264625, "post_id": 52371141, "comment_id": 91711809, "body": "@ Dave Cross Im new to perl so im learning hash now so that i can get solution . And I have altered my question Please take a time to glance once Thanks :)"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537353860, "post_id": 52371141, "comment_id": 91751726, "body": "@Anthonyj: <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1537362321, "last_edit_date": 1537362321, "creation_date": 1537198023, "answer_id": 52371141, "question_id": 52367262, "link": "https://stackoverflow.com/questions/52367262/search-a-keyword-in-a-file-and-then-add-line-after-finding-keyword-in-a-body-usi/52371141#52371141", "title": "Search a keyword in a file and then add line after finding keyword in a body using perl or sed", "body": "<p>A Perl solution. This works as a Unix filter. So if it's in a file called <code>transform</code>, you would run it as:</p>\n\n<pre><code>$ transform &lt; input.txt &gt; output.txt\n</code></pre>\n\n<p>Here's the code:</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nmy $in_cell_a;\nmy $brace_level = 0;\nmy ($pin_q, $pin_y);\n\nwhile (&lt;&gt;) {\n  print;\n  if (/{/) {\n    $brace_level++;\n  }\n  if (/cell \\(a\\)/) {\n    $in_cell_a = $brace_level;\n  }\n  if (/(\\s*)pin \\(Q\\)/) {\n    if ($pin_q) {\n      print \"${1}class ;\\n\";\n      $pin_q = 0;\n    } else {\n      $pin_q = 1;\n    }\n  }\n  if (/(\\s*)pin \\(y\\)/) {\n    if ($pin_y) {\n      print \"${1}board ;\\n\";\n      $pin_y = 0;\n    } else {\n      $pin_y = 1;\n    }\n  }\n\n  if (/}/) {\n    if ($brace_level == $in_cell_a) {\n      $in_cell_a = 0;\n    }\n    $brace_level--;\n  }\n}\n</code></pre>\n\n<p><strong>Update:</strong> Here's an updated version that uses a more data-driven approach. To add extra transformations, you just need to add them to the <code>$fix</code> variable.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nmy $in_edit_block;\nmy $brace_level = 0;\n\nmy $fix = {\n  'pin (Q)' =&gt; \"class ;\\n\",\n  'pin (y)' =&gt; \"board ;\\n\",\n};\n\nmy $flag;\n\nmy $fix_re = join '|', map { \"\\Q$_\\E\" } keys %$fix;\n\nwhile (&lt;&gt;) {\n  print;\n  if (/{/) {\n    $brace_level++;\n  }\n  if (/\\Qcell (a)/) {\n    $in_edit_block = $brace_level;\n  }\n  if ($in_edit_block) {\n    if (my ($pad, $match) = /(\\s*)($fix_re)/) {\n      if ($flag-&gt;{$match}) {\n        print \"${pad}$fixes-&gt;{$match}\";\n        $flag-&gt;{$match} = 0;\n      } else {\n        $flag-&gt;{$match} = 1;\n      }\n    }\n  }\n\n  if (/}/) {\n    if ($brace_level == $in_edit_block) {\n      $in_edit_block = 0;\n    }\n    $brace_level--;\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "edited": false, "score": 0, "creation_date": 1537247511, "post_id": 52371847, "comment_id": 91702879, "body": "Thanks ,I want to know wheter you meant if there are more pin ? Thanks"}], "tags": [], "owner": {"reputation": 2285, "user_id": 8592975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fea54eef1c73000439a2c38b53d422?s=128&d=identicon&r=PG&f=1", "display_name": "ctac_", "link": "https://stackoverflow.com/users/8592975/ctac"}, "is_accepted": false, "score": 0, "last_activity_date": 1537200488, "creation_date": 1537200488, "answer_id": 52371847, "question_id": 52367262, "link": "https://stackoverflow.com/questions/52367262/search-a-keyword-in-a-file-and-then-add-line-after-finding-keyword-in-a-body-usi/52371847#52371847", "title": "Search a keyword in a file and then add line after finding keyword in a body using perl or sed", "body": "<p>If you have more than 1 block with cell (a) ...</p>\n\n<pre><code>awk '\n  function addline(ind, value) {\n    if(++a[ind]==2) { \n      b=$0\n      sub(/[^[:blank:]].*/,\"\",b)\n      $0=$0 \"\\n\" b value \" ;\"\n    }\n  }\n  /^cell/ {\n    split(\"\",a)\n    f=0\n    if(/(a)/)\n      f=1\n  }\n  $0 ~ \"pin [(]Q[)]\" &amp;&amp; f {\n    addline(\"Q\", \"class\")\n  }\n  $0 ~ \"pin [(]y[)]\" &amp;&amp; f {\n    addline(\"y\", \"board\")\n  }\n1' input.txt\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9462322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Anthonyj", "link": "https://stackoverflow.com/users/9462322/anthonyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 52368168, "answer_count": 4, "score": 0, "last_activity_date": 1537362321, "creation_date": 1537185563, "last_edit_date": 1537264885, "question_id": 52367262, "link": "https://stackoverflow.com/questions/52367262/search-a-keyword-in-a-file-and-then-add-line-after-finding-keyword-in-a-body-usi", "title": "Search a keyword in a file and then add line after finding keyword in a body using perl or sed", "body": "<p>I was trying to search a keyword (cell (edita)) in a lengthy file (input.txt) which has above 10000 lines and different cell names like cell(noedit) , cell (editb) .And then I should search for pin (q) (2nd occurance )and add line \"class\" , pin (yz) (2nd occurance ) and add \"board\". <strong>I should not manipulate cell (noedit) block</strong> .</p>\n\n<p>MY input.txt </p>\n\n<pre><code>        cell (edita)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 add\n                 }\n                 pin (yz) {\n                 add \n             }\n        }\n        cell (noedit)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 add\n                 }\n                 pin (yz) {\n                 add \n             }\n        }\n    cell (editb)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 add\n                 }\n                 pin (yz) {\n                 add \n             }\n        }\n</code></pre>\n\n<p>my output.txt should look like this</p>\n\n<pre><code>cell (edita)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 \"class\";\n                 add\n                 }\n                 pin (yz) {\n                 board;\n                 add \n             }\n        }\n        cell (noedit)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 add\n                 }\n                 pin (yz) {\n                 add \n             }\n        }\n    cell (editb)  {\n            test{\n                 pin (Q) {\n                 zzzzzz\n                }\n                pin (yz) {\n                zzzzz \n                }\n                }\n                 pin (Q) {\n                 \"class\";\n                 add\n                 }\n                 pin (yz) {\n                 board ;\n                 add \n             }\n        }\n</code></pre>\n\n<p>I have tried writing sed which only does if file has from pin (i.e no cell (a) line) ,and even it manipulates only 2nd occurance </p>\n\n<p>sed '/\\s<em>pin\\s(Q)/{p;s/.</em>/1/;H;g;/^(\\n1){2}$/s//        class;/p;d}' input.txt\nsed '/\\s<em>pin\\s(y)/{p;s/.</em>/1/;H;g;/^(\\n1){2}$/s//        board;/p;d}' input.txt</p>\n\n<p>Please can any one help me out to serach for cell and then manipulate.</p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["perl", "installation", "executable"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 0, "creation_date": 1537184298, "post_id": 52366779, "comment_id": 91677849, "body": "It depends if your installer module has a silent mode. If not, this is going to be difficult: you could either unpack the installer and do the install manually, or - and this probably isn&#39;t possible on Windows I&#39;d guess - somehow invoke the installer on a virtual desktop and automate the UI."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537187200, "post_id": 52366779, "comment_id": 91679597, "body": "That depends entirely on what the installer requires. Does it have a silent mode? Does it open a window and ask for options? Please provide more details."}, {"owner": {"reputation": 1, "user_id": 8735932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DI05R.jpg?s=128&g=1", "display_name": "coder", "link": "https://stackoverflow.com/users/8735932/coder"}, "edited": false, "score": 0, "creation_date": 1537187354, "post_id": 52366779, "comment_id": 91679698, "body": "for ex : i want to silent install vlc music player using perl script. may i know which module to use and how to automate script to  it."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 10363808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zyzyf.jpg?s=128&g=1", "display_name": "Breezed11", "link": "https://stackoverflow.com/users/10363808/breezed11"}, "is_accepted": false, "score": 3, "last_activity_date": 1537221521, "last_edit_date": 1537221521, "creation_date": 1537188773, "answer_id": 52368235, "question_id": 52366779, "link": "https://stackoverflow.com/questions/52366779/how-to-silent-install-an-exe-file-using-perl-script/52368235#52368235", "title": "How to silent install an exe file using perl script", "body": "<p>Would it not make sense to do something like that in a <code>.bat</code> or <code>.ps1</code> file, using the command: </p>\n\n<pre><code>vlc-2.0.1-win32.exe /L=1033 /S\n</code></pre>\n\n<p>(just put the full filepath and executable file in there)?</p>\n\n<p>That should result in a silent install, and looks easier for Windows than trying to use Perl? Or does it have to be Perl for whatever reason?</p>\n"}], "owner": {"reputation": 1, "user_id": 8735932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DI05R.jpg?s=128&g=1", "display_name": "coder", "link": "https://stackoverflow.com/users/8735932/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1537221521, "creation_date": 1537183988, "question_id": 52366779, "link": "https://stackoverflow.com/questions/52366779/how-to-silent-install-an-exe-file-using-perl-script", "title": "How to silent install an exe file using perl script", "body": "<p>I want to silent install a software executable file using Perl coding.</p>\n\n<p>I check to have a installer module to run executable file but no luck.</p>\n\n<p>Kindly respond with some idea to initiate .</p>\n"}, {"tags": ["perl", "sorting", "hash", "key"], "answers": [{"tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": false, "score": 3, "last_activity_date": 1537185258, "last_edit_date": 1537185258, "creation_date": 1537184074, "answer_id": 52366807, "question_id": 52366644, "link": "https://stackoverflow.com/questions/52366644/sorting-hashes-on-value-length-whilst-preserving-order/52366807#52366807", "title": "Sorting hashes on value length whilst preserving order", "body": "<h2>One possible solution</h2>\n\n<p>You can save the position of the line in the input file handle as well as the <code>length</code>. The <a href=\"http://perldoc.perl.org/perlvar.html#%24.\" rel=\"nofollow noreferrer\"><code>$.</code> magic variable (<em>input line number</em>)</a> provides this. You can then sort on both values.</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy %lines;\nwhile ( my $curr_line = &lt;DATA&gt; ) {\n  chomp($curr_line);\n  $lines{$curr_line} = [ length $curr_line, $. ];\n}\n\nfor my $line (\n  sort {\n       $lines{$a}-&gt;[0] &lt;=&gt; $lines{$b}-&gt;[0]\n    || $lines{$a}-&gt;[1] &lt;=&gt; $lines{$b}-&gt;[1]\n  } keys %lines\n) {\n  print $line, \"\\n\";\n}\n\n__DATA__\ntiny lin1\nmedium line\nbig line\nhuge lin2\nrand lin3\nmegahugegigantic line\n</code></pre>\n\n<p>This will always output</p>\n\n<pre><code>big line\ntiny lin1\nhuge lin2\nrand lin3\nmedium line\nmegahugegigantic line\n</code></pre>\n\n<p>You can of course use a hash to make the code more readable, too.</p>\n\n<pre><code>$lines{$curr_line} = { \n  length   =&gt; length $curr_line, \n  position =&gt; $., \n};\n</code></pre>\n\n<hr>\n\n<h2>Explanation of your implementation</h2>\n\n<p>Your results changed their order every time because of random hash ordering. The way <code>keys</code> returns the list of keys is random, because of the way Perl implements hashes. This is by design, and a security feature. Since there are several keys that have the same value, the sort will sometimes return different results, based on which of the equal value keys came out first.</p>\n\n<p>You could mitigate this by sticking another <code>sort</code> in front of your <code>keys</code> call. That would sort the keys by name, at least making the order of the undesired result be consistent.</p>\n\n<pre><code>#                                               vvvv\nfor my $line (sort{ $lines{$a} &lt;=&gt; $lines{$b} } sort keys %lines) { ... }\n</code></pre>\n\n<hr>\n\n<p>Note that you don't have to <a href=\"http://perldoc.perl.org/functions/chomp.html\" rel=\"nofollow noreferrer\"><code>chomp</code></a> the input if you put the <code>\\n</code> back when you <code>print</code>. It's always of the same length anyway. If you do, you should <code>print</code> a <code>$/</code>, which is the <a href=\"http://perldoc.perl.org/perlvar.html#%24%2F\" rel=\"nofollow noreferrer\"><em>input record separator</em></a> that <code>chomp</code> removed, or you falsify your data.</p>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537188340, "post_id": 52367076, "comment_id": 91680326, "body": "<code>print join &quot;\\n&quot;, LIST</code> is a bad idea because it will leave the last line of the output unterminated. And it is no shorter than the proper <code>print &quot;$_\\n&quot; for LIST</code>."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537188676, "post_id": 52367076, "comment_id": 91680534, "body": "<code>my  @lines = &lt;STDIN&gt;</code> will require the operator to use Ctrl-D (Linux) or Ctrl-Z (Windows) to terminate the input. That&#39;s an ugly user interface, and you should allow a blank input line to end the list. The OP has <code>while ( my $curr_line = &lt;STDIN&gt; )</code> but that won&#39;t terminate either because the input will always contain a newline. The best way is <code>last unless $curr_line =~ &#47;\\S&#47;</code> within the loop."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537189756, "post_id": 52367076, "comment_id": 91681272, "body": "Please don&#39;t mislead people into unnecessary optimisation in a vain attempt to show off. You should never add optimisation until you have written straightforward working code and found it to be too slow. In any case, a <i>Schwartzian Transform</i> is likely to be slower than using <code>sort { length $a &lt;=&gt; length $b } @lines</code> because <code>length</code> is extremely fast."}], "tags": [], "owner": {"reputation": 3509, "user_id": 4243840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeabd769bae1bf82fd4b8882fed6653?s=128&d=identicon&r=PG", "display_name": "JGNI", "link": "https://stackoverflow.com/users/4243840/jgni"}, "is_accepted": true, "score": 2, "last_activity_date": 1537184956, "creation_date": 1537184956, "answer_id": 52367076, "question_id": 52366644, "link": "https://stackoverflow.com/questions/52366644/sorting-hashes-on-value-length-whilst-preserving-order/52367076#52367076", "title": "Sorting hashes on value length whilst preserving order", "body": "<p>Your problem is not with sort Perl uses the quick sort algorithm which is a stable sort, inputs that match the same sort key have the same order on output of the sort as input.</p>\n\n<p>Your problem is that you are storing the lines in a hash. A hash is an unordered collection of key value pairs so adding the lines to the hash and then printing them out again with out the sort will give you the lines in a random order.</p>\n\n<p>You need to read all the lines into an array and then sort them on length, the quickest way being to use a <a href=\"https://en.wikipedia.org/wiki/Schwartzian_transform\" rel=\"nofollow noreferrer\">Schwartzian Transformation</a> see below.</p>\n\n<pre><code>my  @lines = &lt;STDIN&gt;;\nchomp(@lines);\n\nmy @sorted = # This is the clever bit and needs to be red from the last map up\n    map { $_-&gt;[0] } # Get the lines\n    sort { $a-&gt;[1] &lt;=&gt; $b-&gt;[1] }  # Sort on length\n    map { [$_, length $_] } # Create a list of array refs containing\n        # the line and the length of the line\n    @lines;\n\nprint join \"\\n\", @sorted; # print out the sorted lines\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1537188238, "creation_date": 1537188238, "answer_id": 52368072, "question_id": 52366644, "link": "https://stackoverflow.com/questions/52366644/sorting-hashes-on-value-length-whilst-preserving-order/52368072#52368072", "title": "Sorting hashes on value length whilst preserving order", "body": "<p>Nowhere do you store the original order, so you can't possibly sort by it. The easiest fix is to store the lines in an array, and ensure that Perl is using a stable sort.</p>\n\n<pre><code>use sort 'stable';\n\nmy @lines = &lt;&gt;;\nchomp(@lines);\n\nfor my $line ( sort { length($a) &lt;=&gt; length($b) } @lines) {\n   say $line;\n}\n</code></pre>\n\n<p>[ <em>ST is overkill for this. It' such overkill that it probably even slows things down!</em> ]</p>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 1, "last_activity_date": 1537189981, "last_edit_date": 1592644375, "creation_date": 1537189519, "answer_id": 52368470, "question_id": 52366644, "link": "https://stackoverflow.com/questions/52366644/sorting-hashes-on-value-length-whilst-preserving-order/52368470#52368470", "title": "Sorting hashes on value length whilst preserving order", "body": "<p>As has been explained, the randomness comes from your use of hash keys to store the strings. There is no need for this, or anything more elaborate like a <em>Schwartzian Transform</em>, to make this work</p>\n<p>All Perl versions since v5.8 have used a <em>stable</em> sort, which will keep values that sort equally in the same order. But you can insist that the <code>sort</code> operator you get is a stable one using the <code>sort</code> pragma with</p>\n<pre><code>use sort 'stable'\n</code></pre>\n<p>Here's how I would write your program. It stops reading input at end of file, or when it sees a blank line in case you want to enter the data from the keyboard</p>\n<pre><code>use strict;\nuse warnings 'all';\nuse feature 'say';\nuse sort 'stable';\n\nmy @list;\n\nwhile ( &lt;&gt; ) {\n    last unless /\\S/;\n    chomp;\n    push @list, $_;\n}\n\nsay for sort { length $a &lt;=&gt; length $b } @list;\n</code></pre>\n<p>Using the same input as you use in the question, this produces</p>\n<h3>output</h3>\n<pre><code>big line\ntiny line\nhuge line\nrand line\nmedium line\nmegahugegigantic line\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 10284022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0811d21b83bd39b556a70188d0b5266e?s=128&d=identicon&r=PG&f=1", "display_name": "user10284022", "link": "https://stackoverflow.com/users/10284022/user10284022"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52367076, "answer_count": 4, "score": 2, "last_activity_date": 1537189981, "creation_date": 1537183505, "last_edit_date": 1537183558, "question_id": 52366644, "link": "https://stackoverflow.com/questions/52366644/sorting-hashes-on-value-length-whilst-preserving-order", "title": "Sorting hashes on value length whilst preserving order", "body": "<p>I'm currently writing a Perl script to sort lines from stdin and print the lines in order of line length whilst preserving order for the ones that are equal.\nMy sorting code consists of the following:</p>\n\n<pre><code>while (my $curr_line = &lt;STDIN&gt;) {\n    chomp($curr_line);\n    $lines{$curr_line} = length $curr_line;\n}\n\nfor my $line (sort{ $lines{$a} &lt;=&gt; $lines{$b} } keys %lines){\n    print $line, \"\\n\";\n}\n</code></pre>\n\n<p>For example my stdin consists of the following:</p>\n\n<pre><code>tiny line\nmedium line\nbig line\nhuge line\nrand line\nmegahugegigantic line\n</code></pre>\n\n<p>I'd get the following output:</p>\n\n<pre><code>big line\nrand line\ntiny line\nhuge line\nmedium line\nmegahugegigantic line\n</code></pre>\n\n<p>Is there any way I can preserve the order for lines of equal length such that tiny would come before huge which comes before rand? Also, the order seems to change everytime I run the script.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["javascript", "python", "perl", "bitwise-operators"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1537182838, "post_id": 52366418, "comment_id": 91677004, "body": "Wouldn&#39;t it be enough to truncate the result to 32 bits? As in <code>use constant { I32 =&gt; 0xffff_ffff }; ... ($x &lt;&lt; $n) &amp; I32</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1537183244, "post_id": 52366418, "comment_id": 91677229, "body": "Can you show us the JavaScript hashing code?"}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537186560, "post_id": 52366418, "comment_id": 91679208, "body": "@melpomene Thanks for your suggestion, but that will not work. We have already tried some similar implementations. Larger ints can overflow the 32-bit boundary after being shifted, so simply truncated the result doesn&#39;t always give the right answer. Several other similar solutions have been given in Python solutions on SO, but from testing, the only solution that works every time is the one that uses ctypes.c_int"}, {"owner": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537195999, "post_id": 52366418, "comment_id": 91685482, "body": "Does anyone on your team write C?  Then you can use either <a href=\"https://metacpan.org/pod/C::Blocks\" rel=\"nofollow noreferrer\">metacpan.org/pod/C::Blocks</a> or <a href=\"https://metacpan.org/pod/distribution/Inline-C/lib/Inline/C.pod\" rel=\"nofollow noreferrer\">metacpan.org/pod/distribution/Inline-C/lib/Inline/C.pod</a>"}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "reply_to_user": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537199981, "post_id": 52366418, "comment_id": 91687939, "body": "@DiabJerius <code>Inline::C</code> looks like it will work. It comes with a cookbook, too: <a href=\"https://metacpan.org/pod/distribution/Inline-C/lib/Inline/C/Cookbook.pod\" rel=\"nofollow noreferrer\">https://metacpan.org/pod/distribution/Inline-C/lib/Inline/C/&zwnj;&#8203;Cookbook.pod</a> Thanks for this suggestion. I will give it a try later."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537207987, "post_id": 52366418, "comment_id": 91691802, "body": "@robasia &quot;<i>Larger ints can overflow the 32-bit boundary after being shifted, so simply truncated the result doesn&#39;t always give the right answer.</i>&quot; That makes no sense. Please show the hash algorithm."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537214173, "post_id": 52366418, "comment_id": 91694462, "body": "@melpomene, I think they mean that 0x08123456 &lt;&lt; 4 should give a negative number, but truncating doesn&#39;t do that."}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "reply_to_user": {"reputation": 2000, "user_id": 1275160, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e59227edde0173c28ade664aac101ec?s=128&d=identicon&r=PG", "display_name": "Diab Jerius", "link": "https://stackoverflow.com/users/1275160/diab-jerius"}, "edited": false, "score": 0, "creation_date": 1537265034, "post_id": 52366418, "comment_id": 91712086, "body": "@DiabJerius We were able to implement it using Inline C as you suggested. Thank you. We added your solution to our summarized answer below."}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537265715, "post_id": 52366418, "comment_id": 91712476, "body": "@melpomene Thanks for your feedback and sorry for the incorrect explanation of the problem. Our algorithm is a variation of md5. We originally tried to use <code>Digest::MD5</code>, but it was not producing the same results. Therefore, we decided to translate it. However, the code is nearly 200 lines, so I was afraid that posting it would distract people from my actual question. Thanks again for your help."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537211083, "post_id": 52371692, "comment_id": 91693197, "body": "It doesn&#39;t make sense to pass negative numbers to an logical shift, but the behaviour of <code>&gt;&gt;&gt;</code> does appear to be defined for negative numbers. You simply need to cast the input, which I&#39;ve added to my lshr32"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537289279, "post_id": 52371692, "comment_id": 91727550, "body": "Your change just makes the sub more complex without changing the output"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537338678, "post_id": 52371692, "comment_id": 91742940, "body": "The size of <code>int</code> must accommodate -32767..32767. It can be smaller than 32 bits. It can be larger than 32 bits."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537354263, "post_id": 52371692, "comment_id": 91751998, "body": "What cases? Positive and negative numbers? It already handled both. Again, your addition literally has no effect."}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537362580, "post_id": 52371692, "comment_id": 91756978, "body": "We finally came to understand your explanation. Because you were lumping <code>lshr32</code> and <code>lshl32</code> together under the <code>#&gt;&gt;&gt; in JS</code> comment, we thought that they needed to be used in combination. We originally tested on negative numbers and got a good result from <code>lshr32</code>, so we mistakenly thought that <code>lshl32</code> was a positive number implementation. Our lack of technical knowledge caused us confusion, and regrettably, caused you frustration. Sorry for making this question tedious for you. Thanks again for your precious help and time."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537363140, "post_id": 52371692, "comment_id": 91757326, "body": "Re &quot;<i>Because you were lumping <code>lshr32</code> and <code>lshl32</code> together under the <code># &gt;&gt;&gt; in JS</code> comment</i>&quot;, You mean you were mistakenly lumping the two together. As the comment indicates, JS&#39;s <code>&gt;&gt;&gt;</code> operator performs a 32-bit logical shift right (<code>lshr32</code>). JS doesn&#39;t provide an operator for performing a logical shift left (<code>lshl32</code>), but I provided an implementation in case any future reader needs it"}, {"owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "edited": false, "score": 0, "creation_date": 1537438427, "post_id": 52371692, "comment_id": 91788331, "body": "Yes, you are right. I shouldn&#39;t have worded my comment that way. Our misunderstanding of your solution was completely due to our lack of knowledge in this field."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 5, "last_activity_date": 1537222954, "last_edit_date": 1537222954, "creation_date": 1537199884, "answer_id": 52371692, "question_id": 52366418, "link": "https://stackoverflow.com/questions/52366418/python-ctypes-c-int-to-perl-xs-or-non-xs-conversion-javascript-signed-32-bit/52371692#52371692", "title": "Python ctypes.c_int to Perl XS (or non-XS) conversion (Javascript signed 32-bit bitwise shift operator conversion)", "body": "<pre><code>sub lshr32 { ( $_[0] &amp; 0xFFFFFFFF ) &gt;&gt; $_[1] }                           # &gt;&gt;&gt; in JS\nsub lshl32 { ( $_[0] &lt;&lt; $_[1] ) &amp; 0xFFFFFFFF }\n\nsub ashr32 { ( $_[0] - ( $_[0] % ( 1 &lt;&lt; $_[1] ) ) ) / ( 1 &lt;&lt; $_[1] ) }   # &gt;&gt; in JS\nsub ashl32 { unpack \"l\", pack \"l\", $_[0] * ( 1 &lt;&lt; $_[1] ) }              # &lt;&lt; in JS\n</code></pre>\n\n<hr>\n\n<p>It doesn't make sense to pass a negative number to a logical shift unless the number isn't really a number but a collection of bits. Given that you are porting a hashing algorithm, this is very likely. It also means you're creating a lot of extra work for yourself by matching JavaScript this closely because you're recreating hacks used to address limits in JavaScript that don't exist in Perl. It should be far simpler to use 32-bit unsigned values, <code>&lt;&lt;</code> truncated using <code>&amp; 0xFFFFFFFF</code>, and <code>&gt;&gt;</code> truncated using <code>&amp; 0xFFFFFFFF</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 10057091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c0795af897ea9a6f99cd6f20ad033b4?s=128&d=identicon&r=PG&f=1", "display_name": "robasia", "link": "https://stackoverflow.com/users/10057091/robasia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 52371692, "answer_count": 1, "score": 0, "last_activity_date": 1537264930, "creation_date": 1537182626, "question_id": 52366418, "link": "https://stackoverflow.com/questions/52366418/python-ctypes-c-int-to-perl-xs-or-non-xs-conversion-javascript-signed-32-bit", "title": "Python ctypes.c_int to Perl XS (or non-XS) conversion (Javascript signed 32-bit bitwise shift operator conversion)", "body": "<h2>Background</h2>\n\n<p>We need to convert a Javascript hashing algorithm into Perl code. Therefore, we need to convert Javascript's bitwise shift operators &lt;&lt;, >>, and >>> into Perl. So far, we have the algorithms for doing the conversion, but since Javascript bitwise shift operators operate on 32-bit integers, we also need to emulate this in Perl.</p>\n\n<h2>Python solution</h2>\n\n<p>Based on this post <a href=\"https://stackoverflow.com/a/41610348\">https://stackoverflow.com/a/41610348</a> we learned that we can do this in Python using ctypes. For example, to left-shift an integer by x bits:</p>\n\n<pre><code>import ctypes\nprint (ctypes.c_int(integer &lt;&lt; x ^ 0).value)\n</code></pre>\n\n<h2>Perl question</h2>\n\n<p>My understanding is that we need to use XS to do this. My question is whether anyone has a quick solution to implementing it. We don't know XS. We could start learning it, but from my impression of it, the learning curve is pretty high and it could take a while to gain any mastery of it. Of course, a non-XS solution would be ideal, if one exists. Any solutions or hints would be greatly appreciated.</p>\n\n<h2>Workaround</h2>\n\n<p>Since we have a Python solution already, we could implement this module in Python and then call it from Perl. Performance isn't really an issue, so this \"hack\" is acceptable, although somewhat undesirable. In other words, we would prefer to maintain the whole program (which consists of several modules) in Perl only.</p>\n"}, {"tags": ["excel", "perl", "excel-writer-xlsx"], "comments": [{"owner": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537172904, "post_id": 52362783, "comment_id": 91671329, "body": "Could you please include your error as a text instead of image?"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537173163, "post_id": 52362783, "comment_id": 91671459, "body": "@Abhi: The error is in a dialogue box. It&#39;s hard to extract the text from there without simply typing it in."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537173740, "post_id": 52362783, "comment_id": 91671766, "body": "What debugging have you done? Start by writing just the header with no data. Then you should try writing just a few lines of data instead of the full quarter million. There may be a specific row of data from the database that is causing the problem, and you may need to search for it."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "reply_to_user": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537183572, "post_id": 52362783, "comment_id": 91677434, "body": "@AbhiNickz I added the error message as an alt tag to the image."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1537183646, "post_id": 52362783, "comment_id": 91677475, "body": "The <code>while (my $sqlStatement = ) {</code> bit of your code is weird. I assume you just left out the query because you think it&#39;s not important, but why would it be in a loop condition? That makes no sense. Please post code that compiles."}, {"owner": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 0, "creation_date": 1537204481, "post_id": 52362783, "comment_id": 91690095, "body": "In the olden days Excel had limits on the number of rows. Is 250k too many for your version? It think the limit was 65k up to version 2003 or 2007. Does it work if you bail out the <code>while</code> loop after just a few rows? Perhaps test this as the last line inside while: <code>last if $count&gt;10;</code>. You could also check out <a href=\"https://metacpan.org/pod/Spreadsheet::WriteExcel\" rel=\"nofollow noreferrer\">metacpan.org/pod/Spreadsheet::WriteExcel</a> which I have used successfully a few times."}, {"owner": {"reputation": 63, "user_id": 7475104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YmjsUusP_LI/AAAAAAAAAAI/AAAAAAAAADQ/v6uFEd7x58U/photo.jpg?sz=128", "display_name": "Chitransh Agarwal", "link": "https://stackoverflow.com/users/7475104/chitransh-agarwal"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537253007, "post_id": 52362783, "comment_id": 91705065, "body": "@Borodin - I found out a thread which talked about this issue, it arises when the writer thinks of a value as numeric when it is explicitly a string, for example &quot;1E43&quot; this value is interpreted by excel as a number and converter to infinity.  Also there are a bunch of values that shows this behaviour rest all of them are written properly"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537263389, "post_id": 52362783, "comment_id": 91711045, "body": "@Chitransh: If you have a solution to your question then you should post an answer, perhaps including a link to the information you found, but also describing what you did to fix the problem in your situation."}, {"owner": {"reputation": 63, "user_id": 7475104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YmjsUusP_LI/AAAAAAAAAAI/AAAAAAAAADQ/v6uFEd7x58U/photo.jpg?sz=128", "display_name": "Chitransh Agarwal", "link": "https://stackoverflow.com/users/7475104/chitransh-agarwal"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537264282, "post_id": 52362783, "comment_id": 91711599, "body": "@Borodin - No i don&#39;t have a solution i just found that out, and since it was another website, and since i am new here and even to perl i don&#39;t know how i can use write_string subroutine to write an entire row"}, {"owner": {"reputation": 63, "user_id": 7475104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YmjsUusP_LI/AAAAAAAAAAI/AAAAAAAAADQ/v6uFEd7x58U/photo.jpg?sz=128", "display_name": "Chitransh Agarwal", "link": "https://stackoverflow.com/users/7475104/chitransh-agarwal"}, "edited": false, "score": 0, "creation_date": 1537268217, "post_id": 52362783, "comment_id": 91713951, "body": "Also below is the thread from where i got the info. <a href=\"https://github.com/jmcnamara/excel-writer-xlsx/issues/73\" rel=\"nofollow noreferrer\">github.com/jmcnamara/excel-writer-xlsx/issues/73</a>"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537268704, "post_id": 52362783, "comment_id": 91714260, "body": "@Chitransh: If you don&#39;t understand the <a href=\"https://metacpan.org/pod/Excel::Writer::XLSX#write_string(-%24row,-%24column,-%24string,-%24format-)\" rel=\"nofollow noreferrer\">documentation for <code>write_string</code></a> then you should open a new question and ask for help. But please at least try something first: it isn&#39;t hard, and your question won&#39;t be well-received if you have made no effort of your own."}, {"owner": {"reputation": 917, "user_id": 3014263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rFh51.jpg?s=128&g=1", "display_name": "AbhiNickz", "link": "https://stackoverflow.com/users/3014263/abhinickz"}, "edited": false, "score": 0, "creation_date": 1537293735, "post_id": 52362783, "comment_id": 91729538, "body": "@Chitransh, once I have recieved the same error due to &#39; present in the worksheet name, Because you are creating the xlsx file from the script so it allows that, but results in error when you open it from ms excel. So technically there could be no of problems with you xlsx file."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 7475104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YmjsUusP_LI/AAAAAAAAAAI/AAAAAAAAADQ/v6uFEd7x58U/photo.jpg?sz=128", "display_name": "Chitransh Agarwal", "link": "https://stackoverflow.com/users/7475104/chitransh-agarwal"}, "is_accepted": true, "score": 3, "last_activity_date": 1538992552, "creation_date": 1538992552, "answer_id": 52699735, "question_id": 52362783, "link": "https://stackoverflow.com/questions/52362783/excelwriterxlsx-unreadable-content-error/52699735#52699735", "title": "Excel::Writer::XLSX Unreadable content error", "body": "<p>Finally i figured it out (Thanks to John McNamara). This was resolved by adding a write handler that uses regular expressions to check if a particular token is being converted to \"inf\", and if it does, it invokes the write_string subroutine instead of write_row.\nBelow is the code.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse Excel::Writer::XLSX;\n\n\nmy $workbook  = Excel::Writer::XLSX-&gt;new( 'write_handler5.xlsx' );\nmy $worksheet = $workbook-&gt;add_worksheet();\n\n\n# Add a handler to match any numbers in order to check for and handle\n# infinity.\n$worksheet-&gt;add_write_handler( qr[\\d], \\&amp;write_with_infinity );\n\n\n# The following function is used by write() to pre-process any the data when a\n# match is found. If it finds something that looks like a number but evaluates\n# to infinity it write it as a string.\nsub write_with_infinity {\n\n    my $worksheet = shift;\n    my @args      = @_;\n    my $token     = $args[2];\n\n    # Check if token looks like a number, in the same way as write().\n    if ( $token =~ /^([+-]?)(?=[0-9]|\\.[0-9])[0-9]*(\\.[0-9]*)?([Ee]([+-]?[0-9]+))?$/ ) {\n\n    # Check for infinity.\n    $token = $token + 0;\n\n    if ($token =~ /inf/) {\n\n        # Write the value as a string instead of a number.\n        return $worksheet-&gt;write_string( @args );\n    }\n    }\n\n    # Reject the match and return control to write()\n    return undef;\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7475104, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YmjsUusP_LI/AAAAAAAAAAI/AAAAAAAAADQ/v6uFEd7x58U/photo.jpg?sz=128", "display_name": "Chitransh Agarwal", "link": "https://stackoverflow.com/users/7475104/chitransh-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "accepted_answer_id": 52699735, "answer_count": 1, "score": 3, "last_activity_date": 1538992552, "creation_date": 1537169454, "last_edit_date": 1537183557, "question_id": 52362783, "link": "https://stackoverflow.com/questions/52362783/excelwriterxlsx-unreadable-content-error", "title": "Excel::Writer::XLSX Unreadable content error", "body": "<p>I just started using Perl and I am using\n<a href=\"https://metacpan.org/pod/Excel::Writer::XLSX\" rel=\"nofollow noreferrer\"><code>Excel::Writer::XLSX</code></a>\nto query a DB2 database and export the data to an .xlsx file. The data is about 250k rows.</p>\n\n<p>The script is running fine, but when I try to open the Excel file it throws an error and asks to repair the file. Upon repairing some of the data gets replaced by <code>inf</code>.</p>\n\n<p><img src=\"https://i.stack.imgur.com/97h7S.png\" alt=\"Error dialog saying &quot;Excel found unreadable content in &#39;Chk.xlsx&#39;. Do you want to recover the contents of this workbook? If you trust the source of this workbook, click Yes.&quot;\"></p>\n\n<p>Below is a snippet from my code.</p>\n\n<pre><code>while ( my $sqlStatement = ) {\n\n    $mSQL = $dbh-&gt;prepare( $sqlStatement )\n            or die \"Can't prepare $sqlStatement\";\n    $mSQL-&gt;execute()\n            or die \"Can't execute $sqlStatement\";\n}\n\nmy $workbook = Excel::Writer::XLSX-&gt;new( $ARGV[2] );\n$workbook-&gt;set_tempdir( '/tempDir/' );\n$workbook-&gt;set_optimization();\n\nmy $worksheet = $workbook-&gt;add_worksheet();\n$worksheet-&gt;keep_leading_zeros();\n\nmy $row    = 0;\nmy $column = 0;\n\nmy @emptyRow = ();\n\n$worksheet-&gt;write_row( $row++, $column, [ @{ $mSQL-&gt;{NAME_uc} } ] );\n$worksheet-&gt;write_row( $row++, $column, [ @emptyRow ] );\n\nwhile ( my @Row = $mSQL-&gt;fetchrow_array ) {\n    $worksheet-&gt;write_row( $row++, $column, [ @Row ] );    #, $cellFormat);\n    $count++;\n}\n\n$workbook-&gt;close();\n</code></pre>\n\n<p>Can someone please advise me on this issue?</p>\n"}, {"tags": ["perl", "ssh"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9993697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6431eb7199f06264f3daa65b256751a?s=128&d=identicon&r=PG&f=1", "display_name": "Riju Mukherjee", "link": "https://stackoverflow.com/users/9993697/riju-mukherjee"}, "edited": false, "score": 0, "creation_date": 1537170381, "post_id": 52362819, "comment_id": 91670087, "body": "So either configure your server not to use hmac-sha1 for integrity checking or tell your script to accept hmac-sha1         How?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 31, "user_id": 9993697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6431eb7199f06264f3daa65b256751a?s=128&d=identicon&r=PG&f=1", "display_name": "Riju Mukherjee", "link": "https://stackoverflow.com/users/9993697/riju-mukherjee"}, "edited": false, "score": 0, "creation_date": 1537170655, "post_id": 52362819, "comment_id": 91670245, "body": "@RijuMukherjee For the server: No idea, I&#39;ve never used Sun SSH. Check its manual? As for the script: What&#39;s unclear about the code snippet I quoted?"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 1, "last_activity_date": 1537169630, "last_edit_date": 1592644375, "creation_date": 1537169630, "answer_id": 52362819, "question_id": 52362274, "link": "https://stackoverflow.com/questions/52362274/no-matching-mac-found-client-hmac-sha2-512-etmopenssh-com-hmac-sha2-256-etmop/52362819#52362819", "title": "No matching mac found: client hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256 server hmac-sha1", "body": "<p><a href=\"https://metacpan.org/pod/Net::SSH::Perl\" rel=\"nofollow noreferrer\"><code>perldoc Net::SSH::Perl</code></a>:</p>\n<blockquote>\n<p>Integrity checking is performed by the <code>hmac-sha2-256</code>, <code>hmac-sha2-512</code>, <code>hmac-sha2-256-etm@openssh.com</code>, or <code>hmac-sha2-512-etm@openssh.com</code> algorithms. The deprecated <code>hmac-sha1</code> or <code>hmac-md5</code> algorithms are available but not enabled by default. Many older SSH server installations still use hmac-sha1 as the main accepted MAC algorithm. To enable this, use the following options parameter:</p>\n<pre><code>options =&gt; [ &quot;MACs +hmac-sha1&quot; ]\n</code></pre>\n</blockquote>\n<p>So either configure your server not to use <code>hmac-sha1</code> for integrity checking or tell your script to accept <code>hmac-sha1</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 9993697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6431eb7199f06264f3daa65b256751a?s=128&d=identicon&r=PG&f=1", "display_name": "Riju Mukherjee", "link": "https://stackoverflow.com/users/9993697/riju-mukherjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3562, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537169643, "creation_date": 1537167351, "last_edit_date": 1537169643, "question_id": 52362274, "link": "https://stackoverflow.com/questions/52362274/no-matching-mac-found-client-hmac-sha2-512-etmopenssh-com-hmac-sha2-256-etmop", "title": "No matching mac found: client hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256 server hmac-sha1", "body": "<p>I am getting below error while running my script, I am on AIX</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Reading configuration data /ecmsq1vg1/home1/aradmin/.ssh/config\nReading configuration data /etc/ssh_config\nConnecting to www.mftcatapp.firstdataclients.com, port 22.\nRemote version string: SSH-2.0-Sun_SSH_1.1.8\nRemote protocol version 2.0, remote software version Sun_SSH_1.1.8\nNet::SSH::Perl Version 2.14, protocol version 2.0.\nNo compat match: Sun_SSH_1.1.8.\nConnection established.\nSent key-exchange init (KEXINIT), waiting for response.\nNo matching mac found: client hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256 server hmac-sha1 at /apps/perl/lib/site_perl/5.18.1/aix-thread-multi/Net/SSH/Perl/SSH2.pm line 273\n</code></pre>\n\n<p>Can anyone help me out why i am facing the above error?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537168296, "post_id": 52361957, "comment_id": 91669069, "body": "Your condition <code>while ($dihed &lt;= 10.0)</code> is not true with <code>$dihed=150</code> so the loop body is not entered at all."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1537169245, "post_id": 52361957, "comment_id": 91669553, "body": "More importantly, with <code>while ($dihed &lt;= 10.0)</code> the loop would never terminate (if it was entered somehow). Did you mean <code>while ($dihed &gt;= 10.0)</code> ?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 1, "creation_date": 1537169786, "post_id": 52361957, "comment_id": 91669824, "body": "Could you please <a href=\"https://stackoverflow.com/posts/52361957/edit\">edit your question</a> to improve the indentation? Good indentation makes code far easier to understand. And if you&#39;re asking a large group of strangers to read your code, it&#39;s polite to make that as easy as possible."}], "answers": [{"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1537170012, "creation_date": 1537170012, "answer_id": 52362928, "question_id": 52361957, "link": "https://stackoverflow.com/questions/52361957/no-output-from-perl-script/52362928#52362928", "title": "No output from Perl script", "body": "<p>Your code does this:</p>\n\n<pre><code>$dihed=150.0;\nwhile ($dihed &lt;= 10.0) {\n  $dihed -= $decr;\n  ...\n}\n</code></pre>\n\n<p>On the first iteration of your <code>while</code> loop, the Boolean condition fails (as 150.0 is not less than or equal to 10.0). So no code inside the <code>while</code> loop ever gets executed.</p>\n\n<p>Perhaps your Boolean condition should have been <code>$dihed &gt;= 10.0</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 1, "last_activity_date": 1537176054, "last_edit_date": 1537176054, "creation_date": 1537174901, "answer_id": 52364140, "question_id": 52361957, "link": "https://stackoverflow.com/questions/52361957/no-output-from-perl-script/52364140#52364140", "title": "No output from Perl script", "body": "\n\n<p>The reason your code isn't working is that your test has the wrong sense: you are starting at 150 and then looping while the value is <em>less than or equal to</em> 10, which is never</p>\n\n<p>It is also a bad idea to repeatedly add floating point values, as the inaccuracies will mount up and result in an error in the output. In this case you are using 0.25, which just happens to be representable accurately as a binary fraction, but in case you ever want a different increment you should know that it is best to use <em>integers</em> to count and convert them to floating point one by one</p>\n\n<p>Finally, you are asking for no decimal places at all on the integers, but two on the fractional values. This may not be absolutely necessary, but it's best to use an explicit format string to avoid some surprises</p>\n\n<p>Here's how I would write your code</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\n\nmy $filename = 'report-4.5-3.txt';\n\nopen my $out_fh, '&gt;', $filename\n        or die qq{Unable to open \"$filename\" for output: $!};\n\nfor ( my $d = 150 * 4; $d &gt;= 10 * 4; --$d ) {\n\n    my $fmt = $d % 4 ? '%.2f' : '%.0f';\n    my $dihed = sprintf $fmt, $d / 4;\n\n    print $out_fh \"\\nYOYO -O -i min_mdin.${dihed} -o min_mdout.${dihed}\\n\";\n}\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>YOYO -O -i min_mdin.150 -o min_mdout.150\n\nYOYO -O -i min_mdin.149.75 -o min_mdout.149.75\n\nYOYO -O -i min_mdin.149.50 -o min_mdout.149.50\n\nYOYO -O -i min_mdin.149.25 -o min_mdout.149.25\n\nYOYO -O -i min_mdin.149 -o min_mdout.149\n\n...\n\nYOYO -O -i min_mdin.11 -o min_mdout.11\n\nYOYO -O -i min_mdin.10.75 -o min_mdout.10.75\n\nYOYO -O -i min_mdin.10.50 -o min_mdout.10.50\n\nYOYO -O -i min_mdin.10.25 -o min_mdout.10.25\n\nYOYO -O -i min_mdin.10 -o min_mdout.10\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8171849, "user_type": "registered", "profile_image": "https://graph.facebook.com/2269780149914388/picture?type=large", "display_name": "sacky0003", "link": "https://stackoverflow.com/users/8171849/sacky0003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 52364140, "answer_count": 2, "score": 0, "last_activity_date": 1537176054, "creation_date": 1537166075, "last_edit_date": 1537174997, "question_id": 52361957, "link": "https://stackoverflow.com/questions/52361957/no-output-from-perl-script", "title": "No output from Perl script", "body": "<p>I want to write a file containing these lines in Perl</p>\n\n<pre><code>YOYO -O -i prod_mdin.150 -o prod_mdout.150  \n\nYOYO -O -i prod_mdin.149.75 -o prod_mdout.149.75  \n\n...\n\nYOYO -O -i prod_mdin.10 -o prod_mdout.10\n</code></pre>\n\n<h3>Perl</h3>\n\n<pre><code>print \"SrepAring inpCKut filYes\\n\";\n\n$decr = 0.25;\n\nmy $filename = 'report-4.5-3.txt';\n\nopen( my $BATCHFILE, '&gt;', \"$filename\" );\n\n$dihed = 150.0;\n\nwhile ( $dihed &lt;= 10.0 ) {\n\n    $dihed -= $decr;\n\n    print $BATCHFILE \"\nYOYO -O -i min_mdin.${dihed} -o min_mdout.${dihed} \n\"\n}\n\nprint \"done\\n\";\n\nclose( $BATCHFILE );\n</code></pre>\n"}, {"tags": ["xml", "perl", "xml-libxml"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 8795995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3664b3f2e04a8156af267c447d38029?s=128&d=identicon&r=PG&f=1", "display_name": "andor", "link": "https://stackoverflow.com/users/8795995/andor"}, "edited": false, "score": 0, "creation_date": 1537175201, "post_id": 52363249, "comment_id": 91672572, "body": "I could not fully understand what you are saying. I can see some validators online which do not throw an error for the above xml but some of them throw."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 75, "user_id": 8795995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3664b3f2e04a8156af267c447d38029?s=128&d=identicon&r=PG&f=1", "display_name": "andor", "link": "https://stackoverflow.com/users/8795995/andor"}, "edited": false, "score": 0, "creation_date": 1537176235, "post_id": 52363249, "comment_id": 91673150, "body": "@andor: The specification for XML 1.0 allows <i>a URI reference</i> and no more. The validators you have found that allow your XML are incomplete and don&#39;t verify the namespace properly. What is your meaning when passing two URIs? A namespace abbreviation cannot stand for two namespaces at once!"}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 1, "last_activity_date": 1537171396, "creation_date": 1537171396, "answer_id": 52363249, "question_id": 52361844, "link": "https://stackoverflow.com/questions/52361844/namespace-error-while-parsing-xml-namespace-with-multiple-uris-in-perl/52363249#52363249", "title": "Namespace error while parsing xml namespace with multiple URIs in perl", "body": "<p>Supplying multiple URIs for an XML 1.0 namespace name isn't legitimate syntax. It is hard to imagine what you may mean by it</p>\n\n<p><a href=\"https://www.w3.org/TR/xml-names/\" rel=\"nofollow noreferrer\">Namespaces in XML 1.0 (Third Edition)</a> says this</p>\n\n<blockquote>\n  <p>The attribute's normalized value <em>MUST</em> be either a URI reference \u2014 the namespace name identifying the namespace \u2014 or an empty string</p>\n</blockquote>\n"}], "owner": {"reputation": 75, "user_id": 8795995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3664b3f2e04a8156af267c447d38029?s=128&d=identicon&r=PG&f=1", "display_name": "andor", "link": "https://stackoverflow.com/users/8795995/andor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 52363249, "answer_count": 1, "score": 0, "last_activity_date": 1537171396, "creation_date": 1537165442, "last_edit_date": 1537170984, "question_id": 52361844, "link": "https://stackoverflow.com/questions/52361844/namespace-error-while-parsing-xml-namespace-with-multiple-uris-in-perl", "title": "Namespace error while parsing xml namespace with multiple URIs in perl", "body": "<pre><code>use XML::LibXML;\n\nuse strict;\nuse warnings;\n\nmy $parser = XML::LibXML-&gt;new();\nmy $xmldata = '&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;Research xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns=\"http://www.rixml.org/2013/2/RIXML\" xmlns:schemaLocation=\"http://www.rixml.org/2013/2/RIXML http://www.rixml.org/assets/documents/schemas/RIXML-2_4.xsd\" xmlns:rixmldt=\"http://www.rixml.org/2013/2/RIXML-datatypes http://www.rixml.org/assets/documents/schemas/RIXML-datatypes-2_4.xsd\" language=\"eng\"&gt;&lt;/Research&gt;';\n\nmy $respDom = $parser-&gt;parse_string($xmldata);\nprint $respDom;\n</code></pre>\n\n<p>This is the error I get. Does <code>XML::LibXML</code> not support multiple URIs in namespaces?</p>\n\n<pre><code>Error(s), warning(s):\n:1: namespace error : xmlns:schemaLocation: 'http://www.rixml.org/2013/2/RIXML http://www.rixml.org/assets/documents/schemas/RIXML-2_4.xsd' is not a valid URI\nml.org/2013/2/RIXML http://www.rixml.org/assets/documents/schemas/RIXML-2_4.xsd\"\n                                                                                ^\n:1: namespace error : xmlns:rixmldt: 'http://www.rixml.org/2013/2/RIXML-datatypes http://www.rixml.org/assets/documents/schemas/RIXML-datatypes-2_4.xsd' is not a valid URI\ndatatypes http://www.rixml.org/assets/documents/schemas/RIXML-datatypes-2_4.xsd\"\n                                                                                ^\n</code></pre>\n\n<h3>XML reformatted</h3>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Research\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n    xmlns=\"http://www.rixml.org/2013/2/RIXML\"\n    xmlns:schemaLocation=\"http://www.rixml.org/2013/2/RIXML http://www.rixml.org/assets/documents/schemas/RIXML-2_4.xsd\"\n    xmlns:rixmldt=\"http://www.rixml.org/2013/2/RIXML-datatypes http://www.rixml.org/assets/documents/schemas/RIXML-datatypes-2_4.xsd\"\n    language=\"eng\"&gt;\n&lt;/Research&gt;\n</code></pre>\n"}, {"tags": ["regex", "perl", "regex-lookarounds", "regex-group"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1537127313, "post_id": 52357633, "comment_id": 91660124, "body": "<code>$re</code> stringifies to <code>(?^u:(foo|bar))</code> which similar to <code>(?u-imnsx:(foo|bar))</code>; it sets the flags to those used when the pattern was compiled, and thus turning <code>&#47;n</code> off."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537127455, "post_id": 52357633, "comment_id": 91660163, "body": "Seems like it works if you avoid using <code>qr</code> on <code>$re</code>, i.e <code>$re = &quot;(foo|bar)&quot;</code>"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 1, "creation_date": 1537129083, "post_id": 52357633, "comment_id": 91660587, "body": "I must be missing something but why doesn&#39;t <code>&#47;foo|(bar)&#47;</code> go?  Like <code>perl -E&#39;$s=shift||q(foobar); $re = qr{foo|(bar)}; $s =~ &#47;$re$re&#47;; say &quot;$1 -- $2&quot;&#39;</code> (with optional input)"}, {"owner": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 0, "creation_date": 1537205487, "post_id": 52357633, "comment_id": 91690595, "body": "<code>\\K</code> leaves stuff matched left of it out of <code>$&amp;</code>, but not out of <code>$1</code> and <code>$2</code>."}], "answers": [{"tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 2, "last_activity_date": 1537127176, "creation_date": 1537127176, "answer_id": 52357810, "question_id": 52357633, "link": "https://stackoverflow.com/questions/52357633/disable-capturing-in-already-compiled-regex-e-g-perl-5-22-n-modifier/52357810#52357810", "title": "Disable capturing in already-compiled regex? (e.g., Perl 5.22+, /n modifier)", "body": "<p>Well, I found a workaround, but it's certainly not an answer!  I'm posting it here anyway, in case it helps anyone else.  In my particular use case, the match is split in two.  Therefore, using <code>/g</code> on the first match and <code>\\G</code> in the second match does the trick.  Example:</p>\n\n<pre><code>$ perl -E '\n    my $re=qr/(foo|bar)/;\n    my $str = \"foo bar\";\n\n    $str =~ m/$re/g;         # Match `foo`, and set `pos` (because of /g)\n    say \"Expecting foo: \", $1;\n\n    $str =~ m/\\G.+$re/g;     # \\G =&gt; skip past `foo`, and check ` bar` against `.+$re`\n    say \"Hoping for bar: \";\n'\nExpecting foo: foo\nHoping for bar: bar          # Hooray!\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1537356213, "post_id": 52357855, "comment_id": 91753121, "body": "Thanks for the explanation of the problem, and the first two solution options.  <code>qq&#47;&#47;</code> would work in my use case.  Would you please add some explanation and an SSCCE of the third option?  Based on perlre&#39;s discussion of DEFINE (which I&#39;ve never used before), shouldn&#39;t the first line of the third pattern have a <code>(?&amp;foo_or_bar)</code> in it somewhere?"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 3, "last_activity_date": 1537356362, "last_edit_date": 1537356362, "creation_date": 1537127501, "answer_id": 52357855, "question_id": 52357633, "link": "https://stackoverflow.com/questions/52357633/disable-capturing-in-already-compiled-regex-e-g-perl-5-22-n-modifier/52357855#52357855", "title": "Disable capturing in already-compiled regex? (e.g., Perl 5.22+, /n modifier)", "body": "<p>The stringification of <code>$re</code> is <code>(?^u:(foo|bar))</code>. In other words, it sets the flags to those used when the pattern was compiled, and thus turning <code>/n</code> off.</p>\n\n<p>You could use any of the following:</p>\n\n<pre><code>my $re = qq/(foo|bar)/;    # Note: Gotta escape `\\` that are part of regex escapes.\n/(?n:$re)$re/\n</code></pre>\n\n<p>(example of escapes: <code>qr{(fo\\w|ba\\w)}</code> becomes <code>qq{(fo\\\\w|ba\\\\w)}</code> when using this technique.)</p>\n\n<pre><code>my $re = qr/foo|bar/;\n/$re($re)/\n</code></pre>\n\n<p>&#x20;</p>\n\n<pre><code>my $re = qr/\n   (?&lt;foo_or_bar&gt;) ((?&lt;foo_or_bar&gt;))\n   (?(DEFINE)\n      (?&lt;foo_or_bar&gt;foo|bar)\n   )\n/x;\n/$re/\n</code></pre>\n"}], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1537356362, "creation_date": 1537125638, "last_edit_date": 1537131435, "question_id": 52357633, "link": "https://stackoverflow.com/questions/52357633/disable-capturing-in-already-compiled-regex-e-g-perl-5-22-n-modifier", "title": "Disable capturing in already-compiled regex? (e.g., Perl 5.22+, /n modifier)", "body": "<p><strong>Environment:</strong> Perl 5.26.2 x64 on Cygwin x64.</p>\n\n<p><strong>Question:</strong> after <code>my $re = qr/...(capturing group).../</code>, is there any way to use <code>$re</code> without capturing into its capturing groups?</p>\n\n<p><strong>X:</strong> I am matching lines that could either be:</p>\n\n<pre><code>#define FOO(X,Y) SomeComplicatedStuff\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#define FOO(X,Y) BAR(X,Y)\n</code></pre>\n\n<p>I have a compiled regex <code>$re</code> that matches <code>FOO(X,Y)</code> and includes numbered capturing groups to split the match into <code>FOO</code> and <code>X,Y</code>.  I would like to match lines of the second form without having to define a separate regex, e.g., using <code>m/$re.+$re/</code>.  This works fine, but I get all the capturing groups of <code>FOO</code> when I all I really want are the groups of <code>BAR</code>.</p>\n\n<p><strong>Y:</strong> I thought I could do this in 5.22+ with the <code>/n</code> modifier, but I can't get it to work.  MCVE:</p>\n\n<pre><code>$ perl -E 'my $re=qr/(foo|bar)/; \"foobar\" =~ m/$re$re/; say $1, \" \", $2;'\nfoo bar     # as expected\n\n$ perl -E 'my $re=qr/(foo|bar)/; \"foobar\" =~ m/(?n:$re)$re/; say $1, \" \", $2;'\n            # I think this should turn off      ^^^  capturing of `foo`\nfoo bar     # oops - I was hoping for `bar`\n\n$ perl -E 'my $re=qr/(foo|bar)/; \"foobar\" =~ m/(?n:(foo|bar))$re/; say $1, \" \", $2;'\nbar         # This works, but I had to inline $re within (?n:...).\n</code></pre>\n\n<p><strong>Note:</strong> I also tried <code>\\K</code>:</p>\n\n<pre><code>$ perl -E 'my $re=qr/(foo|bar)/; \"foobar\" =~ m/$re\\K$re/; say $1, \" \", $2, \" \", $&amp;;'\nfoo bar bar      # was hoping for `bar  bar`\n</code></pre>\n\n<p><strong>Edit</strong> Forgot to mention &mdash; I did look at <a href=\"https://stackoverflow.com/q/3552850/2877364\">this related question</a>, but it's not the same problem statement.</p>\n"}, {"tags": ["mysql", "perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 3, "creation_date": 1537116093, "post_id": 52355468, "comment_id": 91657031, "body": "Why do you assign <code>( $variable1, $variable2, $variable3 ) = @$names</code> without using those variables?"}], "answers": [{"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": false, "score": 2, "last_activity_date": 1537112488, "creation_date": 1537112488, "answer_id": 52355739, "question_id": 52355468, "link": "https://stackoverflow.com/questions/52355468/using-templatetoolkit-with-array-data-from-database/52355739#52355739", "title": "Using Template::Toolkit with array data from database", "body": "<p>fetchall_arrayref returns a reference to an array that has an element for each row returned by the query.  Those elements are references to arrays with an element per column.</p>\n\n<p>You are missing code to loop over the rows returned.</p>\n"}, {"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 1, "last_activity_date": 1537194516, "last_edit_date": 1537194516, "creation_date": 1537170632, "answer_id": 52363078, "question_id": 52355468, "link": "https://stackoverflow.com/questions/52355468/using-templatetoolkit-with-array-data-from-database/52363078#52363078", "title": "Using Template::Toolkit with array data from database", "body": "<p>This is weird:</p>\n\n<pre><code>{ list =&gt; \\@$names }\n</code></pre>\n\n<p><code>$names</code> is a reference to an array. You deference it (<code>@$names</code>) and then take another reference to the dereferenced array (<code>\\@$names</code>). You could get exactly the same result with:</p>\n\n<pre><code>{ list =&gt; $names }\n</code></pre>\n\n<p>But none of that solves your problem. You're calling <code>fetchall_arrayref()</code> and that returns an array reference where each element of the array is a reference to another array. In effect, it's a two-dimensional array. The outer array is for the rows returned from your database query and the inner arrays are for the individual fields in each row.</p>\n\n<p>When you see a value like <code>ARRAY(0x2030674)</code>, you should realise that you're displaying an array reference and you need to do one more level of dereferencing.</p>\n\n<p>Your template code needs to look something like this:</p>\n\n<pre><code>[% FOREACH row IN LIST -%]\n&lt;p&gt;Start of new record:&lt;/p&gt;\n&lt;ul&gt;\n[%   FOREACH field IN row -%]\n  &lt;li&gt;[% field %]&lt;/li&gt;\n[%   END -%]\n&lt;/ul&gt;\n[% END %]\n</code></pre>\n\n<p><strong>Update:</strong> You say:</p>\n\n<blockquote>\n  <p>When I run I get that error.</p>\n</blockquote>\n\n<p>But there's no error there. It's not even a warning. It's just data that you didn't quite understand :-)</p>\n"}], "owner": {"reputation": 15, "user_id": 10360970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65435edcf73c59f8027beae1a6262c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Lee", "link": "https://stackoverflow.com/users/10360970/jose-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537194516, "creation_date": 1537110681, "last_edit_date": 1537115822, "question_id": 52355468, "link": "https://stackoverflow.com/questions/52355468/using-templatetoolkit-with-array-data-from-database", "title": "Using Template::Toolkit with array data from database", "body": "<p>I don't know why my script works when I declare arrays in my script, but doesn't work when I try to get array data from a database.</p>\n\n<h3>Perl</h3>\n\n<pre><code>use Template;\n\nmy $template = Template-&gt;new;\n\nif ( $info ) {\n\n    my $select = $DBH-&gt;prepare(\"SELECT FOO, BAR, MOO FROM tble WHERE CONCAT(FOO, ', ', BAR, ', ', MOO) LIKE ?\");\n    $select-&gt;execute('%' . $info . '%');\n    $names = $select-&gt;fetchall_arrayref();\n    foreach $names ( @$names ) {\n        ( $variable1, $variable2, $variable3 ) = @$names;\n    }\n}\n\nmy $templ = &lt;&lt;START_HTML;\n&lt;!DOCTYPE html\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\n+\" /&gt;\n&lt;title&gt;Untitled Document&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n[% FOREACH name IN list %]\n    &lt;li&gt;\n      &lt;div class='inforno'&gt;\n        &lt;img src='inforno'&gt;\n      &lt;/div&gt;\n      &lt;div class='inforno'&gt;\n        &lt;a href='#' class='inforno'&gt;[% name %]&lt;/a&gt;\n      &lt;/div&gt;\n      &lt;span class='inforno'&gt;\n        &lt;a href='#' class='inforno'&gt;Edit user&lt;/a&gt;\n      &lt;/span&gt;\n    &lt;/li&gt;\n    [% END %]\n\n&lt;/body&gt;\n    &lt;/html&gt;\n    START_HTML\n\n$template-&gt;process(\\$templ, { list =&gt; \\@$names })\n        or die $template-&gt;error;\n</code></pre>\n\n<h3>output</h3>\n\n<pre><code>    ARRAY(0x2030674)\n    ARRAY(0x2030634)\n    ARRAY(0x2030618)\n</code></pre>\n\n<p>When I run I get that error. I want to get the array data from database.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537091349, "post_id": 52352816, "comment_id": 91650689, "body": "Please show the code that you need us to help you with: we can&#39;t do anything without seeing it. Are there really blank lines in the data file? And are there really column headers <code>Col1</code>, <code>Col2</code> etc?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1537091498, "post_id": 52352816, "comment_id": 91650731, "body": "One way: Use <a href=\"https://metacpan.org/pod/DBD::CSV\" rel=\"nofollow noreferrer\">DBD::CSV</a> to treat the files as tables in a database, and join them with the appropriate SQL statement."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1537099466, "post_id": 52352816, "comment_id": 91652544, "body": "@Shawn: So write up an answer using that module."}, {"owner": {"reputation": 147, "user_id": 9426481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d9e5d67bf0ef6f703fffa820ba1a5e?s=128&d=identicon&r=PG&f=1", "display_name": "Victor.H", "link": "https://stackoverflow.com/users/9426481/victor-h"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537142875, "post_id": 52352816, "comment_id": 91663217, "body": "@Borodin: yes, there are blank lines in the data and all datasets have header."}], "answers": [{"tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1537238008, "creation_date": 1537238008, "answer_id": 52378089, "question_id": 52352816, "link": "https://stackoverflow.com/questions/52352816/combine-two-tab-separated-text-files/52378089#52378089", "title": "Combine two tab-separated text files", "body": "<p>Your join critera is kind of confusing file2.col2 has nothing in common with file1.col2 or file1.col3... did you mean file2.col3? And you don't have any sample output so we know exactly what you're looking for.</p>\n\n<p>But I think this'll work. It relies on the aforementioned <a href=\"https://metacpan.org/pod/DBD::CSV\" rel=\"nofollow noreferrer\">DBD::CSV</a> module for reading your tsv files and joining them, and <a href=\"https://metacpan.org/pod/DBIx::TSV\" rel=\"nofollow noreferrer\">DBIx::TSV</a> for formatting the output. Both are available through your favorite CPAN client.</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse DBI;\nuse DBIx::TSV;\n\nmy $dbh = DBI-&gt;connect(\"dbi:CSV:\", undef, undef,\n                       {csv_tables =&gt; {\n                                       \"file1\" =&gt; { f_file =&gt; \"file1.tsv\" },\n                                       \"file2\" =&gt; { f_file =&gt; \"file2.tsv\" }\n                                      },\n                        csv_sep_char =&gt; \"\\t\"\n                       }) or die $DBI::errstr;\n\nprint $dbh-&gt;selectall_tsv(&lt;&lt;EOQ);\nSELECT f1.col2 AS Col1, f1.col3 AS Col2, f1.col4 AS Col3, f2.col4 AS Col4, f2.col5 AS Col5\nFROM file1 AS f1\n   , file2 AS f2\nWHERE f1.col2 = f2.col1 OR f1.col2 = f2.col3 OR f1.col3 = f2.col1 OR f1.col3 = f2.col3\nEOQ\n$dbh-&gt;disconnect;\n</code></pre>\n\n<p>which prints out</p>\n\n<pre><code>Col1    Col2    Col3    Col4    Col5\nNH1 NH1 Unknown Unknown 1\nNH2 NH2 Unknown Unknown 1\nBU51    BU51    Unknown Unknown 1\nBU52    BU52    Unknown Unknown 1\n</code></pre>\n\n<p>(SO formatting does not play well with tabs)</p>\n\n<p>There are other ways of doing this, I'm sure, but when you start talking about joining lines of different files based on common fields, and then only displaying certain fields... that just screams relational data and SQL is my usual way of handling it even without an actual database.</p>\n"}], "owner": {"reputation": 147, "user_id": 9426481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d9e5d67bf0ef6f703fffa820ba1a5e?s=128&d=identicon&r=PG&f=1", "display_name": "Victor.H", "link": "https://stackoverflow.com/users/9426481/victor-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 52378089, "answer_count": 1, "score": -1, "last_activity_date": 1537238008, "creation_date": 1537090742, "last_edit_date": 1537142487, "question_id": 52352816, "link": "https://stackoverflow.com/questions/52352816/combine-two-tab-separated-text-files", "title": "Combine two tab-separated text files", "body": "<p>I have two tab-separated with header text file.</p>\n\n<p>File1 has 11 columns</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Col1    Col2    Col3    Col4    Col5    Col6    Col7    Col8    Col9    Col10   Col1\n\n1   NH1 NH1 Unknown 149578  B2                  202410200023_R02C02\n\n2   NH2 NH2 Unknown 149578  A4                  202410200023_R04C01\n\n10  NH10    NH10    Unknown 149578  A1                  202410200023_R01C01\n\n11  BU51    BU51    Unknown 149578  B3                  202410200023_R03C02\n\n12  BU52    BU52    Unknown 149578  A6                  202410200023_R06C01\n</code></pre>\n\n<p>file2 has 4, 5 or more columns. </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Col1    Col2    Col3    Col4    Col5\n\nBU51    149578  BU51    Unknown 1\n\nBU52    149578  BU52    Unknown 1\n\nNH1 149578  NH1 Unknown 1\n\nNH2 149578  NH2 Unknown 1\n</code></pre>\n\n<p>I try to make a output with column 2 to 4 from file 1 and column 4 and 5 from file2. But the col2 or col3 from file1 need to match with col1 or col2 from file2. The columns of output may have new locations. Such as column2 from file1 may be located at column1 in output </p>\n\n<p>I try to find the answer from <a href=\"https://stackoverflow.com/questions/28436267/how-to-compare-and-merge-multiple-files\">How to compare and merge multiple files?\n</a>\nI am not sure why the line <code>foreach my $key (keys %ref){ push( @{$ref{$key} }, $current{key}}\n</code>can not work well.</p>\n"}, {"tags": ["bash", "perl"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1537045201, "post_id": 52348770, "comment_id": 91642993, "body": "What is the purpose of the command list file?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10368967"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1537048154, "post_id": 52348770, "comment_id": 91643564, "body": "To have a set of commands for each category - routers checks , switch checks , WLC checks etc . This was my first thought - to go with external command list ."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1537049182, "post_id": 52348770, "comment_id": 91643745, "body": "<code>File::Slurp</code> has issues and <a href=\"http://blogs.perl.org/users/leon_timmermans/2015/08/fileslurp-is-broken-and-wrong.html\" rel=\"nofollow noreferrer\">should be avoided</a>, btw. Alternatives include <a href=\"https://metacpan.org/pod/File::Slurper\" rel=\"nofollow noreferrer\">File::Slurper</a> (Or in this case just reading the file a line at a time like normal)"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1537049735, "post_id": 52348770, "comment_id": 91643859, "body": "The <a href=\"http://perldoc.perl.org/functions/open.html\" rel=\"nofollow noreferrer\">documentation for open()</a> has examples for how to capture the output from running a program."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10368967"}, "edited": false, "score": 0, "creation_date": 1537087524, "post_id": 52348770, "comment_id": 91649882, "body": "&quot;sh running-config &quot; is a command displaying the full host configuration . It provides a very long output of the different settings and parameters of a device. My question is how do I set a parser to go over this output and search for some key elements of interest ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10368967"}, "edited": false, "score": 0, "creation_date": 1537087610, "post_id": 52348770, "comment_id": 91649904, "body": "Here is the login in my &quot;start&quot;  print &quot;\\nEnter switch list filenane: &quot;; my $input = &lt;STDIN&gt;;                         chomp($input); my @hostfile = read_file($input,chomp =&gt; 1);        my $arrSize = @hostfile; my $user = &quot;username&quot;;  print &quot;\\nEnter ssh password: &quot;; my $password = &lt;STDIN&gt;;        chomp($password); print &quot;\\nEnter enable password: &quot;; my $secret = &lt;STDIN&gt;;    chomp($secret);"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1537091351, "post_id": 52348770, "comment_id": 91650691, "body": "&quot;<i>How would I [...] parse through [text] with conditions?</i>&quot; is super vague. There are multiple decades of research into parser theory. Without a concrete problem to solve, I vote to close this question as &quot;too broad&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 1, "last_activity_date": 1537093592, "last_edit_date": 1537093592, "creation_date": 1537091105, "answer_id": 52352860, "question_id": 52348770, "link": "https://stackoverflow.com/questions/52348770/configuration-verification/52352860#52352860", "title": "Configuration verification", "body": "<p>This is a very broad question, and it is unclear exactly what is puzzling you</p>\n\n<p>The documentation for\n<a href=\"https://metacpan.org/pod/Net::SSH2\" rel=\"nofollow noreferrer\"><code>Net::SSH2</code></a>\nand\n<a href=\"https://metacpan.org/pod/Net::SSH2::Channel\" rel=\"nofollow noreferrer\"><code>Net::SSH2::Channel</code></a>\ndescribes clearly how to open a <em>channel</em>, send commands to it, and receive the response</p>\n\n<p>You ask how you could store the results of the command in a variable, but it would be very awkward to do anything else. Again, the documentation describes this clearly</p>\n\n<p>I suggest that you try writing some working code and experiment with it. It will be much easier to help you when you have a <em>specific</em> question</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10368967"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1537093592, "creation_date": 1537044718, "last_edit_date": 1537090343, "question_id": 52348770, "link": "https://stackoverflow.com/questions/52348770/configuration-verification", "title": "Configuration verification", "body": "<ul>\n<li><code>ssh</code> to an IP supplied via user input</li>\n<li>Inject <code>show running-config</code> command</li>\n<li>Search the output of the command and look for specific parameters like ports, QoS, VTY lines, SMTP settings, IP helpers etc.</li>\n<li>Output only if the predefined parameters are not in place</li>\n</ul>\n\n<p>If I store the output of the <code>ssh</code> run in a variable, is there a method I can use for parsing through it and just go with endless <code>if</code>, <code>elsif</code>, and <code>else</code> statements? How would that look?</p>\n\n<p>It can be in Python bash or Perl, doesn't matter to me really but I don't know how to structure the thing and then fill in the gaps and expand the script.</p>\n\n<p>Here's where I imagine starting from</p>\n\n<pre><code>use Net::SSH2 \nuse File::Slurp;\n\nprint \"\\nEnter command list filename: \"; \nmy $commandlist = &lt;STDIN&gt;; \nchomp($commandlist);\n\nmy @commandfile = read_file($commandlist, chomp =&gt; 1); \nmy $commandsize = @commandfile; \n</code></pre>\n\n<p>How would I store the output of the commands in a variable or a temporary file and parse through it with conditions? </p>\n"}, {"tags": ["regex", "perl", "newline"], "comments": [{"owner": {"reputation": 5701, "user_id": 35812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e663162cefd6ac833e0555933b8583f?s=128&d=identicon&r=PG", "display_name": "Chris Charley", "link": "https://stackoverflow.com/users/35812/chris-charley"}, "edited": false, "score": 1, "creation_date": 1537034282, "post_id": 52347330, "comment_id": 91640218, "body": "<code>[^&#47;]</code>will match non slash (including newlines). Maybe try <code>[^\\n&#47;]</code>"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537041560, "post_id": 52347330, "comment_id": 91642134, "body": "If you&#39;re matching a hex string then it would be better to use <code>[[:xdigit:]]</code> rather than <code>[[:alnum:]]</code>. Alternatively, the Unicode property <code>\\p{Hex}</code> is more concise and more modern."}, {"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "edited": false, "score": 0, "creation_date": 1537043984, "post_id": 52347330, "comment_id": 91642729, "body": "I think your work (&quot;your&quot; referring to the OP&#39;s) on solving this problem, especially your strategy for getting the filename, is ingenious! I will combine it with the answers given. It will be better than my usual: <code>s|^.*&#47;(.*)$|$1|</code> approach (which must be used with the <code>-l</code> switch, as discussed by @Shawn, as well as the <code>-p</code> switch you&#39;ve used). It&#39;ll be <code>perl -lpe &#39;s|([^&#47;])$|$1|</code> for me to find filenames being the last entry on a line. I love it!"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1537048472, "post_id": 52347330, "comment_id": 91643623, "body": "One other suggestion: Use <code>[:xdigit:]</code> instead of <code>[:alnum:]</code>, to help with the (admittedly unlikely) case of getting a line that doesn&#39;t start with a valid hash."}, {"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "reply_to_user": {"reputation": 5701, "user_id": 35812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e663162cefd6ac833e0555933b8583f?s=128&d=identicon&r=PG", "display_name": "Chris Charley", "link": "https://stackoverflow.com/users/35812/chris-charley"}, "edited": false, "score": 0, "creation_date": 1537051080, "post_id": 52347330, "comment_id": 91644124, "body": "@ChrisCharley, it&#39;s very correct that the <code>[^&#47;]</code> will match newlines. Am I correct in surmising that it&#39;s actually the plus after, i.e. <code>&lt;code&gt;</code> [^/] <b>+</b> <code>&lt;&#47;code&gt;</code>, that causes this behavior to be a problem?"}], "answers": [{"comments": [{"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "edited": false, "score": 0, "creation_date": 1537044339, "post_id": 52347408, "comment_id": 91642795, "body": "So, basically, you&#39;re saying that all @raph82 was missing was an <code>-l</code> flag to go along with the <code>-pe</code>, then the goal would be accomplished? It worked for me when I tried it. <code>$ perl -lpe &#39;s|^([[:alnum:]]+).*?([^&#47;]+)$|$2 $1|&#39; DCIM.md5</code> gave me the desired output."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "edited": false, "score": 1, "creation_date": 1537046282, "post_id": 52347408, "comment_id": 91643194, "body": "@bballdave025 Yup. No need to muck with the regular expression and make it even more cryptic and linenoisey. Even if it is just for a one-liner."}, {"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "edited": false, "score": 0, "creation_date": 1537047236, "post_id": 52347408, "comment_id": 91643370, "body": "I like that approach. Good &#39;on ya."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 5, "last_activity_date": 1537034237, "creation_date": 1537034237, "answer_id": 52347408, "question_id": 52347330, "link": "https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline/52347408#52347408", "title": "s/// returns out of place newline", "body": "<p><code>[^/]+</code> matches newlines, so the ones in your input are part of <code>$2</code>, which gets put first in your transformed <code>$_</code> (And there's no newline in <code>$1</code> so there's no newline at the end of <code>$_</code>...)</p>\n\n<p>Solution: Read up on the <code>-l</code> option from <a href=\"http://perldoc.perl.org/perlrun.html\" rel=\"noreferrer\">perlrun</a>. In particular:</p>\n\n<blockquote>\n  <p>-l[octnum]\n  enables automatic line-ending processing. It has two separate effects. First, it automatically chomps $/ (the input record separator) when used with -n or -p. Second, it assigns $\\ (the output record separator) to have the value of octnum so that any print statements will have that separator added back on. If octnum is omitted, sets $\\ to the current value of $/ . </p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "edited": false, "score": 0, "creation_date": 1537048401, "post_id": 52347417, "comment_id": 91643609, "body": "Why was this down-voted? It gives precisely the output desired by the OP. In addition, it gives executable code, which is always good to have in an answer."}], "tags": [], "owner": {"reputation": 957, "user_id": 9632774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zP3nO.png?s=128&g=1", "display_name": "CrafterKolyan", "link": "https://stackoverflow.com/users/9632774/crafterkolyan"}, "is_accepted": false, "score": 2, "last_activity_date": 1537034324, "creation_date": 1537034324, "answer_id": 52347417, "question_id": 52347330, "link": "https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline/52347417#52347417", "title": "s/// returns out of place newline", "body": "<p>use <code>[^/\\n]</code> instead of <code>[^/]</code>:</p>\n\n<p><code>perl -pe 's|^([[:alnum:]]+).*?([^/\\n]+)$|$2 $1|' DCIM.md5</code></p>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 2, "last_activity_date": 1537035398, "last_edit_date": 1537035398, "creation_date": 1537034939, "answer_id": 52347513, "question_id": 52347330, "link": "https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline/52347513#52347513", "title": "s/// returns out of place newline", "body": "\n\n<p>Doing a substitution leaves you having to write a regex pattern that matches everything you <em>don't</em> want as well as everything you do. It's usually much better to match just the parts you need and build another string from them</p>\n\n<p>Like this</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>for ( &lt;&gt; ) {\n    die unless m&lt; (\\w++) .*? ([^/\\s]+) \\s* \\z &gt;x;\n    print \"$2 $1\\n\";\n}\n</code></pre>\n\n<p>or if you <em>must</em> have a one-liner</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>perl -ne 'die unless m&lt; (\\w++) .*? ([^/\\s]+) \\s*\\z &gt;x; print \"$2 $1\\n\";' myfile.md5\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>IMG_20150201_160548.jpg e26ff03dc1bac80226e200c0c63d17a2\nIMG_20150204_190528.jpg 01f92572e4c6f2ea42bd904497e4f939\nIMG_20151011_193008.jpg afce027c977944188b4f97c5dd1bd101\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 6505499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9632fb64ecb7a04e5f65d92a4063288?s=128&d=identicon&r=PG&f=1", "display_name": "bballdave025", "link": "https://stackoverflow.com/users/6505499/bballdave025"}, "is_accepted": false, "score": 3, "last_activity_date": 1537052299, "last_edit_date": 1537052299, "creation_date": 1537050534, "answer_id": 52349408, "question_id": 52347330, "link": "https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline/52349408#52349408", "title": "s/// returns out of place newline", "body": "<p>Alternate solution, which uses lots of concepts from other answers, and comments ...</p>\n\n<pre><code>$ perl -pe 's|(\\p{hex}+).*?([^/]+?)$|$2 $1|' DCIM.md5\n</code></pre>\n\n<p>... and explanation.</p>\n\n<p>After investigating all the answers and trying to figure them out, I've decided that the base of the problem is that the <code>[^/]+</code> is <strong>greedy</strong>. Its greediness causes it to capture the newline; it ignores the <code>$</code> anchor.</p>\n\n<p>This was hard for me to figure out, since I did a lot of parsing using <code>sed</code> before using Perl, and even a greedy wildcard won't capture a newline in <code>sed</code>. Hopefully this post will help those who (being used to <code>sed</code> as I am) are also wondering (as I did) why the <code>$</code> isn't acting \"as I expect it to.\"</p>\n\n<p>We can see the \"greedy\" issue by trying what I'll post as another, alternate answer.</p>\n\n<p>Write the file:</p>\n\n<pre><code>$ cat &gt; DCIM.md5&lt;&lt;EOF\n&gt; e26ff03dc1bac80226e200c0c63d17a2  ./Path1/IMG_20150201_160548.jpg\n&gt; 01f92572e4c6f2ea42bd904497e4f939  ./Path 2/IMG_20150204_190528.jpg\n&gt; afce027c977944188b4f97c5dd1bd101  ./Path3/Path 4/IMG_20151011_193008.jpg\n&gt; EOF\n</code></pre>\n\n<p>Get rid of the greedy <code>[^/]+</code> by changing it to <code>[^/]+?</code>. Parse.</p>\n\n<pre><code>$ perl -pe 's|([[:alnum:]]+).*?([^/]+?)$|$2 $1|' DCIM.md5\nIMG_20150201_160548.jpg e26ff03dc1bac80226e200c0c63d17a2\nIMG_20150204_190528.jpg 01f92572e4c6f2ea42bd904497e4f939\nIMG_20151011_193008.jpg afce027c977944188b4f97c5dd1bd101\n</code></pre>\n\n<p>Desired output accomplished.</p>\n\n<p>The <a href=\"https://stackoverflow.com/a/52347408/6505499\">accepted answer</a>, by @Shawn, </p>\n\n<pre><code>$ perl -lpe 's|^([[:alnum:]]+).*?([^/]+)$|$2 $1|' DCIM.md5\n</code></pre>\n\n<p>basically changes the <code>$</code> anchor so as to behave the way a <code>sed</code> person would expect it to. </p>\n\n<p>The <a href=\"https://stackoverflow.com/a/52347417/6505499\">answer</a> by @CrafterKolyan takes care of the greedy <code>[^/]</code> capturing the newline by saying you can't have a forward-slash <em>or</em> a newline. This answer still needs the <code>$</code> anchor to prevent the following situation</p>\n\n<p>1) <code>.*</code> captures the empty string (<strong>0</strong> or more of any character)</p>\n\n<p>2) <code>[^/\\n]+</code> captures <code>  .</code> .</p>\n\n<p>The answer by @Borodin takes a quite different approach, but it's a great concept.</p>\n\n<p>@Borodin, in addition, made a great <a href=\"https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline/52347408?noredirect=1#comment91642134_52347330\">comment</a> that allows a more-precise/more-exact version of this answer, which is the version I put at the top of this post.</p>\n\n<p>Finally, if one wants to follow the <a href=\"https://en.wikipedia.org/wiki/There%27s_more_than_one_way_to_do_it\" rel=\"nofollow noreferrer\">Perl programming model</a>, here's another alternative.</p>\n\n<pre><code>$ perl -pe 's|([[:xdigit:]]+).*?([^/]+?)(\\n\\|\\Z)|$2 $1$3|' DCIM.md5\n</code></pre>\n\n<hr/>\n\n<p>P.S. Because <code>sed</code> isn't quite like <code>perl</code> (<a href=\"https://stackoverflow.com/a/1103177/6505499\">no non-greedy wildcards</a>,) here's a <code>sed</code> example that shows the behavior I discuss.</p>\n\n<pre><code>$ sed 's|^\\([[:alnum:]]\\+\\).*/\\([^/]\\+\\)$|\\2 \\1|' DCIM.md5\n</code></pre>\n\n<p>This is basically a \"direct translation\" of the <code>perl</code> expression <em>except</em> for the extra <code>'/'</code> before the <code>[^/]</code> stuff. I hope it will help those comparing <code>sed</code> and <code>perl</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 113885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5844b8a47a1f69cbe03bcc2af9d8eff?s=128&d=identicon&r=PG", "display_name": "raph82", "link": "https://stackoverflow.com/users/113885/raph82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 52347408, "answer_count": 4, "score": 2, "last_activity_date": 1537052299, "creation_date": 1537033629, "last_edit_date": 1537039275, "question_id": 52347330, "link": "https://stackoverflow.com/questions/52347330/s-returns-out-of-place-newline", "title": "s/// returns out of place newline", "body": "<p>I'm trying to use Perl to reorder the content of an md5 file. For each line, I want the filename without the path then the hash. The best command I've come up with is:</p>\n\n<pre><code>$ perl -pe 's|^([[:alnum:]]+).*?([^/]+)$|$2 $1|' DCIM.md5\n</code></pre>\n\n<p>The input file (<code>DCIM.md5</code>) is produced by <code>md5sum</code> on Linux. It looks like this:</p>\n\n<pre><code>e26ff03dc1bac80226e200c0c63d17a2  ./Path1/IMG_20150201_160548.jpg\n01f92572e4c6f2ea42bd904497e4f939  ./Path 2/IMG_20150204_190528.jpg\nafce027c977944188b4f97c5dd1bd101  ./Path3/Path 4/IMG_20151011_193008.jpg\n</code></pre>\n\n<ol>\n<li>The hash is matched by the first group <code>([[:alnum:]]+)</code> in the<br>\nregular expression.</li>\n<li>Then the spaces and the path to the file are<br>\nmatched by <code>.*?</code>.</li>\n<li>Then the filename is matched by <code>([^/]+)</code>.</li>\n<li>The expression is enclosed with <code>^</code> (apparently non-necessary here) \nand <code>$</code>. Without the <code>$</code>, the expression does not output what I expect.</li>\n<li>I use <code>|</code> rather than <code>/</code> as a separator to avoid escaping it in file paths.</li>\n</ol>\n\n<p>That command returns:</p>\n\n<pre><code>IMG_20150201_160548.jpg\n e26ff03dc1bac80226e200c0c63d17a2IMG_20150204_190528.jpg\n 01f92572e4c6f2ea42bd904497e4f939IMG_20151011_193008.jpg\n afce027c977944188b4f97c5dd1bd101IMG_20151011_195133.jpg\n</code></pre>\n\n<p>The matching is correct, the output sequence is correct (filename without path then hash) but the spacing is not: there's a newline after the filename. I expect it after the hash, like this:</p>\n\n<pre><code>IMG_20150201_160548.jpg e26ff03dc1bac80226e200c0c63d17a2\nIMG_20150204_190528.jpg 01f92572e4c6f2ea42bd904497e4f939\nIMG_20151011_193008.jpg afce027c977944188b4f97c5dd1bd101\n</code></pre>\n\n<p>It seems to me that my command outputs the newline character, but I don't know how to change this behavior.\nOr possibly the problem comes from the shell, not the command?</p>\n\n<p>Finally, some version information:</p>\n\n<pre><code>$ perl -version\nThis is perl 5, version 22, subversion 1 (v5.22.1) built for i686-linux-gnu-thread-multi-64int\n(with 69 registered patches, see perl -V for more detail)\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537017314, "post_id": 52344335, "comment_id": 91635919, "body": "Please show the code that you want help with, and describe exactly what problems you are having. If you have no code then your question is off topic for Stack Overflow: we will happily answer questions about <i>specific problems</i>, but if the problem is simply <i>&quot;I don&#39;t know Perl&quot;</i> then it is way too broad, and I suggest you start by exploring the excellent links in <a href=\"https://stackoverflow.com/tags/perl/info\">the Perl tag information page</a>."}, {"owner": {"reputation": 61, "user_id": 9689207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7975a29a8ce6ae6966f013697a6c8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "LowerMoon", "link": "https://stackoverflow.com/users/9689207/lowermoon"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537020967, "post_id": 52344335, "comment_id": 91636837, "body": "Will do. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537043735, "post_id": 52347583, "comment_id": 91642676, "body": "Or <code>perl -pe &#39;$_ x= not &#47;module1&#47; .. &#47;endmodule&#47;&#39;</code> if you want to be cute."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1537046391, "post_id": 52347583, "comment_id": 91643222, "body": "@melpomene Being cute is what gave perl a bad name."}], "tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": true, "score": 1, "last_activity_date": 1537035474, "creation_date": 1537035474, "answer_id": 52347583, "question_id": 52344335, "link": "https://stackoverflow.com/questions/52344335/delete-a-set-of-lines-from-a-file-in-perl/52347583#52347583", "title": "Delete a set of lines from a file in Perl", "body": "<p>I'd use sed for this, not perl:</p>\n\n<pre><code>sed -e '/module1/,/endmodule/d' input.txt\n</code></pre>\n\n<p><code>X,Y</code> specifies a range of lines to do something on, starting with the one matching X and ending with the one matching Y, and the <code>d</code> command basically says to delete the current line instead of printing it like normal.</p>\n\n<p>If you're set on perl, the <a href=\"https://perldoc.perl.org/perlop.html#Range-Operators\" rel=\"nofollow noreferrer\">scalar form of the range operator</a> (<code>..</code>) allows for the same sort of thing:</p>\n\n<pre><code>perl -ne 'print unless /module1/ .. /endmodule/' data.txt\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9689207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7975a29a8ce6ae6966f013697a6c8f6b?s=128&d=identicon&r=PG&f=1", "display_name": "LowerMoon", "link": "https://stackoverflow.com/users/9689207/lowermoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52347583, "answer_count": 1, "score": 0, "last_activity_date": 1537035474, "creation_date": 1537011435, "question_id": 52344335, "link": "https://stackoverflow.com/questions/52344335/delete-a-set-of-lines-from-a-file-in-perl", "title": "Delete a set of lines from a file in Perl", "body": "<p>I have a Verilog file that looks like this:</p>\n\n<pre><code>Line1\nLine2\nLine3\nmodule1\nLine4\nLine5\nLine6\nendmodule\nLine7\nLine8\nmodule2\nLine9\nLine11\nLine12\nLine13\nendmodule\nLine15\nLine16\n</code></pre>\n\n<p>Here I want to delete whole modules and the module names will be specified by me. Ex: I want to delete module1 so I want lines from module1 to endmodule to be deleted(module1, Line4, Line5, Line6, endmodule). And keep the other remaining modules intact.</p>\n\n<p>My expected output when I delete module1:</p>\n\n<pre><code>Line1\nLine2\nLine3\nLine7\nLine8\nmodule2\nLine9\nLine11\nLine12\nLine13\nendmodule\nLine15\nLine16\n</code></pre>\n\n<p>How do I go about it?</p>\n"}, {"tags": ["file", "perl", "csv"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1536958267, "post_id": 52339015, "comment_id": 91625381, "body": "Yes this is easy, but it is expected that you show what you have tried. Please post the code you are struggling with. Please see <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a> for more information"}, {"owner": {"reputation": 95, "user_id": 10317001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68552265c320a1694760abb3811dcbb?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid", "link": "https://stackoverflow.com/users/10317001/francemadrid"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1536959512, "post_id": 52339015, "comment_id": 91625754, "body": "@hakonhagland I posted some code that I have. I didn&#39;t post it originally because I did not want to bog down anyone&#39;s vision in my incorrect code. Thanks in advance."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1536959811, "post_id": 52339015, "comment_id": 91625866, "body": "Ok, the next step is to split each line on comma. You could try use the <a href=\"https://perldoc.perl.org/functions/split.html\" rel=\"nofollow noreferrer\"><code>split</code></a> function or the more advanced <a href=\"https://metacpan.org/pod/Text::CSV\" rel=\"nofollow noreferrer\"><code>Text::CSV</code></a> module. Then use the first item (owner) as a hash key and the rest of the items as the value (an array), and save it into an <code>%owners</code> hash..."}, {"owner": {"reputation": 95, "user_id": 10317001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68552265c320a1694760abb3811dcbb?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid", "link": "https://stackoverflow.com/users/10317001/francemadrid"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1536960457, "post_id": 52339015, "comment_id": 91626052, "body": "@hakonhagland Thank you for the help. I have tried exactly what you told me but have not been able to reach a solid output. Is it possible you could write some sample code on the problem to push me in the right direction? Any help is greatly appreciated. Thank you very much"}, {"owner": {"reputation": 141, "user_id": 6277637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b75bd241571946bd8060b505d56ec4b?s=128&d=identicon&r=PG&f=1", "display_name": "James E Keenan", "link": "https://stackoverflow.com/users/6277637/james-e-keenan"}, "edited": false, "score": 0, "creation_date": 1537054001, "post_id": 52339015, "comment_id": 91644583, "body": "Consider using CPAN module <a href=\"https://metacpan.org/release/Text-CSV-Hashify\" rel=\"nofollow noreferrer\">Text::CSV::Hashify</a>."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 10317001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68552265c320a1694760abb3811dcbb?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid", "link": "https://stackoverflow.com/users/10317001/francemadrid"}, "edited": false, "score": 0, "creation_date": 1536965010, "post_id": 52339441, "comment_id": 91627172, "body": "@hakonhagland Thank you for the guidance. When implementing your code, I get the output &quot; Use of uninitialized value in say at table.pl line 78. Passing count for Y65 = &quot; Line 78 in this case being the last line of the code. I have been trying to tweak it, but I have not been able to get it to work still. Thank you so much for your guidance thus far."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536969364, "post_id": 52339441, "comment_id": 91627937, "body": "You should use <code>:encoding(UTF-8)</code> rather than <code>:utf8</code>"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 95, "user_id": 10317001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68552265c320a1694760abb3811dcbb?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid", "link": "https://stackoverflow.com/users/10317001/francemadrid"}, "edited": false, "score": 0, "creation_date": 1536997731, "post_id": 52339441, "comment_id": 91631749, "body": "@FranceMadrid As line 78 is the last line, the warning <i>&quot;Use of uninitialized value in say at table.pl line 78&quot;</i> means that either <code>$key</code>, <code>$index</code>, or most likely <code>$owners{$key}</code> is undefined. My guess would be that the key <code>$key</code> does not exist in the hash <code>%owners</code>. Can you check that by using e.g. <code>Data::Dumper</code> on the hash?"}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 1, "last_activity_date": 1536961385, "last_edit_date": 1536961385, "creation_date": 1536960747, "answer_id": 52339441, "question_id": 52339015, "link": "https://stackoverflow.com/questions/52339015/how-to-load-a-csv-file-into-a-perl-hash-and-access-each-element/52339441#52339441", "title": "How to load a CSV file into a perl hash and access each element", "body": "<p>Here is an example of how to put the data into a hash <code>%owners</code> and later (after having read the file) extract a \"passing count\" for a particular owner. I am using the <a href=\"https://metacpan.org/pod/Text::CSV\" rel=\"nofollow noreferrer\"><code>Text::CSV</code></a> module to parse the lines of the file.</p>\n\n<pre><code>use feature qw(say);\nuse open qw(:std :utf8);  # Assume UTF-8 files and terminal output\nuse strict;\nuse warnings qw(FATAL utf8);\nuse Text::CSV;\n\nmy $csv = Text::CSV-&gt;new ( )\n  or die \"Cannot use CSV: \" . Text::CSV-&gt;error_diag ();\nmy $fn = 'test.csv';\nopen my $fh, \"&lt;\", $fn\n  or die \"Could not open file '$fn': $!\";\nmy %owners;\nmy $header = $csv-&gt;getline( $fh );  # TODO: add error checking \nwhile ( my $row = $csv-&gt;getline( $fh ) ) {\n    next if @$row == 0; # TODO: more error checking\n    my ($owner, @values) = @$row;\n    $owners{$owner} = \\@values;\n}\nclose $fh;\n\nmy $key = 'Y65';\nmy $index = 1;\nsay \"Passing count for $key = \", $owners{$key}-&gt;[$index];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "is_accepted": false, "score": 0, "last_activity_date": 1536976109, "last_edit_date": 1536976109, "creation_date": 1536970820, "answer_id": 52340553, "question_id": 52339015, "link": "https://stackoverflow.com/questions/52339015/how-to-load-a-csv-file-into-a-perl-hash-and-access-each-element/52340553#52340553", "title": "How to load a CSV file into a perl hash and access each element", "body": "<p>Since it's not really clear what \"load a CSV file into a perl hash\" means (Nor does it really make sense. An array of hashes, one per row, maybe, if you don't care about keeping the ordering of fields, but just a hash? What are the keys supposed to be?), let's focus on the rest of your question, in particular</p>\n\n<blockquote>\n  <p>how I will print the \"Passing\" count for the \"Owner\" Y65.</p>\n</blockquote>\n\n<p>There are a few other CSV modules that might be of interest that are much easier to use than <code>Text::CSV</code>:</p>\n\n<ul>\n<li><a href=\"https://metacpan.org/pod/Tie::CSV_File\" rel=\"nofollow noreferrer\">Tie::CSV_File</a> lets you access a CSV file like a 2D array. <code>$foo[0][0]</code> is the first field of the first row of the tied file.</li>\n</ul>\n\n<p>So:</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse feature qw/say/;\nuse Tie::CSV_File;\n\nmy $csv = \"data.csv\";\ntie my @data, \"Tie::CSV_File\", $csv or die \"Unable to tie $csv!\";\nfor my $row (@data) {\n  say $row-&gt;[2] and last if $row-&gt;[0] eq \"Y65\";\n}\n</code></pre>\n\n<ul>\n<li><a href=\"https://metacpan.org/pod/DBD::CSV\" rel=\"nofollow noreferrer\">DBD::CSV</a> lets you treat a CSV file like a table in a database you can run SQL queries on.</li>\n</ul>\n\n<p>So:</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse feature qw/say/;\nuse DBI;\n\nmy $csv = \"data.csv\";\nmy $dbh = DBI-&gt;connect(\"dbi:CSV:\", undef, undef,\n                       { csv_tables =&gt; { data =&gt; { f_file =&gt; $csv } } })\n  or die $DBI::errstr;\nmy $owner = \"Y65\";\nmy $p = $dbh-&gt;selectrow_arrayref(\"SELECT Passing FROM data WHERE Owner = ?\",\n                                 {}, $owner);\nsay $p-&gt;[0] if defined $p;\n</code></pre>\n\n<ul>\n<li><a href=\"https://metacpan.org/pod/Text::AutoCSV\" rel=\"nofollow noreferrer\">Text::AutoCSV</a> has a bunch of handy functions for working with CSV files.</li>\n</ul>\n\n<p>So:</p>\n\n<pre><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse feature qw/say/;\nuse Text::AutoCSV;\n\nmy $csv = \"data.csv\";\nmy $acsv = Text::AutoCSV-&gt;new(in_file =&gt; $csv) or die \"Unable to open $csv!\";\nmy $row = $acsv-&gt;search_1hr(\"OWNER\", \"Y65\");\nsay $row-&gt;{\"PASSING\"} if defined $row;\n</code></pre>\n\n<p>This last one is probably closest to what I think you think you want.</p>\n"}], "owner": {"reputation": 95, "user_id": 10317001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e68552265c320a1694760abb3811dcbb?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid", "link": "https://stackoverflow.com/users/10317001/francemadrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 52339441, "answer_count": 2, "score": 1, "last_activity_date": 1536976109, "creation_date": 1536957914, "last_edit_date": 1536959431, "question_id": 52339015, "link": "https://stackoverflow.com/questions/52339015/how-to-load-a-csv-file-into-a-perl-hash-and-access-each-element", "title": "How to load a CSV file into a perl hash and access each element", "body": "<p>I have a CSV file with the following information seperated by commas ... </p>\n\n<pre><code>Owner,Running,Passing,Failing,Model\nD42,21,54,543,Yes\nT43,54,76,75,No\nY65,76,43,765,Yes\n</code></pre>\n\n<p>I want to open this CSV file and place its containments inside of a perl hash in my program. I am also interested in the code needed to print a specific element inside of the has. For example, how I will print the \"Passing\" count for the \"Owner\" Y65.</p>\n\n<p>The code I currently have:</p>\n\n<pre><code>$file = \"path/to/file\";\n\nopen $f, '&lt;', $files, or die \"cant open $file\"\n\nwhile (my $line = &lt;$f&gt;) {\n\n#inside here I am trying to take the containments of this file and place it into a hash. I have tried numerous ways of trying this but none have seemed to work. I am leaving this blank because I do not want to bog down the visibility of my code for those who are kind enough to help and take a look. Thanks.\n\n}\n</code></pre>\n\n<p>AS well as placing the csv file inside of a hash I also need to understand the syntax to print and navigate through specific elements. Thank you very much in advance.</p>\n"}, {"tags": ["perl", "websocket", "mojolicious"], "comments": [{"owner": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1536943293, "post_id": 52336018, "comment_id": 91619242, "body": "You essentially ask how to solve a problem which happens with one server but not with another server - without providing any usable information about the other server and how exactly it fails. This makes it impossible to understand why the problem happens and to help you. Instead you seem to randomly fiddle with some additional headers for no apparent reason. And, you cannot just add some arbitrary <code>Sec-WebSocket-Extensions</code> header without actually supporting the given extensions."}, {"owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "reply_to_user": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1536954886, "post_id": 52336018, "comment_id": 91624155, "body": "Well, the question is: &quot;how do I add extra headers to a websocket connection request&quot;. The question isn&#39;t &quot;what&#39;s the problem here&quot;. Like I said, I suspect the lack of certain headers is the problem here but I can&#39;t be sure since I can&#39;t find in the Majolicious documentation how to send multiple header. So that&#39;s my first question: &quot;Is this the way to send extra headers?&quot;"}, {"owner": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1536988047, "post_id": 52336018, "comment_id": 91630144, "body": "If you only want to know if this is the correct way to add headers: yes it is and it is <a href=\"https://mojolicious.org/perldoc/Mojo/UserAgent#toc\" rel=\"nofollow noreferrer\">also documented as such</a>. Why it still fails: no idea since it is not clear what your server expects and how exactly your code fails. It might for example fail already during the SSL handshake which is before it even sends any HTTP headers."}, {"owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "reply_to_user": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1536992268, "post_id": 52336018, "comment_id": 91630816, "body": "I know the documentation states how to set the &#39;Sec-WebSocket-Extensions&#39; header. But it doesn&#39;t mention you can set arbitrary headers the same way. And if you can, I was wondering if what I did is the proper way to send <b>multiple</b> headers."}, {"owner": {"reputation": 89568, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 2, "creation_date": 1536992672, "post_id": 52336018, "comment_id": 91630880, "body": "The documentation has even an example where it sets the <code>DNT</code> header. And yes, you can set multiple headers this way at once (just tried it) and you also did it the right way."}], "answers": [{"tags": [], "owner": {"reputation": 3946, "user_id": 65706, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6e0652a12b8a5b2577f91f0e192ea3f9?s=128&d=identicon&r=PG", "display_name": "Yordan Georgiev", "link": "https://stackoverflow.com/users/65706/yordan-georgiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1563182455, "creation_date": 1563182455, "answer_id": 57036730, "question_id": 52336018, "link": "https://stackoverflow.com/questions/52336018/sending-headers-with-websocket-connection-request-mojolicious/57036730#57036730", "title": "Sending headers with websocket connection request (Mojolicious)", "body": "<p>One proper way might be to set the headers each time you perform a http request, which should also include web socket type of requests ... and in a way which is specified by the web socket server side ...</p>\n\n<pre><code>my $ua  = Mojo::UserAgent-&gt;new;\n$ua-&gt;on(start =&gt; sub {\n   my ($ua, $tx) = @_;\n   $tx-&gt;req-&gt;headers-&gt;header('Sec-WebSocket-Extensions' =&gt; 'foo-bar-extensions');\n   $tx-&gt;req-&gt;headers-&gt;header('Origin' =&gt; 'foo-bar-origin'); \n});\n\n$ua-&gt;websocket('ws://my.server/jsonecho' =&gt; sub {\n   my ($ua, $tx) = @_;\n   say 'WebSocket handshake failed!' and return unless $tx-&gt;is_websocket;\n   $tx-&gt;on(json =&gt; sub {\n   my ($tx, $hash) = @_;\n   say \"WebSocket message via JSON: $hash-&gt;{msg}\";\n   $tx-&gt;finish;\n   });\n   $tx-&gt;send({json =&gt; {msg =&gt; 'Hello World!'}});\n });\n</code></pre>\n"}], "owner": {"reputation": 525, "user_id": 3272110, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3a30dbd0c0785ff9369805ebafc853dc?s=128&d=identicon&r=PG&f=1", "display_name": "Zippy1970", "link": "https://stackoverflow.com/users/3272110/zippy1970"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1563182455, "creation_date": 1536942845, "question_id": 52336018, "link": "https://stackoverflow.com/questions/52336018/sending-headers-with-websocket-connection-request-mojolicious", "title": "Sending headers with websocket connection request (Mojolicious)", "body": "<p>I need to open a websocket connection from Perl with a server. I got it working on echo.websocket.org, but when I replace the websocket.org with the real server, the handshake fails. I suspect I need to send some extra headers but I'm unsure how to do that. I'm using Mojolicious to make the connection:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\n\nuse Mojo::UserAgent;\nuse Mojo::IOLoop;\n\n# Open WebSocket\nmy $ua = Mojo::UserAgent-&gt;new;\n$ua-&gt;websocket('wss://someserver.com/' =&gt; {\n'Origin' =&gt; 'https://www.myserver.com',\n'Sec-WebSocket-Extensions' =&gt; 'permessage-deflate'\n} =&gt; sub {\n  my ($ua, $tx) = @_;\n\n  # Check if WebSocket handshake was successful\n  unless( $tx-&gt;is_websocket ) {\n    print \"Handshake failed!\\n\";\n    return;\n  }\n\n  # Wait for WebSocket to be closed\n  $tx-&gt;on(finish =&gt; sub {\n    my ($tx, $code, $reason) = @_;\n    print \"WebSocket closed with status $code.\\n\";\n  });\n\n  # Close WebSocket after receiving one message\n  $tx-&gt;on(message =&gt; sub {\n    my ($tx, $msg) = @_;\n    print \"WebSocket message: $msg\\n\";\n    $tx-&gt;finish;\n  });\n\n  # Send a message to the server\n  $tx-&gt;send(\"Hello world!\");\n});\n\n# Start event loop if necessary\nMojo::IOLoop-&gt;start unless Mojo::IOLoop-&gt;is_running;\n\nprint \"Done.\\n\";\n</code></pre>\n\n<p>As you can see, I'm trying to add two request headers: <strong>Origin</strong> and <strong>Sec-WebSocket-Extensions</strong>.</p>\n\n<p>Is this the proper way to do it? I'm asking because the handshake still fails.</p>\n"}, {"tags": ["perl", "sorting", "duplicates"], "comments": [{"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536938044, "post_id": 52334691, "comment_id": 91616662, "body": "I do not see the array. I only see <code>%hash</code> that have been saved into <code>scalar</code> ie <code>$var1</code> etc..."}, {"owner": {"reputation": 91, "user_id": 10033194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cde3f9ea294cca4f0d23b1ed2a041e7?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Anowez", "link": "https://stackoverflow.com/users/10033194/thomas-anowez"}, "reply_to_user": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536938414, "post_id": 52334691, "comment_id": 91616892, "body": "@Onyambu I&#39;ve add my push value into array"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1536940666, "post_id": 52334691, "comment_id": 91618033, "body": "@ThomasAnowez: I&#39;ve added indentation to your example in an attempt to make it easier to follow. You&#39;re welcome, but please consider doing it yourself next time. Clear indentation is one of the best tools for understanding code and when you want a large group of strangers to read your code, then surely it&#39;s only polite to make it as easy as possible for them. Also, note that I&#39;ve added what looks like a missing <code>}</code> to the code. Please feel free to remove it if my guess is wrong."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1536940828, "post_id": 52334691, "comment_id": 91618097, "body": "@ThomasAnowez: I&#39;m puzzled by your use of <code>split &#47;\\n&#47;</code> and <code>$lines[0]</code>. Unless you have changed <code>$&#47;</code>, each line will only have a single newline character, which will be the last character in the string. If you want remove it, just use <code>chomp()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1536939894, "post_id": 52334919, "comment_id": 91617630, "body": "Yours may be what they actually want, despite the question :)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1536996641, "post_id": 52334919, "comment_id": 91631528, "body": "Re &quot;<i>This answer is for eliminating complete duplicate hash references!</i>&quot;, ....assuming all the hashes have the same keys. The following avoids that problem, and avoids the problems with using sentinel values: <code>my $key = pack &#39;(J&#47;a*)*&#39;, map { $_ =&gt; $e-&gt;{$_} } sort keys %$e;</code> Could also use <code>state $json = Cpanel::JSON::XS-&gt;new-&gt;canonical; my $key = $json-&gt;encode($_);</code>"}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 2, "last_activity_date": 1536939958, "last_edit_date": 1536939958, "creation_date": 1536938381, "answer_id": 52334919, "question_id": 52334691, "link": "https://stackoverflow.com/questions/52334691/perl-remove-duplicate-from-a-referenced-array/52334919#52334919", "title": "Perl - Remove duplicate from a referenced @array", "body": "<h2>This answer is for eliminating complete duplicate hash references!</h2>\n\n<p>If you only want the <em>time</em> key to be unique, see <a href=\"https://stackoverflow.com/a/52335229/1331451\">ysth's answer</a>.</p>\n\n<p>Your implementation of <code>uniq</code> only works if those references are pointing to the same memory. But likely they are not, they just contain the same value.</p>\n\n<p>You need to look at the values inside each element and build your <code>uniq</code> that way. The easiest way is to simply concatenate all values in a known way. You can add a delimiter between the fields, like you would in a CSV export. You could also <em>hash</em> this with a digest algorithm (like <a href=\"https://metacpan.org/pod/Digest::MD5\" rel=\"nofollow noreferrer\">MD5</a>, which is in general discouraged but shouldn't have a high chance of collision here).</p>\n\n<pre><code>sub uniq {\n  my %seen;\n  grep {\n    my $e = $_;\n    my $key = join '___', map { $e-&gt;{$_}; } sort keys %$_;\n    !$seen{$key}++\n  } @_;\n}\n</code></pre>\n\n<p>I picked <code>___</code> as a delimiter because that's unlikely to appear in your data. Since it takes the keys and sorts it, this can be used universally.</p>\n\n<p>Also note that you can eliminate the duplicates before you sort by user. If you intend to sort by other columns as well, this will save you additional work. Depending on the number of lines of your input data, reducing will the size will in general be faster than sorting first.</p>\n"}, {"tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 2, "last_activity_date": 1536939358, "creation_date": 1536939358, "answer_id": 52335178, "question_id": 52334691, "link": "https://stackoverflow.com/questions/52334691/perl-remove-duplicate-from-a-referenced-array/52335178#52335178", "title": "Perl - Remove duplicate from a referenced @array", "body": "<p></p>\n\n<ul>\n<li><p>You have made this far harder than necessary by using a regex to parse your data: there is no need for anything more than a <code>split /;/</code></p></li>\n<li><p>Please <em>indent</em> your code properly. You will find it much easier to work with, and it is only polite when you are asking others for help with it. As a result, your code won't even compile and I have had to fix it before working on the problem at hand</p></li>\n<li><p>You should also <code>use strict</code> and <code>use warnings 'all'</code> at the top of <em>every</em> Perl program you write, and declare every variable as close as possible to its first point of use with <code>my</code></p></li>\n<li><p>You should <em>always</em> check that an <code>open</code> call has succeeded, and invoke <code>die</code> on any error with the value of <code>$!</code> in the die string to say <em>why</em> it failed. It doesn't make sense to continue running most programs if the source of input data is unavailable</p></li>\n</ul>\n\n<p>To make a list of unique entries, you can use the <code>uniq_by</code> function from the \n<a href=\"https://metacpan.org/pod/List::UtilsBy\" rel=\"nofollow noreferrer\"><code>List::UtilsBy</code></a> module.\nThis isn't a core module and is likely to need installing</p>\n\n<p>Here's how I would write your code</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\n\nuse List::UtilsBy 'uniq_by';\n\nmy $file = 'evts.txt';\n\nmy @evts;\n\n{\n    open my $fh, '&lt;', $file or die qq{Unable to open \"$file\" for input: $!};\n\n    while ( &lt;$fh&gt; ) {\n        chomp;\n\n        my ( $user, $date, $time ) = split /;/;\n\n        push @evts, {\n            user =&gt; $user,\n            date =&gt; $date,\n            time =&gt; $time,\n        };\n    }\n}\n\nmy @uniq = uniq_by { $_-&gt;{time} } @evts;\n\nuse Data::Dump;\ndd \\@uniq;\n</code></pre>\n\n<h3>evts.txt</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>USER1;2018/08/06;08:08:36.120\nUSER1;2018/08/06;08:08:36.120\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>[\n  { date =&gt; \"2018/08/06\", time =&gt; \"08:08:36.120\", user =&gt; \"USER1\" },\n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": false, "score": 3, "last_activity_date": 1536939514, "creation_date": 1536939514, "answer_id": 52335229, "question_id": 52334691, "link": "https://stackoverflow.com/questions/52334691/perl-remove-duplicate-from-a-referenced-array/52335229#52335229", "title": "Perl - Remove duplicate from a referenced @array", "body": "<p>You are only checking if the hash references (when stringified) are unique.  To check for unique times, just, well, do that.</p>\n\n<pre><code>grep !$seen{$_-&gt;{'time'}}++, @_;\n</code></pre>\n\n<p>simbabque's answer checks if any value is different, not just time (assuming all the hashes have the same keys and no values contain ___).</p>\n"}], "owner": {"reputation": 91, "user_id": 10033194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cde3f9ea294cca4f0d23b1ed2a041e7?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Anowez", "link": "https://stackoverflow.com/users/10033194/thomas-anowez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 52334919, "answer_count": 3, "score": 2, "last_activity_date": 1536940527, "creation_date": 1536937560, "last_edit_date": 1536940527, "question_id": 52334691, "link": "https://stackoverflow.com/questions/52334691/perl-remove-duplicate-from-a-referenced-array", "title": "Perl - Remove duplicate from a referenced @array", "body": "<p>If I've a perl array with following structure (Date, Time, User), sorted by user:</p>\n\n<pre><code>open my $fh, '&lt;', $file;\nwhile( &lt;$fh&gt; ) {\n  my @lines = split /\\n/;\n  my ($user, $y, $m, $d, $time) = $lines[0] =~ /\\A(\\w);(\\d+)\\/(\\d+)\\/(\\d+);(\\d+:\\d+:\\d+.\\d+)/;   # Encapsulate values\n  push @evts, { user =&gt; $user, date =&gt; \"$y/$m/$d\", time =&gt; $time};  # Array loader\n} # This was missing.\nclose($fh);\nmy @by_usr = sort { $a-&gt;{user} cmp $b-&gt;{user} } @evts;\n</code></pre>\n\n<p>How could I remove duplicate entry from it, if it has the exactly same time?</p>\n\n<pre><code>$VAR1 = {\n          'time' =&gt; '08:08:36.120',\n          'date' =&gt; '2018/08/06',\n          'user' =&gt; 'USER1'\n        };\n$VAR2 = {\n          'time' =&gt; '08:08:36.120',\n          'date' =&gt; '2018/08/06',\n          'user' =&gt; 'USER1'\n        };\n...(and more)\n</code></pre>\n\n<p>I've try with unique function but it doesn't work:</p>\n\n<pre><code>sub uniq {\n    my %seen;\n    grep !$seen{$_}++, @_;\n}\nmy @unique_events = uniq (@by_usr);\n</code></pre>\n\n<p>I'm available for any clarifications.</p>\n"}, {"tags": ["perl", "dropbox", "large-files"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 3, "creation_date": 1536935262, "post_id": 52333127, "comment_id": 91615025, "body": "Can you provide more details? What happens if you try uploading a large file? Is there an error? Does it respond with a specific code, or does the connection close unexpectedly? Please <a href=\"https://stackoverflow.com/posts/52333127/edit\">edit</a> your question and provide answers to my questions as well as the code you&#39;ve written to upload that file. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "edited": false, "score": 0, "creation_date": 1536942774, "post_id": 52334699, "comment_id": 91619028, "body": "In my case I know how to upload file on sites  but its first time I&#39;m trying with this so I&#39;m not comfortable to understand the 2nd part of that documentation. My English is not that good that get that easily. You can say I have $content =  $x-&gt;{dir}/$fname already available with completely available in my package file that I am using that to post data in a form for upload. So can you suggest me how should I write that up for their code.  I just started learning perl just few days back so just trying my level best."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "edited": false, "score": 0, "creation_date": 1536946806, "post_id": 52334699, "comment_id": 91620898, "body": "@alex: Please edit the question to show how you have successfully uploaded smaller files."}, {"owner": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "edited": false, "score": 0, "creation_date": 1536975783, "post_id": 52334699, "comment_id": 91628793, "body": "Thanks for your help m8 but dev helped me this is what  I was looking for <a href=\"https://github.com/s-aska/dropbox-api-command/blob/master/script/dropbox-api#L1133-L1233\" rel=\"nofollow noreferrer\">github.com/s-aska/dropbox-api-command/blob/master/script/&hellip;</a> he got it what exactly I was looking for!"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "edited": false, "score": 0, "creation_date": 1537099363, "post_id": 52334699, "comment_id": 91652522, "body": "@alex: That&#39;s a very long-winded solution to your problem: it would be much better to use a simple <code>upload_session</code> call. And it&#39;s very rude of you to ignore our advice and questions and go elsewhere for help without telling us. You&#39;ve just wasted hours of several people&#39;s time. If you have a solution then please at least write up an answer of your own, including the final code that you are using and not just a link to an external site."}, {"owner": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "edited": false, "score": 0, "creation_date": 1537160999, "post_id": 52334699, "comment_id": 91666394, "body": "Hey sorry for that but I failed to make it more than 150mb (my mistake was just this  &quot;&quot;)so we dropped idea of Dropbox and since I&#39;m modifying someone else code I&#39;m bound to his licence terms so can&#39;t post code :("}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 2, "last_activity_date": 1536938390, "last_edit_date": 1592644375, "creation_date": 1536937574, "answer_id": 52334699, "question_id": 52333127, "link": "https://stackoverflow.com/questions/52333127/uploading-large-files-with-webservicedropbox/52334699#52334699", "title": "Uploading large files with WebService::Dropbox", "body": "<p>The\n<a href=\"https://metacpan.org/pod/WebService::Dropbox#upload_session($path,-$content-%5B,-%5C%25optional_params,-$limit%5D)\" rel=\"nofollow noreferrer\">module documentation</a>\nsays this about the <code>update</code> method</p>\n<blockquote>\n<p>Do not use this to upload a file larger than 150 MB. Instead, create an upload session with upload_session/start.</p>\n</blockquote>\n<p>And this is presumably why you have mentioned 150MB in your question.</p>\n<p>The documentation for <code>upload_session</code> has this</p>\n<blockquote>\n<p>Uploads large files by upload_session API</p>\n<pre><code># File Handle  \nmy $content = IO::File-&gt;new('./mysql.dump', '&lt;');  \n\nmy $result = $dropbox-&gt;upload_session($path, $content);  \n\nmy $result = $dropbox-&gt;upload_session($path, $content, {  \n    mode =&gt; 'add',  \n    autorename =&gt; JSON::true,  \n    mute =&gt; JSON::false  \n});\n</code></pre>\n</blockquote>\n<p>Note that, just like the documentation for <code>upload</code>, those two examples of calling <code>upload_session</code> are <em>alternatives</em>, and you should choose the second only if you have special requirements that require non-default option values</p>\n<p>There is also no need to use <code>IO::File</code> to open a file: the standard Perl <code>open</code> call will work fine, and you should add a <code>:raw</code> layer whether you are using <code>IO::File</code> or not, like this</p>\n<pre><code>open my $content, '&lt;:raw', './mysql.dump' or die $!\n</code></pre>\n<p>There is also no need for <code>JSON::true</code> and <code>JSON::false</code>: a simple <code>1</code> and <code>0</code> will do fine</p>\n<p>This is pretty much identical to the <code>upload</code> use case, which you say you have working fine. What exactly are you having problems with?</p>\n"}], "owner": {"reputation": 3, "user_id": 9131135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca70564eebbe2a2db0fa15e05aa551c?s=128&d=identicon&r=PG&f=1", "display_name": "alex", "link": "https://stackoverflow.com/users/9131135/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1536938390, "creation_date": 1536931974, "last_edit_date": 1536937016, "question_id": 52333127, "link": "https://stackoverflow.com/questions/52333127/uploading-large-files-with-webservicedropbox", "title": "Uploading large files with WebService::Dropbox", "body": "<p>Can someone here give me some example code for using the\n<a href=\"https://metacpan.org/pod/WebService::Dropbox\" rel=\"nofollow noreferrer\"><code>WebService::Dropbox</code></a> module\nto upload files bigger than 1GB?</p>\n\n<p>I followed the instructions and successfully uploaded files less than 150MB but I don't understand how to upload larger files.</p>\n"}, {"tags": ["bash", "perl", "string-comparison", "scramble"], "comments": [{"owner": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1536931979, "post_id": 52333044, "comment_id": 91612992, "body": "It works yes?  The best improvement for speed is to do it in another language like Perl (the whole thing), Python, ...  It will run <b>MUCH</b> faster than bash since once interpreted it does not create a bunch of shells to run.  There might be other algorithms that are more efficient, but that language change will have a huge impact."}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 3, "creation_date": 1536932397, "post_id": 52333044, "comment_id": 91613271, "body": "Apart from choice of language, for every line of <code>scrambled-words.txt</code>, you process the complete <code>dictionary.txt</code> file. Your question might be a better match for   <a href=\"https://codereview.stackexchange.com\">Code Review</a> - make sure it is <a href=\"https://codereview.stackexchange.com/help/on-topic\">on topic</a> there, though."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1536932430, "post_id": 52333044, "comment_id": 91613291, "body": "Two things immediately stand out: (1) Nested loops mean you&#39;re re-reading <code>dictionary.txt</code> in its entirety for every single word in <code>scrambled-words.txt</code>. If you are clever you only need to read the dictionary once. Avoid any nested loops. (2) You&#39;re calling <code>perl</code> 550&#215;9900 times, which is incredibly inefficient. You should really only need to call it once per file at most. Either write the whole script in perl, or if you stick with bash avoid calling perl so much."}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "edited": false, "score": 1, "creation_date": 1536932575, "post_id": 52333044, "comment_id": 91613378, "body": "Also, you&#39;ll get false matches for anagrams: your input word &quot;listen&quot; would show up as a match for &quot;silent&quot; because they both sort to &quot;eilnst&quot;."}, {"owner": {"reputation": 860, "user_id": 1999924, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/nHGK8.jpg?s=128&g=1", "display_name": "ingroxd", "link": "https://stackoverflow.com/users/1999924/ingroxd"}, "edited": false, "score": 0, "creation_date": 1536937338, "post_id": 52333044, "comment_id": 91616280, "body": "Can you provide us the two files?"}], "answers": [{"tags": [], "owner": {"reputation": 860, "user_id": 1999924, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/nHGK8.jpg?s=128&g=1", "display_name": "ingroxd", "link": "https://stackoverflow.com/users/1999924/ingroxd"}, "is_accepted": false, "score": -1, "last_activity_date": 1536938684, "creation_date": 1536938684, "answer_id": 52334986, "question_id": 52333044, "link": "https://stackoverflow.com/questions/52333044/unscramble-words-challenge-improve-my-bash-solution/52334986#52334986", "title": "Unscramble words Challenge - improve my bash solution", "body": "<p>I tried something very alike, but a bit different.</p>\n\n<pre><code>#!/bin/bash\n\nexec 3&lt;scrambled-words.txt\nwhile read -r line &lt;&amp;3; do\n   printf \"%s\" ${line} | perl -F -lane 'print sort @F'\ndone&gt;scrambled-words_sorted.txt\nexec 3&gt;&amp;-\n\nexec 3&lt;dictionary.txt\nwhile read -r line &lt;&amp;3; do\n   printf \"%s\" ${line} | perl -F -lane 'print sort @F'\ndone&gt;dictionary_sorted.txt\nexec 3&gt;&amp;-\n\nprintf \"\" &gt; whichline.txt\nexec 3&lt;scrambled-words_sorted.txt\nwhile read -r line &lt;&amp;3; do\n   counter=\"$((++counter))\"\n   grep -n -e \"^${line}$\" dictionary_sorted.txt | cut -d ':' -f 1 | tr -d '\\n' &gt;&gt;whichline.txt   printf \"\\n\" &gt;&gt;whichline.txt\ndone   \nexec 3&gt;&amp;-\n</code></pre>\n\n<p>As you can see I don't create a <code>new.txt</code> file; instead I only create <code>whichline.txt</code> with a blank line where the word doesn't match. You can easily paste them up to create <code>new.txt</code>.</p>\n\n<p>The logic behind the script is nearly the logic behind yours, with the exception that I called <code>perl</code> less times and I save two support files.\nI think (but I am not sure) that creating them and cycle only one file will be better than ~5kk calls of <code>perl</code>. This way \"only\" ~10k times is called.</p>\n\n<p>Finally, I decided to use <code>grep</code> because it's (maybe) the fastest regex matcher, and searching for the entire line the lenght is intrinsic in the regex.</p>\n\n<p>Please, note that what @benjamin-w said is still valid and, in that case, <code>grep</code> will reply badly and I did not managed it!</p>\n\n<p>I hope this could help [:</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10248678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JpnLA.jpg?s=128&g=1", "display_name": "oguz ismail", "link": "https://stackoverflow.com/users/10248678/oguz-ismail"}, "is_accepted": false, "score": 3, "last_activity_date": 1537003152, "last_edit_date": 1537003152, "creation_date": 1536943267, "answer_id": 52336111, "question_id": 52333044, "link": "https://stackoverflow.com/questions/52333044/unscramble-words-challenge-improve-my-bash-solution/52336111#52336111", "title": "Unscramble words Challenge - improve my bash solution", "body": "<p>I would do something like this with gawk</p>\n\n<pre><code>gawk '\nNR == FNR {\n    dict[csort()] = $0\n    next\n}\n\n{\n    print dict[csort()]\n}\n\nfunction csort(    chars, sorted) {\n    split($0, chars, \"\")\n    asort(chars)\n    for (i in chars)\n        sorted = sorted chars[i]\n\n    return sorted\n}' dictionary.txt scrambled-words.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18466, "user_id": 477563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/07a89fb7b2fd8ece1e9e39e95e004a36?s=128&d=identicon&r=PG", "display_name": "Mr. Llama", "link": "https://stackoverflow.com/users/477563/mr-llama"}, "is_accepted": false, "score": 2, "last_activity_date": 1536943926, "creation_date": 1536943926, "answer_id": 52336275, "question_id": 52333044, "link": "https://stackoverflow.com/questions/52333044/unscramble-words-challenge-improve-my-bash-solution/52336275#52336275", "title": "Unscramble words Challenge - improve my bash solution", "body": "<p>Here's perl-free solution I came up with using <code>sort</code> and <code>join</code>:</p>\n\n<pre><code>sort_letters() {\n    # Splits each letter onto a line, sorts the letters, then joins them\n    #   e.g. \"hello\" becomes \"ehllo\"\n    echo \"${1}\" | fold-b1 | sort | tr -d '\\n'\n}\n\n\n# For each input file...\nfor input in \"dict.txt\" \"words.txt\"; do\n    # Convert each line to [sorted] [original]\n    #  then sort and save the results with a .sorted extension\n    while read -r original; do\n        sorted=$(sort_letters \"${original}\")\n        echo \"${sorted} ${original}\"\n    done &lt; \"${input}\" | sort &gt; \"${input}.sorted\"\ndone\n\n# Join the two files on the [sorted] word\n#   outputting the scrambled and unscrambed words\njoin -j 1 -o 1.2,2.2 \"words.txt.sorted\" \"dict.txt.sorted\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1536997870, "last_edit_date": 1536997870, "creation_date": 1536948183, "answer_id": 52337162, "question_id": 52333044, "link": "https://stackoverflow.com/questions/52333044/unscramble-words-challenge-improve-my-bash-solution/52337162#52337162", "title": "Unscramble words Challenge - improve my bash solution", "body": "<p>You're better off creating a lookup dictionary (keyed by the sorted word) from the dictionary file.</p>\n\n<p>Your loop body is executed 550 * 9,000 = 4,950,000 times (O(N*M)).</p>\n\n<p>The solution I propose executes two loops of at most 9,000 passes each (O(N+M)).</p>\n\n<p>Bonus: It finds all possible solutions at no cost.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings qw( all );\nuse feature qw( say );\n\nmy $dict_qfn      = \"dictionary.txt\";\nmy $scrambled_qfn = \"scrambled-words.txt\";\n\nsub key { join \"\", sort split //, $_[0] }\n\nmy %dict;\n{\n   open(my $fh, \"&lt;\", $dict_qfn)\n      or die(\"Can't open \\\"$dict_qfn\\\": $!\\n\");\n\n   while (&lt;$fh&gt;) {\n      chomp;\n      push @{ $dict{key($_)} }, $_;\n   }\n}\n\n{\n   open(my $fh, \"&lt;\", $scrambled_qfn)\n      or die(\"Can't open \\\"$scrambled_qfn\\\": $!\\n\");\n\n   while (&lt;$fh&gt;) {\n      chomp;\n      my $matches = $dict{key($_)};\n      say \"$_ matches @$matches\" if $matches;\n   }\n}\n</code></pre>\n\n<p>I wouldn't be surprised if this only takes one millionths of the time of your solution for the sizes you provided (and it scales so much better than yours if you were to increase the sizes).</p>\n"}], "owner": {"reputation": 85, "user_id": 6583387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yV1Nd.png?s=128&g=1", "display_name": "cuilster", "link": "https://stackoverflow.com/users/6583387/cuilster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 52337162, "answer_count": 4, "score": 1, "last_activity_date": 1549706464, "creation_date": 1536931629, "last_edit_date": 1549706464, "question_id": 52333044, "link": "https://stackoverflow.com/questions/52333044/unscramble-words-challenge-improve-my-bash-solution", "title": "Unscramble words Challenge - improve my bash solution", "body": "<p>There is a Capture the Flag challenge</p>\n\n<p>I have two files; one with scrambled text like this with about 550 entries</p>\n\n<pre><code>dnaoyt\ncinuertdso\nbda\nhaey\ntolpap\n...\n</code></pre>\n\n<p>The second file is a dictionary with about 9,000 entries</p>\n\n<pre><code>radar\nccd\ngcc\nfcc\nhistorical\n...\n</code></pre>\n\n<p>The goal is to find the right, unscrambled version of the word, which is contained in the dictionary file.</p>\n\n<p>My approach is to sort the characters from the first word from the first file and then look up if the first word from the second file has the same length. If so then sort that too and compare them.</p>\n\n<p>This is my fully functional bash script, but it is very slow.</p>\n\n<pre><code>#!/bin/bash\n\nwhile IFS=\"\" read -r p || [ -n \"$p\" ]\ndo\n    var=0\n    ro=$(echo $p | perl -F -lane 'print sort @F')\n    len_ro=${#ro}\n    while IFS=\"\" read -r o || [ -n \"$o\" ]\n    do\n        ro2=$(echo $o | perl -F -lane 'print sort @ F')\n        len_ro2=${#ro2}\n        let \"var+=1\"\n        if [ $len_ro == $len_ro2 ]; then\n            if  [ $ro == $ro2 ]; then\n                echo $o &gt;&gt; new.txt\n                echo $var &gt;&gt; whichline.txt\n            fi\n        fi\n    done &lt; dictionary.txt\ndone &lt; scrambled-words.txt\n</code></pre>\n\n<p>I have also tried converting all characters to ASCII integers and sum each word, but while comparing I realized that the sum of a different char pattern may have the same sum.</p>\n\n<p>[edit]\nFor the records:\n- no anagrams contained in dictionary\n- to get the flag, you need to export the unscrambled words as one blob and ans make a SHA-Hash out of it (thats the flag)\n- link to ctf for guy who wanted the files <a href=\"https://challenges.reply.com/tamtamy/user/login.action\" rel=\"nofollow noreferrer\">https://challenges.reply.com/tamtamy/user/login.action</a></p>\n"}, {"tags": ["perl", "cgi"], "comments": [{"owner": {"reputation": 2422, "user_id": 9112798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2689048404de2b747c712b6782e8c7?s=128&d=identicon&r=PG&f=1", "display_name": "David Collins", "link": "https://stackoverflow.com/users/9112798/david-collins"}, "edited": false, "score": 2, "creation_date": 1536934118, "post_id": 52332983, "comment_id": 91614343, "body": "You might be better off using a dedicated templating module such as <code>HTML::Template</code> or <code>Template::Toolkit</code>."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 802, "user_id": 4687963, "user_type": "registered", "profile_image": "https://graph.facebook.com/1056110974405231/picture?type=large", "display_name": "Ahmed Numaan", "link": "https://stackoverflow.com/users/4687963/ahmed-numaan"}, "edited": false, "score": 0, "creation_date": 1536937758, "post_id": 52332983, "comment_id": 91616513, "body": "@AhmedNumaan: Your edit made the English in the question substantially <i>worse</i>. Please don&#39;t vandalise Stack Overflow pages."}, {"owner": {"reputation": 802, "user_id": 4687963, "user_type": "registered", "profile_image": "https://graph.facebook.com/1056110974405231/picture?type=large", "display_name": "Ahmed Numaan", "link": "https://stackoverflow.com/users/4687963/ahmed-numaan"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536946985, "post_id": 52332983, "comment_id": 91620981, "body": "@Borodin I had to open up the dictionary to look for the meaning of &quot;vandalize&quot;(See spelling you wrote) that you used. Thanks for your advice anyways."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 802, "user_id": 4687963, "user_type": "registered", "profile_image": "https://graph.facebook.com/1056110974405231/picture?type=large", "display_name": "Ahmed Numaan", "link": "https://stackoverflow.com/users/4687963/ahmed-numaan"}, "edited": false, "score": 0, "creation_date": 1536948201, "post_id": 52332983, "comment_id": 91621525, "body": "@Ahmed: \u201cVandalize\u201d is American. \u201cVandalise\u201d is English."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1537116004, "post_id": 52332983, "comment_id": 91657006, "body": "From your subsequent question <a href=\"https://stackoverflow.com/questions/52355468\"><i>Using Template::Toolkit with array data from database</i></a>  you have clearly made use of an answer to this question. Please read <a href=\"http://stackoverflow.com/help/someone-answers\"><i>What should I do when someone answers my question?</i></a> and put it into practice."}], "answers": [{"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536935047, "post_id": 52333711, "comment_id": 91614894, "body": "This produces nine copies of the warning <code>Odd number of elements in anonymous hash at E:\\Perl\\source\\pp.pl line 6.</code>"}, {"owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1536936004, "post_id": 52333711, "comment_id": 91615478, "body": "That&#39;s an error in the OP&#39;s code, not mine. The question wasn&#39;t about fixing warnings or any other problems, it was about how to write a loop. Please downvote the OP&#39;s question, not this answer."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1536936616, "post_id": 52333711, "comment_id": 91615861, "body": "And you think it&#39;s okay to post answers containing incorrect Perl code, just because the OP didn&#39;t ask about those issues?"}, {"owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537038506, "post_id": 52333711, "comment_id": 91641345, "body": "@Borodin yes I do think it&#39;s completely okay to post an answer containing &#39;incorrect&#39; Perl code because I was quoting the OP&#39;s code and answering one specific question. It wouldn&#39;t make sense to change multiple aspects of the code, that would just be confusing."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537041712, "post_id": 52333711, "comment_id": 91642167, "body": "@Will: I appreciate your comment on my answer: thank you. But I wonder that you rate it at all when you say <i>&quot;It wouldn&#39;t make sense to change multiple aspects of the code, that would just be confusing&quot;</i>. There is no trace of the original code in my answer at all!"}, {"owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1537162918, "post_id": 52333711, "comment_id": 91666947, "body": "@Borodin Yours is the answer to a different question &quot;Could you fix my code?&quot;, which is obviously very useful to the OP. I defend my answer as literally correct, while yours serves a wider purpose."}], "tags": [], "owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "is_accepted": false, "score": -1, "last_activity_date": 1536934145, "creation_date": 1536934145, "answer_id": 52333711, "question_id": 52332983, "link": "https://stackoverflow.com/questions/52332983/output-all-names-from-an-array-in-html/52333711#52333711", "title": "Output all names from an array in HTML", "body": "<p>You don't need a <code>join</code>, you need to use a <code>foreach</code> loop and put the code that generates and prints the <code>&lt;li&gt;</code> inside the loop.</p>\n\n<pre><code>use CGI::Pretty \":standard\";\n\n@names  = ('Foo', 'Bar', 'Moo');\n\nforeach $name (@names){\n    $data =  li (\n            div({\"class='inforno'\"}, \"&lt;img src='inforno&gt;'\"),\n            div({\"class='inforno'\"}, \"&lt;a href='#' class='inforno'&gt;$name&lt;/a&gt;\"),\n            span({\"class='inforno'\"},  \"&lt;a href='#' class='inforno'&gt;\n                    Edit user &lt;/a&gt;\")\n\n            );  \n\n        print \"$data\\n\";\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "edited": false, "score": 0, "creation_date": 1537038665, "post_id": 52334238, "comment_id": 91641385, "body": "This is a very good answer, and much more comprehensive than mine. It addresses all the issues with the original code. I salute you sir!"}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": false, "score": 4, "last_activity_date": 1536936053, "creation_date": 1536936053, "answer_id": 52334238, "question_id": 52332983, "link": "https://stackoverflow.com/questions/52332983/output-all-names-from-an-array-in-html/52334238#52334238", "title": "Output all names from an array in HTML", "body": "<p>Unless you are using a very old copy of\n<a href=\"https://metacpan.org/pod/CGI::Pretty\" rel=\"nofollow noreferrer\"><code>CGI::Pretty</code></a>,\nyour code produces this warning message when you run it</p>\n\n<blockquote>\n  <p>CGI::Pretty is DEPRECATED and will be removed in a future release. Please see <a href=\"https://github.com/leejo/CGI.pm/issues/162\" rel=\"nofollow noreferrer\">https://github.com/leejo/CGI.pm/issues/162</a> for more information at C:/Strawberry/perl/site/lib/CGI/Pretty.pm line 21.</p>\n</blockquote>\n\n<p>It is important that you don't ignore warning messages: they are there to help you</p>\n\n<p>You will also get three occurrences of this warning</p>\n\n<blockquote>\n  <p>Odd number of elements in anonymous hash ...</p>\n</blockquote>\n\n<p>That is because you are using <code>{\"class='inforno'\"}</code> which is the <em>wrong syntax</em> for an anonymous hash</p>\n\n<p>Because CGI is deprecated, and because the HTML generation parts of the library are especially frowned on, it is best to use a templating system. One of the most popular templating systems is the\n<a href=\"https://metacpan.org/pod/Template::Toolkit\" rel=\"nofollow noreferrer\"><code>Template::Toolkit</code></a> module,\nand this code shows you how to use it to achieve what you want</p>\n\n<h3>Perl</h3>\n\n<pre><code>use strict;\nuse warnings 'all';\n\nuse Template;\n\nmy @names  = qw/ Foo Bar Moo /;\n\nmy $template = Template-&gt;new;\n\nbinmode STDOUT;\n\n$template-&gt;process('list.html', { list =&gt; \\@names })\n        or die $template-&gt;error;\n</code></pre>\n\n<h3>list.html</h3>\n\n<pre class=\"lang-html prettyprint-override\"><code>[% FOREACH name IN list %]\n&lt;li&gt;\n  &lt;div class='inforno'&gt;\n    &lt;img src='inforno'&gt;\n  &lt;/div&gt;\n  &lt;div class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;[% name %]&lt;/a&gt;\n  &lt;/div&gt;\n  &lt;span class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Edit user&lt;/a&gt;\n  &lt;/span&gt;\n&lt;/li&gt;\n[% END %]\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;li&gt;\n  &lt;div class='inforno'&gt;\n    &lt;img src='inforno'&gt;\n  &lt;/div&gt;\n  &lt;div class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Foo&lt;/a&gt;\n  &lt;/div&gt;\n  &lt;span class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Edit user&lt;/a&gt;\n  &lt;/span&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n  &lt;div class='inforno'&gt;\n    &lt;img src='inforno'&gt;\n  &lt;/div&gt;\n  &lt;div class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Bar&lt;/a&gt;\n  &lt;/div&gt;\n  &lt;span class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Edit user&lt;/a&gt;\n  &lt;/span&gt;\n&lt;/li&gt;\n\n&lt;li&gt;\n  &lt;div class='inforno'&gt;\n    &lt;img src='inforno'&gt;\n  &lt;/div&gt;\n  &lt;div class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Moo&lt;/a&gt;\n  &lt;/div&gt;\n  &lt;span class='inforno'&gt;\n    &lt;a href='#' class='inforno'&gt;Edit user&lt;/a&gt;\n  &lt;/span&gt;\n&lt;/li&gt;\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10360970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65435edcf73c59f8027beae1a6262c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Lee", "link": "https://stackoverflow.com/users/10360970/jose-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536937839, "creation_date": 1536931401, "last_edit_date": 1536937839, "question_id": 52332983, "link": "https://stackoverflow.com/questions/52332983/output-all-names-from-an-array-in-html", "title": "Output all names from an array in HTML", "body": "<p>I am trying to loop and get all arrays, every name with its own <code>&lt;li&gt;</code> element.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;li&gt;\n#Foo\nwith all div and span inside here\n&lt;/li&gt;\n\n&lt;li&gt;\n#bar\nwith all div and span inside here\n&lt;/li&gt;\n\n&lt;li&gt;\n#moo\nwith all div and span inside here\n&lt;/li&gt;\n</code></pre>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use CGI::Pretty \":standard\";\n\n@names  = ('Foo', 'Bar', 'Moo');\nmy $str = join(\" \",@names);\n\n$data =  li (\n           div({\"class='inforno'\"}, \"&lt;img src='inforno&gt;'\"),\n           div({\"class='inforno'\"}, \"&lt;a href='#' class='inforno'&gt;$str&lt;\n+/a&gt;\"),\n           span({\"class='inforno'\"},  \"&lt;a href='#' class='inforno'&gt;\n                   Edit user &lt;/a&gt;\")\n\n          );\n\n     print \"$data\\n\";\n</code></pre>\n\n<p>when I run I get only single <code>&lt;li&gt;</code> element with all names in the same <code>&lt;li&gt;</code>. I want to give each name its own <code>&lt;li&gt;</code> with all <code>&lt;div&gt;</code> and <code>&lt;span&gt;</code> elements inside in opening and closing <code>&lt;li&gt;</code> tags.</p>\n"}, {"tags": ["perl", "hashtable", "key-value", "autovivification"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1536975485, "post_id": 52324973, "comment_id": 91628755, "body": "Note that allowing <code>keys</code> to work on a reference was decided to be a bad idea, and was removed from Perl v5.24. So <code>keys $lookup_cache_latlonhash</code> should be written as <code>keys %$lookup_cache_latlonhash</code>."}], "answers": [{"tags": [], "owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "is_accepted": false, "score": 2, "last_activity_date": 1536900700, "creation_date": 1536900700, "answer_id": 52325158, "question_id": 52324973, "link": "https://stackoverflow.com/questions/52324973/unintentionally-adding-keys-to-hash-while-iterating/52325158#52325158", "title": "Unintentionally adding keys to hash while iterating", "body": "<p>Put</p>\n\n<pre><code>no autovivification;\n</code></pre>\n\n<p>in scope.</p>\n"}, {"comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536930555, "post_id": 52325166, "comment_id": 91612073, "body": "This is completely unrelated to the code in the question."}], "tags": [], "owner": {"reputation": 5252, "user_id": 43012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/180951122f7cacd632da53088781a484?s=128&d=identicon&r=PG", "display_name": "Will Bickford", "link": "https://stackoverflow.com/users/43012/will-bickford"}, "is_accepted": false, "score": 2, "last_activity_date": 1536900737, "creation_date": 1536900737, "answer_id": 52325166, "question_id": 52324973, "link": "https://stackoverflow.com/questions/52324973/unintentionally-adding-keys-to-hash-while-iterating/52325166#52325166", "title": "Unintentionally adding keys to hash while iterating", "body": "<p>You can use the <a href=\"http://perldoc.perl.org/functions/exists.html\" rel=\"nofollow noreferrer\">exists keyword</a> for this.</p>\n\n<h2>Solution</h2>\n\n<pre><code>use Data::Dumper;\n$hash = {};\n$hash{'alpha'} = 'yep';\n$hash{'beta'} = 'this too';\nif (exists $hash{'gamma'}) {\n    print \"Found gamma.\"\n}\nprint Dumper(\\%hash);\n$hash{'gamma'} = 'added';\nif (exists $hash{'gamma'}) {\n    print \"Gamma was updated.\\n\"\n}\nprint Dumper(\\%hash);\n</code></pre>\n\n<h2>Example Output</h2>\n\n<pre><code>$VAR1 = {\n          'beta' =&gt; 'this too',\n          'alpha' =&gt; 'yep'\n        };\nGamma was updated.\n$VAR1 = {\n          'gamma' =&gt; 'added',\n          'beta' =&gt; 'this too',\n          'alpha' =&gt; 'yep'\n        };\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "edited": false, "score": 0, "creation_date": 1536908171, "post_id": 52325196, "comment_id": 91599822, "body": "Makes perfect sense and the sandwiched if between each foreach is clear - thorough answer. I&#39;m wondering why <code>no autovivification</code> isn&#39;t invoked with <code>use strict</code> - it feels like it should be, no?"}, {"owner": {"reputation": 42833, "user_id": 18914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a20a39ae2ef47ae042a3eddd5b5bd19?s=128&d=identicon&r=PG", "display_name": "Dave Sherohman", "link": "https://stackoverflow.com/users/18914/dave-sherohman"}, "reply_to_user": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "edited": false, "score": 2, "creation_date": 1536910627, "post_id": 52325196, "comment_id": 91601082, "body": "@ikebukuru - In my experience, autovivification is the desired behavior (or at least not-undesired) well over 90% of the time. It does surprise a lot of people the first time they encounter it, but it&#39;s extremely rare for it to do any harm beyond that."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536922770, "post_id": 52325196, "comment_id": 91607804, "body": "I&#39;m unclear why you think <code>keys %{ $lookup_cache_latlonhash-&gt;{$lat_key} }</code> will autovivify an element when this is inside a loop <code>for my $lat_key ( keys $lookup_cache_latlonhash )</code> so the element must already exist."}, {"owner": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536965880, "post_id": 52325196, "comment_id": 91627334, "body": "@Borodin indeed! That&#39;s why it had me scratching my head. Thanks for cleaning up my question&#39;s code for readability."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "edited": false, "score": 0, "creation_date": 1536969548, "post_id": 52325196, "comment_id": 91627964, "body": "@ikebukuru: The only way I can see this happening with your own code is if you have the elements already existing but with a value of <code>undef</code>, which will also be autovivified. Is that possible? If not then the problem must exist elsewhere in your code. Check the hash both before and after the outer <code>for</code> loop."}, {"owner": {"reputation": 4462, "user_id": 1018580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757fafb944d47f80a2336d097dcef7c5?s=128&d=identicon&r=PG", "display_name": "Trenton Trama", "link": "https://stackoverflow.com/users/1018580/trenton-trama"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 0, "creation_date": 1536969613, "post_id": 52325196, "comment_id": 91627971, "body": "@Borodin - I somehow missed that it was accessing keys of an element as it looped over it.  However, the description of the problem sounds like a classic explanation of auto-vivification.  There may be another location in the code that&#39;s causing the issue, but it does most likely boil down to auto-vivification."}, {"owner": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "edited": false, "score": 0, "creation_date": 1536971481, "post_id": 52325196, "comment_id": 91628230, "body": "@TrentonTrama it absolutely was an auto-vivification issue; before asking, I&#39;d put in <code>my $size = keys $lookup_cache_latlonhash;</code> and was printing a Dumper of the hash and watching it grow upon every loop through. Found that with the <code>no autovivification</code> directive it worked, before implementing the cleaner solution that you recommended. Thanks!"}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "edited": false, "score": 0, "creation_date": 1536974985, "post_id": 52325196, "comment_id": 91628702, "body": "@ikebukuru: I would still like to see this explained properly. Please can you give some example data that will display this behaviour with the code in your question?"}], "tags": [], "owner": {"reputation": 4462, "user_id": 1018580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757fafb944d47f80a2336d097dcef7c5?s=128&d=identicon&r=PG", "display_name": "Trenton Trama", "link": "https://stackoverflow.com/users/1018580/trenton-trama"}, "is_accepted": true, "score": 9, "last_activity_date": 1536918451, "last_edit_date": 1536918451, "creation_date": 1536900994, "answer_id": 52325196, "question_id": 52324973, "link": "https://stackoverflow.com/questions/52324973/unintentionally-adding-keys-to-hash-while-iterating/52325196#52325196", "title": "Unintentionally adding keys to hash while iterating", "body": "<p>What you're experiencing is <a href=\"https://en.wikipedia.org/wiki/Autovivification\" rel=\"noreferrer\">auto-vivification</a>.  It's a feature of Perl to make working with nested structures a little easier.  </p>\n\n<p>Any time an undefined value is dereferenced, perl will automatically create the object you're accessing.</p>\n\n<pre><code>use Data::Dumper; \nmy $hash = {}; if ($hash-&gt;{'a'}) {} #No auto-vivification because you're just checking the value   \nkeys %{$hash-&gt;{'b'}}; #auto-vivification because you're acting on the value (getting the keys of it) $hash-&gt;{b} \nprint Dumper($hash);\n</code></pre>\n\n<p>There are a couple of ways to avoid this - </p>\n\n<ol>\n<li>Add <code>no autovivification</code> in the scope you want to avoid this\nfunctionality </li>\n<li>Check to see if they item you're accessing is defined\nor exists (and is of the type you need)</li>\n</ol>\n\n<p>I recommend the second one because it helps build the habit of checking your code for correct data structuring and makes debugging much easier.</p>\n\n<pre><code>foreach my $lat_key (keys $lookup_cache_latlonhash) {\n    if (($lat &gt; ($lat_key - .5)) \n        &amp;&amp; ($lat &lt; ($lat_key + .5)) \n        &amp;&amp; ref($lookup_cache_latlonhash-&gt;{$lat_key}) eq 'HASH')  #expecting a hash here - undefined or any non-hash value will skip the foreach\n    {\n        foreach my $lon_key (keys %{ $lookup_cache_latlonhash-&gt;{$lat_key}}) {\n            if (($lon &gt; ($lon_key - .5)) &amp;&amp; ($lon &lt; ($lon_key + .5))) {\n                $country = $$lookup_cache_latlonhash{$lat_key}{$lon_key};\n                print \"Approx match found: $lat_key $lon_key $country\\n\";\n                return $country;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10352116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d323a002259e56a92ef55c9dbebb97f1?s=128&d=identicon&r=PG", "display_name": "ikebukuru", "link": "https://stackoverflow.com/users/10352116/ikebukuru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 52325196, "answer_count": 3, "score": 4, "last_activity_date": 1536966109, "creation_date": 1536899131, "last_edit_date": 1536966109, "question_id": 52324973, "link": "https://stackoverflow.com/questions/52324973/unintentionally-adding-keys-to-hash-while-iterating", "title": "Unintentionally adding keys to hash while iterating", "body": "<p>I'm iterating through a cache of a hash of hashes of latitude keys that point to key/value pairs of longitudes/cities. I'm trying to find approximate matches for latitudes/longitudes that are close enough to what's already been looked up and is in the hash.</p>\n\n<p>I'm doing it like this</p>\n\n<pre><code>    foreach my $lat_key ( keys $lookup_cache_latlonhash ) {\n\n        if ( ($lat &gt; ($lat_key - .5)) &amp;&amp; ($lat &lt; ($lat_key + .5)) ) {\n\n            foreach my $lon_key ( keys %{ $lookup_cache_latlonhash-&gt;{$lat_key}} ) {\n\n                if ( ($lon &gt; ($lon_key - .5)) &amp;&amp; ($lon &lt; ($lon_key + .5)) ) {\n\n                    $country = $$lookup_cache_latlonhash{$lat_key}{$lon_key};\n                    print \"Approx match found: $lat_key $lon_key $country\\n\";\n                    return $country;\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>The code works to find these lat/lon pairs within the range. However for each latitude it loops through using, when it does find it's in range (the first nested condition), it's adding it to the hash (presumably <code>keys %{ $goog_lookup_cache_latlonhash-&gt;{$lat_key}}</code>) which is not intended, adding useless/empty keys to the hash:</p>\n\n<pre><code>$VAR1 = {\n      '37.59' =&gt; {},\n      '37.84' =&gt; {},\n      '37.86' =&gt; {},\n      '37.42' =&gt; {\n                   '126.44' =&gt; 'South Korea/Jung-gu'\n                 },\n      '37.92' =&gt; {},\n      '37.81' =&gt; {},\n      '38.06' =&gt; {\n                   '-122.53' =&gt; 'America/Novato'\n                 },\n      '37.8' =&gt; {},\n      '37.99' =&gt; {},\n      '37.61' =&gt; {},\n       ...\n</code></pre>\n\n<p>What's the clever, or at least sane, way to do this lookup? So I'm not unintentionally adding keys to the hash just by looking them up?</p>\n"}, {"tags": ["string", "perl", "output"], "comments": [{"owner": {"reputation": 915, "user_id": 2016450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R9IKl.jpg?s=128&g=1", "display_name": "mrunion", "link": "https://stackoverflow.com/users/2016450/mrunion"}, "edited": false, "score": 2, "creation_date": 1536895139, "post_id": 52324477, "comment_id": 91596053, "body": "It appears your code is left justified. Can you provide a sample of what you want the output to look like?"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1536895511, "post_id": 52324477, "comment_id": 91596106, "body": "Are you sure you want to <code>&#47;=</code>?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1536895519, "post_id": 52324477, "comment_id": 91596109, "body": "Your last printf gets just one variable, <code>$total</code>, which thus gets formatted as <code>%-6s</code> -- and the <code>%.2f</code> gets nothing.  Did you forget another variable before <code>$total</code>, or should there be no <code>%-6s</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "is_accepted": false, "score": 1, "last_activity_date": 1536933265, "last_edit_date": 1536933265, "creation_date": 1536932528, "answer_id": 52333261, "question_id": 52324477, "link": "https://stackoverflow.com/questions/52324477/left-justify-output/52333261#52333261", "title": "Left justify output", "body": "<p>You don't need to use <code>printf</code> if you're trying to left-justify the values, just add spaces in the label strings. By label string I mean e.g. <code>\"Credits taken:       %s\\n\"</code> (note the spaces between the <code>:</code> and the <code>%</code>)</p>\n\n<pre><code>$user_name = 'Jogi';\n$credits_taken = 13;\n$credits_passed = 9;\n$semester_gpa = 4.329;\n\n#Calculating $semester_gpa\nif($credits_taken == 0) {\n  exit();\n}\nmy $total = $semester_gpa /= $credits_taken;\n\n#Output formatting\nprintf (\"The student name is: %s\\n\", $user_name);\nprintf (\"Credits taken:       %s\\n\", $credits_taken);\nprintf (\"Credits passed:      %s\\n\", $credits_passed);\nprintf (\"GPA:                 %.2f\\n\", $total);\n</code></pre>\n\n<p>Even if you wanted to right-justify, you should still put spaces in the label strings to make the code clear and easy to understand:</p>\n\n<pre><code>printf (\"The student name is: %10s\\n\", $user_name);\nprintf (\"Credits taken:       %10s\\n\", $credits_taken);\nprintf (\"Credits passed:      %10s\\n\", $credits_passed);\nprintf (\"GPA:                 %10.2f\\n\", $total);\n</code></pre>\n\n<p>Notice the syntax <code>%10.2f</code> to combine right-justify with decimal precision.</p>\n\n<p>To make the width of the justified fields dynamic you can use the special <code>*</code> (asterisk) <a href=\"https://perldoc.perl.org/functions/sprintf.html\" rel=\"nofollow noreferrer\">syntax for printf</a>:</p>\n\n<pre><code>$width = 20;\nprintf (\"The student name is: %*s\\n\", $width, $user_name);\nprintf (\"Credits taken:       %*s\\n\", $width, $credits_taken);\nprintf (\"Credits passed:      %*s\\n\", $width, $credits_passed);\nprintf (\"GPA:                 %*.2f\\n\", $width, $total);\n</code></pre>\n\n<p>You could even make the precision dynamic if you wanted:</p>\n\n<pre><code>$width = 20;\n$precision = 2;\nprintf (\"GPA:                 %*.*f\\n\", $width, $precision, $total);\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 5701641, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JuTHnkxHPT0/AAAAAAAAAAI/AAAAAAAAAbI/wrda8chhosw/photo.jpg?sz=128", "display_name": "Sai Peri", "link": "https://stackoverflow.com/users/5701641/sai-peri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536937502, "creation_date": 1536894942, "question_id": 52324477, "link": "https://stackoverflow.com/questions/52324477/left-justify-output", "title": "Left justify output", "body": "<p>I am working on an assignment where I have to left justify my output text. When I test may program I can't seem to get the output to line up. Also for the GPA if I try to justify the text I lose the 2 decimal point precision. Here is my code</p>\n\n<pre><code>#Calculating $semester_gpa\nif($credits_taken == 0) {\n  exit();\n}\nmy $total = $semester_gpa /= $credits_taken;\n\n#Output formatting\nprintf (\"The student name is: %-6s\\n\",$user_name);\nprintf (\"Credits taken: %-6s\\n\", $credits_taken);\nprintf (\"Credits passed: %-6s\\n\", $credits_passed);\nprintf (\"GPA: %-6s %.2f\\n\", $total);\n</code></pre>\n\n<p>The output of my program is as follows\n<a href=\"https://i.stack.imgur.com/sgsy9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sgsy9.png\" alt=\"enter image description here\"></a></p>\n\n<p>What exactly am I doing wrong?</p>\n"}, {"tags": ["python", "perl", "pipe"], "comments": [{"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536892955, "post_id": 52323653, "comment_id": 91595608, "body": "why do you need python for this? it seems you just need the first two columns, why not use <code>perl</code> directly, calling the two columns from the file directly?? ie <code>perl -pe &quot;s&#47;((.*?\\t)(?2)).*&#47;$1&#47;&quot; C:\\users\\file1.txt</code>"}, {"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536893064, "post_id": 52323653, "comment_id": 91595629, "body": "also <code>my ($name, $title) = split &#39;_&#39;</code> is enough"}, {"owner": {"reputation": 1, "user_id": 10361170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zg839jOI23o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNb4XSwrYrGUCHA9JiqpqT3Y725qw/mo/photo.jpg?sz=128", "display_name": "duaghk", "link": "https://stackoverflow.com/users/10361170/duaghk"}, "reply_to_user": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536893109, "post_id": 52323653, "comment_id": 91595636, "body": "Thanks for your reply. I need to edit 2 dataframe and need to merge it by specific id and adjust some values two dataframe."}, {"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536893231, "post_id": 52323653, "comment_id": 91595664, "body": "which should call the other? Should python call perl or should perl call python?? I don&#39;t know which is which, but you can use <code>import os;print(os.popen(the_code_above).read())</code> which should also work"}, {"owner": {"reputation": 1, "user_id": 10361170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zg839jOI23o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNb4XSwrYrGUCHA9JiqpqT3Y725qw/mo/photo.jpg?sz=128", "display_name": "duaghk", "link": "https://stackoverflow.com/users/10361170/duaghk"}, "reply_to_user": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536894022, "post_id": 52323653, "comment_id": 91595828, "body": "python print the lines, and perl need to read and make them hash"}, {"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536894344, "post_id": 52323653, "comment_id": 91595898, "body": "But you can do that directly in python!! hash in perl is known as dictionaries in python"}, {"owner": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536894498, "post_id": 52323653, "comment_id": 91595931, "body": "just do <code>hash = dict(zip(data[1],data[0]))</code>.  and you can obtain the elements you need for example <code>hash[&#39;the_title_you_want&#39;]</code>"}, {"owner": {"reputation": 1, "user_id": 10361170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zg839jOI23o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNb4XSwrYrGUCHA9JiqpqT3Y725qw/mo/photo.jpg?sz=128", "display_name": "duaghk", "link": "https://stackoverflow.com/users/10361170/duaghk"}, "reply_to_user": {"reputation": 28698, "user_id": 8380272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3ZL-hcLCA44/AAAAAAAAAAI/AAAAAAAAAag/L1xahsLXycQ/photo.jpg?sz=128", "display_name": "Onyambu", "link": "https://stackoverflow.com/users/8380272/onyambu"}, "edited": false, "score": 0, "creation_date": 1536898862, "post_id": 52323653, "comment_id": 91596774, "body": "I need to stdout all text.. not just value..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10361170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zg839jOI23o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNb4XSwrYrGUCHA9JiqpqT3Y725qw/mo/photo.jpg?sz=128", "display_name": "duaghk", "link": "https://stackoverflow.com/users/10361170/duaghk"}, "edited": false, "score": 0, "creation_date": 1536893315, "post_id": 52324208, "comment_id": 91595680, "body": "Thanks to your reply!  I just edit my code what you suggest, and successfully get all lines. Thanks!"}], "tags": [], "owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "is_accepted": false, "score": 2, "last_activity_date": 1536892256, "creation_date": 1536892256, "answer_id": 52324208, "question_id": 52323653, "link": "https://stackoverflow.com/questions/52323653/python-print-perl-stdin-line-skip-problem/52324208#52324208", "title": "Python print -&gt; Perl STDIN line skip problem", "body": "<p>The expression <code>&lt;STDIN&gt;</code> reads a line from standard input, so your Perl code reads two lines for every iteration of the <code>while</code> loop.</p>\n\n<p>It is sufficient to say</p>\n\n<pre><code>while (&lt;STDIN&gt;) {\n    my $line = $_;\n    ...\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>while (my $line = &lt;STDIN&gt;) {\n    ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10361170, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zg839jOI23o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNb4XSwrYrGUCHA9JiqpqT3Y725qw/mo/photo.jpg?sz=128", "display_name": "duaghk", "link": "https://stackoverflow.com/users/10361170/duaghk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536892256, "creation_date": 1536886952, "question_id": 52323653, "link": "https://stackoverflow.com/questions/52323653/python-print-perl-stdin-line-skip-problem", "title": "Python print -&gt; Perl STDIN line skip problem", "body": "<p>Im newbie of perl and python.</p>\n\n<p>I need to file handling in python(dataframe), and that file need to calculated in Perl.</p>\n\n<p>At first, I tried to use python subprocess, and it was not working(borken pipe)</p>\n\n<p>i need to multiple lines from python, and perl code need to read it and processing.</p>\n\n<p>I just use | in command line, and it was work, but perl skip odds number line and just read even number line.</p>\n\n<p>how can i fix it?</p>\n\n<p>my python code is :</p>\n\n<pre><code>import pandas as pd\n\ndata = pd.read_csv('./data.txt', sep = '\\t', header = None)\n\ndatalist = list(data[0] + '_' + data[1])\n\nfor line in kinase_list:\n\n    print(line)\n</code></pre>\n\n<p>and my perl code is :\n//</p>\n\n<pre><code>use strict;\n\nmy %new_list = ();\n\nwhile (&lt;STDIN&gt;){\n  my $line = &lt;STDIN&gt;;\n#  print STDERR $line;\n#  chomp $line;\n  my ($name, $title) = split('_', &lt;STDIN&gt;);\n  $new_list{$title} = $name;\n  print STDERR $name, \"\\t\", $title, \"\\n\";\n}\n\nprint STDERR scalar(keys %new_list);\n</code></pre>\n\n<p>my python output 657 lines, but perl just out 329.</p>\n\n<p>how can i fix it?</p>\n"}, {"tags": ["html", "file", "perl"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1536865346, "post_id": 52319767, "comment_id": 91587800, "body": "Copy the subroutine into another file and add code to call that subroutine and print the two arrays. Run the new file."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 3972351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b40ff35cfcbbe4a456b9ca05209b0d?s=128&d=identicon&r=PG&f=1", "display_name": "melds", "link": "https://stackoverflow.com/users/3972351/melds"}, "is_accepted": false, "score": 1, "last_activity_date": 1536864657, "creation_date": 1536864657, "answer_id": 52320084, "question_id": 52319767, "link": "https://stackoverflow.com/questions/52319767/how-to-only-copy-lines-of-code-with-specific-word-from-perl-file-into-new-file/52320084#52320084", "title": "How to only copy lines of code with specific word from perl file into new file", "body": "<p>If you're using a unix-like OS, try using grep. Something like:</p>\n\n<pre><code>$ grep 'push' myfile.pl | grep -Po '(?&lt;=qq\\().*(?=\\);)' &gt;Newfile.html\n</code></pre>\n\n<p>The first grep just grabs lines with 'push' on them. The second grep turns on Perl RE mode (the -P) and only returns matching results. The query has two parts: <code>(?&lt;=qq\\()</code> matches \"qq(\" right before the text (but doesn't include it in the result) and (?=);) looks for the last \");\" on the line.</p>\n\n<p>This won't match multi-line quotes and the output will also include escapes, like the \\n for newlines.</p>\n"}, {"tags": [], "owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "is_accepted": false, "score": 0, "last_activity_date": 1536924668, "last_edit_date": 1536924668, "creation_date": 1536924356, "answer_id": 52331009, "question_id": 52319767, "link": "https://stackoverflow.com/questions/52319767/how-to-only-copy-lines-of-code-with-specific-word-from-perl-file-into-new-file/52331009#52331009", "title": "How to only copy lines of code with specific word from perl file into new file", "body": "<p>Using perl to grep the file:</p>\n\n<pre><code>perl -lne'm/push.+qq\\((.+)?(\\\\n)\\);/ &amp;&amp; print $1' source.pl &gt; target.html\n</code></pre>\n\n<p>For the output you've shown, this one-liner will work.</p>\n\n<p>If your source script is more complex, e.g. multi-line statements and embedded variables, then you will need to write some temporary code to call <code>getTable</code>, print the contents of <code>@htmlBase</code>, then save that output to the new file.</p>\n"}], "owner": {"reputation": 41, "user_id": 10360144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f045cc610cd3bc6112fcc532637a87?s=128&d=identicon&r=PG&f=1", "display_name": "FranceMadrid9", "link": "https://stackoverflow.com/users/10360144/francemadrid9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1536924668, "creation_date": 1536863268, "last_edit_date": 1536866011, "question_id": 52319767, "link": "https://stackoverflow.com/questions/52319767/how-to-only-copy-lines-of-code-with-specific-word-from-perl-file-into-new-file", "title": "How to only copy lines of code with specific word from perl file into new file", "body": "<p>I have a perl file with html code inside of a subroutine. I want to copy the html code into a new file but ONLY the html code, not the rest of the perl syntax. The HTML code is all inside of one subroutine and all the HTML code starts with the 'push':</p>\n\n<pre><code>sub getTable {    \n    push @htmlBase, qq(&lt;html&gt;\\n);\n    push @htmlBase, qq(\\n);\n    push @htmlBase, qq(&lt;head&gt;\\n);\n    push @htmlBase, qq(&lt;meta http-equiv=\"Content-Language\" content=\"en-us\"&gt;\\n);\n</code></pre>\n\n<p>In essence, how do I ONLY copy lines that start with 'push' into a new file from my current perl file? Thanks in advance.</p>\n"}, {"tags": ["file", "perl", "text"], "comments": [{"owner": {"reputation": 6351, "user_id": 3498962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9tW.jpg?s=128&g=1", "display_name": "Essex Boy", "link": "https://stackoverflow.com/users/3498962/essex-boy"}, "edited": false, "score": 1, "creation_date": 1536844221, "post_id": 52314092, "comment_id": 91576070, "body": "$ grep -nr Apples file1 | awk &#39;{count++;print $0}END{print count}&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 2347, "user_id": 1717259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f70451a8ea5b380bf1a28fe529b190cc?s=128&d=identicon&r=PG", "display_name": "user1717259", "link": "https://stackoverflow.com/users/1717259/user1717259"}, "is_accepted": false, "score": 4, "last_activity_date": 1536845430, "last_edit_date": 1536845430, "creation_date": 1536844486, "answer_id": 52314561, "question_id": 52314092, "link": "https://stackoverflow.com/questions/52314092/output-the-line-numbers-where-a-string-appears/52314561#52314561", "title": "Output the line numbers where a string appears", "body": "<p>Change </p>\n\n<p><code>push(@lineAry, $counter);</code></p>\n\n<p>to </p>\n\n<p><code>push(@lineAry, $.);</code></p>\n\n<p><code>$.</code> is a variable that stores the line number when using perl's <code>while (&lt;&gt;)</code>.</p>\n\n<p>The alternative, if you want to use your $counter variable, is that you move the increment to increment on every line, not on every match.</p>\n"}, {"comments": [{"owner": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 0, "creation_date": 1537206940, "post_id": 52314754, "comment_id": 91691286, "body": "<code>my $n = 0;</code> for when there is no apples."}, {"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "reply_to_user": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 0, "creation_date": 1537304791, "post_id": 52314754, "comment_id": 91734283, "body": "@Kjetil: Agreed, but I would prefer to see a warning because the <code>on these lines</code> then needs fixing too, and it&#39;s just not worth it for this case."}, {"owner": {"reputation": 2626, "user_id": 849967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/137c89ef80ed860b95e68b42e0d5353e?s=128&d=identicon&r=PG", "display_name": "Kjetil S.", "link": "https://stackoverflow.com/users/849967/kjetil-s"}, "edited": false, "score": 0, "creation_date": 1537536004, "post_id": 52314754, "comment_id": 91832049, "body": "I see your point, <code>if $n&gt;0</code> could be appended to the last line."}], "tags": [], "owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "is_accepted": true, "score": 5, "last_activity_date": 1536845596, "last_edit_date": 1536845596, "creation_date": 1536845229, "answer_id": 52314754, "question_id": 52314092, "link": "https://stackoverflow.com/questions/52314092/output-the-line-numbers-where-a-string-appears/52314754#52314754", "title": "Output the line numbers where a string appears", "body": "\n\n<p>There are a number of problems with your code, but the reason for the line numbers being printed wrongly is that you are incrementing your variable <code>$counter</code> once each time <code>Apples</code> appears on a line and saving it to <code>@lineAry</code>. That is different from the number of the line where the string appears, and the easiest fix is to use the built-in variable <code>$.</code> which represents the number of times a read has been performed on the file handle</p>\n\n<p>In addition, I would encourage you to use lexical file handles, and the three-parameter form of <code>open</code>, and check that every call to <code>open</code> has succeeded</p>\n\n<p>You never use the value of <code>$initialLine</code>, and I don't understand why you have initialised it to 10</p>\n\n<p>I would write it like this</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings 'all';\n\nmy $filename = 'file.txt';\n\nopen my $fh, '&lt;', $filename or die qq{Unable to open \"$filename\" for input: $!};\n\nmy @lines;\nmy $n;\n\nwhile ( &lt;$fh&gt; ) {\n    push @lines, $. if /apples/i;\n    ++$n while /apples/ig;\n}\n\nprint \"Apples appear $n times in this file\\n\";\nprint \"Apples appear on these lines: \", join( ', ', @lines ), \"\\n\\n\";\n</code></pre>\n\n<h3>output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Apples appear 2 times in this file\nApples appear on these lines: 1, 4\n</code></pre>\n"}], "owner": {"reputation": 943, "user_id": 1608954, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd1368f3b1b64bf10b40fddf19b7365d?s=128&d=identicon&r=PG", "display_name": "Minimalist", "link": "https://stackoverflow.com/users/1608954/minimalist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 52314754, "answer_count": 2, "score": 0, "last_activity_date": 1536845596, "creation_date": 1536842883, "last_edit_date": 1536845516, "question_id": 52314092, "link": "https://stackoverflow.com/questions/52314092/output-the-line-numbers-where-a-string-appears", "title": "Output the line numbers where a string appears", "body": "\n\n<p>I am trying to determine how many time a string, <code>Apples</code> appears in a text file and in which lines it appears.</p>\n\n<p>The script outputs incorrect line numbers, instead it outputs numbers consecutively (1,2,..) and not the correct lines for the word.</p>\n\n<h3>file.txt</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>    Apples\n    Grapes\n    Oranges\n    Apples\n</code></pre>\n\n<h3>Goal Output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Apples appear 2 times in this file\nApples appear on these lines: 1, 4,\n</code></pre>\n\n<p>Instead my output as illustrated from the code below is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Apples appear 2 times in this file\nApples appear on these lines: 1, 2,\n</code></pre>\n\n<h3>Perl</h3>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my $filename = \"&lt;file.txt\";\n\nopen( TEXT, $filename );\n\n$initialLine = 10;    ## holds the number of the line\n$line        = 0;\n$counter     = 0;\n\n# holder for line numbers\n@lineAry = ();\n\nwhile ( $line = &lt;TEXT&gt; ) {\n\n    chomp( $line );\n\n    if ( $line =~ /Apples/ ) {\n\n        while ( $line =~ /Apples/ig ) {\n            $counter++;\n        }\n\n        push( @lineAry, $counter );\n\n        $initialLine++;\n    }\n}\nclose( TEXT );\n\n# print \"\\n\\n'Apples' occurs $counter times in file.\\n\";\nprint \"Apples appear $counter times in this file\\n\";\nprint \"Apples appear on these lines: \";\n\nforeach $a ( @lineAry ) {\n    print \"$a, \";\n}\n\nprint \"\\n\\n\";\n\nexit;\n</code></pre>\n"}, {"tags": ["perl", "slack-api", "mojolicious", "mojolicious-lite"], "comments": [{"owner": {"reputation": 23438, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 1, "creation_date": 1536841020, "post_id": 52313267, "comment_id": 91574107, "body": "I don&#39;t think its fair to ask people to rewrite your existing fork based code for you.So please post your last best attempt using the Mojo approach."}, {"owner": {"reputation": 91, "user_id": 2491075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e805f2fca5f6cbaaa010dedf1aca4b?s=128&d=identicon&r=PG", "display_name": "Spyratos Aggelos", "link": "https://stackoverflow.com/users/2491075/spyratos-aggelos"}, "reply_to_user": {"reputation": 23438, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 1, "creation_date": 1536853940, "post_id": 52313267, "comment_id": 91582197, "body": "thanks for indicating Erik! I ll keep that in mind in any future questions !"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 2491075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e805f2fca5f6cbaaa010dedf1aca4b?s=128&d=identicon&r=PG", "display_name": "Spyratos Aggelos", "link": "https://stackoverflow.com/users/2491075/spyratos-aggelos"}, "edited": false, "score": 0, "creation_date": 1536842597, "post_id": 52313877, "comment_id": 91575095, "body": "I didn&#39;t get the reason for a downvote in my answer :( . Please at least leave a comment when you downvote so people with low expirience on stackoverflow (like me) can have an actual feedback of what they did wrong...)"}, {"owner": {"reputation": 23438, "user_id": 4379151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kOLJQ.jpg?s=128&g=1", "display_name": "Erik Kalkoken", "link": "https://stackoverflow.com/users/4379151/erik-kalkoken"}, "edited": false, "score": 0, "creation_date": 1536845676, "post_id": 52313877, "comment_id": 91576946, "body": "Not sure why you got the downvote - maybe is because you mixed your reply to my comment into your answer. Would suggest to remove that bit from the answer and make it an actual comment next to mine. that way other people will find it easier to understand and read the whole thing."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1537312144, "post_id": 52313877, "comment_id": 91736472, "body": "FYI you should use Mojo::IOLoop-&gt;subprocess to spawn subprocesses rather than creating the object yourself; and since you&#39;re in the context of a Mojolicious controller action, <a href=\"https://metacpan.org/pod/Mojolicious::Plugin::Subprocess\" rel=\"nofollow noreferrer\">Mojolicious::Plugin::Subprocess</a> will handle it even better."}], "tags": [], "owner": {"reputation": 91, "user_id": 2491075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e805f2fca5f6cbaaa010dedf1aca4b?s=128&d=identicon&r=PG", "display_name": "Spyratos Aggelos", "link": "https://stackoverflow.com/users/2491075/spyratos-aggelos"}, "is_accepted": true, "score": 3, "last_activity_date": 1536853910, "last_edit_date": 1536853910, "creation_date": 1536842124, "answer_id": 52313877, "question_id": 52313267, "link": "https://stackoverflow.com/questions/52313267/delayed-response-to-slash-command-with-mojolicious-in-perl/52313877#52313877", "title": "Delayed response to slash command with Mojolicious in Perl", "body": "<p>Actually I just found a solution to my problem!</p>\n\n<p>So here is my solution:</p>\n\n<pre><code>my $c = shift; #receive request\n\nmy $user   = $c-&gt;param('user_name'); #get parameters\nmy $response_url = $c-&gt;param('response_url');\nmy $text = $c-&gt;param('text');\n\nmy $response_body = { #create the imidiate response that Slack is waiting for\n            response_type =&gt; \"ephemeral\",\n            text          =&gt; \"Running for $user:\",\n            attachments   =&gt; [\n                { text =&gt; 'analyze' },\n            ],\n        };\n\nmy $subprocess = Mojo::IOLoop::Subprocess-&gt;new; #create the subprocesses\n$subprocess-&gt;run(\nsub {do_time_consuming_things($user,$response_url,$text)}, #this callback is the\n#actuall subprocess that will run in background and contains the POST request\n#from my \"fork\" code (with the output) that should send a late response to Slack\nsub {# this is a dummy subprocess doing nothing as this is needed by Mojo.\n    my ($subprocess, $err, @results) = @_;\n    say $err if $err;\n    say \"\\n\\nok\\n\\n\";\n}\n);\n#and here is the actual imidiate response outside of the subprocesses in order\n#to avoid making the server wait for the subprocess to finish before responding!\n$c-&gt;render( json =&gt; $response_body ); \n</code></pre>\n\n<p>So I actually simply had to put my code of do_time_consuming_things in the first callback (in order for it to run as a subprocess) and use the second callback (that is actually linked to the parent process) as a dummy one and keep my \"imidiate\" response in the main body of the whole function instead of putting it inside one of the subprocesses. See code comments for more information!</p>\n"}], "owner": {"reputation": 91, "user_id": 2491075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e805f2fca5f6cbaaa010dedf1aca4b?s=128&d=identicon&r=PG", "display_name": "Spyratos Aggelos", "link": "https://stackoverflow.com/users/2491075/spyratos-aggelos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 52313877, "answer_count": 1, "score": 3, "last_activity_date": 1536861504, "creation_date": 1536839954, "last_edit_date": 1536861504, "question_id": 52313267, "link": "https://stackoverflow.com/questions/52313267/delayed-response-to-slash-command-with-mojolicious-in-perl", "title": "Delayed response to slash command with Mojolicious in Perl", "body": "<p>I am trying to create a slack application in Perl with mojolicious and I am having the following use case:</p>\n\n<p>Slack sends a request to my API from a slash command and needs a response in a 3 seconds timeframe. However, Slack also gives me the opportunity to send up to 5 more responses in a 30 minute timeframe but still needs an initial response in 3 seconds (it just sends a \"late_response_url\" in the initial call back so that I could POST something to that url later on). In my case I would like to send an initial response to slack to inform the user that the operation is \"running\" and after a while send the actual outcome of my slow function to Slack.</p>\n\n<p>Currently, I can do this by spawning a second process using fork() and using one process to respond imidiately as Slack dictates and the second to do the rest of the work and respond later on. </p>\n\n<p>I am trying to do this with Mojolicious' subprocesses to avoid using fork(). However I can't find a way to get this to work....</p>\n\n<p>a sample code of what I am already doing with fork is like this: </p>\n\n<pre><code>sub withpath\n{\n     my $c = shift;\n\n     my $user   = $c-&gt;param('user_name');\n\n     my $response_body = {\n                response_type =&gt; \"ephemeral\",\n                text          =&gt; \"Running for $user:\",\n                attachments   =&gt; [\n                     { text =&gt; 'analyze' },\n                 ],\n             };\n     my $pid = fork();\n     if($pid != 0){\n         $c-&gt;render( json =&gt; $response_body );\n     }else{\n         $output = do_time_consuming_things()\n         $response_body = {\n             response_type =&gt; \"in-channel\",\n             text          =&gt; \"Result for $user:\",\n             attachments   =&gt; [\n                { text =&gt; $output },\n             ],\n         };\n\n         my $ua = Mojo::UserAgent-&gt;new;\n         my $tx = $ua-&gt;post(\n               $response_url,\n               { Accept =&gt; '*/*' },\n               json =&gt; $response_body,\n               );\n        if( my $res = $tx-&gt;success )\n        {\n                print \"\\n success \\n\";\n        }\n        else\n        {\n                my $err = $tx-&gt;error;\n                print \"$err-&gt;{code} response: $err-&gt;{message}\\n\" if $err-&gt;{code};\n                print \"Connection error: $err-&gt;{message}\\n\";\n        }\n    }\n}\n</code></pre>\n\n<p>So the problem is that no matter how I tried I couldn't replicate the exact same code with Mojolicious' subproccesses. Any ideas?</p>\n\n<p>Thanks in advance!</p>\n"}]