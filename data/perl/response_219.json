[{"tags": ["perl", "debugging", "directory", "padre"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1553200061, "post_id": 55271280, "comment_id": 97306840, "body": "I have not used Padre before, but I was able to install it now. It seems that you can use the <i>&quot;Run in directory&quot;</i> option from the <i>&quot;Debug launch Parameters&quot;</i> dialog to set the script execution directory"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1553224705, "post_id": 55271280, "comment_id": 97313544, "body": "@H&#229;konH&#230;gland - Wow.. wait... where do you see that dialog?"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1553257556, "post_id": 55271280, "comment_id": 97327462, "body": "I select menu <i>&quot;Debug-&gt;Debug launch options&quot;</i> then I get the dialog"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1553265970, "post_id": 55271280, "comment_id": 97332795, "body": "That&#39;s weird, I don&#39;t have that option in my Debug menu. What Padre version are you using? I use Padre 0.94 (32-bit) on Windows, installed from the <code>dwimperl-5.14.2.1-v7-32bit.exe</code> installer."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1553266346, "post_id": 55271280, "comment_id": 97333020, "body": "I installed <a href=\"https://www.cpan.org/modules/by-module/Padre/Padre-1.00.tar.gz\" rel=\"nofollow noreferrer\">version 1.00</a> and I am using Ubuntu 18.10. So it seems this option is a feature that was added recently (after 0.94)?"}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1553270182, "post_id": 55271280, "comment_id": 97335348, "body": "Mmmmm.... Seems like the latest (official?) Windows release (2012!!) lags behind the Ubuntu release, unfortunately."}, {"owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "reply_to_user": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 1, "creation_date": 1553270926, "post_id": 55271280, "comment_id": 97335776, "body": "Downloaded the tarball but no obvious way to build on Windows (and the documentation is atrocious), so I just let go. If you make your comments an answer, I can upvote (and accept) it."}], "answers": [{"tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 1, "last_activity_date": 1553280998, "creation_date": 1553280998, "answer_id": 55306174, "question_id": 55271280, "link": "https://stackoverflow.com/questions/55271280/how-to-set-the-script-execution-directory-in-padre-debugger/55306174#55306174", "title": "How to set the script execution directory in Padre debugger?", "body": "<blockquote>\n  <p>How can one set the execution directory to be other than the script's location?</p>\n</blockquote>\n\n<p>According to the comments, you seem to be running Padre version 0.94 for Windows, then apparently it is not possible to set the directory (at least from the GUI). </p>\n\n<p>However, the feature seems to have been added to Padre later. I installed Padre version 1.00 on my Ubuntu 18.10 laptop running Perl 5.29.8 (with thread support). Then there is an option \n <em>\"Run in directory\"</em> from the <em>\"Debug launch Parameters\"</em> dialog where you can set the script execution directory.</p>\n"}], "owner": {"reputation": 6975, "user_id": 274579, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/745415fffcdea46caf03c90534a4c7fa?s=128&d=identicon&r=PG", "display_name": "ysap", "link": "https://stackoverflow.com/users/274579/ysap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 55306174, "answer_count": 1, "score": 1, "last_activity_date": 1553280998, "creation_date": 1553122168, "last_edit_date": 1553181505, "question_id": 55271280, "link": "https://stackoverflow.com/questions/55271280/how-to-set-the-script-execution-directory-in-padre-debugger", "title": "How to set the script execution directory in Padre debugger?", "body": "<p>How to set the script execution directory?</p>\n\n<p>For example, the script <code>main.pl</code> is located in a <code>scripts/</code> directory. The file to be processed is <code>data.txt</code>, located in a <code>data/</code> directory.</p>\n\n<p>Then, <code>cd data/</code> and invoke the script using <code>../scripts/main.pl -i data.txt</code></p>\n\n<p>When debugging the script in Padre debugger, the execution directory is the script's location <code>scripts/</code>. The command args <code>-i data.txt</code> can be set through the Preferences dialog, but in order for this to work, it needs to be changed to <code>-i ../data/data.txt</code></p>\n\n<p>How can one set the execution directory ti be other than the script's location?</p>\n"}, {"tags": ["arrays", "file", "perl", "loops"], "comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1553123916, "post_id": 55271234, "comment_id": 97274247, "body": "Do you <i>really</i> need the arrays to be named <code>first_array</code>, <code>second_array</code>, etc? Or do you just want to make sure each file gets loaded into a separate array?"}, {"owner": {"reputation": 105, "user_id": 10675821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4097be1d7de1201ca93069000faa8783?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil\u0117 Vaini\u016bt\u0117", "link": "https://stackoverflow.com/users/10675821/kamil%c4%97-vaini%c5%abt%c4%97"}, "reply_to_user": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1553125066, "post_id": 55271234, "comment_id": 97274577, "body": "Not sure, what I really need to do is to later access elements from different arrays with the same indexes(I need to multiply first_array[0] with second_array[0], first_array[1] with second_array[1] and etc.)"}], "answers": [{"comments": [{"owner": {"reputation": 799, "user_id": 3956017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5814cfe5bfd09b7e3047088132a8eac7?s=128&d=identicon&r=PG&f=1", "display_name": "Garo", "link": "https://stackoverflow.com/users/3956017/garo"}, "edited": false, "score": 2, "creation_date": 1553126844, "post_id": 55271791, "comment_id": 97275044, "body": "Incorrect, <code>push @array_of_arrays, @array</code> will just add all values in @array to @array_of_arrays. The result here will be one large array and not an array of arrays"}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "reply_to_user": {"reputation": 799, "user_id": 3956017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5814cfe5bfd09b7e3047088132a8eac7?s=128&d=identicon&r=PG&f=1", "display_name": "Garo", "link": "https://stackoverflow.com/users/3956017/garo"}, "edited": false, "score": 0, "creation_date": 1553126995, "post_id": 55271791, "comment_id": 97275088, "body": "@Garo Not according to <code>Data::Dumper</code>. That&#39;s weird. I think you&#39;re actually correct, but now I can&#39;t explain why <code>Data::Dumper</code> shows an array of arrays."}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 1, "creation_date": 1553128131, "post_id": 55271791, "comment_id": 97275332, "body": "<code>Data::Dumper</code> would show an array of arrays if the return value of <code>load_file</code> was an array reference, and every assignment to <code>@array</code> made it an array with a single array reference element."}], "tags": [], "owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "is_accepted": true, "score": 2, "last_activity_date": 1553128665, "last_edit_date": 1553128665, "creation_date": 1553125759, "answer_id": 55271791, "question_id": 55271234, "link": "https://stackoverflow.com/questions/55271234/creating-different-arrays-through-loops/55271791#55271791", "title": "Creating different arrays through loops", "body": "<p>It sounds like you don't really need the individual arrays to be named <code>@first_array</code>, <code>@second_array</code>, etc. You just want to keep them separate.</p>\n\n<p>In that case, why not just have an array of arrays? Like so:</p>\n\n<pre><code>my @array_of_arrays;\n\nfor my $f (@ARGV) {\n   my @array = load_file($f);\n   push @array_of_arrays, \\@array;\n}\n</code></pre>\n\n<p>Note: <code>load_file</code> is just a placeholder for some function you presumably have to read a file into an array.</p>\n\n<p>Then later on...</p>\n\n<pre><code>array_of_arrays[0][0] * array_of_arrays[1][0] * ... * array_of_arrays[$N][0]\n</code></pre>\n\n<p><strong>Update</strong>: You need to pass a <em>reference</em> to <code>@array</code> to the <code>push</code> function, rather than just <code>@array</code>. Otherwise, <code>push</code> will create a flattened array containing all of the elements of each individual array. Thanks to @Garo and @mob for pointing this out.</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 10675821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4097be1d7de1201ca93069000faa8783?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil\u0117 Vaini\u016bt\u0117", "link": "https://stackoverflow.com/users/10675821/kamil%c4%97-vaini%c5%abt%c4%97"}, "edited": false, "score": 0, "creation_date": 1553165659, "post_id": 55272103, "comment_id": 97287400, "body": "Thanks, your answer helped a lot. I edited my question after adding Data Dumper, maybe you know where is the problem?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1553191149, "post_id": 55272103, "comment_id": 97302946, "body": "Don&#39;t need the line <code>$data-&gt;{$currentfile}=[];</code>  -- the arrayref will be <i>autovivfied</i> (created automatically when needed) in <code>push @{$data-&gt;{$currentfile}};</code>"}], "tags": [], "owner": {"reputation": 799, "user_id": 3956017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5814cfe5bfd09b7e3047088132a8eac7?s=128&d=identicon&r=PG&f=1", "display_name": "Garo", "link": "https://stackoverflow.com/users/3956017/garo"}, "is_accepted": false, "score": 1, "last_activity_date": 1553128551, "creation_date": 1553128551, "answer_id": 55272103, "question_id": 55271234, "link": "https://stackoverflow.com/questions/55271234/creating-different-arrays-through-loops/55272103#55272103", "title": "Creating different arrays through loops", "body": "<p>If I understand your question correctly, what you should use is arrayreferences inside a hash, hashref, array or arrayref.</p>\n\n<p>Below is how i would do it (a hashref of arrayrefs):</p>\n\n<pre><code>my $data={};  #a hashref where all data will end up\nforeach my $currentfile (@ARGV){\n  open (my $filehandle ,$currentfile);\n  $data-&gt;{$currentfile}=[];  #a empty arrayref inside the hashref for every file\n  while(&lt;$fh&gt;) {\n    push @{$data-&gt;{$currentfile}}; #add lines to the arrayref\n  }\n  close $filehandle;\n}\n</code></pre>\n\n<p>Result: all data will be available in the form <code>$data-&gt;{FILENAME}-&gt;[LINENUMBER COUNTING FROM 0]</code>.</p>\n\n<p>Example: line 7 of file \"foo.txt\" will now be in <code>$data-&gt;{foo.txt}-&gt;[6]</code></p>\n\n<p>Depending on your actual purpose an array or arrayref might be a better choice then a hashref (If you don't care about the filenames but care about which number of argument they are in <code>@ARGV</code>). But this is not entirely clear in your question</p>\n"}, {"tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 2, "last_activity_date": 1553175008, "last_edit_date": 1553175008, "creation_date": 1553166894, "answer_id": 55279185, "question_id": 55271234, "link": "https://stackoverflow.com/questions/55271234/creating-different-arrays-through-loops/55279185#55279185", "title": "Creating different arrays through loops", "body": "<p>This is the strange part of your code:</p>\n\n<pre><code>push @{$data-&gt;{$arg}}, $fh;\n</code></pre>\n\n<p><code>$fh</code> is the filehandle. That's why you're getting that output. Each time around the loop, you're adding exactly the same value (the filehandle) to your data structure.</p>\n\n<pre><code>'skai.txt' =&gt; [\n               \\*{'::$fh'},\n               $VAR1-&gt;{'skai.txt'}[0],\n               $VAR1-&gt;{'skai.txt'}[0],\n               $VAR1-&gt;{'skai.txt'}[0]\n             ],\n</code></pre>\n\n<p>The first value (<code>\\*{'::$fh'}</code>) is just Data::Dumper's slightly over-complicated way of saying \"a reference to the filehandle that is stored in <code>$fh</code>\". The three subsequent values are Data::Dumper saying \"this is a value that already appears in this data structure, so instead of writing the value out again, I'll just show you a reference to the existing value\".</p>\n\n<p>I think that if you change that line to:</p>\n\n<pre><code>push @{$data-&gt;{$arg}}, $_;\n</code></pre>\n\n<p>Then you'll get something a lot closer to what you wanted.</p>\n"}], "owner": {"reputation": 105, "user_id": 10675821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4097be1d7de1201ca93069000faa8783?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil\u0117 Vaini\u016bt\u0117", "link": "https://stackoverflow.com/users/10675821/kamil%c4%97-vaini%c5%abt%c4%97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55271791, "answer_count": 3, "score": 1, "last_activity_date": 1553191060, "creation_date": 1553121827, "last_edit_date": 1553191060, "question_id": 55271234, "link": "https://stackoverflow.com/questions/55271234/creating-different-arrays-through-loops", "title": "Creating different arrays through loops", "body": "<p>Is it possible to create different named arrays while looping in Perl? What I need to do is open some files from <code>@ARGV</code> and put their data in separate arrays in one loop, for example: <code>1.txt</code> in <code>@first_array</code>, <code>2.txt</code> in <code>@second_array</code> and etc. Is it possible and if yes, what would be the best approach?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I think I'm getting closer, since <code>Data::Dumper</code> shows a correct structure of what I need, but it doesn't show the values of the files, instead, it shows this: </p>\n\n<pre><code>$VAR1 = {\n      'skai.txt' =&gt; [\n                      \\*{'::$fh'},\n                      $VAR1-&gt;{'skai.txt'}[0],\n                      $VAR1-&gt;{'skai.txt'}[0],\n                      $VAR1-&gt;{'skai.txt'}[0]\n                    ],\n      'numb.txt' =&gt; [\n                      \\*{'::$fh'},\n                      $VAR1-&gt;{'numb.txt'}[0],\n                      $VAR1-&gt;{'numb.txt'}[0],\n                      $VAR1-&gt;{'numb.txt'}[0]\n                    ]\n    };\n</code></pre>\n\n<p>Each file consists of 4 numbers. My code looks like this:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse Data::Dumper;\n\nmy $data = {};\n\nforeach my $arg(@ARGV){\n    if(open(my $fh, $arg)){\n        $data-&gt;{$arg}=[];\n        while(&lt;$fh&gt;){\n            chomp;\n            push @{$data-&gt;{$arg}}, $fh;\n        }\n    close($fh);\n    }\n}\n\nprint Dumper $data;\n</code></pre>\n\n<p>What is the meaning of <code>\\*{'::$fh'}</code>?</p>\n"}, {"tags": ["apache", "perl", "docker", "environment-variables", "cgi"], "comments": [{"owner": {"reputation": 8273, "user_id": 1334695, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/431ae6e9f7610b9d6a6a6cdebd0244d5?s=128&d=identicon&r=PG", "display_name": "stevieb", "link": "https://stackoverflow.com/users/1334695/stevieb"}, "edited": false, "score": 0, "creation_date": 1553117827, "post_id": 55270543, "comment_id": 97272326, "body": "Do you have more than one Perl installation in place? Are you running under different user accounts? Environments don&#39;t get copied from one user to another under different circumstances. Test at the command line with both users and see if they have the same things in <code>@INC</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1445, "user_id": 1441592, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a58917def8d1523a840b52ae7d59d21?s=128&d=identicon&r=PG", "display_name": "Paul Serikov", "link": "https://stackoverflow.com/users/1441592/paul-serikov"}, "is_accepted": true, "score": 1, "last_activity_date": 1553189393, "creation_date": 1553189393, "answer_id": 55286099, "question_id": 55270543, "link": "https://stackoverflow.com/questions/55270543/different-inc-at-cgi-script-and-shell/55286099#55286099", "title": "Different @INC at CGI script and shell", "body": "<p>After investigating the problem I found by checking <code>httpd.conf</code> that httpd run <code>httpd-foreground</code> under <code>daemon</code> user, not root.</p>\n\n<p>User <code>daemon</code> has no shebang by default:</p>\n\n<pre><code>$ docker run -it httpd cat /etc/passwd | grep daemon\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n</code></pre>\n\n<p>But even if we add</p>\n\n<pre><code>runuser - daemon -c \"export PERL5LIB=/somedir\" -s /bin/bash\n</code></pre>\n\n<p>to <code>command:</code> it wouldn't pass a variable to perl since httpd run CGI scripts in separate, isolated processes so shell is isolated too. We can control ENV variables only by using <a href=\"https://httpd.apache.org/docs/2.4/mod/mod_env.html\" rel=\"nofollow noreferrer\">mod_env</a> <code>SetEnv</code> and <code>PassEnv</code> directives.</p>\n\n<p>So, for passing <code>/somedir</code> to <code>@INC</code> we need to add </p>\n\n<pre><code>echo \"SetEnv PERL5LIB /somedir\" &gt;&gt; /usr/local/apache2/conf/httpd.conf\n</code></pre>\n"}], "owner": {"reputation": 1445, "user_id": 1441592, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2a58917def8d1523a840b52ae7d59d21?s=128&d=identicon&r=PG", "display_name": "Paul Serikov", "link": "https://stackoverflow.com/users/1441592/paul-serikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55286099, "answer_count": 1, "score": 0, "last_activity_date": 1553189393, "creation_date": 1553117677, "question_id": 55270543, "link": "https://stackoverflow.com/questions/55270543/different-inc-at-cgi-script-and-shell", "title": "Different @INC at CGI script and shell", "body": "<p>I have following docker-compose file:</p>\n\n<pre><code>version: '2'\n\nservices:\n    test:\n        image: httpd\n        container_name: inc_test\n        ports:\n            - \"3000:80\"\n        environment:\n            - PERL5LIB=/somedir\n            - PERLLIB=/somedir\n        command:\n            - bash\n            - -c\n            - |\n                cat /usr/local/apache2/conf/httpd.conf | grep modules/mod_cgid.so\n                sed -i 's,#\\(LoadModule cgid_module modules/mod_cgid.so\\),\\1,g' /usr/local/apache2/conf/httpd.conf\n                cat /usr/local/apache2/conf/httpd.conf | grep modules/mod_cgid.so\n                echo '#!/usr/bin/env perl' &gt;&gt; /usr/local/apache2/cgi-bin/test.pl\n                echo 'print \"Content-type: text/html\\n\\n\";' &gt;&gt; /usr/local/apache2/cgi-bin/test.pl\n                echo 'print join(\"\\n\", @INC);' &gt;&gt; /usr/local/apache2/cgi-bin/test.pl\n                ls -lah /usr/local/apache2/cgi-bin/test.pl\n                cat /usr/local/apache2/cgi-bin/test.pl\n                httpd -M | grep -e cgid -e alias\n                chmod a+x /usr/local/apache2/cgi-bin/test.pl\n                perl -le 'print for @INC'\n                echo \"Which perl : \"\n                which perl\n                httpd-foreground\n</code></pre>\n\n<p>When I go to <a href=\"http://localhost:3000/cgi-bin/test.pl\" rel=\"nofollow noreferrer\">http://localhost:3000/cgi-bin/test.pl</a> I see that <code>/somedir</code> is not in <code>@INC</code>. Hovewer <code>perl -le 'print for @INC'</code> contains <code>/somedir</code>.\nWTF?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1553109398, "post_id": 55268542, "comment_id": 97268224, "body": "Is <code>my $corpIdaccessCode;</code> a transcription error, or actually in the code?"}, {"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553109466, "post_id": 55268542, "comment_id": 97268272, "body": "Do those hashes have any uniq field or you need to check all fields?"}, {"owner": {"reputation": 5970, "user_id": 2618323, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Czph.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/2618323/developer"}, "reply_to_user": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1553109516, "post_id": 55268542, "comment_id": 97268301, "body": "@jhnc i have updated the question sorry for confusion"}, {"owner": {"reputation": 5970, "user_id": 2618323, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Czph.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/2618323/developer"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553109569, "post_id": 55268542, "comment_id": 97268331, "body": "@UjinT34 before pushing to the array i want to check all three hash keys values exists in the array or not"}], "answers": [{"tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": false, "score": 1, "last_activity_date": 1553110615, "last_edit_date": 1553110615, "creation_date": 1553110128, "answer_id": 55268797, "question_id": 55268542, "link": "https://stackoverflow.com/questions/55268542/check-hash-values-before-pushing-to-an-array-in-perl/55268797#55268797", "title": "Check hash values before pushing to an array in perl", "body": "<p>It would be ineficient to check the whole array before pushing or remove duplicates afterwards. So you need to keep track what data you have pushed already:</p>\n\n<pre><code>my $seen;\nforeach my $corp_id(@{corpId}) {\n    foreach my $rcode(@{$brands_map-&gt;{$corp_id-&gt;{s_brand}}}) {\n            my ($k1, $k2, $k3) = ($corp_id-&gt;{s_id}, $corp_id-&gt;{c_id}, $rcode);\n            if ($seen-&gt;{$k1}-&gt;{$k2}-&gt;{$k3}) {\n                next;\n            }\n            $seen-&gt;{$k1}-&gt;{$k2}-&gt;{$k3} = 1;\n\n            my $corpIdAccessCode;\n            $corpIdAccessCode-&gt;{accessCode} = $corp_id-&gt;{s_id};\n            $corpIdAccessCode-&gt;{corporateId} = $corp_id-&gt;{c_id};\n            $corpIdAccessCode-&gt;{bcode} = $rcode;\n            push @{$accessCode_array} ,$corpIdAccessCode; **// Here before pushing to array i want to have a check wheather $corp_id-&gt;{s_id}, $corp_id-&gt;{c_id} and  $rcode already exists or not in the accessCode_array**\n    }\n}\n</code></pre>\n\n<p><code>my ($k1, $k2, $k3)</code> just to make it shorter and more readable.</p>\n"}, {"comments": [{"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553111657, "post_id": 55268998, "comment_id": 97269339, "body": "I would write something like this myself but postfix conditionals and <code>++</code> are considered to be a bad style. <code>$seen{ $corp_id-&gt;{s_id} }{ $corp_id-&gt;{c_id} }{ $rcode }++</code> is hard to read. And using a delimeter is a bit unreliable."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 2, "creation_date": 1553111737, "post_id": 55268998, "comment_id": 97269377, "body": "@UjinT34, Re &quot;<i>considered to be a bad style.</i>&quot;, Quite that contrary, <code>!$seen{$_}++</code> is an idiom, so it can&#39;t possibly be bad style. It also means that deviations are harder to read by virtue of being departures from the usual."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 1, "creation_date": 1553111886, "post_id": 55268998, "comment_id": 97269452, "body": "@UjinT34, Re &quot;<i>And using a delimeter is a bit unreliable.</i>&quot;, huh?"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1553113341, "post_id": 55268998, "comment_id": 97270182, "body": "@ikegami He is probably referring to the Perl Best Practices suggestion reflected in <a href=\"https://metacpan.org/pod/Perl::Critic::Policy::ControlStructures::ProhibitPostfixControls\" rel=\"nofollow noreferrer\">metacpan.org/pod/&hellip;</a>. (I completely disagree with this opinion/policy.) I&#39;m not sure who considers <code>++</code> bad style."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 1, "creation_date": 1553115113, "post_id": 55268998, "comment_id": 97271086, "body": "@UjinT34 postfix ++ for uniqifying is a pretty universal idiom.  doing <code>++$seen{...} == 1</code> instead of <code>!$seen{...}++</code> might be considered more readable I guess, but I think that ship has long sailed."}, {"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553116489, "post_id": 55268998, "comment_id": 97271736, "body": "As I mentioned I prefer the approach from this answer myself. I just don&#39;t want to recommend it for everyone. With <code>++</code> in a conditional you have too keep in mind what happens first: increment or evaluation. A lot of coders get confused with such relatively simple constructions."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 1, "creation_date": 1553146451, "post_id": 55268998, "comment_id": 97279156, "body": "@UjinT34, Actually, you don&#39;t. You just need to know that <code>!$seen{$_}++</code> finds the first of duplicates (and that <code>$seen{$_}++</code> finds everything else). Knowing how it works is secondary."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 0, "last_activity_date": 1553111492, "last_edit_date": 1553111492, "creation_date": 1553110929, "answer_id": 55268998, "question_id": 55268542, "link": "https://stackoverflow.com/questions/55268542/check-hash-values-before-pushing-to-an-array-in-perl/55268998#55268998", "title": "Check hash values before pushing to an array in perl", "body": "<p>Checking <code>!$seen{$key}++</code> is a common way of identifying the first of duplicates. For example,</p>\n\n<pre><code>my %seen;\nmy @uniques = grep { !$seen{$_}++ } @items;\n</code></pre>\n\n<p>This can be unrolled into a foreach loop.</p>\n\n<pre><code>my %seen;\nfor my $corp_id (@corpId) {\n    for my $rcode (@{ $brands_map-&gt;{ $corp_id-&gt;{s_brand} } }) {\n        next if $seen{ $corp_id-&gt;{s_id} }{ $corp_id-&gt;{c_id} }{ $rcode }++;\n\n        push @$accessCode_array, {\n            accessCode  =&gt; $corp_id-&gt;{s_id},\n            corporateId =&gt; $corp_id-&gt;{c_id},\n            bcode       =&gt; $rcode,\n        };\n    }\n}\n</code></pre>\n\n<p>To save memory, you could even replace</p>\n\n<pre><code>next if $seen{ $corp_id-&gt;{s_id} }{ $corp_id-&gt;{c_id} }{ $rcode }++;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>next if $seen{ join \":\", $corp_id-&gt;{s_id}, $corp_id-&gt;{c_id}, $rcode }++;\n</code></pre>\n\n<p>but that assumes none of the three fields can contain <code>:</code>.</p>\n"}], "owner": {"reputation": 5970, "user_id": 2618323, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/3Czph.jpg?s=128&g=1", "display_name": "Developer", "link": "https://stackoverflow.com/users/2618323/developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 55268998, "answer_count": 2, "score": 0, "last_activity_date": 1553111492, "creation_date": 1553109167, "last_edit_date": 1553109474, "question_id": 55268542, "link": "https://stackoverflow.com/questions/55268542/check-hash-values-before-pushing-to-an-array-in-perl", "title": "Check hash values before pushing to an array in perl", "body": "<p>For creating a Json file i am pushing a hashes in an array but the values are getting duplicated now i don't want to add those hashes which are already in the array.</p>\n\n<pre><code>foreach my $corp_id(@{corpId}) {\n    foreach my $rcode(@{$brands_map-&gt;{$corp_id-&gt;{s_brand}}}) {\n            my corpIdAccessCode;\n            $corpIdAccessCode-&gt;{accessCode} = $corp_id-&gt;{s_id};\n            $corpIdAccessCode-&gt;{corporateId} = $corp_id-&gt;{c_id};\n            $corpIdAccessCode-&gt;{bcode} = $rcode;\n            push @{$accessCode_array} ,$corpIdAccessCode; **// Here before pushing to array i want to have a check wheather $corp_id-&gt;{s_id}, $corp_id-&gt;{c_id} and  $rcode already exists or not in the accessCode_array**\n    }\n}\n</code></pre>\n\n<p>So from the below array of hashes i don't want  duplicate ones</p>\n\n<pre><code>[\n      {\n        \"accessCode\": \"NQ\",\n        \"bcode\": \"PD\",\n        \"corporateId\": \"12\"\n      },\n      {\n        \"accessCode\": \"NQ\",\n        \"bcode\": \"CI\",\n        \"corporateId\": \"2122121\"\n      },\n      {\n        \"accessCode\": \"NQ\",\n        \"bcode\": \"CI\",\n        \"corporateId\": \"2122121\"\n      },\n      {\n        \"accessCode\": \"CD\",\n        \"bcode\": \"PD\",\n        \"corporateId\": \"12\"\n      },\n</code></pre>\n\n<p>The final ooutput from the code changes should give a result like below :</p>\n\n<pre><code>[\n      {\n        \"accessCode\": \"NQ\",\n        \"bcode\": \"PD\",\n        \"corporateId\": \"12\"\n      },\n      {\n        \"accessCode\": \"NQ\",\n        \"bcode\": \"CI\",\n        \"corporateId\": \"2122121\"\n      },\n\n      {\n        \"accessCode\": \"CD\",\n        \"bcode\": \"PD\",\n        \"corporateId\": \"12\"\n      },\n</code></pre>\n\n<p>Or is there any way we can remove duplicate hashes from the array.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 641, "user_id": 9581546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c590b5d68174d592eb53d1fc35996a?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/9581546/sam"}, "edited": false, "score": 1, "creation_date": 1553109031, "post_id": 55268106, "comment_id": 97268034, "body": "with the assignment to <code>$d</code> in the first line of the function you are making a copy of the value. if you directly assign to the respective element in <code>@_</code>, it should affect the caller data."}, {"owner": {"reputation": 3734, "user_id": 425893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/150bcdb3aa4e2b8096065f19f1b6d568?s=128&d=identicon&r=PG", "display_name": "John O", "link": "https://stackoverflow.com/users/425893/john-o"}, "reply_to_user": {"reputation": 641, "user_id": 9581546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c590b5d68174d592eb53d1fc35996a?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/9581546/sam"}, "edited": false, "score": 0, "creation_date": 1553109495, "post_id": 55268106, "comment_id": 97268291, "body": "Thanks @Sam. If you&#39;ll write up a quick answer, would be happy to select it."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1553111232, "post_id": 55268880, "comment_id": 97269127, "body": "Added code with the necessary changes (and some simplifications) to the answer. Hope you don&#39;t mind."}, {"owner": {"reputation": 641, "user_id": 9581546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c590b5d68174d592eb53d1fc35996a?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/9581546/sam"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1553111944, "post_id": 55268880, "comment_id": 97269487, "body": "i sure don&#39;t :)"}], "tags": [], "owner": {"reputation": 641, "user_id": 9581546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c590b5d68174d592eb53d1fc35996a?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/9581546/sam"}, "is_accepted": true, "score": 3, "last_activity_date": 1553111912, "last_edit_date": 1553111912, "creation_date": 1553110469, "answer_id": 55268880, "question_id": 55268106, "link": "https://stackoverflow.com/questions/55268106/how-can-i-replace-values-in-a-deeply-nested-but-arbitrary-data-structure/55268880#55268880", "title": "How can I replace values in a deeply nested but arbitrary data structure?", "body": "<p>The <code>@_</code> array with function parameters contains aliases to the scalars (or otherwise explicit references) passed to the function. Modifications to it <em>will</em> affect the caller data. The same with <code>$_</code> in <code>grep</code> or <code>map</code>. This is something that coming from other programming languages you sometimes need to be careful of.</p>\n\n<p>However, by making an assignment from one scalar variable to another, as in the idiomatic <code>my ($d, $string) = @_</code>, the scalar value is copied from one variable to another.</p>\n\n<p>If you want to affect a scalar value passed to a function in the caller, you can work directly with the <code>@_</code> array and its elements.</p>\n\n<pre><code>sub deep_nested_replace {\n    my ($d, $string) = @_;\n\n    if (ref($d) eq 'ARRAY') {\n        deep_nested_replace($_, $string) for @$d;\n    }\n    elsif (ref($d) eq 'HASH') {\n        deep_nested_replace($_, $string) for values %$d;\n    }\n    elsif (defined $d) {\n        $_[0] = $string;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3734, "user_id": 425893, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/150bcdb3aa4e2b8096065f19f1b6d568?s=128&d=identicon&r=PG", "display_name": "John O", "link": "https://stackoverflow.com/users/425893/john-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 55268880, "answer_count": 1, "score": 1, "last_activity_date": 1553111912, "creation_date": 1553107612, "question_id": 55268106, "link": "https://stackoverflow.com/questions/55268106/how-can-i-replace-values-in-a-deeply-nested-but-arbitrary-data-structure", "title": "How can I replace values in a deeply nested but arbitrary data structure?", "body": "<p>I have a data structure that is arbitrary. The form is usually similar in that it consists of arrays and hashes about four levels deep, with about two to six values I'd like to change. A typical example:</p>\n\n<pre><code>$VAR1 = [\n          undef,\n          [\n            {\n              '0' =&gt; 'some string'\n            }\n          ],\n          undef,\n          [\n            undef,\n            {\n              '1033' =&gt; 'another string '\n            }\n          ]\n        ];\n</code></pre>\n\n<p>While I know the syntax well enough to access these two values and change them in this particular example (or any other), from one use to the next this will change in ways that hard-coded expressions will fail.</p>\n\n<p>This feels like it should be a simple sub that runs recursively, but once it finds that the element of the data structure is an array or hash, I don't know how to pass the element into the next recursive call by reference such that it can be modified in a non-temporary way. The following code fails recursively (though if it doesn't recurse, it can change a shallow value in the top-level array and this change sticks):</p>\n\n<pre><code>sub deep_nested_replace {\n    my ($d, $string) = @_;\n\n    if (ref($d) eq 'ARRAY') {\n        for (my $i=0; $i&lt;scalar @$d; $i++) {\n            deep_nested_replace($d-&gt;[$i], $string);\n        }\n    }\n    elsif (ref($d) eq 'HASH') {\n        foreach my $k (keys %$d) {\n            deep_nested_replace($d-&gt;{$k}, $string);\n        }\n    }\n    elsif (defined $d) {\n        $d = $string;\n    }\n}\n</code></pre>\n\n<p>How do I make this work? If this is the wrong approach, what's a correct one?</p>\n"}, {"tags": ["regex", "bash", "perl", "sed"], "answers": [{"tags": [], "owner": {"reputation": 658023, "user_id": 548225, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dab08478b226280d4a30894c9a7ed719?s=128&d=identicon&r=PG", "display_name": "anubhava", "link": "https://stackoverflow.com/users/548225/anubhava"}, "is_accepted": true, "score": 1, "last_activity_date": 1553107325, "creation_date": 1553107325, "answer_id": 55268029, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55268029#55268029", "title": "Get substring using either perl or sed", "body": "<p>You may use this <code>sed</code>:</p>\n\n<pre><code>sed -E 's~^.*/|-.*$~~g' &lt;&lt;&lt; \"$BRANCH_NAME\"\n</code></pre>\n\n<p></p>\n\n<pre><code>US3280841\n</code></pre>\n\n<p>Ot this <code>awk</code>:</p>\n\n<pre><code>awk -F '[/-]' '{print $2}' &lt;&lt;&lt; \"$BRANCH_NAME\"\n</code></pre>\n\n<p></p>\n\n<pre><code>US3280841\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4177, "user_id": 7953189, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CEXB2.jpg?s=128&g=1", "display_name": "tso", "link": "https://stackoverflow.com/users/7953189/tso"}, "is_accepted": false, "score": 1, "last_activity_date": 1553107455, "creation_date": 1553107455, "answer_id": 55268064, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55268064#55268064", "title": "Get substring using either perl or sed", "body": "<pre><code>sed 's:[^/]*/\\([^-]*\\)-.*:\\1:'&lt;&lt;&lt;\"bugfix/US3280841-something-duh\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1553109249, "post_id": 55268114, "comment_id": 97268150, "body": "Upvoted your answer because I generally like to avoid calling <code>sed</code> et al for what should be simple string transformations. Still, it bothers me that <code>bash</code> doesn&#39;t provide an easy one-liner way to do a regex substitution on a variable. The best I could come up with for a one-liner in <code>bash</code> is the very ugly <code>branch=$([[ &quot;$branch&quot; =~ ^.*&#47;([^-]+)-.*$ ]] &amp;&amp; echo &quot;${BASH_REMATCH[1]}&quot;)</code>. I wish <code>bash</code> would give us something similar to <code>perl</code>&#39;s <code>$s =~ s&#47;pattern&#47;subst&#47;;</code>, but <code>bash</code>&#39;s <code>${parameter&#47;pattern&#47;subst}</code> expansion AFAIK doesn&#39;t speak regex."}, {"owner": {"reputation": 8293, "user_id": 8656552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FPg67.png?s=128&g=1", "display_name": "Paul Hodges", "link": "https://stackoverflow.com/users/8656552/paul-hodges"}, "reply_to_user": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1556284282, "post_id": 55268114, "comment_id": 98396653, "body": "You <i>could</i> just type it as <code>tmp=&quot;${branch##*&#47;}&quot; &amp;&amp; trimmed=&quot;${tmp%%-*}&quot;</code>. but yeah. I understand it, but I agree."}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1556297977, "post_id": 55268114, "comment_id": 98404077, "body": "Yeah it&#39;s not just about cramming it all into one <i>line</i>. It&#39;s that what should ideally be one <i>operation</i> requires multiple operations in bash."}], "tags": [], "owner": {"reputation": 8293, "user_id": 8656552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FPg67.png?s=128&g=1", "display_name": "Paul Hodges", "link": "https://stackoverflow.com/users/8656552/paul-hodges"}, "is_accepted": false, "score": 6, "last_activity_date": 1556284027, "last_edit_date": 1556284027, "creation_date": 1553107651, "answer_id": 55268114, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55268114#55268114", "title": "Get substring using either perl or sed", "body": "<p>Using bash parameter expansion only:</p>\n\n<pre><code>$: # don't use caps; see below.\n$: declare branch=\"bugfix/US3280841-something-duh\"\n$: tmp=\"${branch##*/}\"\n$: echo \"$tmp\"\nUS3280841-something-duh\n$: trimmed=\"${tmp%%-*}\" \n$: echo \"$trimmed\"\nUS3280841\n</code></pre>\n\n<p>Which means:</p>\n\n<pre><code>$: tmp=\"${branch_name##*/}\"\n$: trimmed=\"${tmp%%-*}\" \n</code></pre>\n\n<p>does the job in two steps without spawning extra processes.</p>\n\n<p>In <code>sed</code>,</p>\n\n<pre><code>$: sed -E 's#^.*/([^/-]+)-.*$#\\1#' &lt;&lt;&lt; \"$branch\"\n</code></pre>\n\n<p>This says \"after any or no characters followed by a slash, remember one or more that are not slashes or dashes, followed by a not-remembered dash and then any or no characters, then replace the whole input with the remembered part.\" </p>\n\n<p>Your original pattern was</p>\n\n<pre><code>'s/\\(^.*\\)\\/[a-z0-9]\\|[A-Z0-9]\\+/\\1/g'\n</code></pre>\n\n<p>This says \"remember any number of anything followed by a slash, then a lowercase letter or a digit, then a pipe character (because those only work with -E), then a capital letter or digit, then a literal plus sign, and then replace it all with what you remembered.\"  </p>\n\n<p>GNU's <a href=\"https://www.gnu.org/software/sed/manual/sed.html\" rel=\"nofollow noreferrer\">manual</a> is your friend. I look stuff up all the time to make sure I'm doing it right. Sometimes it still takes me a few tries, lol.</p>\n\n<p>An aside - try not to use all-capital variable names. That is a convention that indicates it's special to the OS, like RANDOM or IFS.</p>\n"}, {"tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": false, "score": 1, "last_activity_date": 1553107656, "creation_date": 1553107656, "answer_id": 55268116, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55268116#55268116", "title": "Get substring using either perl or sed", "body": "<p>Perl version just has <code>+</code> in wrong place. It should be inside the capture brackets:</p>\n\n<pre><code>TRIMMED=$(echo $BRANCH_NAME | perl -nle 'm/^.*\\/([a-z0-9A-Z]+)/; print $1');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38137, "user_id": 5841306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wwk1C.jpg?s=128&g=1", "display_name": "Barbaros &#214;zhan", "link": "https://stackoverflow.com/users/5841306/barbaros-%c3%96zhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1553108414, "last_edit_date": 1553108414, "creation_date": 1553107721, "answer_id": 55268135, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55268135#55268135", "title": "Get substring using either perl or sed", "body": "<p>Just use a <code>^</code> before <code>A-Z0-9</code></p>\n\n<pre><code>TRIMMED=$(echo $BRANCH_NAME | sed -e 's/\\(^.*\\)\\/[a-z0-9]\\|[^A-Z0-9]\\+/\\1/g')\n</code></pre>\n\n<p>in your <code>sed</code> case.</p>\n\n<p>Alternatively and briefly, you can use</p>\n\n<pre><code>TRIMMED=$(echo $BRANCH_NAME | sed \"s/[a-z\\/\\-]//g\" )\n</code></pre>\n\n<p>too.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7712945"}, "is_accepted": false, "score": 0, "last_activity_date": 1554678808, "creation_date": 1554678808, "answer_id": 55564484, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55564484#55564484", "title": "Get substring using either perl or sed", "body": "<p>type on shell terminal</p>\n\n<pre><code>$ BRANCH_NAME=\"bugfix/US3280841-something-duh\"\n\n$ echo $BRANCH_NAME| perl -pe 's/.*\\/(\\w\\w[0-9]+).+/\\1/'\n</code></pre>\n\n<p>use s (substitute) command instead of m (match)<br>\nperl is a superset of sed so it'd be identical 'sed -E' instead of 'perl -pe'</p>\n"}, {"tags": [], "owner": {"reputation": 5886, "user_id": 2019415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645958eb08719fa5119052d7d1d079ff?s=128&d=identicon&r=PG", "display_name": "G. Cito", "link": "https://stackoverflow.com/users/2019415/g-cito"}, "is_accepted": false, "score": 0, "last_activity_date": 1556346838, "creation_date": 1556346838, "answer_id": 55877935, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed/55877935#55877935", "title": "Get substring using either perl or sed", "body": "<p>Another variant using <em>Perl Regular Expression Character Classes</em> (see <a href=\"https://perldoc.perl.org/perlrecharclass.html\" rel=\"nofollow noreferrer\"><code>perldoc perlrecharclass</code></a>).</p>\n\n<pre><code>echo $BRANCH_NAME | perl -nE 'say m/^.*\\/([[:alnum:]]+)/;'\n</code></pre>\n"}], "owner": {"reputation": 1624, "user_id": 2094116, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/jXrRV.png?s=128&g=1", "display_name": "Nxt3", "link": "https://stackoverflow.com/users/2094116/nxt3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 55268029, "answer_count": 7, "score": 2, "last_activity_date": 1556346838, "creation_date": 1553107083, "question_id": 55267974, "link": "https://stackoverflow.com/questions/55267974/get-substring-using-either-perl-or-sed", "title": "Get substring using either perl or sed", "body": "<p>I can't seem to get a substring correctly. </p>\n\n<pre><code>declare BRANCH_NAME=\"bugfix/US3280841-something-duh\";\n\n# Trim it down to \"US3280841\"\nTRIMMED=$(echo $BRANCH_NAME | sed -e 's/\\(^.*\\)\\/[a-z0-9]\\|[A-Z0-9]\\+/\\1/g')\n</code></pre>\n\n<p>That still returns <code>bugfix/US3280841-something-duh</code>.</p>\n\n<p>If I try an use perl instead:</p>\n\n<pre><code>declare BRANCH_NAME=\"bugfix/US3280841-something-duh\";\n\n# Trim it down to \"US3280841\"\nTRIMMED=$(echo $BRANCH_NAME | perl -nle 'm/^.*\\/([a-z0-9]|[A-Z0-9])+/; print $1');\n</code></pre>\n\n<p>That outputs nothing.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 7, "creation_date": 1553103862, "post_id": 55267077, "comment_id": 97265445, "body": "Even the syntax highlighting here on SO shows the problem: missing closing double quote after <code>open(my $infile, &quot;{&#39;id&#39;},0,2);</code>. It&#39;s present in the original, too."}], "answers": [{"comments": [{"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 1, "creation_date": 1553121288, "post_id": 55267131, "comment_id": 97273484, "body": "Right there on line 97. What are the odds?"}], "tags": [], "owner": {"reputation": 1028, "user_id": 731339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23d1ca6a73cadeccaeeadcd255265cfa?s=128&d=identicon&r=PG", "display_name": "Ossip", "link": "https://stackoverflow.com/users/731339/ossip"}, "is_accepted": false, "score": 1, "last_activity_date": 1553103916, "creation_date": 1553103916, "answer_id": 55267131, "question_id": 55267077, "link": "https://stackoverflow.com/questions/55267077/how-to-solve-a-runaway-multi-line-string-error/55267131#55267131", "title": "How to solve a runaway multi-line &quot;&quot; string error?", "body": "<p>There are a bunch of errors in the code, see the other messages...</p>\n\n<p>Your runnaway line is here, missing \" -\n<code>open(my $infile, \"{'id'},0,2);</code></p>\n"}, {"tags": [], "owner": {"reputation": 170445, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 2, "last_activity_date": 1553105402, "last_edit_date": 1553105402, "creation_date": 1553104881, "answer_id": 55267401, "question_id": 55267077, "link": "https://stackoverflow.com/questions/55267077/how-to-solve-a-runaway-multi-line-string-error/55267401#55267401", "title": "How to solve a runaway multi-line &quot;&quot; string error?", "body": "<p>The web site you copied this script from has corrupted it badly. A large section of code is completely missing; the nonsensical line:</p>\n\n<pre><code>open(my $infile, \"{'id'},0,2);\n                 ^^\n</code></pre>\n\n<p>is the result of about a dozen lines of code being deleted, starting after the double quote and ending before the open curly brace.</p>\n\n<p>The original, working version of this script is available on Github at:</p>\n\n<p><a href=\"https://github.com/tautology0/ayfabtu/blob/master/git-grab\" rel=\"nofollow noreferrer\">https://github.com/tautology0/ayfabtu/blob/master/git-grab</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10473409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 55267401, "answer_count": 2, "score": -2, "last_activity_date": 1553105402, "creation_date": 1553103675, "last_edit_date": 1553104000, "question_id": 55267077, "link": "https://stackoverflow.com/questions/55267077/how-to-solve-a-runaway-multi-line-string-error", "title": "How to solve a runaway multi-line &quot;&quot; string error?", "body": "<p>So im trying to follow a Pentest partners post (<a href=\"https://www.pentestpartners.com/security-blog/git-extraction-abusing-version-control-systems/\" rel=\"nofollow noreferrer\">https://www.pentestpartners.com/security-blog/git-extraction-abusing-version-control-systems/</a>) in order extract metadata from a open git port. </p>\n\n<p>Im getting an error when running the perl script that was provided.</p>\n\n<p>Full Stack Trace:</p>\n\n<pre><code>Bareword found where operator expected at ./git-grab.pl line 102, near \"print \"Extracting\"\n  (Might be a runaway multi-line \"\" string starting on line 97)\n    (Do you need to predeclare print?)\nGlobal symbol \"%i\" requires explicit package name at ./git-grab.pl line 37.\nGlobal symbol \"$resthash\" requires explicit package name at ./git-grab.pl line 94.\nGlobal symbol \"$entry\" requires explicit package name at ./git-grab.pl line 94.\nGlobal symbol \"$file\" requires explicit package name at ./git-grab.pl line 94.\nGlobal symbol \"$firsttwo\" requires explicit package name at ./git-grab.pl line 97.\nGlobal symbol \"$resthash\" requires explicit package name at ./git-grab.pl line 97.\nGlobal symbol \"$rawdata\" requires explicit package name at ./git-grab.pl line 97.\nGlobal symbol \"$decompressed\" requires explicit package name at ./git-grab.pl line 97.\nGlobal symbol \"$oh\" requires explicit package name at ./git-grab.pl line 97.\nsyntax error at ./git-grab.pl line 102, near \"print \"Extracting\"\n./git-grab.pl has too many errors.\n</code></pre>\n\n<p>Here is the script:</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse File::Path qw(make_path);\nuse LWP::UserAgent;\nuse File::Temp qw(tempfile tempdir);\nuse Compress::Zlib qw(uncompress);\n\nsub readtime\n{\n   my ($handle, $hashref) = @_;\n\n   read $handle, my $rawtime, 8;\n\n   ( $hashref-&gt;{'lsb32'},\n     $hashref-&gt;{'nsec'} ) = unpack \"NN\", $rawtime;\n\n   return $hashref;\n}\n\nsub readindex\n{\n   my ($infile) = @_;\n   my $packindex;\n\n   # read the header\n   read $infile, my $rawheader, 12;\n   my $header = {};\n   ($header-&gt;{'ident'}, $header-&gt;{'version'}, $header-&gt;{'entries'})\n      = unpack(\"a4NN\", $rawheader);\n\n   die \"Not a git index file\" if ($header-&gt;{'ident'} ne \"DIRC\");\n   die \"Unsupported version of git index\" if ($header-&gt;{'version'} != 2);\n\n   my @index_entries = ();\n\n   for (my $i=0; $i{'entries'}; $i++)\n   {\n      my $statinfo = {};\n      my $entry = {};\n      my $rawdata;\n      my %ctime = ();\n      my %mtime = ();\n\n      $statinfo-&gt;{'ctime'}=readtime($infile, \\%ctime);\n      $statinfo-&gt;{'mtime'}=readtime($infile, \\%ctime);\n\n      # read the non-time fields\n      read $infile, $rawdata, 24;\n      ( $statinfo-&gt;{'dev'}.\n        $statinfo-&gt;{'inode'}.\n        $statinfo-&gt;{'mode'}.\n        $statinfo-&gt;{'uid'}.\n        $statinfo-&gt;{'gid'}.\n        $statinfo-&gt;{'size'} ) = unpack \"NNNNNN\", $rawdata;\n\n      $entry-&gt;{'statinfo'}=$statinfo;\n      read $infile, $rawdata, 20;\n      ( $entry-&gt;{'id'} ) = unpack \"H*\", $rawdata;\n      $packindex.=$rawdata;\n      read $infile, $rawdata, 2;\n      ( $entry-&gt;{'flags'} ) = unpack \"n\", $rawdata;\n\n      # Finally read name - it's length is the lower 11 bits of flags\n      my $namelength=($entry-&gt;{'flags'} &amp; 0x7ff)+1;\n\n      # Pad it up to a multiple of 4\n      read $infile, $rawdata, $namelength + (8 - (($namelength + 62) % 8)) %8;\n      ($entry-&gt;{'name'}) = unpack \"a\" . ($namelength-1), $rawdata;\n\n      push(@index_entries, $entry);\n   }\n   return @index_entries;\n}\n\n# First grab the database file\nmy $target=$ARGV[0];\nmy $giturl=\"http://$ARGV[0]/.git/index\";\nmy $ua=LWP::UserAgent-&gt;new;\nprint \"Target is: $giturl\\n\";\n$ua-&gt;agent(\"All Your Files Are Belong To Us/1.0\");\nmy $request=HTTP::Request-&gt;new(GET =&gt; $giturl);\nmy $result=$ua-&gt;request($request);\n\nif ($result-&gt;status_line !~ /^200/)\n{\n   die \"Could not find Git index file\";\n}\n\nmy ($dbfileh, $dbfilen) = tempfile();\nprint $dbfileh $result-&gt;content;\nclose $dbfileh;\n\nopen(my $infile, \"{'id'},0,2);\n   my $resthash=substr($entry-&gt;{'id'},2);\n\n   my $file=\".git/objects/\" . $firsttwo . \"/\" . $resthash;\n   my $rawdata;\n   my $decompressed;\n   my $oh;\n\n   print \"Extracting\" . $entry-&gt;{'name'} . \"\\n\";\n\n   my $giturl=\"http://$server/$file\";\n   my $frequest=HTTP::Request-&gt;new(GET =&gt; $giturl);\n   my $fresult=$ua-&gt;request($frequest);\n   $rawdata=$fresult-&gt;content;\n\n   # Make sure the path is there for the output\n   my $outputpath=\"output/\" . $entry-&gt;{'name'};\n   $outputpath =~ s#/[^/]*$##g;\n\n   make_path($outputpath);\n   open $oh, \"&gt;\", \"output/$entry-&gt;{'name'}\";\n\n   # Now decompress the data\n   $decompressed=uncompress($rawdata);\n   my $gitfile={};\n\n   ($gitfile-&gt;{'type'}) = substr($decompressed,0,5);\n   if ($gitfile-&gt;{'type'} ne \"blob \")\n   {\n      print \"Unknown git file type: $gitfile-&gt;{'type'}. Skipping\\n\";\n      next;\n   }\n   ($gitfile-&gt;{'size'}) = unpack \"Z*\", substr($decompressed,5);\n   ($gitfile-&gt;{'data'}) = substr($decompressed,length($gitfile-&gt;{'size'})+6);\n\n   # And write it\n   print $oh $gitfile-&gt;{'data'};\n   close($oh);\n}\n</code></pre>\n\n<p>Im not sure whats wrong with it. If anyone is able to help it would really helpful? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["perl", "if-statement", "file-writing"], "comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 1, "creation_date": 1553100841, "post_id": 55265932, "comment_id": 97263717, "body": "I&#39;m not sure I completely follow what is your problem (&quot;it doesn&#39;t work&quot; isn&#39;t a very good description), but does <code>find( { wanted =&gt; \\&amp;findAllFiles, no_chdir =&gt; 1}, &#39;.&#39;);</code> instead of your <code>find( \\&amp;findAllFiles, &#39;.&#39;);</code> (and <code>&gt;&gt;</code> instead of <code>&gt;</code>) solve it?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 0, "creation_date": 1553100956, "post_id": 55265932, "comment_id": 97263787, "body": "You never actually print the value of <code>$File::Find::name</code> or <code>$filename</code>. So my first guess would be that your filenames don&#39;t match your regex."}, {"owner": {"reputation": 1183, "user_id": 1985337, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/WMtrj.png?s=128&g=1", "display_name": "Reverend Bubbles", "link": "https://stackoverflow.com/users/1985337/reverend-bubbles"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1553101240, "post_id": 55265932, "comment_id": 97263960, "body": "1) I actually DO print out the $filename and it prints to the screen exactly correctly. 2) @Dada - it worked! I have no clue what that snippet means, but it did it! Thanks!"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1553101242, "post_id": 55265932, "comment_id": 97263963, "body": "note that filenames.csv will be created in the directory where the pdf is found, since find() changes directories as it searches; is that what you want?"}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1553101318, "post_id": 55265932, "comment_id": 97264005, "body": "is the &quot;Adding ...&quot; message showing up?"}, {"owner": {"reputation": 1183, "user_id": 1985337, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/WMtrj.png?s=128&g=1", "display_name": "Reverend Bubbles", "link": "https://stackoverflow.com/users/1985337/reverend-bubbles"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1553101427, "post_id": 55265932, "comment_id": 97264080, "body": "@ysth - yes. and thanks for the other tip - that&#39;s what was happening! I&#39;m reminded of the movie the Illusionist!"}], "answers": [{"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": false, "score": 1, "last_activity_date": 1553101757, "creation_date": 1553101757, "answer_id": 55266510, "question_id": 55265932, "link": "https://stackoverflow.com/questions/55265932/writing-to-a-file-inside-if-statement-not-working-in-perl/55266510#55266510", "title": "Writing to a file inside if statement not working in Perl", "body": "<p>filenames.csv will be created in the directory where the pdf is found, since find() changes directories as it searches.  If that's not what you want, use an absolute path to open it (or open it before calling find, which seems like a better idea).</p>\n"}, {"tags": [], "owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "is_accepted": true, "score": 2, "last_activity_date": 1553108052, "last_edit_date": 1553108052, "creation_date": 1553102686, "answer_id": 55266802, "question_id": 55265932, "link": "https://stackoverflow.com/questions/55265932/writing-to-a-file-inside-if-statement-not-working-in-perl/55266802#55266802", "title": "Writing to a file inside if statement not working in Perl", "body": "<p>Quoting <a href=\"https://perldoc.perl.org/File/Find.html#*find*\" rel=\"nofollow noreferrer\"><code>File::Find::find</code></a>'s documentation:</p>\n\n<blockquote>\n  <p>Additionally, for each directory found, it will chdir() into that directory</p>\n</blockquote>\n\n<p>It means that when you <code>open</code> inside <code>findAllFiles</code>, you are potentially opening a file <code>filenames.csv</code> inside a subdirectory of your initial directory. You can run something like <code>find . -name filenames.csv</code> from your terminal, and you'll see plenty of <code>filenames.csv</code>. You can change this behavior by passing <code>no_chdir</code> option to <code>find</code>:</p>\n\n<pre><code>find( { wanted =&gt; \\&amp;findAllFiles, no_chdir =&gt; 1}, '.');\n</code></pre>\n\n<p>(and additionally changing <code>&gt;</code> for <code>&gt;&gt;</code> in your open)</p>\n\n<p>However, personally, I'd avoid repeatedly opening and closing <code>filenames.csv</code> when you could open it just once before calling <code>find</code>. If you don't want to have your filehandle globally defined, you can always pass it as an argument to <code>findAllFiles</code>: </p>\n\n<pre><code>{ \n    open my $fh, '&gt;', 'filenames.csv' or die \"Failed to open 'filenames.csv': $!\";\n    find(sub { findAllFiles($fh) }, '.')\n}\n\nsub findAllFiles {\n    my ($fh) = @_;\n    ...\n</code></pre>\n"}], "owner": {"reputation": 1183, "user_id": 1985337, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/WMtrj.png?s=128&g=1", "display_name": "Reverend Bubbles", "link": "https://stackoverflow.com/users/1985337/reverend-bubbles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55266802, "answer_count": 2, "score": 1, "last_activity_date": 1553108052, "creation_date": 1553099967, "last_edit_date": 1553100046, "question_id": 55265932, "link": "https://stackoverflow.com/questions/55265932/writing-to-a-file-inside-if-statement-not-working-in-perl", "title": "Writing to a file inside if statement not working in Perl", "body": "<p>I've looked around here a bit and found similar questions but not exactly. If there is one, I apologize and please point me to it.</p>\n\n<p>I have the following code. I'm trying to create a csv file of simply an ID pulled from a filename and the filename itself. This is the ENTIRE script.</p>\n\n<pre><code>use strict;\nuse warnings;\nuse File::Find;\n\nfind( \\&amp;findAllFiles, '.');\nexit;\n\nsub findAllFiles {\n\nmy @fp1;\nmy @fp2;\nmy $patId;\nmy $filename;\nmy $testvar = \"hello again\";\n\n\n$filename = $File::Find::name;\n\nif ($filename =~ /\\.pdf$/) {\nopen (my $fh, '&gt;', 'filenames.csv') or die \"Failed to open - $!\\n\";\nprint $fh \"starting...$testvar\\n\" or die \"Failed to print to file - $!\\n\";\n    @fp1 = split('/', $filename);\n    @fp2 = split('_', $fp1[-1]);\n    $patId = $fp2[-1];\n    $patId =~ s/\\.pdf$//;\n    print \"Adding $patId, file = $filename\\n\";\n    print $fh \"$patId,$filename\\n\" or die \"File print error: $!\";\nclose $fh or warn \"close failed! - $!\";\n}\n\n\nreturn;\n}\n</code></pre>\n\n<p>The line that prints to the screen, prints perfectly.\nIf I take the file open/close and the first print statement out of the <code>if</code> block, it prints that line into the file, but not the data inside the block.\nI've tried every combo I can think of and it doesn't work. I've alternated between <code>'&gt;'</code> and <code>'&gt;&gt;'</code> since it clearly needs the append since it's looping over filenames, but neither works inside the <code>if</code> block.</p>\n\n<p>Even this code above doesn't throw the <code>die</code> errors! It just ignores those lines! I'm figuring there's something obvious I'm missing.</p>\n"}, {"tags": ["linux", "perl", "email", "cron", "pipe"], "comments": [{"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 2, "creation_date": 1553095142, "post_id": 55264008, "comment_id": 97259903, "body": "Have you tried to move this long line of scripts to a separate script?"}, {"owner": {"reputation": 87, "user_id": 5112491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jJPnvrrpCLQ/AAAAAAAAAAI/AAAAAAAAABU/Yw4zwtArCNE/photo.jpg?sz=128", "display_name": "Tim Curtin", "link": "https://stackoverflow.com/users/5112491/tim-curtin"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553096045, "post_id": 55264008, "comment_id": 97260544, "body": "@UjinT34 I&#39;m trying hard to minimize changes to existing crontab because there are so many crons.  (See caveat 2, which should maybe be caveat 1.)   Also, even compressing into a separate script doesn&#39;t solve the issue with the current email subject getting cut off in the first path - I really need the ability to edit the subject and/or change the from."}, {"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1553133391, "post_id": 55264008, "comment_id": 97276448, "body": "can you list all your cronjobs with <code>crontab -l</code> or are they stored elsewhere (eg. /etc/cron.*/*)?"}, {"owner": {"reputation": 87, "user_id": 5112491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jJPnvrrpCLQ/AAAAAAAAAAI/AAAAAAAAABU/Yw4zwtArCNE/photo.jpg?sz=128", "display_name": "Tim Curtin", "link": "https://stackoverflow.com/users/5112491/tim-curtin"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1553135857, "post_id": 55264008, "comment_id": 97276955, "body": "@jww - fair enough. Edited for clarity.  (The issue with neither is actual errors, but failure to resolve the problem statement effectively.)"}, {"owner": {"reputation": 87, "user_id": 5112491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jJPnvrrpCLQ/AAAAAAAAAAI/AAAAAAAAABU/Yw4zwtArCNE/photo.jpg?sz=128", "display_name": "Tim Curtin", "link": "https://stackoverflow.com/users/5112491/tim-curtin"}, "reply_to_user": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1553135971, "post_id": 55264008, "comment_id": 97276982, "body": "@jhnc - yes to <code>crontab -l</code>.  I mention toward the end that I&#39;ve considered combining the info culled from <code>lsof</code> with <code>crontab -l</code>, but I can&#39;t think of a way to make that error-proof."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5112491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jJPnvrrpCLQ/AAAAAAAAAAI/AAAAAAAAABU/Yw4zwtArCNE/photo.jpg?sz=128", "display_name": "Tim Curtin", "link": "https://stackoverflow.com/users/5112491/tim-curtin"}, "edited": false, "score": 0, "creation_date": 1553275363, "post_id": 55273019, "comment_id": 97338151, "body": "Thank you @jhnc, this put me on the right track!  Final working script solution posted above."}], "tags": [], "owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "is_accepted": true, "score": 1, "last_activity_date": 1553137382, "last_edit_date": 1553137382, "creation_date": 1553136089, "answer_id": 55273019, "question_id": 55264008, "link": "https://stackoverflow.com/questions/55264008/get-full-current-crontab-line-and-create-unique-result-email-headers-from-sub/55273019#55273019", "title": "get full current crontab line, and create unique result email headers (from, subject, etc) per line", "body": "<h2>determining the pipeline</h2>\n\n<p>If you always invoke <code>coolmailer.pl</code> with a unique argument then you can simply grep it from your list of cronjobs:</p>\n\n<pre><code>#!/usr/bin/perl -wT\n\n$ENV{PATH} = '/sensible:/path';\n\nmy ($pipeline) = grep /\\|\\s+$0\\s+$ARGV[0]/, `crontab -l`;\n$pipeline ||= \"oops\";\n\n# ... mung $pipeline ...\n\n# ... do mail stuff ...\n</code></pre>\n\n<hr>\n\n<h2>checking pipe failure</h2>\n\n<p>If you rewrite your cronjob entries from:</p>\n\n<pre><code>/path/to/script1 | /path/to/script2 | /path/to/script3 2&gt;&amp;1 | coolmailer.pl\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>coolermailer /path/to/script1 \\| /path/to/script2 \\| /path/to/script3\n</code></pre>\n\n<p>then you could construct the pipeline manually and have control over pipe member status information. (This also gives you the pipeline directly, although you then have to construct it before it will run.)</p>\n\n<p>For example, with a bash implementation, you might make use of <code>eval</code> and <code>PIPESTATUS</code>. With Perl, you might use <code>results()</code> from <a href=\"https://metacpan.org/pod/distribution/IPC-Run/lib/IPC/Run.pm#results\" rel=\"nofollow noreferrer\">IPC::Run</a></p>\n"}], "owner": {"reputation": 87, "user_id": 5112491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jJPnvrrpCLQ/AAAAAAAAAAI/AAAAAAAAABU/Yw4zwtArCNE/photo.jpg?sz=128", "display_name": "Tim Curtin", "link": "https://stackoverflow.com/users/5112491/tim-curtin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 55273019, "answer_count": 1, "score": 2, "last_activity_date": 1553275328, "creation_date": 1553094287, "last_edit_date": 1553275328, "question_id": 55264008, "link": "https://stackoverflow.com/questions/55264008/get-full-current-crontab-line-and-create-unique-result-email-headers-from-sub", "title": "get full current crontab line, and create unique result email headers (from, subject, etc) per line", "body": "<p>I have a giant crontab with many scripts on a linux machine.  I need to be able to a) change the subject and/or from of cronjob result emails, because the default is unreadably long.  b) Do so via a centralized solution. c) Only require minimal changes to the crontab itself.</p>\n\n<p>For example this crontab line:</p>\n\n<pre><code>0 */3 * * * /path/to/script1 | /path/to/script2 | /path/to/script3\n</code></pre>\n\n<p>Creates this email subject:</p>\n\n<pre><code>Cron &lt;cronuser@myserver&gt; /path/to/script1 | /path/to/script2 | /path/to/script3\n</code></pre>\n\n<p>Which in my inbox gets cut off somewhere in the path to script1.  (And many lines in the crontab are significantly longer.)</p>\n\n<h2>Options I've tried:</h2>\n\n<ol>\n<li><p>Piping to mail and setting subject etc per line (The -E preserves cron's default only-send-on-output behavior):</p>\n\n<pre><code>0 */3 * * * /path/to/script1 | /path/to/script2 | /path/to/script3 2&gt;&amp;1 | mail -E -s \"test subject\" -S from=\"Cron Script2 &lt;cronuser@myserver.com&gt;\" recipient@myserver.com\n</code></pre>\n\n<p>This \"works\", but I want to centralize my changes in one place, and minimize how much I add to each cron line for readability</p></li>\n<li><p>Using shell : (noop) command, which shows up first in the subject (note that the space after the : is important!):</p>\n\n<pre><code>0 */3 * * *  : Descriptive Words; /path/to/script1 | /path/to/script2 | /path/to/script3\n</code></pre>\n\n<p>Unfortunately there's still too much unnecessary that cron puts before \"Descriptive Words\" on the subject line, so this is still unusable.</p></li>\n</ol>\n\n<h2>What I want to create:</h2>\n\n<p>Something generic, like this:</p>\n\n<pre><code>0 */3 * * * /path/to/script1 | /path/to/script2 | /path/to/script3 2&gt;&amp;1 | coolmailer.pl\n</code></pre>\n\n<p>coolmailer.pl would build the subject line by getting the commands on that cron line, strip out the paths and arguments, and email me this (optionally only if there's a fail in any of the scripts):</p>\n\n<pre><code>SUBJECT: script1 | script2 | script3\nFROM: Cron Script3&lt;noreply@myserver.com&gt;\n(actual results of the command /path/to/script1 | /path/to/script2 | /path/to/script3)\n</code></pre>\n\n<p>As a bonus, I'd also love to say whether any of the previous commands (script1 or script2) failed on the subject line.</p>\n\n<p>This has turned out to be... way more complicated than I expected.</p>\n\n<h2>Challenges:</h2>\n\n<ol>\n<li>Find a way for a pipeline member (coolmailer) to know the other\nmembers of the pipeline.</li>\n</ol>\n\n<p>There's an ingenious method for 1 here using lsof <a href=\"https://superuser.com/questions/244413/how-do-you-determine-the-actual-command-that-is-piping-into-you\">how-do-you-determine-the-actual-command-that-is-piping-into-you</a> but it also sometimes finds commands started by the scripts in my pipeline (ie if script1 forks processes or does system calls, those show up too any time they take long enough to complete.)  Ditto for the method using process groups at the same link.</p>\n\n<ol start=\"2\">\n<li>Find a way for a pipeline member (coolmailer) to know the results of\nother members of the pipeline.  (I realize this may not be possible at all, but the lsof hack gives me hope.)</li>\n</ol>\n\n<p>Any better way?  Does the fact that I'm running from cron buy me anything?  Part of me wants to combine the lsof strategy with grepping through <code>crontab -l</code> results, but that just seems too kludgy and prone to errors.</p>\n\n<h2>Caveats:</h2>\n\n<ol>\n<li>I can have changes made to my account, but I can't make changes that\nwould effect all users. I.e. if there's a way to change cron's\nmailing format server-wide, that doesn't help.</li>\n<li>I can't realistically update every script called to handle emailing its own results, even if that's probably the \"right\" way.</li>\n<li>I know about the <code>mail -s -E -S</code> options, but would prefer to have a single place to change things.  Also, I really want to find a way to get the pipeline.</li>\n<li>Language used now for \"coolmailer\" is Perl, but I'll try anything</li>\n</ol>\n\n<h2>My first attempt:</h2>\n\n<p>(which works, except it often also shows other commands started inside my scripts, which means it doesn't work)</p>\n\n<pre><code>#!/usr/bin/perl -w\nmy $pgid=`ps -o pgid= -p $$`;\nmy $lsofout = `/usr/sbin/lsof -g $pgid`;\nmy @otherpids = `echo \"$lsofout\" | awk '\\$5 == \"1w\" { print \\$2 }'`;\nmy @longcmds;\nmy @shortcmds;\n\nforeach my $pid (@otherpids) {\n  chomp($pid);\n  if (my $cmd = `ps -o cmd= -p $pid 2&gt;/dev/null`) {\n    chomp($cmd);\n    push @longcmds, $cmd;\n    next;\n  }\n}\nmy $cmdline = join (' | ',@longcmds);\n\nforeach my $cmd (@longcmds) {\n  $cmd =~ s/(\\/\\S+\\/)(\\S+)/$2/g;\n  push @shortcmds, $cmd;\n}\nmy $subj = join('|',@shortcmds);\n\nprint \"SUBJ:$subj\\n\";\nprint \"CMDLINE: $cmdline\\n\";\n\n# and now do some mail stuff\n</code></pre>\n\n<h2>And final version, based on suggestion by Jhnc</h2>\n\n<pre><code>#!/usr/bin/perl -w\n# cronmgr.pl -- understand cron emails for once\n\n# usage: 0 */3 * * * cronmgr.pl cd blah\\; /path/to/script1 \\| /path/to/script2 \\| /path/to/script3\n# note that ; | &amp; in any cronmgr.pl line must be backslashed to run!\n\nuse strict;\nuse IPC::Cmd qw[can_run run run_forked];\n\nmy $CMDLINE = join(' ',@ARGV);\nmy( $success, $error_message, $full_buf, $stdout_buf, $stderr_buf ) =\n        run( command =&gt; $CMDLINE, verbose =&gt; 0 ); # verbose = 0 means don't output normally, capture all output\n\nmy ($stdout, $stderr);\n$stdout = join \"\", @$stdout_buf;\n$stderr = join \"\", @$stderr_buf;\n\nmy $emailsubject;\n\nif( $success ) {\n    if ($stdout eq '' &amp;&amp; $stderr eq '') { # if there's no output, don't send any email!\n        exit;\n    }\n} else {\n    print \"CMD FAIL!\\n$error_message\\nSTDERR:\\n$stderr\";\n    $emailsubject = \"FAIL:$error_message\";\n}\n\n# etc etc\n</code></pre>\n\n<p>(Edited for clarity re goals and why options attempted so far aren't sufficient.)</p>\n"}, {"tags": ["regex", "perl", "sed"], "comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 7, "creation_date": 1553093702, "post_id": 55263708, "comment_id": 97258850, "body": "It seems like JSON with XML inside. If that is true, using JSON and XML modules in Perl should help you a lot."}, {"owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "reply_to_user": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1553094699, "post_id": 55263708, "comment_id": 97259604, "body": "I know (as I said I&#39;m able to sort everything using the perl modules but special characters always modify the output, that&#39;s why I&#39;d like to work on the global file)."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1553094970, "post_id": 55263708, "comment_id": 97259782, "body": "If you are properly using both an XML and a JSON parser this should be relatively straight-forward, as choroba said."}, {"owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "edited": false, "score": 0, "creation_date": 1553095794, "post_id": 55263708, "comment_id": 97260367, "body": "I did not mention it but the json file quite big (several MBytes) and xml strings in it contain thousand of entries. I would have to parse all the file and recreate a new one (with exactly the same syntax)...I don&#39;t see how it can be simplier than a regexp (for the guys who knows regexp better than me). And I still confirm that non utf-8 character a real pain when you read them and write them gain"}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1553096418, "post_id": 55263708, "comment_id": 97260796, "body": "If the XML data is real XML, and not something that just resembles XML, it will still mean the same thing when it comes back out. The same goes for the JSON. My experience tells me that this is more of a concern for the XML bit than the JSON bit though. You will be best off using a combination of two parsers, but you will have to at least run it through a JSON parser to get all the escaping out."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "edited": false, "score": 0, "creation_date": 1553175395, "post_id": 55265721, "comment_id": 97293117, "body": "Thank you. I tried it but I have &quot;Use of uninitialized value $xml in pattern match (m//)&quot;. I don&#39;t get your call to sub process (there should be 2 parameters, but when you call it, it seems to me there is only one...). the result is : no add in group1, and everything deleted in group3. For information, I made a mistake : &quot;;&quot; is&#39;nt the separator in my file, &quot;&amp;#10;&quot; is the separator (I&#39;ve put this in the split and the join lines but no success)."}, {"owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "edited": false, "score": 0, "creation_date": 1553176428, "post_id": 55265721, "comment_id": 97293835, "body": "forget my previous comment, there was a second level I didn&#39;t see in the json (so it&#39;s $hash-&gt;{content}-&gt;{xml}). I made a mistake : in <code>&lt;node n</code> and <code>&quot; u-l</code> the separator is not a space but &quot;\\n&quot;. So when I open the file, all xml is in one line, but when the script reads it it seems &quot;\\n&quot; is interepreted (so the websites are not on the same line as &quot;Group1&quot;). the regex never match if it&#39;s not one the same line..."}], "tags": [], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "is_accepted": true, "score": 1, "last_activity_date": 1553099310, "creation_date": 1553099310, "answer_id": 55265721, "question_id": 55263708, "link": "https://stackoverflow.com/questions/55263708/add-delete-a-string-to-a-pattern-matching/55265721#55265721", "title": "Add/Delete a string to a pattern matching", "body": "<p>This is possible to do with just parsing JSON. I doubt it is a good idea to do it without parsing the JSON at all.</p>\n\n<p>I've written an implementation that can modify groups, and add as well as remove domains from them. You need to keep in mind that altering stuff inside XML with regular expressions is always flimsy and naive. It will break easily, as it relies on things being in the right order. It doesn't know about attributes inside the XML tags, or even the tags themselves. It's just a bunch of text.</p>\n\n<p>Having said that, let's first look at the configuration and the actual call.</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\nuse JSON;\nmy $json =\n  q[{\"xml\" :\"SOMESTUFFWEDONOTCARE&lt;node n=\\\"Group1\\\" u-l=\\\"toto.com;tata.com;tutu.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group2\\\" u-l=\\\"bobo.com;baba.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group3\\\" u-l=\\\"toto.com;papa.com;pepe.com;pupu.com\\\"&gt;&lt;/node&gt;SOMESTUFFWEDONOTCARE\"}];\nmy $hash = decode_json $json;\n$hash-&gt;{xml} = process(\n    $hash-&gt;{xml} =&gt; {\n        \"Group1\" =&gt; {add    =&gt; [qw/newwebsite.com/]},\n        \"Group3\" =&gt; {remove =&gt; [qw/toto.com/]}\n    },\n);\nprint encode_json($hash);\n</code></pre>\n\n<p>The first assumption is that the string of data you've given us, which looks like JSON, is actually JSON, and that the escaping with the backslashes is verbatim. If that changes, all the code breaks.</p>\n\n<p>There's configuration here that allows you to say you want to <code>add</code> and/or <code>remove</code> domains from a group.</p>\n\n<p>That's done in the <code>process</code> sub, which will iterate the groups, find the first occurrence in the string of XML, and handle it. This assumes the entire XML document is in one line. If there are newlines, this breaks.</p>\n\n<p>Here's the full function.</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>sub process {\n    my ($xml, $args) = @_;\n\n    foreach my $group (keys %$args) {\n        if ($xml =~ m/&lt;node n=\"\\Q$group\\E\" u-l=\"([^\"]+)\"&gt;/) {\n            my $existing_list = $1;\n            my @items = split /;/, $existing_list;\n\n            # remove items from the list\n            if (exists $args-&gt;{$group}-&gt;{remove}) {\n                no warnings 'experimental';\n\n                my @remove = @{$args-&gt;{$group}-&gt;{remove}};\n                @items = grep { not $_ ~~ @remove } @items;\n            }\n\n            # add new items to the list\n            if (exists $args-&gt;{$group}-&gt;{add}) {\n                push @items, @{$args-&gt;{$group}-&gt;{add}};\n            }\n\n            # serialise the list and stick it back in\n            # need the \"\" as an anchor\n            my $new_list = join ';', @items;\n            $xml =~ s/\"(\\Q$existing_list\\E)\"/\"$new_list\"/;\n        }\n    }\n    return $xml;\n}\n</code></pre>\n\n<p>Remember that while this looks like XML, we treat it like just a bunch of text. We need the opening and closing bracket of the <code>&lt;node&gt;</code> as an anchor. We grab the list of domains out, and manipulate it. If there is extra whitespace or the order of elements changes, this breaks.</p>\n\n<p>The code uses simple list operations to handle the lists of domains.</p>\n\n<p>To allow easy removal of several domains, this uses the experimental smartmatch operator. You can implement it in a different way, but I was lazy. It will only work on certain Perl version, as this is experimental.</p>\n\n<p>We then stick the new list back into the big string that looks like XML by replacing the old one with it. We need to make sure no special characters (like the dot <code>.</code>) make it into the pattern, so we escape it with <code>\\Q</code> and <code>\\E</code>.</p>\n\n<p>In case it's not clear yet, I will say it again. While this works for this very specific set of parameters you've given in your question, chances are this will not work fully in production for you. You will have to adapt it, and likely adapt it often. </p>\n\n<p>You are probably better off using both a JSON parser as well as an XML parser.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "edited": false, "score": 0, "creation_date": 1553500821, "post_id": 55268283, "comment_id": 97391967, "body": "I focused my time on the previous answer which solved it. But I want to thank you because your answer is also useful to me (pure regex is needed in other raw text files so your regex helps me to understand a bit more how it works on complex pattern matching)"}], "tags": [], "owner": {"reputation": 11, "user_id": 7174732, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7aXWDV3yDjk/AAAAAAAAAAI/AAAAAAAAAT0/dz5t6SfKoRA/photo.jpg?sz=128", "display_name": "Mir Al-Masud", "link": "https://stackoverflow.com/users/7174732/mir-al-masud"}, "is_accepted": false, "score": 0, "last_activity_date": 1553108233, "creation_date": 1553108233, "answer_id": 55268283, "question_id": 55263708, "link": "https://stackoverflow.com/questions/55263708/add-delete-a-string-to-a-pattern-matching/55268283#55268283", "title": "Add/Delete a string to a pattern matching", "body": "<p>I believe this works. I am using perl regular expression substitution techniques. I hope I did not misunderstand the question.</p>\n\n<pre><code>my $line = '\"xml\" : \"SOMESTUFFWEDONOTCARE&lt;node n=\\\"Group1\\\" u-l=\\\"toto.com;tata.com;tutu.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group2\\\" u-l=\\\"bobo.com;baba.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group3\\\" u-l=\\\"toto.com;papa.com;pepe.com;pupu.com\\\"&gt;&lt;/node&gt;SOMESTUFFWEDONOTCARE\"';\n\nmy $new_word = \"newwebsite.com\";\nmy $remove_word = \"toto.com\";\nprint $line;\n$line =~ s/(.+)\\\\\\\"(Group1\\\\\\\" u-l=\\\\\\\".+.com)(\\\\\\\"\\&gt;\\&lt;\\/node\\&gt;\\&lt;node n=\\\\\\\"Group2.+)(Group3\\\\\\\" u-l=\\\\\\\".+.com)(.+)/$1.$2.';'.${new_word}.$3.'***'.rm_string($4,$remove_word).$5/e;\nprint(\"\\n\\n$line\");\n\n\nsub rm_string{\n    $string = shift;\n    $remove_string=shift;\n    $string =~ s/$remove_string;?//;\n    $string =~ s/;$//;\n    return($string);\n\n}\n</code></pre>\n\n<p>the result gives after substitution-</p>\n\n<pre><code>\n\"xml\" : \"SOMESTUFFWEDONOTCARE&lt;node n=Group1\\\" u-l=\\\"toto.com;tata.com;tutu.com;newwebsite.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group2\\\" u-l=\\\"bobo.com;baba.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"***Group3\\\" u-l=\\\"papa.com;pepe.com;pupu.com\\\"&gt;&lt;/node&gt;SOMESTUFFWEDONOTCARE\"\n\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7712945"}, "is_accepted": false, "score": 0, "last_activity_date": 1554704116, "creation_date": 1554704116, "answer_id": 55567227, "question_id": 55263708, "link": "https://stackoverflow.com/questions/55263708/add-delete-a-string-to-a-pattern-matching/55567227#55567227", "title": "Add/Delete a string to a pattern matching", "body": "<p>by gnu sed , your data string in 'd' file</p>\n\n<pre><code>sed -E 's/(Group1\\\\.[^&gt;]+)\\\"(&gt;&lt;)/\\1;newwebsite.com\"\\2/i; s/(Group3\\\\\"[^=]+=\\\\\")toto\\.com;/\\1/i' d\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11232602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGs--3j0cBg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regoxlhIy56PT3lkXG_cZUbh77YUQ/mo/photo.jpg?sz=128", "display_name": "Stephane Proud", "link": "https://stackoverflow.com/users/11232602/stephane-proud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 55265721, "answer_count": 3, "score": 0, "last_activity_date": 1554704116, "creation_date": 1553093480, "last_edit_date": 1553094926, "question_id": 55263708, "link": "https://stackoverflow.com/questions/55263708/add-delete-a-string-to-a-pattern-matching", "title": "Add/Delete a string to a pattern matching", "body": "<p>I need to find a list based on a pattern and add or delete an other string...</p>\n\n<p>I have a xml list of URLs in a file.</p>\n\n<p>In my file, on a single line, I have this :</p>\n\n<pre><code>\"xml\" : \"SOMESTUFFWEDONOTCARE&lt;node n=\\\"Group1\\\" u-l=\\\"toto.com;tata.com;tutu.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group2\\\" u-l=\\\"bobo.com;baba.com\\\"&gt;&lt;/node&gt;&lt;node n=\\\"Group3\\\" u-l=\\\"toto.com;papa.com;pepe.com;pupu.com\\\"&gt;&lt;/node&gt;SOMESTUFFWEDONOTCARE\"\n</code></pre>\n\n<p>My questions :</p>\n\n<ol>\n<li>in Group1 I want to add \"newwebsite.com\" to my list (at the end of my list)</li>\n</ol>\n\n<p>So <code>u-l=\\\"toto.com;tata.com;tutu.com\\\"</code> becomes <code>u-l=\\\"toto.com;tata.com;tutu.com;newwebsite.com\\\"</code></p>\n\n<p>Of course the only things I know are \"Group1\" and \"newwebsite.com\"...</p>\n\n<ol start=\"2\">\n<li>in Group3 I want to delete \"toto.com\" from my list</li>\n</ol>\n\n<p>So <code>u-l=\\\"toto.com;papa.com;pepe.com;pupu.com\\\"</code> becomes <code>u-l=\\\"papa.com;pepe.com;pupu.com\\\"</code></p>\n\n<p>It must not delete \"toto.com\" from Group1 and I assume that I don't know where \"toto.com\" is in my Group3 list (position 1 to N possible).</p>\n\n<p>The solutions can be a perl code (working on the file as a filehandler) or a \"sed\" in the perl code (working with the file directly).\nI don't want to put the xml into a hash and work on it (I've tried and basically it works but when we put everything in a file again it's a mess, because of accented characters, newlines, or non utf-8 characters, the output is never matching the input...</p>\n"}, {"tags": ["perl", "csh"], "comments": [{"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 1, "creation_date": 1553095544, "post_id": 55263696, "comment_id": 97260179, "body": "Does it work when you type this command yourself? Your script might not have enough permissions to access <code>&#47;vobs&#47;common&#47;gradle-X.X&#47;bin</code>"}, {"owner": {"reputation": 1140, "user_id": 8981474, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5S2rF.png?s=128&g=1", "display_name": "isakbob", "link": "https://stackoverflow.com/users/8981474/isakbob"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 0, "creation_date": 1553096065, "post_id": 55263696, "comment_id": 97260558, "body": "That&#39;s it, when I run <code>&#47;bin&#47;env $path which gradle</code> in command line, it returns <code>&#47;bin&#47;env: &#47;home&#47;adm&#47;common&#47;binOverrides: Permission denied.</code>"}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "reply_to_user": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 1, "creation_date": 1553096458, "post_id": 55263696, "comment_id": 97260826, "body": "You should probably post that as an actual answer, so it can be upvoted/accepted. @UjinT34"}], "answers": [{"tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": true, "score": 1, "last_activity_date": 1553098924, "creation_date": 1553098924, "answer_id": 55265597, "question_id": 55263696, "link": "https://stackoverflow.com/questions/55263696/why-does-which-miss-commands-even-when-the-bin-directory-is-in-path/55265597#55265597", "title": "Why does &quot;which&quot; miss commands even when the /bin directory is in PATH?", "body": "<p>Your script might not have enough permissions to access <code>/vobs/common/gradle-X.X/bin</code>.</p>\n"}], "owner": {"reputation": 1140, "user_id": 8981474, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5S2rF.png?s=128&g=1", "display_name": "isakbob", "link": "https://stackoverflow.com/users/8981474/isakbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 55265597, "answer_count": 1, "score": 0, "last_activity_date": 1553098924, "creation_date": 1553093451, "question_id": 55263696, "link": "https://stackoverflow.com/questions/55263696/why-does-which-miss-commands-even-when-the-bin-directory-is-in-path", "title": "Why does &quot;which&quot; miss commands even when the /bin directory is in PATH?", "body": "<h1>Background</h1>\n\n<p>I am currently testing a perl script, running in cshell (<a href=\"http://www.grymoire.com/unix/CshTop10.txt\" rel=\"nofollow noreferrer\">company default if you were wondering</a>) that will be used by a Jenkins job. As part of that script, I am doing a sanity check that gradle exists in the path.</p>\n\n<p>I am adding the gradle directory to the path, then I save a local version of the path as seen below:</p>\n\n<pre><code>$ENV{PATH} .= \":/vobs/common/gradle-X.X/bin\";\nmy $myPATH = $ENV{ \"PATH\" };\n</code></pre>\n\n<p>Then I do the sanity check with the <a href=\"https://linux.die.net/man/1/which\" rel=\"nofollow noreferrer\">which</a> command inside a <a href=\"https://perldoc.perl.org/functions/system.html\" rel=\"nofollow noreferrer\">system</a> command as depicted below:</p>\n\n<pre><code>system (\"/bin/env PATH=$myPath which gradle\" );\n</code></pre>\n\n<p>The error returned states that I added the path correctly, but for some reason it cannot find gradle within it as seen below:</p>\n\n<pre><code>which: no gradle in (&lt;standard directories&gt;:/vobs/common/gradle-X.X/bin)\n</code></pre>\n\n<hr>\n\n<p><strong>Note:</strong> Another main reason I mentioned cshell is that these two questions <strong>don't</strong> apply to my issue because they are bash related: </p>\n\n<p><a href=\"http://www.grymoire.com/unix/CshTop10.txt\" rel=\"nofollow noreferrer\">Why 'whereis' and 'which' don't show me location of command?</a></p>\n\n<p><a href=\"https://unix.stackexchange.com/questions/5609/how-do-i-clear-bashs-cache-of-paths-to-executables\">How do I clear Bash's cache of paths to executables?</a></p>\n\n<h1>Question</h1>\n\n<p>Why does \"which\" miss commands despite knowing that the /bin directory exists in the path?</p>\n"}, {"tags": ["perl", "hash", "hashmap", "dna-sequence", "expectation-maximization"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1553105164, "post_id": 55263812, "comment_id": 97266128, "body": "I&#39;m working on editing the code and updating the post to address your concerns."}], "tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": false, "score": 0, "last_activity_date": 1553094625, "last_edit_date": 1553094625, "creation_date": 1553093741, "answer_id": 55263812, "question_id": 55263631, "link": "https://stackoverflow.com/questions/55263631/perl-expectation-maximization-of-log-odds-scores-of-dna-sequences/55263812#55263812", "title": "Perl Expectation Maximization of log-odds scores of DNA sequences", "body": "<p><code>foreach $id (keys %loscore, %maxscore, %id2seq)</code> doesn't iterate over all three hashes. You probably meant <code>foreach $id (keys %loscore, keys %maxscore, keys %id2seq)</code></p>\n\n<p><code>if ($id2seq{$id}[$pos] = $mot{$base})</code> assigns the value to <code>$id2seq{$id}[$pos]</code>. To check for eqaulity you need <code>if ($id2seq{$id}[$pos] eq $mot{$base})</code>. But this is probably wrong too since <code>$id2seq{$id}</code> should be a string and <code>$mot{$base}</code> is an array.</p>\n\n<p>It is not clear how your code should work and it is hard to find errors in such long code samples.</p>\n"}], "owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1553094625, "creation_date": 1553093303, "question_id": 55263631, "link": "https://stackoverflow.com/questions/55263631/perl-expectation-maximization-of-log-odds-scores-of-dna-sequences", "title": "Perl Expectation Maximization of log-odds scores of DNA sequences", "body": "<p>My overall goal for this code is to find the motif (smaller sequence) in each DNA sequence that will report a maximum log-odds score based on a log-odds scoring matrix. The .txt file I am searching through looks like this:</p>\n\n<pre><code>&gt;Sequence 1\nTCGACGATCAGACAG\n&gt;Sequence 2\nTGGGACTTGCACG\n</code></pre>\n\n<p>.... and so on.</p>\n\n<p>I am working on the maximization step of my code at the moment, and I am struggling to calculate a log-odds score of a motif within my DNA sequence. I have code that creates the log-odds scoring matrix - see the following:</p>\n\n<pre><code>#!/usr/bin/perl -w\n#Above line used in Unix and Linux\n#Grome Programming Assignment 2\n#E-M\nuse strict;\nuse warnings;\n\n# usage: script.pl {motif_width} {dnafile}\n#USER SPECIFICATIONS\nprint \"Please enter the filename of the fasta sequence data: \";\nmy $filename1 = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $filename1;\n\n#Open the file and store each dna seq in hash\nmy %id2seq = ();\nmy $id = '';\nopen (FILE, '&lt;', $filename1) or die \"Cannot open $filename1.\",$!;\nmy $dna;\nwhile (&lt;FILE&gt;)\n{\n    if($_ =~ /^&gt;(.+)/)\n    {\n        $id = $1;\n    }\n    else\n    {\n        $id2seq{$id} .= $_;\n    }\n}\nclose FILE;\nforeach $id (keys %id2seq)\n{\n    print \"$id2seq{$id}\\n\\n\";\n}\n\n#User specifies motif width\nprint \"Please enter the motif width:\\n\";\nmy $width = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $width;\n\n#Default width is 3 (arbitrary number chosen)\nif ($width eq '')\n{\n    $width = 3;\n}\nelsif ($width &lt;=0)\n{\n    print \"Please enter a number greater than zero:\\n\";\n    $width = &lt;STDIN&gt;;\n    chomp $width;\n}\n\n#User specifies number of initial random\n#starting alignments\nprint \"Please enter the number of initial random\nstarting alignments:\\n\";\nmy $start = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $start;\n\n#Default start is 50\nif ($start eq '')\n{\n    $start = 50;\n}\nelsif ($start &lt;=0)\n{\n    print \"Please enter a number greater than zero:\\n\";\n    $start = &lt;STDIN&gt;;\n    chomp $start;\n}\n\n#User specifies number of iterations to\n#perform expectation-maximization\nprint \"Please enter the number of iterations for \nexpectation-maximization:\\n\";\nmy $iteration = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $iteration;\n\n#Default iteration = 500\nif($iteration eq '') \n{\n    $iteration = 500;\n}\nelsif ($iteration &lt;=0)\n{\n    print \"Please enter a number greater than zero:\\n\";\n    $iteration = &lt;STDIN&gt;;\n    chomp $iteration;\n}\n\n#EXPECTATION\n#Initialize counts for motif positions\n#Incorporate pseudocounts initially\nmy %mot = map { $_ =&gt; [ (1) x $width ] } qw( A C G T );\n\n# Initialize background counts\nmy %bg = map { $_ =&gt; 0 } qw( A C G T );\n\n#Fill background and motif counts\nforeach $id (keys %id2seq)\n{\n    #Generate random start site in the sequence\n    #for motif to start from\n    my $ms = int(rand(length($id2seq{$id})-$width));\n\n    # Within a motif, count the bases at the positions\n    for my $pos (0..length($id2seq{$id})-1)\n    {\n        my $base = substr($id2seq{$id}, $pos, 1);\n        if ($pos &gt;= $ms &amp;&amp; $pos &lt; $ms + $width) \n        {\n            ++$mot{$base}[$pos-$ms]\n                if exists($mot{$base});\n        } \n        else \n        {\n            ++$bg{$base}\n            if exists($bg{$base});\n        }\n    }\n}\n#Print the background and motif counts\nfor my $base (qw( A C G T )) \n{\n   print \"$base @{$mot{$base}}\\n\";\n}\n\nprint \"\\n\";\n\nfor my $base (qw( A C G T )) \n{\n   print \"bg$base = $bg{$base}\\n\";\n}\n\n#Create frequency table of the motifs\n#Get sum of the background\nmy $bgsum = 0;\nfor my $base (qw( A C G T))\n{\n    $bgsum = $bgsum + $bg{$base};\n}\nprint \"\\n$bgsum\\n\\n\";\n\n#Create background frequency table\nmy %bgfreq = map { $_ =&gt; 0 } qw( A C G T );\nfor my $base (qw( A C G T))\n{\n    $bgfreq{$base} = $bg{$base} / $bgsum;\n    print \"bgfreq$base = $bgfreq{$base}\\n\";\n}\n\n#Get sum of each motif position\nmy @motsum = ( (0) x $width );\nfor my $base (qw( A C G T))\n{\n    for my $arrpos (0.. ($width-1))\n    {\n        $motsum[$arrpos] = $motsum[$arrpos] + @{$mot{$base}}[$arrpos];\n    }\n}\n\n#Create motif frequency table\nmy %motfreq = map { $_ =&gt; [ (0) x $width ]} qw( A C G T );\nfor my $base (qw( A C G T))\n{\n    for my $arrpos (0.. ($width-1))\n    {\n        $motfreq{$base}[$arrpos] = $mot{$base}[$arrpos] / $motsum[$arrpos];\n    }\n    print \"motfreq$base @{$motfreq{$base}}\\n\";\n}\n\n#Create odds table of motifs\nmy %odds = map { $_ =&gt; [ (0) x ($width) ]} qw( A C G T );\n\nfor my $base (qw( A C G T))\n{\n    for my $arrpos (0.. ($width-1))\n    {\n        $odds{$base}[$arrpos] = $motfreq{$base}[$arrpos] / $bgfreq{$base};\n    }\n    print \"odds$base @{$odds{$base}}\\n\";\n}\n\n#Create log-odds table of motifs\nmy %logodds = map { $_ =&gt; [ (0) x ($width) ]} qw( A C G T );\nfor my $base (qw( A C G T))\n{\n    for my $arrpos (0.. ($width-1))\n    {\n        $logodds{$base}[$arrpos] = log2($odds{$base}[$arrpos]);\n    }\n    print \"logodds$base @{$logodds{$base}}\\n\";\n}\n#####################################################\nsub log2\n{\n    my $n = shift;\n    return log($n)/log(2);\n}\n</code></pre>\n\n<p>Now, I need to calculate the log-odds score of a motif within each DNA sequence. Then, I will iterate through all possible positions in the sequence and find the maximum score for each sequence. Future work requires me to recall the motif with the max score, but I have not made an attempt at that yet (just wanted to give scope to these max scores).</p>\n\n<p>Strategy: I am going to create a hash of log-odds scores and maximum scores to hold the max scores of each sequence as iterated. To calculate the log-odds score, I will see which element of the log-odds scoring matrix matches the elements in the motif. </p>\n\n<pre><code>#MAXIMIZATION\n#Determine location for each sequence that maximally\n#aligns to the motif pattern\n#Calculate logodds for the motif\n\n#Create hash of logodds scores and hash of maxscores\n#so each id has a logodds score and max score\n my %loscore = map { $_ =&gt; [ (0) x (length($id2seq{$id})-$width) ]} qw( $id ); #Not sure if $id is correct, but I want a loscore for each $id\n my %maxscore = map { $_ =&gt; [ (0) x (length($id2seq{$id})-$width) ]} qw( $id ); #Not sure if $id is correct, but I want a maxscore for each $id\n foreach $id (keys %loscore, %maxscore, %id2seq)\n {\n my $len = length($id2seq{$id});\n for my $base (qw( A C G T ))\n {\n     for my $pos (0..$len-1)\n     {\n         if ($id2seq{$id}[$pos] = $mot{$base})\n         {\n             for my $motpos (0..$width-1)\n             {\n                 $loscore{$id} = $loscore{$id} + $logodds{$base}[$motpos];\n                 if ($loscore{$id} &gt; $maxscore{$id})\n                 {\n                     $maxscore{$id} = $loscore{$id};\n                 }\n             }\n         }\n     }\n }\n print \"$id2seq{$id} logodds score: $maxscore{$id}\\n\";\n }\n\n#####################################################\nsub log2\n{\n    my $n = shift;\n    return log($n)/log(2);\n}\n</code></pre>\n\n<p>When I uncomment the maximization step from the code an run it, nothing prints from the maximization section. I do not get any errors, but nothing new prints. I understand that my expectation step can be simplified (I will clean everything up after it works), but I am focused on this maximization step first. I know that there are plenty of flaws in the maximization code, especially when trying to create the log-odds score and max score hashes. Any and all input helps! Thank you in advance for your patience and advice. Let me know if you need any clarification.</p>\n"}, {"tags": ["perl"], "answers": [{"comments": [{"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553087260, "post_id": 55261385, "comment_id": 97254322, "body": "it gives <code>00 01 00 00 00 00 00 00</code> in hexdump -C, but I want <code>00 00 00 00 00 00 01 00</code>"}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "reply_to_user": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 1, "creation_date": 1553087392, "post_id": 55261385, "comment_id": 97254400, "body": "@stack0114106 That&#39;s an endianess issue. You have a little-endian CPU. It&#39;s likely that you actually want what pack gives you."}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "reply_to_user": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553088327, "post_id": 55261385, "comment_id": 97254962, "body": "@stack0114106 Or, if you are sure you want your data little-endian, then use <code>Q&gt;</code> instead of <code>Q</code> (but when the Java side stops working, I suggest that the first thing you do is reconsider this choice)"}, {"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1553089386, "post_id": 55261385, "comment_id": 97255664, "body": "@Dada actually it is read by a package called scala.math.BigInteger"}, {"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553160272, "post_id": 55261385, "comment_id": 97284426, "body": "@JGNI.. pls add <code>Q&gt;</code> variant and output of them in hex formats..I&#39;ll accept the answer"}], "tags": [], "owner": {"reputation": 3509, "user_id": 4243840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaeabd769bae1bf82fd4b8882fed6653?s=128&d=identicon&r=PG", "display_name": "JGNI", "link": "https://stackoverflow.com/users/4243840/jgni"}, "is_accepted": true, "score": 3, "last_activity_date": 1553165835, "last_edit_date": 1553165835, "creation_date": 1553086914, "answer_id": 55261385, "question_id": 55261277, "link": "https://stackoverflow.com/questions/55261277/convert-integer-to-8-byte-long/55261385#55261385", "title": "Convert integer to 8 byte long", "body": "<p>pack() is your friend.</p>\n\n<pre><code>my $long = pack('Q', $value);\n</code></pre>\n\n<p>This will create a 64bit, 8 byte, unsigned integer in native, CPU endianess, however if you want a particular, ie non native endian format, adding <code>&gt;</code> after the <code>Q</code> will force big-endian and <code>&lt;</code> will force little-endian</p>\n\n<p>Note that this only works on 64 bit processors.</p>\n\n<p>From your question you want big endian format so you need </p>\n\n<pre><code>my $long = pack('Q&gt;', $value);\n</code></pre>\n\n<p>which will convert 256 to <code>\"\\x0\\x0\\x0\\x0\\x0\\x0\\x1\\x0\"</code></p>\n\n<p>See <a href=\"https://perldoc.perl.org/functions/pack.html\" rel=\"nofollow noreferrer\"><code>perldoc pack</code></a> for more info on this useful function.</p>\n"}], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 1, "accepted_answer_id": 55261385, "answer_count": 1, "score": 2, "last_activity_date": 1553165835, "creation_date": 1553086557, "last_edit_date": 1553086722, "question_id": 55261277, "link": "https://stackoverflow.com/questions/55261277/convert-integer-to-8-byte-long", "title": "Convert integer to 8 byte long", "body": "<p>I'm working on generating some sequence numbers and I need to encode them in a long format, i.e. standard 8 byte, as the downstream is a Java application and the generated number should be read by Java's <code>Long</code> datatype.</p>\n\n<p>I searched Stack Overflow and I could find answers in other languages, but not in Perl.</p>\n\n<p>Note that the below prints in 8 bytes in ASCII form:</p>\n\n<pre><code>$ perl -le ' BEGIN { printf(\"%08d\\n\", 256) } '\n00000256\n$\n</code></pre>\n\n<p>But I don't want that. I want the raw hex values of the output to be:</p>\n\n<pre><code>\\x00 \\x00 \\x00 \\x00 \\x00 \\x00 \\x01 \\x00\n</code></pre>\n\n<p>Which when scanned as 8 byte <code>Long</code> should become 256 again.</p>\n\n<p>For 255, it should be:</p>\n\n<pre><code>\\x00 \\x00 \\x00 \\x00 \\x00 \\x00 \\x00 \\xFF\n</code></pre>\n\n<p>How could this be done in Perl?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1553079669, "post_id": 55258840, "comment_id": 97249616, "body": "If we take <code>\\x80</code> as example: do you want the hexadecimal representation of the UTF-8 string (<code>C280</code>) or the unicode <i>codepoint</i> (<code>U+00880</code>)?"}, {"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "reply_to_user": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1553079807, "post_id": 55258840, "comment_id": 97249710, "body": "@stefan.. for now, I need utf-8 alone.. but if you know for unicode, pls add it for reference"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1553101183, "post_id": 55258840, "comment_id": 97263934, "body": "This question also has some terminology confusion. Unicode has code points and they go way above 255, UTF-8 is a character encoding for representing Unicode code points as bytes."}], "answers": [{"comments": [{"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553079429, "post_id": 55258968, "comment_id": 97249480, "body": "thank you for quick response.. how to reformat further..  like get the hex chars in upper case C280.. or \\XC2\\X80 like that?."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553080544, "post_id": 55258968, "comment_id": 97250179, "body": "Glad I could help, Updated my answer with some variants."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553081218, "post_id": 55258968, "comment_id": 97250531, "body": "BTW: <code>use utf8;</code> is not necessary to access <code>utf8::encode()</code>."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1553100840, "post_id": 55258968, "comment_id": 97263716, "body": "The language here needs some clarification, there is plenty of confusion already about character encoding. There is only one type of string (Perl&#39;s internal representation is not relevant), but it will contain either bytes (which may be either non-textual binary data, or an encoded representation of text such as UTF-8) or characters (which are decoded unicode codepoints). You use encode and decode to convert between these, and you use bytes to interact with pipes, files, terminals, etc, and characters for text operations."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1553101036, "post_id": 55258968, "comment_id": 97263839, "body": "Confusing the matter, a string of bytes can be treated as a string of characters (like with split, length, etc), they will be treated as the equivalent Unicode codepoints."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1553101490, "post_id": 55258968, "comment_id": 97264119, "body": "And you can also treat a string of characters as bytes, which is commonly done by accident when printing decoded characters to a default STDOUT or filehandle for example, and you get wide character warnings/errors if any characters are over U+00FF (255)."}], "tags": [], "owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "is_accepted": true, "score": 2, "last_activity_date": 1553081153, "last_edit_date": 1553081153, "creation_date": 1553078971, "answer_id": 55258968, "question_id": 55258840, "link": "https://stackoverflow.com/questions/55258840/perl-how-to-print-utf8-code-points-for-each-byte/55258968#55258968", "title": "perl - How to print utf8 code points for each byte", "body": "<p>Use <code>unpack('H*')</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl -e '$x=\"\\x80\"; utf8::encode($x); print unpack(\"H*\", $x), \"\\n\"'\nc280\n</code></pre>\n\n<p>For your example file I get</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl -e 'open($fh, \"&lt;\", \"raw_bytes.dat\"); binmode($fh); \n           while ($rb=read($fh,$x,1)) { utf8::encode($x);\n               print unpack(\"H*\", $x), \"\\n\";\n           }'\n00\n01\n02\n03\n...\n7f\nc280\nc281\nc282\nc283\n...\nc3bd\nc3be\nc3bf\n</code></pre>\n\n<p>Variants:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl -e '$x=\"\\x80\"; utf8::encode($x);\n           print uc(unpack(\"H*\", $x)), \"\\n\"'\nC280\n\n$ perl -e '$x=\"\\x80\"; utf8::encode($x);\n           ($r = uc(unpack(\"H*\", $x))) =~ s/(..)/\\\\X\\1/g;\n           print \"$r\\n\"'\n\\XC2\\X80\n\n# a little bit pointless example, but assume that $x is a provided Perl scalar....\n$ perl -e '$x=\"\\N{U+0080}\\N{U+0081}\";\n           printf(\"U+%04x \", ord($_)) foreach(split(//, $x));\n           print \"\\n\";'\nU+0080 U+0081\n</code></pre>\n\n<p>Please remember the difference between</p>\n\n<ul>\n<li>a scalar holding a raw string: <code>split(//)</code> returns <strong>octets</strong>, e.g. <code>\\x80</code></li>\n<li>a scalar holding a properly encoded string: <code>split(//)</code> returns <strong>characters</strong>, e.g. <code>\\N{U+0080}</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": false, "score": 2, "last_activity_date": 1553084054, "creation_date": 1553084054, "answer_id": 55260539, "question_id": 55258840, "link": "https://stackoverflow.com/questions/55258840/perl-how-to-print-utf8-code-points-for-each-byte/55260539#55260539", "title": "perl - How to print utf8 code points for each byte", "body": "<blockquote>\n  <p>I tried %02x using printf, but it didn't work.</p>\n</blockquote>\n\n<p>You can use </p>\n\n<pre><code>printf \"%vX\\n\", $x;\n</code></pre>\n\n<p>According to <a href=\"https://perldoc.perl.org/functions/sprintf.html\" rel=\"nofollow noreferrer\">perldoc sprintf</a>:</p>\n\n<blockquote>\n  <p><strong>vector flag</strong></p>\n  \n  <p>This flag tells Perl to interpret the supplied string as a vector of\n  integers, one for each character in the string. Perl applies the\n  format to each integer in turn, then joins the resulting strings with\n  a separator (a dot . by default). This can be useful for displaying\n  ordinal values of characters in arbitrary strings.</p>\n</blockquote>\n"}], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55258968, "answer_count": 2, "score": 1, "last_activity_date": 1553084054, "creation_date": 1553078581, "last_edit_date": 1553078942, "question_id": 55258840, "link": "https://stackoverflow.com/questions/55258840/perl-how-to-print-utf8-code-points-for-each-byte", "title": "perl - How to print utf8 code points for each byte", "body": "<p>I'm trying to print the code points for all possible byte values.</p>\n\n<p>My test file :</p>\n\n<pre><code>$ perl -e ' open($fh,\"&gt;raw_bytes.dat\");while($i++&lt;256){ print $fh chr($i-1) } close($fh)'\n\n$ ls -l raw_bytes.dat\n-rw-rw-r--+ 1 uuuuu Domain Users 256 Mar 20 15:41 raw_bytes.dat\n$ \n</code></pre>\n\n<p>What should go into the below <code>#---&gt;</code> part so that I print the code points of utf8 $x in hexadecimal?</p>\n\n<pre><code>perl -e ' use utf8; open($fh,\"&lt;raw_bytes.dat\");binmode($fh);\n          while($rb=read($fh,$x,1)) { utf8::encode($x);\n          #---&gt;\n          } ' \n</code></pre>\n\n<p>I tried %02x using printf, but it didn't work. Also, I want the solution only using core modules.</p>\n"}, {"tags": ["arrays", "perl", "pdl"], "comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1553079084, "post_id": 55258565, "comment_id": 97249281, "body": "(FYI, I googled &quot;Undefined subroutine &amp;PDL::mult&quot; and the question I linked in my previous comment was the first result)"}], "owner": {"reputation": 474, "user_id": 1949418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh4sK.jpg?s=128&g=1", "display_name": "jinawee", "link": "https://stackoverflow.com/users/1949418/jinawee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1553084228, "answer_count": 0, "score": 1, "last_activity_date": 1553077751, "creation_date": 1553077751, "question_id": 55258565, "link": "https://stackoverflow.com/questions/55258565/how-to-avoid-error-when-multiplying-an-array-with-one-element-in-pdl", "closed_reason": "Duplicate", "title": "How to avoid error when multiplying an array with one element in PDL?", "body": "<p>I've tried using PDL to multiply arrays in a faster way, but get an error with one-element piddles. The example code is</p>\n\n<pre><code>use PDL::Core;\nuse PDL::Primitive;\n\nmy $m = [ [ 2 ] ];\npdl($m) x pdl($m);\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>Undefined subroutine &amp;PDL::mult called at /home/user/perl5/lib/perl5/x86_64-linux-gnu-thread-multi/PDL/Primitive.pm line 263.\n</code></pre>\n\n<p><code>Primitive.pm</code> source code is:</p>\n\n<pre><code>sub PDL::matmult {\n    my ($a,$b,$c) = @_;\n\n    $b = pdl($b) unless eval { $b-&gt;isa('PDL') };\n    $c = PDL-&gt;null unless eval { $c-&gt;isa('PDL') };\n\n    while($a-&gt;getndims &lt; 2) {$a = $a-&gt;dummy(-1)}\n    while($b-&gt;getndims &lt; 2) {$b = $b-&gt;dummy(-1)}\n\n    return ($c .= $a * $b) if( ($a-&gt;dim(0)==1 &amp;&amp; $a-&gt;dim(1)==1) ||\n                               ($b-&gt;dim(0)==1 &amp;&amp; $b-&gt;dim(1)==1) );\n    if($b-&gt;dim(1) != $a-&gt;dim(0)) {\n        barf(sprintf(\"Dim mismatch in matmult of [%dx%d] x [%dx%d]: %d != %d\",$a-&gt;dim(0),$a-&gt;dim(1),$b-&gt;dim(0),$b-&gt;dim(1),$a-&gt;dim(0),$b-&gt;dim(1)));\n    }\n    PDL::_matmult_int($a,$b,$c);\n    $c;\n}\n\n\n*matmult = \\&amp;PDL::matmult;\n</code></pre>\n\n<p>It seems that multiplication is not defined when there is a single element. Is this a bug? Way it is the adequate way to solve it?</p>\n"}, {"tags": ["shell", "perl", "unix", "ksh"], "comments": [{"owner": {"reputation": 165, "user_id": 3740968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/782dbe04ef7af95e30656d5b88b89aa4?s=128&d=identicon&r=PG&f=1", "display_name": "swet", "link": "https://stackoverflow.com/users/3740968/swet"}, "reply_to_user": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 0, "creation_date": 1553077400, "post_id": 55258273, "comment_id": 97248289, "body": "Hi Allan, sed &#39;s/&quot;&quot;|/|/g&#39;      and     sed -e &quot;s/\\&quot;\\&quot;//g&quot;        and      perl -pe &#39;s/(?&lt;!^)(?&lt;!\\,)&quot;(?!\\,)(?!$)/&quot;&quot;/g&#39;"}, {"owner": {"reputation": 51521, "user_id": 2566198, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y34ZA.jpg?s=128&g=1", "display_name": "Sobrique", "link": "https://stackoverflow.com/users/2566198/sobrique"}, "edited": false, "score": 0, "creation_date": 1553077485, "post_id": 55258273, "comment_id": 97248349, "body": "<code>perl</code>&#39;s <code>Text::CSV</code> module might well do the trick."}, {"owner": {"reputation": 5598, "user_id": 540341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7762851de72b8505fa70cae4eb7c83?s=128&d=identicon&r=PG", "display_name": "filiprem", "link": "https://stackoverflow.com/users/540341/filiprem"}, "edited": false, "score": 0, "creation_date": 1553090381, "post_id": 55258273, "comment_id": 97256347, "body": "How come in the 1st line of test example in the input you have 2 trailing spaces: <code>&quot;1&quot;,&quot;2col&quot;,&quot;&quot;3col[ ]&quot;[ ]&quot;</code> and in the output you have 4 (four) trailing spaces: <code>&quot;1&quot;,&quot;2col&quot;,&quot;3col[ ][ ][ ][ ]&quot;</code>? Please adjust examples so they accurately match your requirements"}, {"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553160151, "post_id": 55258273, "comment_id": 97284377, "body": "the double quotes are not balanced in record 5... can you clarify that"}, {"owner": {"reputation": 165, "user_id": 3740968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/782dbe04ef7af95e30656d5b88b89aa4?s=128&d=identicon&r=PG&f=1", "display_name": "swet", "link": "https://stackoverflow.com/users/3740968/swet"}, "reply_to_user": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 0, "creation_date": 1553680131, "post_id": 55258273, "comment_id": 97470508, "body": "@Allan I had already upvoted the below answer few days back."}, {"owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 0, "creation_date": 1553687832, "post_id": 55258273, "comment_id": 97475261, "body": "@swet: thank you so much! If someone did answer the question could you also accept it ;)"}], "answers": [{"comments": [{"owner": {"reputation": 16325, "user_id": 3220113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1c0b015f14adfdf581d04c065e903d?s=128&d=identicon&r=PG&f=1", "display_name": "Walter A", "link": "https://stackoverflow.com/users/3220113/walter-a"}, "edited": false, "score": 1, "creation_date": 1553085120, "post_id": 55258743, "comment_id": 97253001, "body": "Will fail for a comma in the first 2 fields: <code>&quot;1&quot;,&quot;2,col&quot;,&quot;3col&quot;</code>"}, {"owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "reply_to_user": {"reputation": 16325, "user_id": 3220113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1c0b015f14adfdf581d04c065e903d?s=128&d=identicon&r=PG&f=1", "display_name": "Walter A", "link": "https://stackoverflow.com/users/3220113/walter-a"}, "edited": false, "score": 0, "creation_date": 1553086216, "post_id": 55258743, "comment_id": 97253685, "body": "@WalterA: I have edited and I have added a disclaimer. In OP post, col1 and 2 look ok, so that&#39;s why I have build my solution on this hypothesis."}], "tags": [], "owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "is_accepted": false, "score": 1, "last_activity_date": 1553086172, "last_edit_date": 1553086172, "creation_date": 1553078259, "answer_id": 55258743, "question_id": 55258273, "link": "https://stackoverflow.com/questions/55258273/unix-remove-internal-double-quote-with-terminator-comma/55258743#55258743", "title": "Unix - Remove internal double quote with terminator comma", "body": "<p>Hypothesis (first and 2nd columns are \"clean\", they do not contain <code>,</code> for example)</p>\n\n<p><strong>Input:</strong></p>\n\n<pre><code>\"1\",\"2col\",\"\"3col \" \"\n\"2\",\"2col\",\" \"3c,ol     \" \"\n\"3\",\"2col\",\" 3co,l\"     \n\"4\",\"2col\",\"3co,l\"\n\"5\",\"2col\",\"\"3co,l      \"\"              \"\n\"6\",\"2col\",\"\"3c,ol \"\"3c,ol\"\"\"\n</code></pre>\n\n<p><strong>Command:</strong></p>\n\n<pre><code>tr -d '\"' &lt; input | awk -F',' -v OFS=',' '{$1=\"\\\"\"$1\"\\\"\";$2=\"\\\"\"$2\"\\\"\";printf $1 OFS $2 OFS \"\\\"\";for(u=3;u&lt;=NF;u++){if(u!=NF)printf $u OFS;else printf $u};printf \"\\\"\" RS}'\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>\"1\",\"2col\",\"3col  \"\n\"2\",\"2col\",\" 3c,ol      \"\n\"3\",\"2col\",\" 3co,l     \"\n\"4\",\"2col\",\"3co,l\"\n\"5\",\"2col\",\"3co,l                    \"\n\"6\",\"2col\",\"3c,ol 3c,ol\"\n</code></pre>\n\n<p><strong>Explanations:</strong></p>\n\n<ul>\n<li><code>tr -d '\"' &lt; input</code> will remove all the <code>\"</code></li>\n<li><code>| awk</code> pipe the output to <code>awk</code></li>\n<li><code>-F',' -v OFS=','</code> input/output field separator defined as comma </li>\n<li>you surround the first 2 columns with <code>\"</code> by using <code>$1=\"\\\"\"$1\"\\\"\";$2=\"\\\"\"$2\"\\\"\";</code> and you print them <code>printf $1 OFS $2 OFS \"\\\"\";</code></li>\n<li><code>for(u=3;u&lt;=NF;u++){if(u!=NF)printf $u OFS;else printf $u};printf \"\\\"\" RS}</code> for the rest of the column you just append them back together and you add the last <code>\"</code> at the end of the line.</li>\n</ul>\n\n<p><strong>For readability:</strong></p>\n\n<pre><code>'{\n  $1=\"\\\"\"$1\"\\\"\"\n  $2=\"\\\"\"$2\"\\\"\"\n  printf $1 OFS $2 OFS \"\\\"\"\n  for(u=3;u&lt;=NF;u++)\n  {\n    if(u!=NF)printf $u OFS\n    else printf $u\n  }\n  printf \"\\\"\" RS\n}'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16325, "user_id": 3220113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a1c0b015f14adfdf581d04c065e903d?s=128&d=identicon&r=PG&f=1", "display_name": "Walter A", "link": "https://stackoverflow.com/users/3220113/walter-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1553092858, "last_edit_date": 1553092858, "creation_date": 1553087748, "answer_id": 55261635, "question_id": 55258273, "link": "https://stackoverflow.com/questions/55258273/unix-remove-internal-double-quote-with-terminator-comma/55261635#55261635", "title": "Unix - Remove internal double quote with terminator comma", "body": "<p>Use the quotes for finding the first two fields and concatenate the other fields.</p>\n\n<pre><code>awk -F '\"' '\n   BEGIN {q=\"\\\"\"}\n   {printf \"%s\", q$2q$3q$4q$5q; for (i=6;i&lt;=NF;i++) printf \"%s\", $i; print q}\n   ' inputfile\n</code></pre>\n\n<p>EDIT: An alternative</p>\n\n<pre><code>paste -d, &lt;( cut -d\",\" -f1,2 &lt; inputfile) \\\n          &lt;( cut -d\",\" -f3-  &lt; inputfile | sed 's/\"//g;s/.*/\"&amp;\"/')\n</code></pre>\n\n<p>EDIT: Another alternative</p>\n\n<p><code>sed 's/old/new/g</code>: Apply the replacement to all matches to the regexp\n<code>sed</code>s/old/new/number`: Only replace the numberth match of the regexp.\nWhen you mix the g and number modifiers in GNU sed, the first matces are ignored, and then match and replace all matches.<br>\nIn this case:</p>\n\n<pre><code>sed -r 's/\"//g6;s/$/\"/' inputfile\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 3740968, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/782dbe04ef7af95e30656d5b88b89aa4?s=128&d=identicon&r=PG&f=1", "display_name": "swet", "link": "https://stackoverflow.com/users/3740968/swet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553092858, "creation_date": 1553076787, "last_edit_date": 1553078369, "question_id": 55258273, "link": "https://stackoverflow.com/questions/55258273/unix-remove-internal-double-quote-with-terminator-comma", "title": "Unix - Remove internal double quote with terminator comma", "body": "<p><strong>Input file:</strong></p>\n\n<pre><code>\"1\",\"2col\",\"\"3col \" \"\n\"2\",\"2col\",\" \"3c,ol     \" \"\n\"3\",\"2col\",\" 3co,l\"     \n\"4\",\"2col\",\"3co,l\"\n\"5\",\"2col\",\"\"3co,l      \"\"              \"\n\"6\",\"2col\",\"\"3c,ol \"\"3c,ol\"\"\"\n</code></pre>\n\n<p><strong>Output file:</strong></p>\n\n<pre><code>\"1\",\"2col\",\"3col    \"\n\"2\",\"2col\",\" 3c,ol       \"\n\"3\",\"2col\",\" 3co,l\"     \n\"4\",\"2col\",\"3co,l\"\n\"5\",\"2col\",\"3co,l                       \"\n\"6\",\"2col\",\"3c,ol 3c,ol\"\n</code></pre>\n\n<p>Please help me to get the above Output using Unix command. Please note the 3rd column is modified in the output, all internal Double Quotes have been removed. </p>\n\n<p>Comma is terminator. When comma is present between Double quote then it is not considered as terminator. See 6th line and after 2nd comma, comma is present as a text between Double quote which is fine. </p>\n\n<p><strong>What I have tried so far:</strong></p>\n\n<pre><code>sed 's/\"\"|/|/g'\nsed -e \"s/\\\"\\\"//g\"\nperl -pe 's/(?&lt;!^)(?&lt;!\\,)\"(?!\\,)(?!$)/\"\"/g'\n</code></pre>\n"}, {"tags": ["perl", "awk", "sed", "text-processing"], "comments": [{"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 0, "creation_date": 1553084227, "post_id": 55256614, "comment_id": 97252403, "body": "Get rid of all the <code>.</code>s in your example so we have something we can test a potential solution against and add what you have tried so far. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> if that&#39;s not clear."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "edited": false, "score": 0, "creation_date": 1553076560, "post_id": 55257460, "comment_id": 97247818, "body": "Yes, it will do and it is clear how (will do means it is good and general enough to do it with the actual output). awk, in your opinion,  not suitable enough for this type of task ?"}, {"owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "reply_to_user": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "edited": false, "score": 0, "creation_date": 1553101985, "post_id": 55257460, "comment_id": 97264409, "body": "I&#39;m sure it&#39;s <i>possible</i> with <code>awk</code>, but for me it was easier to write it with Perl."}], "tags": [], "owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "is_accepted": false, "score": 0, "last_activity_date": 1553074169, "creation_date": 1553074169, "answer_id": 55257460, "question_id": 55256614, "link": "https://stackoverflow.com/questions/55256614/transpose-variable-amount-of-rows-with-variable-amount-of-columns-in-them-to-pa/55257460#55257460", "title": "transpose variable amount of rows with variable amount of columns in them to &lt;pattern&gt; followed by all the rows till next &lt;pattern&gt;", "body": "<p>This should be very easy to do in Perl. The <code>eth</code> lines are easy to match, and we just want to combine all the lines between them into a single line.</p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\nmy $collected;\nwhile (my $line = &lt;DATA&gt;){\n  next if $line =~ /^#/;\n  if($line =~ /^eth/) {\n    # new block of lines\n    if ($collected) {\n      print $collected, \"\\n\";\n      $collected = \"\";\n    }\n    chomp $line;\n    $collected = $line;\n  } else {\n    # Append to collected lines\n    chomp $line;\n    $collected = \"$collected $line\";\n  }\n}\nprint $collected,\"\\n\" if $collected;\n__DATA__\neth&lt;number1&gt;\nparameter1 parameter2 parameter3...parameterN\n#ellipsis means and so on and is not literal\nparameter21 parameter22\nparameter31 parameter32 parameter33 parameter34\nparameter41\neth&lt;number2&gt;\nparameter1 parameter2\nparameter21\nparameterN1 parameterN2\neth&lt;number3&gt;\nparameter1 parameter2\neth&lt;number4&gt;\nparameter1 parameter2\nparameter21\n</code></pre>\n\n<p>This will parse your sample data (ignoring the comments) and create the desired output. Of course, this is just a demo; you'd want to <code>open</code> the file that the data lives in and read it:</p>\n\n<pre><code>open my $fh, \"&lt;\", \"your.data\" or die \"Can't open file: $!\\n\";\n...\nwhile(my $line = &lt;$fh&gt;) { \n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "edited": false, "score": 0, "creation_date": 1553102039, "post_id": 55263460, "comment_id": 97264447, "body": "This is very elegant!"}, {"owner": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "edited": false, "score": 0, "creation_date": 1553107566, "post_id": 55263460, "comment_id": 97267330, "body": "Maybe (and quite probably) I was not clear enough and I am sorry about it but &lt;number1&gt; is not literal in the sense that there are no &lt;...&gt; to be found in the input -- I attempted to represent running number of the given interface. In hard reality it looks like: eth 1-43 ; eth 1-44; eth 2-36; eth 2-37 and so on and what is represented as parameter&lt;number&gt; below these lines in principle CAN very well contain the same numerical pattern."}, {"owner": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "edited": false, "score": 0, "creation_date": 1553246094, "post_id": 55263460, "comment_id": 97320841, "body": "@protong -- OK, I am still digesting sed incantation (including notion of HS), however, what very clearly happens is that last line (row) is both transposed to last  column&lt;s&gt; for the last eth entry and also is printed as the last line. So, in the example input it would be parameter21 both as a last column for the line containing eth&lt;number4&gt;  and also printed out as a separate line. You can try it yourself."}, {"owner": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "edited": false, "score": 0, "creation_date": 1553609978, "post_id": 55263460, "comment_id": 97442629, "body": "@potong, just got some spare minutes -- it still prints it twice. Example input is representative enough."}], "tags": [], "owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "is_accepted": false, "score": 1, "last_activity_date": 1553336077, "last_edit_date": 1553336077, "creation_date": 1553092878, "answer_id": 55263460, "question_id": 55256614, "link": "https://stackoverflow.com/questions/55256614/transpose-variable-amount-of-rows-with-variable-amount-of-columns-in-them-to-pa/55263460#55263460", "title": "transpose variable amount of rows with variable amount of columns in them to &lt;pattern&gt; followed by all the rows till next &lt;pattern&gt;", "body": "<p>This might work for you (GNU sed):</p>\n\n<pre><code>sed -E '/^#/d;/^eth/!{H;$!d};x;s/\\n/ /gp;x;h;d' file\n</code></pre>\n\n<p>There are three scenarios: lines that begin with <code>#</code>, lines that begin `eth and other lines.</p>\n\n<p>If the current line is a comment, delete it.</p>\n\n<p>If the current line does not begin <code>eth</code>, append it to the hold space (HS) and delete it unless it is the last line.</p>\n\n<p>Otherwise, the current line begins <code>eth</code> or is the last line, so swap to the HS and if that contains any linefeeds, replace them with spaces and print the result. Swap back to the pattern space and replace the HS with the current line and delete the current line unless it is the last line of the file in which case print it.</p>\n"}], "owner": {"reputation": 11, "user_id": 11230784, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ariel Burbaickij", "link": "https://stackoverflow.com/users/11230784/ariel-burbaickij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1553336077, "creation_date": 1553071360, "last_edit_date": 1553073419, "question_id": 55256614, "link": "https://stackoverflow.com/questions/55256614/transpose-variable-amount-of-rows-with-variable-amount-of-columns-in-them-to-pa", "title": "transpose variable amount of rows with variable amount of columns in them to &lt;pattern&gt; followed by all the rows till next &lt;pattern&gt;", "body": "<p>I have the following input, related to multi-interface (dozens of them) piece of network equipment (note that the lines with <code>#</code> are for clarification only and are not present in the data):</p>\n\n<pre><code>eth&lt;number1&gt; \n# eth as pattern is fine, running number will be dealt with\nparameter1 parameter2 parameter3...parameterN \n#ellipsis means and so on and is not literal\nparameter21 parameter22\nparameter31 parameter32 parameter33 parameter34\nparameter41\neth&lt;number2&gt;\nparameter1 parameter2\nparameter21\n.\n.\n.\n.\nparameterN1 parameterN2  \n# again, vertical ellipsis is not literal and means simply that rows \n# with parameters can go on and on, it is not known in advance for \n# how long\neth&lt;number3&gt;\nparameter1 parameter2\neth&lt;number4&gt;\nparameter1 parameter2\nparameter21\n</code></pre>\n\n<p>The desired output should look like this:</p>\n\n<pre><code>eth&lt;number1&gt; parameter1 parameter2 parameterN parameter21 parameter22 parameter31 parameter32 parameter33 parameter34 parameter41 \n# all in one line, with as many columns as there are parameters for \n# the given interface.\neth&lt;number2&gt; parameter1 parameter2....parameterNM\neth&lt;number3&gt; parameter1 parameter2\neth&lt;number4&gt; parameter1 parameter2 parameter21\n</code></pre>\n\n<p>Any ideas how to accomplish it with, preferably, <code>awk</code> or <code>sed</code>? Any clarifying question are welcome, of course.  </p>\n"}, {"tags": ["perl", "ffi", "strawberry-perl"], "comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1553061302, "post_id": 55252583, "comment_id": 97240657, "body": "<code>EnumProcessModules</code> and <code>GetModuleFileNameExA</code> are Windows API functions. I&#39;m guessing from the API documentation that <code>-lKernel32</code> is missing from the linker command line. The linker command line is unfortunately not visible in your question."}], "answers": [{"comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1553064854, "post_id": 55254679, "comment_id": 97241933, "body": "Just tried on my Windows 10 64-bit VM: (a) download &amp; unpack Strawberry Perl 5.28.1.1 portable zip file, (b) opened <code>portableshell</code> and (c) entered the two command lines from my solution. Module build goes through without a hitch and <code>perl -MFFI::Platypus -e 1</code> runs without error message afterwards."}, {"owner": {"reputation": 567, "user_id": 9652562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7179b8082590d9450b7783721493cb?s=128&d=identicon&r=PG&f=1", "display_name": "jsor", "link": "https://stackoverflow.com/users/9652562/jsor"}, "edited": false, "score": 0, "creation_date": 1553086594, "post_id": 55254679, "comment_id": 97253924, "body": "I tried the instructions but still get the same error , i added more info about the installation if you want to look thanks ."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 567, "user_id": 9652562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7179b8082590d9450b7783721493cb?s=128&d=identicon&r=PG&f=1", "display_name": "jsor", "link": "https://stackoverflow.com/users/9652562/jsor"}, "edited": false, "score": 1, "creation_date": 1553148546, "post_id": 55254679, "comment_id": 97279707, "body": "I&#39;ve now verified that the space in the path name is the cause for your error. I&#39;ve updated my answer accordingly. I would suggest to always use <code>cpanm -v ...</code> in the future and checking for warnings in the output."}], "tags": [], "owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "is_accepted": true, "score": 3, "last_activity_date": 1553148414, "last_edit_date": 1553148414, "creation_date": 1553062968, "answer_id": 55254679, "question_id": 55252583, "link": "https://stackoverflow.com/questions/55252583/installing-ffi-platypus-on-strawberry-perl-5-28-1/55254679#55254679", "title": "Installing FFI-Platypus on Strawberry perl 5.28.1", "body": "<p>From the linker error message (missing symbols <code>EnumProcessModules</code> and <code>GetModuleFileNameExA</code> which are Windows API functions) it is clear that the library <code>kernel32</code> is missing. The linker command line shown in your update proves that.</p>\n\n<p>The update also shows that you have installed Strawberry Perl under a path that contains spaces:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\...\n</code></pre>\n\n<p>Using paths with characters that have special meanings, like space (<code></code>), hash (<code>#</code>), etc., is always asking for trouble. In this particular case it leads to a build that can't find any libraries:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>...\nConfiguring FFI-Platypus-0.86 ... using system libffia via PkgConfigPP\nChecking if your kit is complete...\nLooks good\nWarning (mostly harmless): No library found for -lpsapi\nWarning (mostly harmless): No library found for -lmoldname\nWarning (mostly harmless): No library found for -lkernel32\nWarning (mostly harmless): No library found for -luser32\nWarning (mostly harmless): No library found for -lgdi32\nWarning (mostly harmless): No library found for -lwinspool\nWarning (mostly harmless): No library found for -lcomdlg32\nWarning (mostly harmless): No library found for -ladvapi32\nWarning (mostly harmless): No library found for -lshell32\nWarning (mostly harmless): No library found for -lole32\nWarning (mostly harmless): No library found for -loleaut32\nWarning (mostly harmless): No library found for -lnetapi32\nWarning (mostly harmless): No library found for -luuid\nWarning (mostly harmless): No library found for -lws2_32\nWarning (mostly harmless): No library found for -lmpr\nWarning (mostly harmless): No library found for -lwinmm\nWarning (mostly harmless): No library found for -lversion\nWarning (mostly harmless): No library found for -lodbc32\nWarning (mostly harmless): No library found for -lodbccp32\nWarning (mostly harmless): No library found for -lcomctl32\nGenerating a gmake-style Makefile\n...\n</code></pre>\n\n<p>Unfortunately the warning is not \"mostly harmless\", because it leads to a linker command line without e.g. <code>-lkernel32</code> and hence the linker error.</p>\n\n<p><strong>Solution</strong>: rename the directories in the path to remove any spaces, e.g.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>C:\\Dev\\OpenSource_Tools\\...\n</code></pre>\n\n<hr>\n\n<p><strong>Original answer</strong> The github project for <a href=\"https://github.com/Perl5-FFI/FFI-Platypus\" rel=\"nofollow noreferrer\">FFI::Platypus</a> shows that the author is running a <a href=\"https://github.com/Perl5-FFI/FFI-Platypus/blob/master/.appveyor.yml\" rel=\"nofollow noreferrer\">CI build for Strawberry Perl</a>. So one thing to check would be to follow the build instructions in that CI build:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>cpanm Capture::Tiny ExtUtils::MakeMaker ExtUtils::ParseXS IPC::Cmd\ncpanm FFI::Platypus\n</code></pre>\n\n<p>You might also want to compare your build log to one of the <a href=\"https://ci.appveyor.com/project/plicease/ffi-platypus/builds/23013891/job/402o0v2hcaux7l9p?fullLog=true\" rel=\"nofollow noreferrer\">FFI::Platypus CI Builds on AppVeyor</a> to discover differences.</p>\n"}], "owner": {"reputation": 567, "user_id": 9652562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7179b8082590d9450b7783721493cb?s=128&d=identicon&r=PG&f=1", "display_name": "jsor", "link": "https://stackoverflow.com/users/9652562/jsor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55254679, "answer_count": 1, "score": 0, "last_activity_date": 1553148414, "creation_date": 1553048064, "last_edit_date": 1553086541, "question_id": 55252583, "link": "https://stackoverflow.com/questions/55252583/installing-ffi-platypus-on-strawberry-perl-5-28-1", "title": "Installing FFI-Platypus on Strawberry perl 5.28.1", "body": "<p>When I am trying to install <a href=\"https://metacpan.org/pod/FFI::Platypus\" rel=\"nofollow noreferrer\">FFI::Platypus</a> on straweberry perl 5.28.1 I get the below messsage. Any idea what might be wrong?</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>xs/windl.o:windl.c:(.text+0x12c): undefined reference to `EnumProcessModules'\nxs/windl.o:windl.c:(.text+0x185): undefined reference to `GetModuleFileNameExA'\ncollect2.exe: error: ld returned 1 exit status\ngmake: *** [Makefile:529: blib\\arch\\auto\\FFI\\Platypus\\Platypus.xs.dll] Error 1\n  PLICEASE/FFI-Platypus-0.86.tar.gz\n  \"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\c\\bin\\gmake.exe\" -- NOT OK\nStopping: 'install' failed for 'FFI::Platypus'.\nFailed during this command:\n PLICEASE/FFI-Platypus-0.86.tar.gz            : make NO\n</code></pre>\n\n<p>also here are the linker steps on the installation</p>\n\n<pre><code>gcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include \\\n-s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2 \\\n  -DVERSION=\\\"0.86\\\" \\\n-DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   lib/FFI/Platypus.c -o lib/FFI/Platypus.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/closure.c -o xs/closure.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/complex.c -o xs/complex.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/custom.c -o xs/custom.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/havepm.c -o xs/havepm.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/meta.c -o xs/meta.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/names.c -o xs/names.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/perl_math_int64.c -o xs/perl_math_int64.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/record_opaque.c -o xs/record_opaque.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/record_simple.c -o xs/record_simple.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/record_string.c -o xs/record_string.o\ngcc -c  -Iinclude -IC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../include -s -O2 -DWIN32 -DWIN64 -DCONSERVATIVE -D__USE_MINGW_ANSI_STDIO -DPERL_TEXTMODE_SCRIPTS -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -DUSE_PERLIO -fwrapv -fno-strict-aliasing -mms-bitfields -s -O2   -DVERSION=\\\"0.86\\\" -DXS_VERSION=\\\"0.86\\\"  \"-IC:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\"   xs/windl.c -o xs/windl.o\n\"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\bin\\perl.exe\" -MExtUtils::Mksymlists \\\n     -e \"Mksymlists('NAME'=&gt;\\\"FFI::Platypus\\\", 'DLBASE' =&gt; 'Platypus', 'DL_FUNCS' =&gt; {  }, 'FUNCLIST' =&gt; [], 'IMPORTS' =&gt; {  }, 'DL_VARS' =&gt; [], 'FILE' =&gt; q[lib/FFI/Platypus]);\"\ng++.exe lib/FFI/Platypus.def -o blib\\arch\\auto\\FFI\\Platypus\\Platypus.xs.dll -LC:/Dev/OPENSO~1/Perl/STRAWB~1.1-6/c/lib/PKGCON~1/../../lib/../lib -mdll -s -L\"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\" -L\"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\c\\lib\" lib/FFI/Platypus.o xs/closure.o xs/complex.o xs/custom.o xs/havepm.o xs/meta.o xs/names.o xs/perl_math_int64.o xs/record_opaque.o xs/record_simple.o xs/record_string.o xs/windl.o   \"C:\\Dev\\OpenSource Tools\\Perl\\strawberry-perl-5.28.1.1-64bit-portable\\perl\\lib\\CORE\\libperl528.a\" \"C:\\Dev\\OPENSO~1\\Perl\\STRAWB~1.1-6\\c\\lib\\PKGCON~1\\..\\..\\lib\\..\\lib\\libffi.a\" -Wl,--enable-auto-image-base\n</code></pre>\n"}, {"tags": ["regex", "perl", "command-line"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1139359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469496619be64e60a0285994d484b266?s=128&d=identicon&r=PG", "display_name": "user1139359", "link": "https://stackoverflow.com/users/1139359/user1139359"}, "edited": false, "score": 0, "creation_date": 1553012874, "post_id": 55245276, "comment_id": 97224421, "body": "Thank you. perl -0777 -pe &#39; s/text.*end/textChanged/gs &#39; a.txt was exactly what I was looking for!"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 1, "creation_date": 1553014888, "post_id": 55245276, "comment_id": 97225558, "body": "See <a href=\"https://perldoc.pl/perlretut\" rel=\"nofollow noreferrer\">perlretut</a> for a general tutorial on regexes, and <a href=\"https://perldoc.pl/perlrun\" rel=\"nofollow noreferrer\">perlrun</a> for how the commandline options work."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1553019594, "post_id": 55245276, "comment_id": 97227972, "body": "You can bundle the <code>-0777</code> with the <code>-p</code> and the <code>-e</code>: <code>perl -0777pe&#39;s&#47;text.*end&#47;textChanged&#47;gs&#39; a.txt</code>"}], "tags": [], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "is_accepted": true, "score": 4, "last_activity_date": 1553020101, "last_edit_date": 1553020101, "creation_date": 1553011322, "answer_id": 55245276, "question_id": 55245037, "link": "https://stackoverflow.com/questions/55245037/how-to-replace-regex-multiline-dotall-using-perl-in-command-line/55245276#55245276", "title": "How to replace regex multiline dotall using perl in command line", "body": "<p>Note that Perl one-liner uses -p or -n switch which wraps a while loop behind the scenes.\nAnd the while loop uses scalar context which reads line by line, so you will not see any changes in your output unless the <code>text.*end</code> appears in a single line.</p>\n\n<p>Here is a sample</p>\n\n<pre><code>$ cat  a.txt\nabc\ntext 1 2\n2 3 4\nab end\nhello\nhere\n\n$ perl -pe 's/text.*end/textChanged/g' a.txt # Nothing happens - while reads line by line\nabc\ntext 1 2\n2 3 4\nab end\nhello\nhere\n</code></pre>\n\n<p>Now, you can do like setting the Record separator variable to <code>undef</code>.</p>\n\n<pre><code>$ perl -pe ' BEGIN { $/=undef } s/text.*end/textChanged/g' a.txt # Nothing happens\nabc\ntext 1 2\n2 3 4\nab end\nhello\nhere\n</code></pre>\n\n<p>But, when you add the /s modifier, the substitution takes place.</p>\n\n<pre><code>$ perl -pe ' BEGIN { $/=undef } s/text.*end/textChanged/gs ' a.txt\nabc\ntextChanged\nhello\nhere\n$\n</code></pre>\n\n<p>Reading the entire file using slurp mode and again nothing happens with your substitution.</p>\n\n<pre><code>$ perl -0777 -pe ' s/text.*end/textChanged/g ' a.txt\nabc\ntext 1 2\n2 3 4\nab end\nhello\nhere\n$\n</code></pre>\n\n<p>Now you use the /s flag so that dot can match the newline as well and the substitution takes place.</p>\n\n<pre><code>$ perl -0777 -pe ' s/text.*end/textChanged/gs ' a.txt\nabc\ntextChanged\nhello\nhere\n$\n</code></pre>\n\n<p>Thanks @ikegami... for the bundle options, like below</p>\n\n<pre><code>$ perl -0777pe ' s/text.*end/textChanged/gs ' a.txt\n</code></pre>\n\n<p>So when you want the dot to match newlines, you need to add the /s modifier in the regex.</p>\n"}], "owner": {"reputation": 119, "user_id": 1139359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469496619be64e60a0285994d484b266?s=128&d=identicon&r=PG", "display_name": "user1139359", "link": "https://stackoverflow.com/users/1139359/user1139359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 1, "accepted_answer_id": 55245276, "answer_count": 1, "score": 0, "last_activity_date": 1553020101, "creation_date": 1553010669, "last_edit_date": 1553014591, "question_id": 55245037, "link": "https://stackoverflow.com/questions/55245037/how-to-replace-regex-multiline-dotall-using-perl-in-command-line", "title": "How to replace regex multiline dotall using perl in command line", "body": "<p>Hi I am new using perl and I would like to know how to use it to replace regex in multline mode. And if possible to also make the \".\" match with break lines.</p>\n\n<p>I am using the following expression:</p>\n\n<pre><code>perl -pe 's/text.*end/textChanged/g' myFile.txt\n</code></pre>\n\n<p>The expression above replace in single line mode. It does not consider break lines.</p>\n\n<p>Using: \nWindows\nStranberry Perl </p>\n"}, {"tags": ["perl", "utf-8", "locale"], "comments": [{"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1556795370, "post_id": 55240390, "comment_id": 98554337, "body": "I&#39;ve submitted a fix for the Dancer2 issue at <a href=\"https://github.com/PerlDancer/Dancer2/pull/1499\" rel=\"nofollow noreferrer\">github.com/PerlDancer/Dancer2/pull/1499</a>."}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1552997463, "post_id": 55240638, "comment_id": 97214145, "body": "Tip: I used <code>sprintf &quot;%vX&quot;</code> to examine the characters of the string. Data::Dumper with <code>Useqq = 1</code> would also do the trick."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1552997601, "post_id": 55240638, "comment_id": 97214239, "body": "I think I am missing something else though. I know I can get rid of the warning as you&#39;ve described. In the Dancer2 source, it does <code>Encode::decode()</code>. I&#39;ve linked to the relevant source above. I can&#39;t find anything else that happens with the string afterwards though. What I wonder is, why does it fail if it does Korean or Russian or Hebrew, and why is there no error message in <code>$@</code>."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1552998156, "post_id": 55240638, "comment_id": 97214642, "body": "It failed because you tried to decode already-decoded text, and because you didn&#39;t encode your outputs. /// <code>decode</code> doesn&#39;t throw exceptions on error by default. The third parameter of <code>decode</code> can be used to change that behaviour."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1552999319, "post_id": 55240638, "comment_id": 97215393, "body": "Ok, that makes sense. Thanks. So basically the code in the Dancer2 file is buggy? I&#39;ve spotted that the handler for <code>%T</code> in the logger format (again, see link above) doesn&#39;t <code>Encode::decode</code>, while <code>%t</code> does. If I drop the decoding the error goes away."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1552999439, "post_id": 55240638, "comment_id": 97215486, "body": "I have very little experience with locales, so I&#39;ll just limit my answer to the following: Make sure to test with locales that aren&#39;t based on UTF-8 before making any changes."}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 2, "creation_date": 1553000485, "post_id": 55240638, "comment_id": 97216173, "body": "Nice, I didn&#39;t know about <code>-C</code> flag. If anyone else is wondering, see <a href=\"https://perldoc.perl.org/perlrun.html\" rel=\"nofollow noreferrer\">perlrun</a>: &quot;The -C flag controls some of the Perl Unicode features.&quot;, and then &quot;S&quot; = stdin/out/err utf8, &quot;D&quot; = in/out streams utf8, &quot;A&quot; = @ARGV utf8."}, {"owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 0, "creation_date": 1553001353, "post_id": 55240638, "comment_id": 97216807, "body": "If you want to edit that in to make it consistent with the German translation, the Korean string says &quot; 3 month&quot;. There are no month names in Korean. April is &quot; 4 month&quot;."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1553003239, "post_id": 55240638, "comment_id": 97218046, "body": "I shall decline. That&#39;s like saying the English translation of &quot;raton laveur&quot; is &quot;washing rat pup&quot; instead of &quot;raccoon&quot;."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "reply_to_user": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "edited": false, "score": 1, "creation_date": 1553014492, "post_id": 55240638, "comment_id": 97225347, "body": "@simbabque I would say it is definitely a bug to try to decode the output of strftime. || In case it&#39;s useful, I made an Encode wrapper with hopefully more sensible functions that you can choose between throwing exceptions and replacement characters (at least, you can look at its source to see how to do this correctly): <a href=\"https://metacpan.org/pod/Encode::Simple\" rel=\"nofollow noreferrer\">Encode::Simple</a>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 2, "creation_date": 1553020214, "post_id": 55240638, "comment_id": 97228267, "body": "@Grinnz, Keep in mind that Perl&#39;s handling of UTF-8 locales was super broken until recently. (5.20?) Maybe it&#39;s a bug now, but it wasn&#39;t before. So let me refine my earlier comment: Also test on older versions of Perl."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 4, "last_activity_date": 1553019757, "last_edit_date": 1553019757, "creation_date": 1552997033, "answer_id": 55240638, "question_id": 55240390, "link": "https://stackoverflow.com/questions/55240390/why-does-encodedecode-with-non-latin-letter-locales-blow-up-on-localised-strft/55240638#55240638", "title": "Why does Encode::decode with non-latin letter locales blow up on localised strftime output?", "body": "<p>Under <code>ko_KR.UTF-8</code>, <code>strftime(\"%b\", localtime(1552997524))</code> returns <code>20.33.C6D4</code>. When interpreted as Unicode Code Points, this is \"&#x2420;3&#xC6D4;\" (\"March\", with a leading space).</p>\n\n<p>Under <code>de_DE.UTF-8</code>, <code>strftime(\"%b\", localtime(1552997524))</code> returns <code>4D.E4.72</code>. When interpreted as Unicode Code Points, this is \"&#x4D;&#xE4;&#x72;\" (short form of \"M\u00e4rz\", \"March\").</p>\n\n<p>So it seems decoded text (Unicode Code Points) are being returned, which is perfect. All that's left to do is to <em>encode</em> the outputs.</p>\n\n<pre><code>$ LC_ALL=ko_KR.UTF-8 perl -CSD -MPOSIX -e'CORE::say strftime(\"%b\", localtime)'\n 3\uc6d4\n\n$ LC_ALL=de_DE.UTF-8 perl -CSD -MPOSIX -e'CORE::say strftime(\"%b\", localtime)'\nM\u00e4r\n</code></pre>\n\n<p>In a program (as opposed to a one-liner), you could use something like the following instead of <code>-CSD</code>:</p>\n\n<pre><code>use open ':std', ':encoding(UTF-8)';\n</code></pre>\n"}], "owner": {"reputation": 50468, "user_id": 1331451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/4ZPmj.png?s=128&g=1", "display_name": "simbabque", "link": "https://stackoverflow.com/users/1331451/simbabque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 55240638, "answer_count": 1, "score": 2, "last_activity_date": 1553019757, "creation_date": 1552996177, "question_id": 55240390, "link": "https://stackoverflow.com/questions/55240390/why-does-encodedecode-with-non-latin-letter-locales-blow-up-on-localised-strft", "title": "Why does Encode::decode with non-latin letter locales blow up on localised strftime output?", "body": "<p>On Ubuntu with Perl 5.26.1 I have encountered the following problem when working on Dancer::Logger::Console. I've lifted this code out of <a href=\"https://metacpan.org/source/Dancer2::Core::Role::Logger#L100\" rel=\"nofollow noreferrer\">Dancer2::Core::Role::Logger</a>.</p>\n\n<p>In order to run this, you need to generate the following locales:</p>\n\n<pre><code>sudo locale-gen de_DE.UTF-8\nsudo locale-gen ko_KR.UTF-8\n</code></pre>\n\n<p>This example code uses the Korean locale, and fails without an error message. <code>$@</code> is empty.</p>\n\n<pre><code>$ LC_ALL=ko_KR.UTF-8 perl -MPOSIX -MEncode -E 'eval {\n    say Encode::decode(\"UTF-8\", strftime(\"%b\", localtime))\n  }; \n  say $@;\n  '\nWide character at -e line 1.\n</code></pre>\n\n<p>When run with a German locale, it succeeds (but throws a wide character warning, which we can ignore for this test).</p>\n\n<pre><code>$ LC_ALL=de_DE.UTF-8 perl -MPOSIX -MEncode -E 'eval {\n    say Encode::decode(\"UTF-8\", strftime(\"%b\", localtime))\n  }; \n  say $@;\n  '\nWide character in say at -e line 2.\nM\ufffdr\n</code></pre>\n\n<p>The <code>%b</code> formatting is the abbreviated month as localised word (see <a href=\"http://strftime.net/\" rel=\"nofollow noreferrer\">http://strftime.net/</a>). </p>\n\n<p>If we don't <code>Encode::decode(\"UTF-8\", ...)</code>, it works, and the version above with Korean produces <code>3\uc6d4</code>.</p>\n\n<p>What's going on here?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1552988136, "post_id": 55237536, "comment_id": 97208400, "body": "I get 4970 warnings (that&#39;s an exact number, not just meant to say &quot;a lot&quot;) when I run your code, and none of them is about an uninitialized value in a division... Also, please add your imports to your code (I&#39;m guessing you are using <code>Math::Trig</code> for instance?)."}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 2, "creation_date": 1552988382, "post_id": 55237536, "comment_id": 97208537, "body": "Don&#39;t put <code>my</code> before every assignement. You should use <code>my</code> once per variable. For instance <code>$X_list[my $j]</code> should be <code>$X_list[$j]</code>,  <code>return my($X_branch,$Y_branch,$Z_branch);</code> should be <code>return ($X_branch,$Y_branch,$Z_branch);</code>. When you write <code>my $x</code>, you redefine <code>$x</code> and it becomes undefined..."}, {"owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1552988486, "post_id": 55237536, "comment_id": 97208595, "body": "Sorry @Dada, that is correct and will add the now."}, {"owner": {"reputation": 12075, "user_id": 1137055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d7b43b9eb7d01bd8f7e51febe6053c?s=128&d=identicon&r=PG", "display_name": "dgw", "link": "https://stackoverflow.com/users/1137055/dgw"}, "edited": false, "score": 1, "creation_date": 1552988971, "post_id": 55237536, "comment_id": 97208908, "body": "And using <code>my</code> within an <code>if</code>-<code>else</code> block limits the scope of the defined variable to this block."}, {"owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "edited": false, "score": 0, "creation_date": 1552989724, "post_id": 55237536, "comment_id": 97209393, "body": "So should I just declare them all at the start?"}, {"owner": {"reputation": 12075, "user_id": 1137055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59d7b43b9eb7d01bd8f7e51febe6053c?s=128&d=identicon&r=PG", "display_name": "dgw", "link": "https://stackoverflow.com/users/1137055/dgw"}, "edited": false, "score": 0, "creation_date": 1552990081, "post_id": 55237536, "comment_id": 97209631, "body": "No. The variables should be declared in the smallest possible scope. For example within a subroutine."}, {"owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "edited": false, "score": 0, "creation_date": 1552990339, "post_id": 55237536, "comment_id": 97209791, "body": "Ah okay, I have declared them now but still getting the division error. It just says illegal division by 0 in that generate pillar shape."}], "answers": [{"tags": [], "owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "is_accepted": true, "score": 5, "last_activity_date": 1552999980, "last_edit_date": 1552999980, "creation_date": 1552992297, "answer_id": 55239110, "question_id": 55237536, "link": "https://stackoverflow.com/questions/55237536/use-of-uninitialised-value-d-in-division-at/55239110#55239110", "title": "Use of uninitialised value $d in division {/} at", "body": "<p>I can't reproduce your error. However, there are a lot of errors in your code, so let me go through them, and hopefully this will help you find your actual mistake.</p>\n\n<p>First, variables should be defined in the smallest possible scope: if a variable is used only within a function, it should be defined within this function. If a variable is used only in a <code>for</code> loop, it should be defined within this loop. In that spirit, you should remove </p>\n\n<pre><code>my $i;\nmy $j;\n</code></pre>\n\n<p>at the begining of your code. Also, keep in mind that <code>my</code> declares a lexical variable visible only in the current scope (<em>ie.</em> you can use it only in the current block). For instance,</p>\n\n<pre><code>else {\n    my $X_branch=$X2;\n    my $Y_branch=$Y2;\n    my $Z_branch=$Z2;\n}\n</code></pre>\n\n<p>declares 3 variables that don't exist after the <code>else</code> block.</p>\n\n<p>Second, <code>my</code> declares a <em>new</em> variable, and should therefore be used only once per variable. If you write</p>\n\n<pre><code>my $x = 5;\nreturn my $x;\n</code></pre>\n\n<p>The first line declares a variable <code>$x</code>, and set it to <code>5</code>. The second line declares a new variable <code>$x</code> (thus shadowing the old one), whose value is <code>undef</code>, and returns it. What you want to write instead is:</p>\n\n<pre><code>my $x = 5;\nreturn $x;\n</code></pre>\n\n<hr>\n\n<p>Now let me go through your code to point out a few mistakes/improvements:</p>\n\n<ul>\n<li><p><code>$X_list[my $j]</code> should be <code>$X_list[$j]</code> (as per the beginning of this answer).</p></li>\n<li><p>Still in <code>find_branch</code>, you have an issue with the scope of the variables you defined (see the beginning of my answer). You should have something like:</p>\n\n<pre><code>my ($X_branch, $Y_branch, $Z_branch);\nif (abs($Z1-$Z2) &lt; $rXY) {\n    $Z_branch=($Z1+$Z2-$rXY)/2;\n    my $a=($Z1-$Z_branch)/$rXY;\n    $X_branch=(1-$a)*$X1+$a*$X2;\n    $Y_branch=(1-$a)*$Y1+$a*$Y2;\n}\nelsif ($Z1 &lt; $Z2) {\n    $X_branch=$X1;\n    $Y_branch=$Y1;\n    $Z_branch=$Z1;\n}\nelse {\n    $X_branch=$X2;\n    $Y_branch=$Y2;\n    $Z_branch=$Z2;\n}\nreturn ($X_branch,$Y_branch,$Z_branch);\n</code></pre>\n\n<p>This two corrections should silence every warnings. However, I suspect there are more things going wrong in your code.</p></li>\n<li><p>In <code>find_min_dist</code>, you should not write <code>my $I = $i</code> and <code>my $J = $j</code> but rather <code>$I = $i</code> and <code>$J = $j</code> (still the same scoping issue).</p></li>\n<li><p>Your sub <code>branch</code> doesn't do anything: you compute some <code>$rho</code>, <code>$theta</code> and <code>$phi</code>, but you don't return them (and you don't modify the arguments either).</p></li>\n<li><p>In <code>generate_pillars_shape</code>, <code>@X_values</code>, <code>@Y_values</code>, <code>@X</code>, <code>@Y</code> should all be locally declared with <code>my</code>. Also, you can initialize <code>@X_values</code> with <code>@X_values = grep { $_ % $d == 0 } $_[0] .. $_[1]</code> (same for <code>@Y_values</code>), which I find more readable that what you wrote.</p></li>\n<li><p>You should put your code in functions or code blocks (<code>{ ... }</code>) to use proper scoping: while it can make sense to have <code>$min_X</code>, <code>$max_X</code>, <code>$min_Y</code>, <code>$max_Y</code>,and <code>$distance</code> as global variables, you definitely don't want to have <code>$min_radian</code> or <code>$b</code> defined everywhere in your file.</p></li>\n<li><p>Don't use <code>$a</code> or <code>$b</code> (they are special variables, used by <code>sort</code>; you don't want to mess with them (see <a href=\"https://stackoverflow.com/q/26127617/4990392\">this question</a> for instance)).</p></li>\n<li><p>Additionally, just for clarity, in your sub <code>find_branch</code>, you can be a bit more compact to retrieve the arguments:</p>\n\n<pre><code>  my ($X1, $Y1, $Z1, $X2, $Y2, $Z2) = @_;\n</code></pre></li>\n</ul>\n\n<p>I'm fairly convinced that there are other issues with your code. Please tell us what you are trying to do and what each function is supposed to do if you want more help.</p>\n"}], "owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55239110, "answer_count": 1, "score": 0, "last_activity_date": 1553000170, "creation_date": 1552987649, "last_edit_date": 1553000170, "question_id": 55237536, "link": "https://stackoverflow.com/questions/55237536/use-of-uninitialised-value-d-in-division-at", "title": "Use of uninitialised value $d in division {/} at", "body": "<p>So I've done some googling and other site, my console is filled with all these warnings. Just a bit unsure how to fix this method overall. Likewise I hope my code isn't vague since I'm not too sure if the code here is enough. Regardless here is the issue. I have been trying to integrate a Perl script within my module for a while. The script itself works but not in the module. The error message for when I try to run it is this method:</p>\n\n<pre><code> sub generate_pillars_shape{\n    my $d=$_[4];\n    @X_values=$_[0]/$d..$_[1]/$d;\n    @X_values=map{$_*$d} @X_values;\n    @Y_values=$_[2]/$d..$_[3]/$d;\n    @Y_values=map{$_*$d} @Y_values;\n    for $i (0..$#X_values){\n    @Y=(@Y,@Y_values);\n    for $j (0..$#Y_values){\n        $X[$i*($#Y_values+1)+$j]= $X_values[$i];\n    }\n    }\n    return (\\@X,\\@Y);\n}\n</code></pre>\n\n<p>The entire code consists of this:</p>\n\n<pre><code>use 5.010;\nuse Math::Trig ':radial';\nuse Math::Trig;\nuse List::Util qw(max min);\n\nmy $min_X=0;\nmy $max_X=60;\nmy $min_Y=0;\nmy $max_Y=60;\nmy $distance=10;\nmy @X_values;\nmy @Y_values;\nmy $i;\nmy $j;\n\n#The minimum angle from horizontl your printer can make, in degrees\nmy $min_angle= 30;\n\n#Ignore the next line, it is not an input parame\nmy @Z;\nmy ($X_ref,$Y_ref)= generate_pillars_shape($min_X,$max_X,$min_Y,$max_Y,$distance);my @X=@$X_ref;my @Y=@{$Y_ref};\nfor my $i (0..$#X){\n    $Z[$i]=20;#The function that defined the height of each point. This setting wil give you a flat roof. For a more advanced tree, try:\n    #$Z[$i]=-0.01*$X[$i]**2+0.2*$Y[$i]-0.005*$Y[$i]**2+20;\n}\n\n#End of input parameters.\n\nmy $min_radian = deg2rad($min_angle);\nmy $b = tan($min_radian);\n@Z=map{$_/$b} @Z;\n\n\n\nwhile ($#X&gt;0){\n  my ($I,$J)=find_min_dist(\\@X,\\@Y,\\@Z);\n  my ($X_branch,$Y_branch,$Z_branch)=find_branch($X[$I],$Y[$I],$Z[$I],$X[$J],$Y[$J],$Z[$J]);\n  my @X_list= ($X_branch,$X[$I],$X[$J]);\n  my @Y_list= ($Y_branch,$Y[$I],$Y[$J]);\n  my @Z_list= ($Z_branch,$Z[$I],$Z[$J]);\n  for my $j (0..$#Y_list){\n      if (abs($X_list[my $j]) &lt; 0.001){\n      $X_list[$j]=0;\n      }\n      if (abs($Y_list[my $j]) &lt; 0.001){\n      $Y_list[$j]=0;\n      }\n      if (abs($Z_list[my $j]) &lt; 0.001){\n      $Z_list[$J]=0;\n      }\n  }\n  branch (\\@X_list,\\@Y_list,\\@Z_list);\n  splice (@X,$I,1,$X_branch);\n  splice (@X,$J,1);\n  splice (@Y,$I,1,$Y_branch);\n  splice (@Y,$J,1);\n  splice (@Z,$I,1,$Z_branch);\n  splice (@Z,$J,1);\n}\n\nsub generate_pillars_shape{\n    my $d=$_[4];\n    @X_values=$_[0]/$d..$_[1]/$d;\n    @X_values=map{$_*$d} @X_values;\n    @Y_values=$_[2]/$d..$_[3]/$d;\n    @Y_values=map{$_*$d} @Y_values;\n    for $i (0..$#X_values){\n    @Y=(@Y,@Y_values);\n    for $j (0..$#Y_values){\n        $X[$i*($#Y_values+1)+$j]= $X_values[$i];\n    }\n    }\n    return (\\@X,\\@Y);\n}\n\nsub branch{\n  my @X=@{ $_[0] };\n  my @Y=@{ $_[1] };\n  my @Z=@{ $_[2] };\n  @Z=map{$_*$b}@Z;\n  for my $i (1..$#X){\n    my ($rho, $theta, $phi) = cartesian_to_spherical($X[$i]-$X[0],$Y[$i]-$Y[0],$Z[$i]-$Z[0]);\n    $phi = rad2deg($phi);\n    if (abs($phi)&lt;0.001){$phi=0;}\n    $theta = rad2deg($theta)+90;\n    if (abs($theta)&lt;0.001){$theta=0;}\n    if (abs($rho)&gt;0.001){}\n  }\n}\n\nsub find_min_dist{\n  my @X=@{ $_[0] };\n  my @Y=@{ $_[1] };\n  my @Z=@{ $_[2] };\n  my $min_dist=($X[0]-$X[1])**2+($Y[0]-$Y[1])**2+($Z[0]-$Z[1])**2;\n  my $max_Z=$Z[0];\n  my $I=0;\n  my $J=1;\n  for my $i (1..$#Z){\n      if ($Z[$i]&gt;=$max_Z){\n      $max_Z=$Z[$i];\n      my $I=$i;}\n  }\n  for my $j (0..$#X){\n    if ($j!=$I){\n      my $dist=(($X[$I]-$X[$j])**2+($Y[$I]-$Y[$j])**2+($Z[$I]-$Z[$j])**2);\n      if ($min_dist&gt;$dist){\n    $min_dist=$dist;\n    my $J=$j;\n      }}}\n  return ($I,$J);\n}\n\nsub find_branch{\n  my $X1=$_[0];\n  my $Y1=$_[1];\n  my $Z1=$_[2];\n  my $X2=$_[3];\n  my $Y2=$_[4];\n  my $Z2=$_[5];\n  my $rXY=sqrt(($X1-$X2)**2+($Y1-$Y2)**2);\n  if (abs($Z1-$Z2) &lt; $rXY) {\n    my $Z_branch=($Z1+$Z2-$rXY)/2;\n    my $a=($Z1-$Z_branch)/$rXY;\n    my $X_branch=(1-$a)*$X1+$a*$X2;\n    my $Y_branch=(1-$a)*$Y1+$a*$Y2;\n  }\n  elsif ($Z1 &lt; $Z2) {\n    my $X_branch=$X1;\n    my $Y_branch=$Y1;\n    my $Z_branch=$Z1;\n  }\n  else {\n    my $X_branch=$X2;\n    my $Y_branch=$Y2;\n    my $Z_branch=$Z2;\n  }\n  return my($X_branch,$Y_branch,$Z_branch);\n}\n</code></pre>\n\n<p>I hope that explains the general situation, any help would be appreciated. Thanks.</p>\n"}, {"tags": ["perl", "unix", "awk", "nawk"], "comments": [{"owner": {"reputation": 8410, "user_id": 202553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Clpiv.jpg?s=128&g=1", "display_name": "knb", "link": "https://stackoverflow.com/users/202553/knb"}, "edited": false, "score": 0, "creation_date": 1553089170, "post_id": 55236637, "comment_id": 97255511, "body": "check the <code>comm</code> binary, a standard unix command line tool <code>comm --help</code>"}, {"owner": {"reputation": 1, "user_id": 11224892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t4dJWtCFUDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrc51rIq71QQ2s5fj3oh_jya3_Yg/mo/photo.jpg?sz=128", "display_name": "Aru", "link": "https://stackoverflow.com/users/11224892/aru"}, "reply_to_user": {"reputation": 8410, "user_id": 202553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Clpiv.jpg?s=128&g=1", "display_name": "knb", "link": "https://stackoverflow.com/users/202553/knb"}, "edited": false, "score": 0, "creation_date": 1553244360, "post_id": 55236637, "comment_id": 97319903, "body": "comm will give unmatched records agreed but wont highlight the differences are in which column"}, {"owner": {"reputation": 8410, "user_id": 202553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Clpiv.jpg?s=128&g=1", "display_name": "knb", "link": "https://stackoverflow.com/users/202553/knb"}, "edited": false, "score": 0, "creation_date": 1553250507, "post_id": 55236637, "comment_id": 97323496, "body": "you can transform the data into &quot;long format&quot; first, check the R-tidyverse documentation for details."}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "is_accepted": false, "score": 0, "last_activity_date": 1553461291, "last_edit_date": 1553461291, "creation_date": 1553455468, "answer_id": 55327631, "question_id": 55236637, "link": "https://stackoverflow.com/questions/55236637/unix-compare-2-files-based-on-primary-column/55327631#55327631", "title": "UNIX - Compare 2 files based on primary column", "body": "<p>If the files comfortably fit in memory, it's quite easy to do with hashes in Perl. For example:</p>\n\n<pre><code>#!/bin/bash\n\n# create test data files\n&gt;cmp.d1 cat &lt;&lt;'EOD'\nabc 234 123\nbcd 567 890\ncde 678 789\nEOD\n&gt;cmp.d2 cat &lt;&lt;'EOD'\nabc 234 012\nbcd 532 890\ncdf 678 789\nEOD\n\n# create script\n&gt;dif.pl cat &lt;&lt;'EOD'\n#!/usr/bin/perl -w\n\nif ( $#ARGV!=0 or ! -f \"$ARGV[0]\" ) {\n    die \"Usage: &lt;file2 filter file1\\n\";\n}\n\n@KEYS = ( 0 ); # list of columns to use for primary key\n\n# read file1 from filename given on commandline\nwhile (&lt;&lt;&gt;&gt;) {\n    chomp;\n    @a1 = (split); # split line into individual fields\n    $k = join \"\\0\", @a1[ @KEYS ];\n\n    # if $k is not unique, only final line is kept\n    warn \"duplicate key: $k\\n\" if exists $h1{$k};\n\n    # store line in %h1 for later use\n    $h1{$k} = [ @a1 ];\n}\n\n# now read file2 from stdin\n# process each line as we read it\nwhile (&lt;&lt;&gt;&gt;) {\n    chomp;\n    @a2 = (split); # split line into individual fields\n    $k = join \"\\0\", @a2[ @KEYS ];\n\n    if ( exists $h1{$k} ) {\n        # record exists in both files\n        # calculate differences \n\n        @a1 = @{ $h1{$k} }; # retrieve file1 version\n\n        # overwrite any difference fields in @a2\n        map {\n            $a1 = shift @a1;\n            $_ = \"${a1}::$_\" if $a1 ne $_;\n        } @a2;\n\n        # save difference records in %hd\n        $hd{$k} = [ @a2 ];\n\n        # this will not be an extra file1 record\n        delete $h1{$k};\n    }\n    else {\n        # this record only exists in file2\n        $h2{$k} = [ @a2 ];\n    }\n}\n\n# format record as csv line\nsub print_csv {\n    print join(\",\", @{ $_ }), \"\\n\";\n}\n\nprint \"differences file :\\n\";\nprint_csv for values %hd;\nprint \"\\n\";\n\nprint \"extra records in file1 :\\n\";\nprint_csv for values %h1;\nprint \"\\n\";\n\nprint \"extra records in file2\\n\";\nprint_csv for values %h2;\n\nEOD\n\n# try it out\nperl dif.pl cmp.d1 &lt;cmp.d2\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>differences file :\nbcd,567::532,890\nabc,234,123::012\n\nextra records in file1 :\ncde,678,789\n\nextra records in file2\ncdf,678,789\n</code></pre>\n\n<hr>\n\n<p><strong>Note:</strong> csv output doesn't normally need to be ordered, so this code doesn't do any sorting.</p>\n"}, {"tags": [], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "is_accepted": false, "score": 0, "last_activity_date": 1553521216, "creation_date": 1553521216, "answer_id": 55339153, "question_id": 55236637, "link": "https://stackoverflow.com/questions/55236637/unix-compare-2-files-based-on-primary-column/55339153#55339153", "title": "UNIX - Compare 2 files based on primary column", "body": "<p>Try this command line Perl</p>\n\n<pre><code>perl -lane ' @t=@{$kv1{$F[0]}}; push(@t,$_); $kv1{$F[0]} = [@t];\nif( defined($kv2{$F[0]}) ) {  $kv2{$F[0]} = \"Both\" } else { $kv2{$F[0]} =$ARGV; $kv3{$F[0]}=$_; }\nEND { \n\n for my $c (keys %kv2) \n { \n   if($kv2{$c} eq \"Both\") { $d1++ or print \"differences file :\";  \n\n   @t=@{$kv1{$c}}; @s1=split(\" \",$t[0]); @s2=split(\" \",$t[1]);\n   $a2= $s1[1] eq $s2[1] ? $s1[1] : $s1[1]. \"::\". $s2[1];\n   $a3= $s1[2] eq $s2[2] ? $s1[2] : $s1[2]. \"::\". $s2[2];\n   print $s1[0],\",\",$a2,\",\",$a3;\n\n   }\n }\n\n for my $c (keys %kv2) \n { \n   if($kv2{$c} eq \"file1\") { $d2++ or print \"\\nextra records in file1 :\";  print $kv3{$c} }\n }\n\n for my $c (keys %kv2) \n { \n   if($kv2{$c} eq \"file2\") { $d3++ or print \"\\nextra records in file2 :\";  print $kv3{$c} }\n }\n\n}\n' file1 file2\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>differences file :\nbcd,567::532,890\nabc,234,123::012\n\nextra records in file1 :\ncde 678 789\n\nextra records in file2 :\ncdf 678 789\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11224892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-t4dJWtCFUDQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfrc51rIq71QQ2s5fj3oh_jya3_Yg/mo/photo.jpg?sz=128", "display_name": "Aru", "link": "https://stackoverflow.com/users/11224892/aru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1553521216, "creation_date": 1552984830, "last_edit_date": 1553078707, "question_id": 55236637, "link": "https://stackoverflow.com/questions/55236637/unix-compare-2-files-based-on-primary-column", "title": "UNIX - Compare 2 files based on primary column", "body": "<p>I need to compare 2 files columnwise based on primary columns(it could be 1 or multiple columns as a primate key). And it should generate 3 csv files as output -  differences , extra records in file1, extra records in file2</p>\n\n<p>Note : tried with <code>sdiff</code> but it doesnt give output as desired</p>\n\n<p>Example :</p>\n\n<p>Here first column is a primary key</p>\n\n<pre><code>file1 :\nabc 234 123\nbcd 567 890\ncde 678 789\n\nfile2 :\nabc 234 012\nbcd 532 890\ncdf 678 789\n\nOutput files\n\ndifferences file :\nabc,234,123::012\nbcd,567::532,890\n\nextra records in file1 :\ncde,678,789\n\nextra records in file2\ncdf,678,789   \n</code></pre>\n"}, {"tags": ["sql", "sql-server", "perl"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3770080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6eafaf2fc8cb9500775609747dd3f9?s=128&d=identicon&r=PG&f=1", "display_name": "jit", "link": "https://stackoverflow.com/users/3770080/jit"}, "edited": false, "score": 0, "creation_date": 1552985490, "post_id": 55236296, "comment_id": 97206829, "body": "checked all this points all are correct in data base. still getting same issue."}, {"owner": {"reputation": 4931, "user_id": 5021687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vqtsd-tYBo4/AAAAAAAAAAI/AAAAAAAADyc/_HNZtCokCCM/photo.jpg?sz=128", "display_name": "Alexander Volok", "link": "https://stackoverflow.com/users/5021687/alexander-volok"}, "reply_to_user": {"reputation": 35, "user_id": 3770080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6eafaf2fc8cb9500775609747dd3f9?s=128&d=identicon&r=PG&f=1", "display_name": "jit", "link": "https://stackoverflow.com/users/3770080/jit"}, "edited": false, "score": 0, "creation_date": 1552986879, "post_id": 55236296, "comment_id": 97207616, "body": "@jit, and you can log in to that server using SSMS and exactly the same credentials?"}, {"owner": {"reputation": 35, "user_id": 3770080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6eafaf2fc8cb9500775609747dd3f9?s=128&d=identicon&r=PG&f=1", "display_name": "jit", "link": "https://stackoverflow.com/users/3770080/jit"}, "edited": false, "score": 0, "creation_date": 1552992752, "post_id": 55236296, "comment_id": 97211203, "body": "and   yes i can login through SSMS by using credentials which i have. but when i run through perl script it failed"}, {"owner": {"reputation": 4931, "user_id": 5021687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vqtsd-tYBo4/AAAAAAAAAAI/AAAAAAAADyc/_HNZtCokCCM/photo.jpg?sz=128", "display_name": "Alexander Volok", "link": "https://stackoverflow.com/users/5021687/alexander-volok"}, "reply_to_user": {"reputation": 35, "user_id": 3770080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6eafaf2fc8cb9500775609747dd3f9?s=128&d=identicon&r=PG&f=1", "display_name": "jit", "link": "https://stackoverflow.com/users/3770080/jit"}, "edited": false, "score": 0, "creation_date": 1552993569, "post_id": 55236296, "comment_id": 97211683, "body": "then the problem is in password and seems it it is becasue of  character &quot;@&quot;. I&#39;ve updated the answer"}], "tags": [], "owner": {"reputation": 4931, "user_id": 5021687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vqtsd-tYBo4/AAAAAAAAAAI/AAAAAAAADyc/_HNZtCokCCM/photo.jpg?sz=128", "display_name": "Alexander Volok", "link": "https://stackoverflow.com/users/5021687/alexander-volok"}, "is_accepted": true, "score": 4, "last_activity_date": 1552993518, "last_edit_date": 1552993518, "creation_date": 1552983491, "answer_id": 55236296, "question_id": 55235554, "link": "https://stackoverflow.com/questions/55235554/sqlcmd-error-microsoft-odbc-driver-11-for-sql-server-login-failed-for-user/55236296#55236296", "title": "Sqlcmd: Error: Microsoft ODBC Driver 11 for SQL Server : Login failed for user &#39;sa&#39;", "body": "<p>There are can be three reasons:</p>\n\n<ol>\n<li>SQL Server (or mixed) authentication is disabled</li>\n<li>The password used in the command is wrong</li>\n<li>The database <code>[JSONdb]</code> is not available</li>\n</ol>\n\n<p>Another reason can be related to special characters escaping. Your password contains <kbd>@</kbd>, therefore this argument is to be also adjusted:</p>\n\n<pre><code> -P test@123 =&gt;  -P test\\@123\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3770080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6eafaf2fc8cb9500775609747dd3f9?s=128&d=identicon&r=PG&f=1", "display_name": "jit", "link": "https://stackoverflow.com/users/3770080/jit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6812, "favorite_count": 0, "accepted_answer_id": 55236296, "answer_count": 1, "score": 3, "last_activity_date": 1552993518, "creation_date": 1552980256, "last_edit_date": 1552982633, "question_id": 55235554, "link": "https://stackoverflow.com/questions/55235554/sqlcmd-error-microsoft-odbc-driver-11-for-sql-server-login-failed-for-user", "title": "Sqlcmd: Error: Microsoft ODBC Driver 11 for SQL Server : Login failed for user &#39;sa&#39;", "body": "<p>I am trying to execute one stored procedure using 'sa' user through perl script</p>\n\n<p>save this line in a perl file and execute that perl file</p>\n\n<pre><code>system(\"start /wait sqlcmd.exe -S serverName -U sa -P test@123 -d JSONdb -Q \\\"EXECUTE UPDATE_SP\\\" -o C:\\\\Temp\\\\log.txt\");\n</code></pre>\n\n<p>=============================================================================</p>\n\n<blockquote>\n  <p>-S serverName :: sql server which i want to connect.</p>\n  \n  <p>-U sa -P test@123 :: login user credentials</p>\n  \n  <p>-d JSONdb :: database name.</p>\n  \n  <p>\\\"EXECUTE update_JSONTable\\\" :: command to execute stored procedure\n  [update_JSONTable]</p>\n  \n  <p>-o C:\\Temp\\log.txt\" :: saving  logs</p>\n</blockquote>\n"}, {"tags": ["mysql", "perl", "zlib"], "comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552978308, "post_id": 55234441, "comment_id": 97203574, "body": "Maybe you have multiple installations of Perl or <code>Compress::Raw::Zlib</code> and your test code and the application use different versions? BTW: C <code>NULL</code> is usually defined as <code>(void *) 0</code>, i.e. passing a <code>0</code> as pointer parameter to a C API would be equivalent to <code>NULL</code>."}, {"owner": {"reputation": 31, "user_id": 11224205, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1ryxScEVZM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIWCwqrQ1ZA3Or87iuom3MDnyuZQ/mo/photo.jpg?sz=128", "display_name": "Garri Djavadyan", "link": "https://stackoverflow.com/users/11224205/garri-djavadyan"}, "reply_to_user": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552979019, "post_id": 55234441, "comment_id": 97203824, "body": "No, I don&#39;t. I use minimal CentOS environment with system-provided Perl 5.16.  <code># grep -FRIn &#39;package Compress::Raw::Zlib&#39; &#47;usr&#47;   &#47;usr&#47;lib64&#47;perl5&#47;vendor_perl&#47;Compress&#47;Raw&#47;Zlib.pm:2:package Compress::Raw::Zlib;    # rpm -qa | grep -i zlib   perl-Compress-Raw-Zlib-2.061-4.el7.x86_64 zlib-1.2.7-18.el7.x86_64</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11224205, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1ryxScEVZM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIWCwqrQ1ZA3Or87iuom3MDnyuZQ/mo/photo.jpg?sz=128", "display_name": "Garri Djavadyan", "link": "https://stackoverflow.com/users/11224205/garri-djavadyan"}, "is_accepted": false, "score": 1, "last_activity_date": 1553274687, "creation_date": 1553274687, "answer_id": 55304668, "question_id": 55234441, "link": "https://stackoverflow.com/questions/55234441/stream-error-while-trying-to-initialize-deflate-object-in-compressrawzlib/55304668#55304668", "title": "Stream error, while trying to initialize deflate object in Compress::Raw::Zlib::_deflateInit", "body": "<p>Well, after several days of debugging it became evident that the core issue is in <code>libmysqlclient.so</code> library, supplied by MySQL community server. The library is statically linked against <code>zlib</code> and it exports all <code>zlib</code> symbols globally. As a result, any binary with loaded <code>zlib.so</code> and <code>libmysqlclient.so</code> at the same time would have a chance to call a <code>zlib</code> function from <code>libmysqlclient.so</code>, rather than from <code>zlib.so</code>.</p>\n\n<p>The related <a href=\"https://bugs.mysql.com/bug.php?id=94725\" rel=\"nofollow noreferrer\">bug report</a> has been opened and approved now (unfortunately, as a feature request).</p>\n\n<p>As I workaround I switched to MariaDB 10.2 from Red Hat Software Collections.</p>\n"}], "owner": {"reputation": 31, "user_id": 11224205, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1ryxScEVZM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIWCwqrQ1ZA3Or87iuom3MDnyuZQ/mo/photo.jpg?sz=128", "display_name": "Garri Djavadyan", "link": "https://stackoverflow.com/users/11224205/garri-djavadyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1553274687, "creation_date": 1552974698, "last_edit_date": 1553106207, "question_id": 55234441, "link": "https://stackoverflow.com/questions/55234441/stream-error-while-trying-to-initialize-deflate-object-in-compressrawzlib", "title": "Stream error, while trying to initialize deflate object in Compress::Raw::Zlib::_deflateInit", "body": "<p>I have faced a strange issue in an application using <code>PDF::API2</code> Perl module on CentOS 7 system (perl-5.16). Whenever it tries to use <code>openpage()</code> function it gets:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Can't call method \"inflate\" on an undefined value at /usr/share/perl5/vendor_perl/PDF/API2/Basic/PDF/Filter/FlateDecode.pm line 49.\n</code></pre>\n\n<p>I tried to reproduce the issue using simple calls to <code>PDF::API2</code>, but couldn't trigger the error:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse PDF::API2;\n\nprint \"Content-Type: application/pdf\\n\\n\";\n\nmy $pdf = PDF::API2-&gt;open('/tmp/test.pdf');\n\nmy $page = $pdf-&gt;openpage(1);\n\nprint $pdf-&gt;stringify();\n</code></pre>\n\n<p>Next, I used the application's own high-level call in my simple script and I was able to trigger the issue. Well, I decided to use Perl debugger to find any differences and ended up in Zlib's <code>deflateInit</code> subroutine (<code>/usr/share/perl5/Compress/Zlib.pm</code>), especially in <code>Compress::Raw::Zlib::_deflateInit</code>:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my $obj ;\n\nmy $status = 0 ;\n($obj, $status) = \n  Compress::Raw::Zlib::_deflateInit(0,\n            $got-&gt;getValue('level'), \n            $got-&gt;getValue('method'), \n            $got-&gt;getValue('windowbits'), \n            $got-&gt;getValue('memlevel'), \n            $got-&gt;getValue('strategy'), \n            $got-&gt;getValue('bufsize'),\n            $got-&gt;getValue('dictionary')) ;\n\nmy $x = ($status == Z_OK() ? bless $obj, \"Zlib::OldDeflate\"  : undef) ;\n</code></pre>\n\n<p>As I understand, it is a low-level call to zlib C library. Here I found that the object is not created because of 'stream error' <code>$status</code>, when I use the high-level calls of the application. Although, the arguments passed (level, method and so on) are absolutely the same in both cases. I couldn't use Perl debugger any further inside <code>Compress::Raw::Zlib::_deflateInit</code>, so it is a black box for me now.</p>\n\n<p>I firmly believe that the application changes some aspects of Perl's behavior, but I couldn't find any. I found out that 'stream error' is returned when the first argument is <code>NULL</code> (in C context) or invalid value for level is passed. I am sure the level is correct and is actually the same in both cases (successful and failed). Next, I thought about the first argument, which is zero (<code>0</code>).</p>\n\n<p>Is it possible that the application changes something in Perl so it treats passed <code>0</code> (zero) argument differently? How can I debug the issue further inside <code>Compress::Raw::Zlib::_deflateInit</code>?</p>\n\n<p>UPDATE:  </p>\n\n<p>I went on debugging C code called by <code>Compress::Raw::Zlib::_deflateInit</code> using <code>gdb</code> and found that <code>/usr/lib64/perl5/vendor_perl/auto/Compress/Raw/Zlib/Zlib.so</code> calls <code>deflateReset</code> function from <code>/usr/lib64/mysql/libmysqlclient.so.18.1.0</code> library instead of <code>/usr/lib64/libz.so.1.2.7</code>.</p>\n\n<p>Now it is clear why my test code could not trigger the error, it does not use MySQL functions. However, code in the application use a lot of MySQL calls before <code>PDF::API2</code> functions.</p>\n\n<p>I use MySQL community server installed from official repository:</p>\n\n<pre><code>$ rpm -qa | grep mysql\nmysql-community-libs-5.6.43-2.el7.x86_64\nmysql-community-server-5.6.43-2.el7.x86_64\nmysql80-community-release-el7-2.noarch\nmysql-community-common-5.6.43-2.el7.x86_64\nmysql-community-client-5.6.43-2.el7.x86_64\n</code></pre>\n\n<p>Now I have got new questions. Did MySQL community incorrectly bundle <code>Zlib</code> code into <code>libmysqlclient.so</code>? What can I do as a systems administrator to solve the problem? Thanks.</p>\n"}, {"tags": ["python", "regex", "perl", "nlp", "moses"], "comments": [{"owner": {"reputation": 589595, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1552969689, "post_id": 55233624, "comment_id": 97200979, "body": "<code>sed</code> doesn&#39;t understand <code>\\d</code>, and it uses <code>\\(...\\)</code> for grouping. Also, you should put the argument in single quotes, because <code>$1</code> and <code>$2</code> are shell variables."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 2, "creation_date": 1552969720, "post_id": 55233624, "comment_id": 97200992, "body": "It doesn&#39;t do what you say. Perl does replace a space with a dot. Demo: <a href=\"https://ideone.com/iWxTub\" rel=\"nofollow noreferrer\">ideone.com/iWxTub</a>"}, {"owner": {"reputation": 93695, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "edited": false, "score": 0, "creation_date": 1552970097, "post_id": 55233624, "comment_id": 97201095, "body": "tripleee barmar zhim Thanks for catching the mistakes in the comments!"}, {"owner": {"reputation": 93695, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552971141, "post_id": 55233624, "comment_id": 97201362, "body": "@zdim, yes but the original perl script didnt seem to budge."}, {"owner": {"reputation": 481636, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1552985108, "post_id": 55233624, "comment_id": 97206618, "body": "Why use <code>&#39;\\g&lt;1&gt;.\\g&lt;2&gt;&#39;</code>? Use <code>r&#39;\\1.\\2&#39;</code>. However, to match any whitespace, you need <code>\\s</code>. And if you have consecutive numbers, you must use a lookahead: <code>re.sub(r&#39;(\\d)\\s(?=\\d)&#39;, r&#39;\\1.\\2&#39;, &#39;123 45&#39;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 93695, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "edited": false, "score": 0, "creation_date": 1552972247, "post_id": 55233871, "comment_id": 97201636, "body": "LOL, non-breaking space! Thanks Fedor for catching that!"}], "tags": [], "owner": {"reputation": 431, "user_id": 7181429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9EyX1.jpg?s=128&g=1", "display_name": "Fedor Dikarev", "link": "https://stackoverflow.com/users/7181429/fedor-dikarev"}, "is_accepted": true, "score": 3, "last_activity_date": 1552971193, "creation_date": 1552971193, "answer_id": 55233871, "question_id": 55233624, "link": "https://stackoverflow.com/questions/55233624/difference-between-perl-regex-to-add-dots-between-two-numbers-in-moses/55233871#55233871", "title": "Difference between perl regex to add dots between two numbers in Moses", "body": "<p>The reason why this code from moose doesn't work is because it search for non-breaking space, not just space. It is not easy to see, but <code>hexdump</code> could help you with that:</p>\n\n<pre><code>fe-laptop-p:moose fe$ head -n87 normalize-punctuation.perl | tail -n1 | hexdump -C\n00000000  09 73 2f 28 5c 64 29 c2  a0 28 5c 64 29 2f 24 31  |.s/(\\d)..(\\d)/$1|\n00000010  2e 24 32 2f 67 3b 0a                              |.$2/g;.|\n00000017\nfe-laptop-p:moose fe$ head -n87 normalize-punctuation.perl.with_space | tail -n1 | hexdump -C\n00000000  09 73 2f 28 5c 64 29 20  28 5c 64 29 2f 24 31 2e  |.s/(\\d) (\\d)/$1.|\n00000010  24 32 2f 67 3b 0a                                 |$2/g;.|\n00000016\n</code></pre>\n\n<p>See the difference: <code>c2 a0</code> vs <code>20</code>?</p>\n\n<p>p.s.\nas for comments about adding plus sign to regex: it is not needed here, as it is enough to put dot sign between two adjacent digits and no need to find full numbers</p>\n"}], "owner": {"reputation": 93695, "user_id": 610569, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0e9087f2672b0e4f28d91266acf9ce57?s=128&d=identicon&r=PG", "display_name": "alvas", "link": "https://stackoverflow.com/users/610569/alvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 55233871, "answer_count": 1, "score": -1, "last_activity_date": 1552971193, "creation_date": 1552969404, "last_edit_date": 1552970906, "question_id": 55233624, "link": "https://stackoverflow.com/questions/55233624/difference-between-perl-regex-to-add-dots-between-two-numbers-in-moses", "title": "Difference between perl regex to add dots between two numbers in Moses", "body": "<p>Context, I'm trying to port a Perl code into Python from <a href=\"https://github.com/moses-smt/mosesdecoder/blob/master/scripts/tokenizer/normalize-punctuation.perl#L87\" rel=\"nofollow noreferrer\">https://github.com/moses-smt/mosesdecoder/blob/master/scripts/tokenizer/normalize-punctuation.perl#L87</a> and there is this regex here in Perl:</p>\n\n<pre><code>s/(\\d) (\\d)/$1.$2/g;\n</code></pre>\n\n<p>If I try it with the Perl script given the input text <code>123 45</code>, it returns the same string with a dot. As a sanity check, I've tried on the command line too:</p>\n\n<pre><code>echo \"123 45\" | perl -pe 's/(\\d) (\\d)/$1.$2/g;' \n</code></pre>\n\n<p>[out]:</p>\n\n<pre><code>123.45\n</code></pre>\n\n<p>And it does so too when I convert the regex to Python, </p>\n\n<pre><code>&gt;&gt;&gt; import re\n&gt;&gt;&gt; r, s = r'(\\d) (\\d)', '\\g&lt;1&gt;.\\g&lt;2&gt;'\n&gt;&gt;&gt; print(re.sub(r, s, '123 45'))\n123.45\n</code></pre>\n\n<p>But when I use the Moses script:</p>\n\n<pre><code>$ wget https://raw.githubusercontent.com/moses-smt/mosesdecoder/master/scripts/tokenizer/normalize-punctuation.perl\n--2019-03-19 12:33:09--  https://raw.githubusercontent.com/moses-smt/mosesdecoder/master/scripts/tokenizer/normalize-punctuation.perl\nResolving raw.githubusercontent.com... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 905 [text/plain]\nSaving to: 'normalize-punctuation.perl'\n\nnormalize-punctuation.perl    100%[================================================&gt;]     905  --.-KB/s    in 0s      \n\n2019-03-19 12:33:09 (8.72 MB/s) - 'normalize-punctuation.perl' saved [1912]\n\n$ echo \"123 45\" &gt; foobar\n\n$ perl normalize-punctuation.perl &lt; foobar\n123 45\n</code></pre>\n\n<p>Even when we try to print the string before and after the regex in the <a href=\"https://github.com/moses-smt/mosesdecoder/blob/master/scripts/tokenizer/normalize-punctuation.perl#L87\" rel=\"nofollow noreferrer\">Moses code</a>, i.e. </p>\n\n<pre><code>if ($language eq \"de\" || $language eq \"es\" || $language eq \"cz\" || $language eq \"cs\" || $language eq \"fr\") {\n    s/(\\d) (\\d)/$1,$2/g;\n    }\nelse {\n    print $_;\n    s/(\\d) (\\d)/$1.$2/g;\n    print $_;\n    }\n</code></pre>\n\n<p>[out]:</p>\n\n<pre><code>123 45\n123 45\n123 45\n</code></pre>\n\n<p>We see that before and after the regex, there's no change in the string.</p>\n\n<p>My question in parts are:</p>\n\n<ul>\n<li>Is the Python <code>\\g&lt;1&gt;.\\g&lt;2&gt;</code> regex equivalent to the Perl's <code>$1.$2</code>?</li>\n<li>Why is it that the Perl regex didn't add the full stop <code>.</code> between the two digit groups in Moses? </li>\n<li>How to replicate Perl's behavior in Moses in Python regex?</li>\n<li>How to replicate Python's behavior in Perl regex in Moses?</li>\n</ul>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 655, "user_id": 9345938, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XVV2JO7Xl1M/AAAAAAAAAAI/AAAAAAAAFus/a44EGq2HBC0/photo.jpg?sz=128", "display_name": "Aureliano Guedes", "link": "https://stackoverflow.com/users/9345938/aureliano-guedes"}, "edited": false, "score": 0, "creation_date": 1552955761, "post_id": 55232001, "comment_id": 97198235, "body": "Are you using any module?? This is your complete code (include libraries you might using)?? Just with this peace of code seams you are trying to use <code>map</code> in a empty array. If <code>@Z</code> is defined, where, when and how you define <code>@Z</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1552959727, "post_id": 55232047, "comment_id": 97199032, "body": "<code>atan</code> is missing too, but <code>atan2</code> is present. Perl is strange sometimes."}], "tags": [], "owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "is_accepted": true, "score": 3, "last_activity_date": 1552955832, "creation_date": 1552955832, "answer_id": 55232047, "question_id": 55232001, "link": "https://stackoverflow.com/questions/55232001/perl-undefined-subroutine-for-tan/55232047#55232047", "title": "Perl - Undefined subroutine for tan", "body": "<p><code>sin</code> and <code>cos</code> are <a href=\"https://metacpan.org/pod/perlfunc#Numeric-functions\" rel=\"nofollow noreferrer\">builtin Perl functions</a>, but <code>tan</code> is not. This is easily remedied with a simple declaration</p>\n\n<pre><code>sub tan { sin($_[0]) / cos($_[0]) }\n</code></pre>\n\n<p>or import a module that defines the tangent function</p>\n\n<pre><code>use Math::Trig;\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55232047, "answer_count": 1, "score": 0, "last_activity_date": 1552955832, "creation_date": 1552955471, "question_id": 55232001, "link": "https://stackoverflow.com/questions/55232001/perl-undefined-subroutine-for-tan", "title": "Perl - Undefined subroutine for tan", "body": "<p>Having an issue since don't understand why it's not working for tan, but is fine to work for cos and sin. I would assume the issue is that it's undefined, hence the error message but why exactly does cos and sin work and not tan? How would I then define a tan method? Sorry for the newbie question, I'm just trying to work out Perl.</p>\n\n<p>Error:</p>\n\n<pre><code>Undefined subroutine &amp;Slic3r::Print::SupportMaterial::tan called at C:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 945.\n</code></pre>\n\n<p>Tan Code:</p>\n\n<pre><code>my $min_angle = 40;\nmy $min_radian = deg2rad($min_angle);\nmy $b = tan($min_radian);\n@Z=map{$_/$b} @Z;\n</code></pre>\n\n<p>Cos and Sin Code:</p>\n\n<pre><code>Polygon-&gt;new(map [ $circle_radius * cos $_, $circle_radius * sin $_ ]\n</code></pre>\n\n<p>Edit: Realised that a subroutine would need a function, however when looking at the Perl script I'm trying to integrate with the module, it works fine and doesn't have a method, just declared tan. </p>\n"}, {"tags": ["regex", "string", "perl", "search", "pos"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1552943452, "post_id": 55229728, "comment_id": 97194633, "body": "<code>&lt;label, someoption=true&gt;</code> The comma in here after the tag, makes this invalid html. It would be better if the tags were valid html, otherwise you have to explain a crap load of stuff to match this. Sort of like going down the rabbit hole. Without the comma, you could do this <code>&lt;([\\w:]+)(?=(?:[^&gt;&quot;&#39;]|&quot;[^&quot;]*&quot;|&#39;[^&#39;]*&#39;)*?\\ssomeoption=false)\\&zwnj;&#8203;s+(?:&quot;[\\S\\s]*?&quot;|&#39;[\\S&zwnj;&#8203;\\s]*?&#39;|[^&gt;]*?)+&gt;</code> and get <i>label</i> tag to be used in the closure part <code>[\\S\\s]*?&lt;&#47;\\1\\s*.</code>"}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 1, "creation_date": 1552943540, "post_id": 55229728, "comment_id": 97194665, "body": "What have you tried? Please tell us what issues you are having."}], "answers": [{"comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 1, "creation_date": 1552943584, "post_id": 55229995, "comment_id": 97194675, "body": "This answer basically says &quot;To remove some lines, just remove those lines&quot;. I fail to see how this is helpful."}, {"owner": {"reputation": 34, "user_id": 3024022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a7b5eceab3617c4e66d29900a10e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul M.", "link": "https://stackoverflow.com/users/3024022/paul-m"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1552944492, "post_id": 55229995, "comment_id": 97194988, "body": "Nonsense.  It&#39;s a description the algorithm required to get the job done.  If I&#39;d posted a code sample, would you have the same complaint?"}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 1, "creation_date": 1552952378, "post_id": 55229995, "comment_id": 97197477, "body": "As Stack Overflow is not a code writing service, this answer seems sufficient given the information provided."}, {"owner": {"reputation": 63, "user_id": 3349234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3affa5ab9d624fd8fb5adf13aaab6054?s=128&d=identicon&r=PG&f=1", "display_name": "metaditch", "link": "https://stackoverflow.com/users/3349234/metaditch"}, "edited": false, "score": 0, "creation_date": 1553097306, "post_id": 55229995, "comment_id": 97261469, "body": "I like this one a lot actually. It&#39;s a better than the general approach I was taking (indexing and printing based on combined locations of someoption=true and /label)."}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1553165247, "post_id": 55229995, "comment_id": 97287160, "body": "@PaulM. Allright, seems that while this answer sounded very obvious an unhelpful to me, it was actually useful to the OP. If you edit it, I&#39;ll remove my downvote (no need to change anything, just edit it: a downvote can be undone unless the answer is edited). Sorry about that, seems like you were right :)"}], "tags": [], "owner": {"reputation": 34, "user_id": 3024022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a7b5eceab3617c4e66d29900a10e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul M.", "link": "https://stackoverflow.com/users/3024022/paul-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1552942910, "creation_date": 1552942910, "answer_id": 55229995, "question_id": 55229728, "link": "https://stackoverflow.com/questions/55229728/using-perl-to-remove-sections-based-on-a-string-search/55229995#55229995", "title": "Using Perl to remove sections based on a string search?", "body": "<p>Loop over the input, one line at a time.  If the current line matches <code>&lt;label, someoption=true&gt;</code>, skip it and every line up to and including the next line that contains <code>&lt;/label&gt;</code>.  Otherwise, print it and every line up to and including the next line that contains <code>&lt;/label&gt;</code>.  Or you could get fancy and use one of the many XML processing Perl modules, but that doesn't appear necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 2349, "user_id": 6794384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153707640356246/picture?type=large", "display_name": "drclaw", "link": "https://stackoverflow.com/users/6794384/drclaw"}, "edited": false, "score": 1, "creation_date": 1552946345, "post_id": 55230571, "comment_id": 97195628, "body": "or using good  old sed for a one liner to do the same <code>sed -ne &#39;&#47;&lt;label, someoption=false&#47;, &#47;&lt;\\&#47;label&gt;&#47;p&#39; &lt; intput.txt</code>"}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 3, "creation_date": 1552947581, "post_id": 55230571, "comment_id": 97196077, "body": "Or if you want to stick with Perl, your one-liner is <code>perl -ne &#39;print unless &#47;&lt;label, someoption=true&#47; .. &#47;&lt;\\&#47;label&gt;&#47;&#39;</code>"}, {"owner": {"reputation": 2349, "user_id": 6794384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153707640356246/picture?type=large", "display_name": "drclaw", "link": "https://stackoverflow.com/users/6794384/drclaw"}, "reply_to_user": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 0, "creation_date": 1552954359, "post_id": 55230571, "comment_id": 97197930, "body": "@Dada that is a much nicer solution"}], "tags": [], "owner": {"reputation": 2349, "user_id": 6794384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153707640356246/picture?type=large", "display_name": "drclaw", "link": "https://stackoverflow.com/users/6794384/drclaw"}, "is_accepted": false, "score": 2, "last_activity_date": 1552947694, "last_edit_date": 1552947694, "creation_date": 1552945987, "answer_id": 55230571, "question_id": 55229728, "link": "https://stackoverflow.com/questions/55229728/using-perl-to-remove-sections-based-on-a-string-search/55230571#55230571", "title": "Using Perl to remove sections based on a string search?", "body": "<p>This will give you the output you demonstrate reading from standard input:</p>\n\n<pre><code>#!/usr/bin/env perl\nuse strict;\nuse warnings;\n\nmy $start=0;\nmy $label=\"label\";  #Set the label text here\nmy $options=\"someoption\"; #Set the option text here\nmy $value=\"false\";  #Set the option value here\nwhile (&lt;&gt;) {\n    if ( /\\Q$label, $options=$value/) {\n        $start=1;\n        print $_;\n        next;\n    }\n    if ($start == 1) {\n        print $_;\n    }\n    if (/\\/$label/) {\n        $start=0;\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1553018462, "post_id": 55237913, "comment_id": 97227407, "body": "@zdim.. I have one question.. how to read a file in binary mode and print each byte in hexadecimal .. in a perl one-liner"}, {"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1553070245, "post_id": 55237913, "comment_id": 97244219, "body": "@zdim.. yep.. cleaned up"}], "tags": [], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "is_accepted": false, "score": 3, "last_activity_date": 1552988828, "creation_date": 1552988828, "answer_id": 55237913, "question_id": 55229728, "link": "https://stackoverflow.com/questions/55229728/using-perl-to-remove-sections-based-on-a-string-search/55237913#55237913", "title": "Using Perl to remove sections based on a string search?", "body": "<p>If the file can fit into memory, you can try command line Perl</p>\n\n<pre><code>perl -0777 -ne ' while( /(&lt;label.+?&lt;\\/label&gt;)/gs ) \n   { $x=$1; print \"$x\\n\" if $x!~/someoption\\s*=\\s*true/ } ' file\n</code></pre>\n\n<p>with your given inputs,</p>\n\n<pre><code>$ cat metaditch.xml\n&lt;label, someoption=true&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;/label&gt;\n&lt;label, someoption=true&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n$ perl -0777 -ne ' while( /(&lt;label.+?&lt;\\/label&gt;)/gs ) \n       { $x=$1; print \"$x\\n\" if $x!~/someoption\\s*=\\s*true/ } ' metaditch.xml\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n$\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3349234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3affa5ab9d624fd8fb5adf13aaab6054?s=128&d=identicon&r=PG&f=1", "display_name": "metaditch", "link": "https://stackoverflow.com/users/3349234/metaditch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1552988828, "creation_date": 1552941703, "question_id": 55229728, "link": "https://stackoverflow.com/questions/55229728/using-perl-to-remove-sections-based-on-a-string-search", "title": "Using Perl to remove sections based on a string search?", "body": "<p>For data sets similar to the following:</p>\n\n<pre><code>&lt;label, someoption=true&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;/label&gt;\n&lt;label, someoption=true&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n</code></pre>\n\n<p>Which variables (1, 2, 3 above) appears is inconsistent. I would like it to get rid of the  sections in which it finds:</p>\n\n<pre><code>someoption=true\n</code></pre>\n\n<p>to return:</p>\n\n<pre><code>&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;/label&gt;\n&lt;label, someoption=false&gt;\n&lt;variable1&gt;\n&lt;variable2&gt;\n&lt;variable3&gt;\n&lt;/label&gt;\n</code></pre>\n\n<p>Please let me know if additional details are helpful. Thanks in advance.</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 0, "creation_date": 1552940895, "post_id": 55229466, "comment_id": 97193558, "body": "If <code>@Z</code> is already declared elsewhere, then why are you using <code>my</code>? On the other hand, if it&#39;s not already declared elsewhere, then why are you trying to pass an undefined variable to <code>map</code>? This is the equivalent of <code>int x = x;</code> in C."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1552952165, "post_id": 55229466, "comment_id": 97197411, "body": "You need to declare variables using <code>my</code> in the scope you want them to exist in visually. <a href=\"https://github.com/mvanwinkleias/perl_tutorials/blob/master/MyOurLocalTutorial.pod\" rel=\"nofollow noreferrer\">This tutorial</a> may be helpful. Your syntax error comes from <code>my $Z[$i]</code> which is an invalid declaration (and you want it declared outside that scope anyway)."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "reply_to_user": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "edited": false, "score": 1, "creation_date": 1552958723, "post_id": 55229466, "comment_id": 97198806, "body": "@MikeHolt no, it isn&#39;t.  while my returns the new variable and allows you to do things like assign to it, otherwise the scope of a lexical in perl only begins on the following statement.  so <code>my @Z = 1..3; my @Z = map 4-$_, @Z; print @Z</code> prints 432; the second @Z in the second statement is the first one declared, not the second."}, {"owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1553011722, "post_id": 55229466, "comment_id": 97223755, "body": "@ysth I was talking about the case when there is no previously defined <code>@Z</code>, and the point was just that he was referencing a non-existent variable. I hadn&#39;t yet seen the <code>my @Z</code> declared inside the loop, but even in that case, the <code>@Z</code> inside the for loop dies once it goes out of scope. If you have <code>use strict</code> on, and you attempted to reference <code>@Z</code> after the loop, it would complain about <code>@Z</code> being undeclared. And without <code>use strict</code>, if you did <code>my @Z { whatever } @Z</code> after the loop, you&#39;d just get an auto-vivified <code>@Z</code>, not the same <code>@Z</code> from inside the loop."}], "answers": [{"tags": [], "owner": {"reputation": 4024, "user_id": 3307686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd8d815759c23dd52428c7cc0c35324?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Holt", "link": "https://stackoverflow.com/users/3307686/mike-holt"}, "is_accepted": true, "score": 3, "last_activity_date": 1552941242, "creation_date": 1552941242, "answer_id": 55229633, "question_id": 55229466, "link": "https://stackoverflow.com/questions/55229466/perl-declared-variable-with-my-still-get-error/55229633#55229633", "title": "Perl - Declared variable with &#39;my&#39;, still get error", "body": "<p>You're declaring <code>@Z</code> (using the keyword <code>my</code>) in two different scopes. One inside the <code>for</code> loop, and one afterwards. If you need <code>@Z</code> to still exist after the <code>for</code> loop completes, you need to declare it outside of (and prior to) that scope.</p>\n\n<p>Also, only use <code>my</code> once:</p>\n\n<pre><code>my @Z;\nmy ($X_ref,$Y_ref)=grid($min_X,$max_X,$min_Y,$max_Y,$distance);my @X=@$X_ref;my @Y=@{$Y_ref};\nfor my $i (0..$#X){\n    $Z[$i]=20;#The function that defined the height of each point. This setting      wil give you a flat roof. For a more advanced tree, try:\n    #$Z[$i]=-0.01*$X[$i]**2+0.2*$Y[$i]-0.005*$Y[$i]**2+20;\n}\n\n#End of input parameters.\n\nmy $min_radian = deg2rad($min_angle);\nmy $b = tan($min_radian);\n@Z=map{$_/$b} @Z;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 1, "creation_date": 1553014186, "post_id": 55243723, "comment_id": 97225184, "body": "Sorry but this answer makes no sense."}], "tags": [], "owner": {"reputation": 1, "user_id": 11227095, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/53f15f309d5537aab7ff97d3728f119e?s=128&d=identicon&r=PG", "display_name": "TRSi", "link": "https://stackoverflow.com/users/11227095/trsi"}, "is_accepted": false, "score": -2, "last_activity_date": 1553006809, "creation_date": 1553006809, "answer_id": 55243723, "question_id": 55229466, "link": "https://stackoverflow.com/questions/55229466/perl-declared-variable-with-my-still-get-error/55243723#55243723", "title": "Perl - Declared variable with &#39;my&#39;, still get error", "body": "<p>When you set my, so you have to define the base. </p>\n\n<p>old school: my @Z =(); \nnew school: my $Z =\"\";</p>\n\n<p>This should be the missed one.</p>\n"}], "owner": {"reputation": 99, "user_id": 10063873, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XqwEqS3G7nI/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7o6sjf_HyLgV4ex0Wxh5mu-kZ8ARQ/mo/photo.jpg?sz=128", "display_name": "User0110101", "link": "https://stackoverflow.com/users/10063873/user0110101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 55229633, "answer_count": 2, "score": 2, "last_activity_date": 1553006809, "creation_date": 1552940460, "last_edit_date": 1552952466, "question_id": 55229466, "link": "https://stackoverflow.com/questions/55229466/perl-declared-variable-with-my-still-get-error", "title": "Perl - Declared variable with &#39;my&#39;, still get error", "body": "<p>so I'm getting this error:</p>\n\n<pre><code>Global symbol \"@Z\" requires explicit package name \n(did you forget to declare \"my @Z\"?) at \nC:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 937. Global symbol \"@Z\" requires explicit package name (did you forget to declare \"my @Z\"?) at C:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 945\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>my ($X_ref,$Y_ref)=grid($min_X,$max_X,$min_Y,$max_Y,$distance);my @X=@$X_ref;my @Y=@{$Y_ref};\nfor my $i (0..$#X){\n    $Z[$i]=20;#The function that defined the height of each point. This setting wil give you a flat roof. For a more advanced tree, try:\n    #$Z[$i]=-0.01*$X[$i]**2+0.2*$Y[$i]-0.005*$Y[$i]**2+20;\n}\n\n#End of input parameters.\n\nmy $min_radian = deg2rad($min_angle);\nmy $b = tan($min_radian);\nmy @Z=map{$_/$b} @Z;\n</code></pre>\n\n<p>After declaring the code with \"my\" for each of the respected errors:</p>\n\n<pre><code>\"my\" variable @Z masks earlier declaration in same statement at C:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 945.\n\"my\" variable @Z masks earlier declaration in same statement at C:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 945.\nsyntax error at C:/Users/owner/Documents/Slic3r/lib/Slic3r/Print/SupportMaterial.pm line 937, near \"$Z[\"\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>my ($X_ref,$Y_ref)=grid($min_X,$max_X,$min_Y,$max_Y,$distance);my @X=@$X_ref;my @Y=@{$Y_ref};\nfor my $i (0..$#X){\n    my $Z[$i]=20;#The function that defined the height of each point. This setting wil give you a flat roof. For a more advanced tree, try:\n    #$Z[$i]=-0.01*$X[$i]**2+0.2*$Y[$i]-0.005*$Y[$i]**2+20;\n}\n\n#End of input parameters.\n\nmy $min_radian = deg2rad($min_angle);\nmy $b = tan($min_radian);\nmy @Z=map{$_/$b} my @Z;\n</code></pre>\n\n<p>Any help would be great guys, really struggling to figure why these two are not working correctly.</p>\n"}, {"tags": ["perl", "unix", "unicode"], "comments": [{"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1552930622, "post_id": 55226974, "comment_id": 97188774, "body": "Please provide a hexdump of a few relevant lines. Btw, if <code>iconv</code> isn&#39;t stripping them, they probably aren&#39;t invalid byte sequences, even if they look like gibberish. Perhaps clarify what you mean precisely by &quot;invalid characters&quot;."}, {"owner": {"reputation": 11, "user_id": 5823693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kSy5UwsBj_w/AAAAAAAAAAI/AAAAAAAAAEo/7xzkcrqOiLA/photo.jpg?sz=128", "display_name": "chronos", "link": "https://stackoverflow.com/users/5823693/chronos"}, "reply_to_user": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1552931185, "post_id": 55226974, "comment_id": 97189074, "body": "I added what I think you were asking for. the utf-8 codepoint says the A0 is an invalid continuation byte. By invalid i mean removing all non-utf-8 characters."}, {"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 1, "creation_date": 1552933423, "post_id": 55226974, "comment_id": 97190157, "body": "1A is valid ASCII and therefore valid UTF-8. my iconv strips out A0. What version of iconv are you using?"}, {"owner": {"reputation": 381, "user_id": 1843616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a14e1edce4c98bf25b19b54fdf7878?s=128&d=identicon&r=PG", "display_name": "Mons Anderson", "link": "https://stackoverflow.com/users/1843616/mons-anderson"}, "edited": false, "score": 0, "creation_date": 1552934163, "post_id": 55226974, "comment_id": 97190524, "body": "You may just decode/encode whole file: <code>encode(&quot;UTF-8&quot;,decode(&quot;utf8&quot;,$content))</code>  wrong characters would be replaced with &quot;?&quot;"}, {"owner": {"reputation": 11, "user_id": 5823693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kSy5UwsBj_w/AAAAAAAAAAI/AAAAAAAAAEo/7xzkcrqOiLA/photo.jpg?sz=128", "display_name": "chronos", "link": "https://stackoverflow.com/users/5823693/chronos"}, "reply_to_user": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1552939009, "post_id": 55226974, "comment_id": 97192771, "body": "@jhnc i was using iconv 1, now I tried using iconv 2 and it does strip out A0 (rendered as &lt;A0&gt; but leaves the 1A&#39;s (rendered as ^Z). Perhaps I was wrong when saying non-utf-8 characters. My system that ingests the XML that contains 1A spits out an error, saying &#39;An invalix XML character (Unicode 0x1A) was found&#39;.  It looks like I should be able to use a combination of iconv to remove A0 first then the perl script to remove 1A, now that I know my iconv was outdated. Thanks for that."}, {"owner": {"reputation": 11, "user_id": 5823693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kSy5UwsBj_w/AAAAAAAAAAI/AAAAAAAAAEo/7xzkcrqOiLA/photo.jpg?sz=128", "display_name": "chronos", "link": "https://stackoverflow.com/users/5823693/chronos"}, "reply_to_user": {"reputation": 381, "user_id": 1843616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a14e1edce4c98bf25b19b54fdf7878?s=128&d=identicon&r=PG", "display_name": "Mons Anderson", "link": "https://stackoverflow.com/users/1843616/mons-anderson"}, "edited": false, "score": 0, "creation_date": 1552939013, "post_id": 55226974, "comment_id": 97192774, "body": "@MonsAnderson I can&#39;t replace the characters with ? as that will invalidate the XML file against the XSD. It expects only numbers, so my only option is to remove the invalid characters."}, {"owner": {"reputation": 4969, "user_id": 10971581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XPQr1.png?s=128&g=1", "display_name": "jhnc", "link": "https://stackoverflow.com/users/10971581/jhnc"}, "edited": false, "score": 0, "creation_date": 1552942416, "post_id": 55226974, "comment_id": 97194188, "body": "btw, the 1A may be an indication of erroneous conversion earlier on: <a href=\"https://en.wikipedia.org/wiki/Substitute_character\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Substitute_character</a>"}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 1843616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1a14e1edce4c98bf25b19b54fdf7878?s=128&d=identicon&r=PG", "display_name": "Mons Anderson", "link": "https://stackoverflow.com/users/1843616/mons-anderson"}, "is_accepted": false, "score": 1, "last_activity_date": 1552935494, "last_edit_date": 1552935494, "creation_date": 1552934776, "answer_id": 55228133, "question_id": 55226974, "link": "https://stackoverflow.com/questions/55226974/remove-invalid-unicode-characters-from-xml-file-in-unix/55228133#55228133", "title": "Remove invalid UNICODE characters from XML file in UNIX?", "body": "<p>You may use the following onliner:</p>\n\n<pre><code>perl -i -MEncode -0777ne'print encode(\"UTF-8\",decode(\"UTF-8\",$_,sub{\"\"}))' file.xml\n</code></pre>\n\n<p>You also may extend it with warnings:</p>\n\n<pre><code>perl -i -MEncode -0777ne'print encode(\"UTF-8\",decode(\"UTF-8\",$_,sub{warn \"Bad byte: @_\";\"\"}))' file.xml\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1552945494, "last_edit_date": 1552945494, "creation_date": 1552934819, "answer_id": 55228142, "question_id": 55226974, "link": "https://stackoverflow.com/questions/55226974/remove-invalid-unicode-characters-from-xml-file-in-unix/55228142#55228142", "title": "Remove invalid UNICODE characters from XML file in UNIX?", "body": "<p><code>A0</code> is not a valid UTF-8 sequence. The errors you were encountering where XML encoding errors, while this one is a character encoding error.</p>\n\n<p><code>A0</code> is the Unicode Code Point for a non-breaking space. It is also the iso-8859-1 and cp1252 encoding of that Code Point.</p>\n\n<p>I would recommend fixing the problem at its source. But if that's not possible, I would recommend using <a href=\"https://metacpan.org/pod/Encoding::FixLatin\" rel=\"nofollow noreferrer\">Encoding::FixLatin</a> to fix this new type of error (perhaps via the bundled <code>fix_latin</code> script). It will correctly replace <code>A0</code> with <code>C2 A0</code> (the UTF-8 encoding of a non-breaking space).</p>\n\n<p>Combined with your existing script:</p>\n\n<pre><code>perl -i -MEncoding::FixLatin=fix_latin -0777pe'\n   $_ = fix_latin($_);\n   utf8::decode($_);\n   s/[^\\x9\\xA\\xD\\x20-\\x{D7FF}\\x{E000}-\\x{FFFD}\\x{10000}-\\x{10FFFF}]+//g;\n   utf8::encode($_);\n' file.xml\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5823693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kSy5UwsBj_w/AAAAAAAAAAI/AAAAAAAAAEo/7xzkcrqOiLA/photo.jpg?sz=128", "display_name": "chronos", "link": "https://stackoverflow.com/users/5823693/chronos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552945494, "creation_date": 1552930245, "last_edit_date": 1552930878, "question_id": 55226974, "link": "https://stackoverflow.com/questions/55226974/remove-invalid-unicode-characters-from-xml-file-in-unix", "title": "Remove invalid UNICODE characters from XML file in UNIX?", "body": "<p>I have a shell script that I use to remotely clean an XML file produced by another system that contains invalid UNICODE characters. I am currently using this command in the script to remove the invalid characters:</p>\n\n<pre><code>perl -CSDA -i -pe's/[^\\x9\\xA\\xD\\x20-\\x{D7FF}\\x{E000}-\\x{FFFD}\\x{10000}-\\x{10FFFF}]+//g;' file.xml\n</code></pre>\n\n<p>and this has worked so far but now the file has new error of, as far as I can tell, 'xA0', and what happens is my perl command reaches that error in the file and erases the rest of the file. I modified my command to include xA0, but it doesn't work:</p>\n\n<pre><code>perl -CSDA -i -pe's/[^\\x9\\xA0\\xD\\x20-\\x{D7FF}\\x{E000}-\\x{FFFD}\\x{10000}-\\x{10FFFF}]+//g;' file.xml\n</code></pre>\n\n<p>I have also tried using:</p>\n\n<pre><code>iconv -f UTF-8 -t UTF-8 -c file.xml &gt; file2.xml\n</code></pre>\n\n<p>but that doesn't do anything. It produces an identical file with the same errors.</p>\n\n<p>Is there a unix command that I can use that will completely remove all invalid UNICODE characters?</p>\n\n<p>EDIT:\nsome HEX output (note the 1A's and A0's):</p>\n\n<p>3E 1A 1A 33 30 34 39 37 1A 1A 3C 2F 70</p>\n\n<p>6D 62 65 72 3E A0 39 34 32 39 38 3C 2F</p>\n"}, {"tags": ["perl", "libxml2", "strawberry-perl"], "comments": [{"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 0, "creation_date": 1552929913, "post_id": 55226761, "comment_id": 97188393, "body": "Most likely, you&#39;re running afoul of XML::LibXML not being threadsafe enough. My recommendation is to avoid <code>fork()</code> and instead launch real child processes."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552930984, "post_id": 55226761, "comment_id": 97188973, "body": "The <a href=\"https://metacpan.org/pod/XML::LibXML#THREAD-SUPPORT\" rel=\"nofollow noreferrer\">note on thread support</a> in <code>XML::LibXML</code>, linked in the post you link to, isn&#39;t &quot;<i>8 years</i>&quot; old; also, <code>fork</code> on Windows is emulated using threads (as Windows has no fork), which can only make it trickier.  So, since there <i>is</i> a problem, I&#39;d try changing to threads (instead of forking) and then follow carefully what docs say on how to work with the module under threads."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552931251, "post_id": 55226761, "comment_id": 97189109, "body": "&quot;<i>code actually works if you remove the outer loop</i>&quot; -- I don&#39;t see that the outer loop does anything, other than triggering 3x as many threads of execution.  This alone may be a factor: issues with threads/forks very often don&#39;t come up in every run, and have far more chance to show when it&#39;s busier (more threads or processes)"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552936280, "post_id": 55226761, "comment_id": 97191533, "body": "<code>fork</code> is a unix concept that doesn&#39;t exist in Windows. Perl poorly emulates it using threads in Windows. It&#39;s best to avoid <code>fork</code> on Windows."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552942564, "post_id": 55226761, "comment_id": 97194255, "body": "...Do you have the problem if you just use threads directly?"}, {"owner": {"reputation": 375, "user_id": 10704286, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-of8xlFarfwE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i8d962iFCs6D-HXxGc6_MAps5gIQ/mo/photo.jpg?sz=128", "display_name": "Demeter P. Chen", "link": "https://stackoverflow.com/users/10704286/demeter-p-chen"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552953459, "post_id": 55226761, "comment_id": 97197729, "body": "@Ikegami @Corion @zdim The code are meant to be run on a linux box but I do most of my development on a Windows machine though. I believe process are more robust and mature in Linux; thus I prefer to stick with <code>fork()</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552954844, "post_id": 55226761, "comment_id": 97198039, "body": "uh, so what&#39;s your question, then?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552959351, "post_id": 55226761, "comment_id": 97198962, "body": "And yeah, it works fine with threads without fork"}], "owner": {"reputation": 375, "user_id": 10704286, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-of8xlFarfwE/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i8d962iFCs6D-HXxGc6_MAps5gIQ/mo/photo.jpg?sz=128", "display_name": "Demeter P. Chen", "link": "https://stackoverflow.com/users/10704286/demeter-p-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1598211244, "creation_date": 1552929484, "last_edit_date": 1598211244, "question_id": 55226761, "link": "https://stackoverflow.com/questions/55226761/perl-with-libxml-silently-crashing-in-windows-10-inside-loop-with-fork", "title": "perl with libxml silently crashing in Windows 10 inside loop with fork", "body": "<p>I'm using perl 5.24.4 under Windows 10 that have the latest LibXML installed (2.0134). Below is the code that crashes on Windows 10 (It works on Linux)</p>\n<h2>crash.pl</h2>\n<pre><code>use strict;\nuse warnings;\n\nuse XML::LibXML;\nuse Utils;\nuse Log::Log4perl;\n\n\nLog::Log4perl-&gt;init('logger.conf');\nmy $logger = Log::Log4perl-&gt;get_logger();\n\nsub generate_word_stats_for_chunk\n{\n    return Utils::load_sql();\n}\n\nmy $num_process = 4; \nmy @modes = (1,3,5);\n\nforeach my $mode (@modes) {\n\n\n    my @pid_list;\n    $logger-&gt;info(&quot;Forking $num_process&quot;);\n    for my $i (0 .. $num_process - 1) {\n        my $pid = fork();\n        $logger-&gt;logconfess(&quot;Unable to fork $!&quot;) if not defined $pid;\n        if ($pid == 0) {\n            # child process\n            generate_word_stats_for_chunk($i);\n            sleep 2;\n\n            # make sure that the child process exit\n            exit;\n    }\n    # parent\n    # Store the PIDs, so that waitpid() can call them later\n    push @pid_list, $pid;\n}\n\nfor my $pid (@pid_list) {\n    waitpid $pid, 0;\n}\n$logger-&gt;info(&quot;finished mode $mode&quot;);\n</code></pre>\n<h2>Utils.pm</h2>\n<pre><code>package Utils;\n\nuse strict;\nuse warnings;\n\nuse XML::LibXML;\nuse Log::Log4perl;\n\nmy $logger = Log::Log4perl-&gt;get_logger();\n\nsub load_sql \n{\n\n    $logger-&gt;info(&quot;parsing XML&quot;);   \n    my $dom;\n\n    eval {\n        $dom  = XML::LibXML-&gt;load_xml(location =&gt; 'sql.xml');\n    };\n    if ($@) {\n        $logger-&gt;error(&quot;parse error $@&quot;);\n        return;\n    }\n    $logger-&gt;info(&quot;finished parsing XML&quot;);  \n\n    # dummy\n    return {};\n}\n\n# perl package ends with 1\n1;\n</code></pre>\n<h2>sql.xml</h2>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;    \n&lt;sqls&gt;    \n    &lt;sql name=&quot;CREATE_COMMODITY_META&quot;&gt;\n        test\n    &lt;/sql&gt;      \n&lt;/sqls&gt; \n</code></pre>\n<p>Running crash.pl gives me the following output</p>\n<pre><code>INFO main::(crash.pl:37) Forking 4\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:31) finished parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:31) finished parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:31) finished parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:31) finished parsing XML\nINFO main::(crash.pl:62) finished mode 1\nINFO main::(crash.pl:37) Forking 4\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\nINFO Utils::load_sql(Utils.pm:21) parsing XML\n</code></pre>\n<p>The code works if I remove the <code>Utils::load_sql()</code> statement. This <em>might</em> be similar to <a href=\"https://stackoverflow.com/questions/8001322/why-does-perl-crash-when-using-libxml-after-a-fork\">Why does Perl crash when using LibXML after a fork?</a>, but I have some doubts as the code in that post works only machine. My code actually works if you remove the outer loop (e.g. the <code>foreach my $mode...</code> ). Also another reason why I doubt it is that post is already 8 years old.</p>\n<p>Also, why isn't the eval statement in <code>Utils.pm</code> not catching the crash?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "edited": false, "score": 2, "creation_date": 1552913332, "post_id": 55221390, "comment_id": 97178266, "body": "You already know the recommended solution \u2013 to declare the offending variables with <code>my</code>. Have you tried doing that?"}, {"owner": {"reputation": 25, "user_id": 9903818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5153e45f1b6d1175d850283791787?s=128&d=identicon&r=PG&f=1", "display_name": "user9903818", "link": "https://stackoverflow.com/users/9903818/user9903818"}, "reply_to_user": {"reputation": 54872, "user_id": 1521179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/MH7pk.png?s=128&g=1", "display_name": "amon", "link": "https://stackoverflow.com/users/1521179/amon"}, "edited": false, "score": 0, "creation_date": 1552913446, "post_id": 55221390, "comment_id": 97178347, "body": "How do I do them for some of them though? I&#39;m a bit unsure. For eample, the sub branch method has $rho, $theta, $phi in the for loop. Can I declare them as my in those brackets?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 4, "creation_date": 1552913528, "post_id": 55221390, "comment_id": 97178400, "body": "Removing <code>use strict;</code> should not be considered an option."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1552913594, "post_id": 55221390, "comment_id": 97178452, "body": "You have oodles on undeclared variables, which is why you&#39;re getting the error message. Declare them!"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1552913745, "post_id": 55221390, "comment_id": 97178553, "body": "You should wrap that top-level code in curlies (<code>{ ... }</code>) so that you can properly scope variables to that code."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1552915634, "post_id": 55221390, "comment_id": 97179737, "body": "@user9903818 <i>&quot;Can I declare them as my in those brackets?&quot;</i> Yes, just put <code>my</code> in front: <code>my ($rho, $theta, $phi) = cartesian_to_spherical(...)</code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552946020, "post_id": 55221390, "comment_id": 97195531, "body": "<code>my ($rho, $theta, $phi)</code> is equivalent to <code>(my $rho, my $theta, my $phi)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1552938813, "post_id": 55222467, "comment_id": 97192683, "body": "Not to mention, they&#39;re not equivalent. <code>my</code> creates local variables. If you remove <code>use strict;</code>, all you get is (implicit) globals. You still need <code>my</code> to declare local variables, strict or not."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 2, "last_activity_date": 1552915549, "creation_date": 1552915549, "answer_id": 55222467, "question_id": 55221390, "link": "https://stackoverflow.com/questions/55221390/perl-requires-explicit-package-name/55222467#55222467", "title": "Perl - Requires explicit package name", "body": "<blockquote>\n  <p>Now to what I know so far as someone new to Perl, you need to declare them \"my ...\" or remove use strict. I am somewhat interested in the latter since the script is working correctly. Does anyone have any help or tips?</p>\n</blockquote>\n\n<p>Declaring the variables with <code>my</code> is the right approach. <code>use strict</code> does an number of things - forcing variable declaration is only one of them.</p>\n\n<p>No serious Perl programmer would consider writing code without <code>use strict</code> and <code>use warnings</code>. Removing them is a bad idea.</p>\n"}], "owner": {"reputation": 25, "user_id": 9903818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5153e45f1b6d1175d850283791787?s=128&d=identicon&r=PG&f=1", "display_name": "user9903818", "link": "https://stackoverflow.com/users/9903818/user9903818"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552936831, "creation_date": 1552911997, "last_edit_date": 1552936831, "question_id": 55221390, "link": "https://stackoverflow.com/questions/55221390/perl-requires-explicit-package-name", "title": "Perl - Requires explicit package name", "body": "<p>I have googled around and looked online and I understand a few criteria would need to be met in order to get this function to work, however, I don't understand why it's able to work in the first place. </p>\n\n<p>Context:\nI have a Perl script that I want to integrate into a Perl module. The situation is that I'm new to the language and I'm a bit unsure the difference and I don't understand why this error is coming up in the first place. </p>\n\n<p>The Perl module is this:\n<a href=\"https://github.com/slic3r/Slic3r/blob/master/lib/Slic3r/Print/SupportMaterial.pm\" rel=\"nofollow noreferrer\">https://github.com/slic3r/Slic3r/blob/master/lib/Slic3r/Print/SupportMaterial.pm</a></p>\n\n<p>I thought I could just add the script into the module and be done, but unfortunately, that is not the case due to the error message. Now to what I know so far as someone new to Perl, you need to declare them \"my ...\" or remove use strict. I am somewhat interested in the latter since the script is working correctly. Does anyone have any help or tips? </p>\n"}, {"tags": ["bash", "perl", "awk", "sed"], "comments": [{"owner": {"reputation": 226874, "user_id": 1983854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/eKpAk.png?s=128&g=1", "display_name": "fedorqui &#39;SO stop harming&#39;", "link": "https://stackoverflow.com/users/1983854/fedorqui-so-stop-harming"}, "edited": false, "score": 2, "creation_date": 1555539408, "post_id": 55220417, "comment_id": 98151375, "body": "Meta on this: <a href=\"https://meta.stackoverflow.com/q/382012/1983854\">Can I create this new question or will it be closed as a dupe or otherwise cause controversy?</a>. Quite strange it is not marked as duplicate of <a href=\"https://stackoverflow.com/q/38972736/1983854\">How to select lines between two patterns?</a>. As mentioned in that one, the idea was to compile a set of options, and for this it was marked as CW. You are saying this is not dupe because one answer does not cover one case. Writing yet another canonical seems a waste of time to me and contributes to knowledge dispersion."}, {"owner": {"reputation": 226874, "user_id": 1983854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/eKpAk.png?s=128&g=1", "display_name": "fedorqui &#39;SO stop harming&#39;", "link": "https://stackoverflow.com/users/1983854/fedorqui-so-stop-harming"}, "reply_to_user": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 0, "creation_date": 1557165704, "post_id": 55220417, "comment_id": 98665760, "body": "Mmm @hek I left my comment here and then some interesting debate was carried over with Alex, tripleee and me. I would just leave it open by now and see if attracts views. In any case, I see we are talking about this topic asynchronously and in different places (also Meta), so it is difficult to get to a consensous."}, {"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "reply_to_user": {"reputation": 226874, "user_id": 1983854, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/eKpAk.png?s=128&g=1", "display_name": "fedorqui &#39;SO stop harming&#39;", "link": "https://stackoverflow.com/users/1983854/fedorqui-so-stop-harming"}, "edited": false, "score": 1, "creation_date": 1557166153, "post_id": 55220417, "comment_id": 98665941, "body": "@fedorqui I followed the discussion somehow here and there. For me this is a clear duplicate of your question - that was my first thought, without being influenced by the meta post you linked above. I don&#39;t see any good reason why the OP shouldn&#39;t accept that."}], "answers": [{"comments": [{"owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 0, "creation_date": 1552912146, "post_id": 55220428, "comment_id": 97177641, "body": "note that this would only print first such sequence of lines between the patterns, if that was your intention, please add that information to the question and the duplicate question marked will no longer hold"}, {"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "reply_to_user": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "edited": false, "score": 1, "creation_date": 1552913174, "post_id": 55220428, "comment_id": 97178157, "body": "Sorry @Sundeep, I believe I already said that, but I&#39;ve now made it even clearer."}], "tags": [], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "is_accepted": false, "score": 5, "last_activity_date": 1557273253, "last_edit_date": 1557273253, "creation_date": 1552908868, "answer_id": 55220428, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55220428#55220428", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>If you have GNU sed (tested using version 4.7 on Mac OS X), the simplest solution could be:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sed '0,/PATTERN1/d;/PATTERN2/Q'\n</code></pre>\n\n<p>Explanation:</p>\n\n<ul>\n<li>The <code>d</code> command deletes from line 1 to the line matching <code>/PATTERN1/</code> inclusive.</li>\n<li>The <code>Q</code> command then exits without printing on the first line matching <code>/PATTERN2/</code>.</li>\n</ul>\n\n<p>If the file has only once instance of the pattern, or if you don't mind extracting all of them, and you want a solution that doesn't depend on a GNU extension, this works:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sed -n '/PATTERN1/,/PATTERN2/{//!p}'\n</code></pre>\n\n<p>Explanation:</p>\n\n<ul>\n<li>Note that the empty regular expression <code>//</code> repeats the last regular expression match.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "edited": false, "score": 1, "creation_date": 1553160593, "post_id": 55222083, "comment_id": 97284589, "body": "It was proposed to chat to use <code>awk &#39;&#47;PATTERN1&#47;{f=1;next}&#47;PATTERN2&#47;{exit}f&#39;</code> which I notice is essentially the same as <code>awk &#39;&#47;PATTERN2&#47;{exit} f; &#47;PATTERN1&#47;{f=1}&#39;</code>, which is why I won&#39;t add it as a separate answer."}], "tags": [], "owner": {"reputation": 18548, "user_id": 4082052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUNps.jpg?s=128&g=1", "display_name": "Sundeep", "link": "https://stackoverflow.com/users/4082052/sundeep"}, "is_accepted": true, "score": 3, "last_activity_date": 1554686172, "last_edit_date": 1554686172, "creation_date": 1552914273, "answer_id": 55222083, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55222083#55222083", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>With <code>awk</code> (assumes that <code>PATTERN1</code> and <code>PATTERN2</code> are always present in pairs and either of them do not occur inside a pair)</p>\n\n<pre><code>$ cat ip.txt\naaa\nPATTERN1\nbbb\nccc\nddd\nPATTERN2\neee\nfff\nPATTERN1\nggg\nhhh\niii\nPATTERN2\njjj\n\n$ awk '/PATTERN2/{exit} f; /PATTERN1/{f=1}' ip.txt\nbbb\nccc\nddd\n</code></pre>\n\n<ul>\n<li><code>/PATTERN1/{f=1}</code> set flag if <code>/PATTERN1/</code> is matched</li>\n<li><code>/PATTERN2/{exit}</code> exit if <code>/PATTERN2/</code> is matched</li>\n<li><code>f;</code> print input line if flag is set</li>\n</ul>\n\n<p><br>\nGeneric solution, where the block required can be specified</p>\n\n<pre><code>$ awk -v b=1 '/PATTERN2/ &amp;&amp; c==b{exit} c==b; /PATTERN1/{c++}' ip.txt\nbbb\nccc\nddd\n$ awk -v b=2 '/PATTERN2/ &amp;&amp; c==b{exit} c==b; /PATTERN1/{c++}' ip.txt\n2\n46\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46858, "user_id": 967492, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/526ea226101e199d029049dda22a4e58?s=128&d=identicon&r=PG", "display_name": "potong", "link": "https://stackoverflow.com/users/967492/potong"}, "is_accepted": false, "score": 2, "last_activity_date": 1552916164, "creation_date": 1552916164, "answer_id": 55222646, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55222646#55222646", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>This might work for you (GNU sed);</p>\n\n<pre><code>sed -n '/PATTERN1/{:a;n;/PATTERN2/q;p;$!ba}' file\n</code></pre>\n\n<p>This prints only the lines between the first set of delimiters, or if the second delimiter does not exist, to the end of the file.</p>\n"}, {"tags": [], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "is_accepted": false, "score": 2, "last_activity_date": 1552937526, "last_edit_date": 1552937526, "creation_date": 1552934156, "answer_id": 55227984, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55227984#55227984", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>I attempted twice to answer, but the questions switched hold/duplicate statuses.. </p>\n\n<p>Borrowing input from @Sundeep and adding the answer which I shared in the question comments.</p>\n\n<p>Using awk</p>\n\n<pre><code>awk -v x=0 -v y=1 ' /PATTERN1/&amp;&amp;y { x=1;next } /PATTERN2/&amp;&amp;y { x=0;y=0; next } x ' file\n</code></pre>\n\n<p>with Perl</p>\n\n<pre><code>perl -0777 -ne ' while( /PATTERN1.*?\\n(.+?)^[^\\n]*?PATTERN2/msg ) { print $1 if $x++ &lt;1 } '\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>$ cat ip.txt\naaa\nPATTERN1\nbbb\nccc\nddd\nPATTERN2\neee\nPATTERN1\n2\n46\nPATTERN2\nxyz\n\n$\n\n$ awk -v x=0 -v y=1 ' /PATTERN1/&amp;&amp;y { x=1;next } /PATTERN2/&amp;&amp;y { x=0;y=0; next } x ' ip.txt\nbbb\nccc\nddd\n\n$ perl -0777 -ne ' while( /PATTERN1.*?\\n(.+?)^[^\\n]*?PATTERN2/msg ) { print $1 if $x++ &lt;1 } ' ip.txt\nbbb\nccc\nddd\n\n$\n</code></pre>\n\n<p>To make it generic</p>\n\n<p><code>awk</code> here y is the input</p>\n\n<pre><code>awk -v x=0 -v y=2 ' /PATTERN1/ { x++;next } /PATTERN2/ { if(x==y) exit } x==y ' ip.txt\n2\n46\n</code></pre>\n\n<p><code>perl</code> check ++$x against the occurence.. here it is 2</p>\n\n<pre><code>perl -0777 -ne ' while( /PATTERN1.*?\\n(.+?)^[^\\n]*?PATTERN2/msg ) { print $1 if ++$x==2 } ' ip.txt\n2\n46\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95936, "user_id": 5866580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/1de2cd722d865edac1575102a48ecc0a?s=128&d=identicon&r=PG&f=1", "display_name": "RavinderSingh13", "link": "https://stackoverflow.com/users/5866580/ravindersingh13"}, "is_accepted": false, "score": 1, "last_activity_date": 1552963996, "creation_date": 1552963996, "answer_id": 55232959, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55232959#55232959", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>Adding more solutions(possible ways here, for fun :)  and not at all claiming that these are better than usual ones) All tested and written in GNU <code>awk</code>. Also tested with given examples only.</p>\n\n<p><strong><em>1st Solution:</em></strong> </p>\n\n<pre><code>awk -v RS=\"\" -v FS=\"PATTERN2\" -v ORS=\"\" '$1 ~ /\\nPATTERN1\\n/{sub(/.*PATTERN1\\n/,\"\",$1);print $1}' Input_file\n</code></pre>\n\n<p><strong><em>2nd solution:</em></strong> </p>\n\n<pre><code>awk -v RS=\"\" -v ORS=\"\" 'match($0,/PATTERN1[^(PATTERN2)]*/){val=substr($0,RSTART,RLENGTH);gsub(/^PATTERN1\\n|^$\\n/,\"\",val);print val}' Input_file\n</code></pre>\n\n<p><strong><em>3rd solution:</em></strong> </p>\n\n<pre><code>awk -v RS=\"\" -v OFS=\"\\n\" -v ORS=\"\" 'sub(/PATTERN2.*/,\"\") &amp;&amp; sub(/.*PATTERN1/,\"PATTERN1\"){$1=$1;sub(/^PATTERN1\\n/,\"\")} 1' Input_file\n</code></pre>\n\n<p>In all above codes output will be as follows.</p>\n\n<pre><code>bbb\nccc\nddd\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7712945"}, "is_accepted": false, "score": 1, "last_activity_date": 1554681808, "last_edit_date": 1554681808, "creation_date": 1554607444, "answer_id": 55555332, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw/55555332#55555332", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>Using GNU sed:</p>\n\n<pre><code>sed -nE '/PATTERN1/{:s n;/PATTERN2/q;p;bs}'\n</code></pre>\n\n<p>-n will prune all but lines between PATTERN1 and PATTERN2 including both, because there will be p printout command.\nevery sed range check if it's true will execute only one the next, so {} grouping is mandated..\nDrop PATTERN1 by n command (means next), if reach the first PATTERN2 outrightly quit otherwise print the line then and continue the next line within that boundary.</p>\n"}], "owner": {"reputation": 11353, "user_id": 3787051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/k2G2V.png?s=128&g=1", "display_name": "Alex Harvey", "link": "https://stackoverflow.com/users/3787051/alex-harvey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 2, "closed_date": 1557156422, "accepted_answer_id": 55222083, "answer_count": 6, "score": 2, "last_activity_date": 1559283420, "creation_date": 1552908833, "last_edit_date": 1559283420, "question_id": 55220417, "link": "https://stackoverflow.com/questions/55220417/print-all-lines-between-two-patterns-exclusive-first-instance-only-in-sed-aw", "closed_reason": "Duplicate", "title": "Print all lines between two patterns, exclusive, first instance only (in sed, AWK or Perl)", "body": "<p>Using sed, AWK (or Perl), how do you print all lines between (the first instance of) two patterns, exclusive of the patterns?<sup>1</sup></p>\n\n<p>That is, given as input:</p>\n\n<pre><code>aaa\nPATTERN1\nbbb\nccc\nddd\nPATTERN2\neee\n</code></pre>\n\n<p>Or possibly even:</p>\n\n<pre><code>aaa\nPATTERN1\nbbb\nccc\nddd\nPATTERN2\neee\nfff\nPATTERN1\nggg\nhhh\niii\nPATTERN2\njjj\n</code></pre>\n\n<p>I would expect, in both cases:</p>\n\n<pre><code>bbb\nccc\nddd\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> <sub>A number of users voted to close this question as a duplicate of <a href=\"https://stackoverflow.com/questions/38972736/how-to-select-lines-between-two-patterns\">this</a> one. In the end, I provided a <a href=\"https://gist.github.com/alexharv074/2f5ed774248277d06bf6f05325206d51\" rel=\"nofollow noreferrer\">gist</a> that proves they are different. The question is also superficially similar to <a href=\"https://stackoverflow.com/questions/42703101/extract-text-between-two-patterns-excluding-patterns\">a</a> <a href=\"https://stackoverflow.com/questions/19177721/extract-lines-between-two-patterns-from-a-file\">number</a> <a href=\"https://stackoverflow.com/questions/51852755/how-to-use-sed-to-print-from-between-one-line-and-another-line\">of</a> <a href=\"https://stackoverflow.com/questions/39703267/print-the-smallest-set-of-lines-between-two-patterns-begin-and-end-including-t\">others</a>, but there is no exact match, and none of them are of high quality, and, as I believe that this specific problem is the one most commonly faced, it deserves a clear formulation, and a set of correct, clear answers.</sub></p>\n"}, {"tags": ["perl", "tsocks"], "answers": [{"tags": [], "owner": {"reputation": 157, "user_id": 4234065, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/880adc30c370216c76c21791ff3fc479?s=128&d=identicon&r=PG&f=1", "display_name": "mirchev1977", "link": "https://stackoverflow.com/users/4234065/mirchev1977"}, "is_accepted": false, "score": 0, "last_activity_date": 1552910503, "creation_date": 1552910503, "answer_id": 55220898, "question_id": 55219465, "link": "https://stackoverflow.com/questions/55219465/how-to-use-perls-lwpuseragent-get-request-with-tsocks/55220898#55220898", "title": "How to use Perl&#39;s LWP::UserAgent GET request with tsocks", "body": "<p>I found a solution which might be very specific for my case:</p>\n\n<p>Before running the script, I just call <code>tsocks</code> like this:</p>\n\n<pre><code>tsocks script_name.pl\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9961, "user_id": 2139766, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b3qcA.png?s=128&g=1", "display_name": "AnFi", "link": "https://stackoverflow.com/users/2139766/anfi"}, "is_accepted": false, "score": 1, "last_activity_date": 1552928376, "creation_date": 1552928376, "answer_id": 55226459, "question_id": 55219465, "link": "https://stackoverflow.com/questions/55219465/how-to-use-perls-lwpuseragent-get-request-with-tsocks/55226459#55226459", "title": "How to use Perl&#39;s LWP::UserAgent GET request with tsocks", "body": "<h1>LWP::UserAgent and SOCKS</h1>\n\n<p>You may use <a href=\"https://metacpan.org/pod/LWP::Protocol::socks\" rel=\"nofollow noreferrer\"><code>LWP::Protocol::socks</code></a> perl package make <a href=\"https://metacpan.org/pod/LWP::UserAgent\" rel=\"nofollow noreferrer\"><code>LWP::UserAgent</code></a>  <a href=\"https://en.wikipedia.org/wiki/SOCKS\" rel=\"nofollow noreferrer\"><code>SOCKS</code></a> capable.</p>\n\n<p>IMHO it is much better way for your own perl scripts.<br>\n<code>tsocks</code> may be better for legacy perl scripts you do not want to modify.</p>\n"}], "owner": {"reputation": 157, "user_id": 4234065, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/880adc30c370216c76c21791ff3fc479?s=128&d=identicon&r=PG&f=1", "display_name": "mirchev1977", "link": "https://stackoverflow.com/users/4234065/mirchev1977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552928376, "creation_date": 1552905750, "question_id": 55219465, "link": "https://stackoverflow.com/questions/55219465/how-to-use-perls-lwpuseragent-get-request-with-tsocks", "title": "How to use Perl&#39;s LWP::UserAgent GET request with tsocks", "body": "<p>I can connect to a remote url using the proxy from tsocks in the following way:</p>\n\n<pre><code>tsocks telnet host port\n</code></pre>\n\n<p>How can I do the same using the Perl's <code>LWP::UserAgent</code> module?\nI've been so far trying it like this, but it doesn't work:</p>\n\n<pre><code>use strict;\nuse warnings;\nuse v5.16;\nuse LWP::UserAgent;\nuse HTTP::Request::Common;\nuse Data::Dumper;\n\n#my $ua = LWP::UserAgent-&gt;new();\nmy $ua  = LWP::UserAgent-&gt;new(timeout =&gt; 10,\n    ssl_opts =&gt; {\n        #verify_hostname =&gt; 0,\n        verify_hostname =&gt; 0,\n        SSL_verify_mode =&gt; '0x01',\n        SSL_version     =&gt; 'SSLv23:!SSLv3:!SSLv2',\n    }\n);\n$ua-&gt;proxy(['http', 'https' ], 'https://proxy_host:proxy_port' );\n\nmy $request = GET ( 'https://remote_url', Accept =&gt; 'application/json' );\n$request-&gt;authorization_basic( 'username', 'password' );\nsay $request-&gt;as_string();\n\nmy $response = $ua-&gt;request( $request );\nsay $response-&gt;as_string();\n</code></pre>\n\n<p>By the way, I don't have socks installed on this server. So I'll need to do it without them.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["perl", "tcl"], "comments": [{"owner": {"reputation": 663, "user_id": 9490777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adhamzhon Shukurov", "link": "https://stackoverflow.com/users/9490777/adhamzhon-shukurov"}, "edited": false, "score": 0, "creation_date": 1552900684, "post_id": 55217383, "comment_id": 97171024, "body": "Probably you need to design a module called KSA_32 which has inputs A and B, and an output Sum. Then you need to assign Sum = A + B; Hope you know what I mean."}, {"owner": {"reputation": 663, "user_id": 9490777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adhamzhon Shukurov", "link": "https://stackoverflow.com/users/9490777/adhamzhon-shukurov"}, "edited": false, "score": 0, "creation_date": 1552900833, "post_id": 55217383, "comment_id": 97171104, "body": "If you asked the question in a better way, you would get  better answers, but we cannot know your system and design before you describe it."}, {"owner": {"reputation": 3, "user_id": 11219510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mROuUYKbiis/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfF_P-DOFaUVohzKbQcvnLKSY91EA/mo/photo.jpg?sz=128", "display_name": "e2g05 Ricky", "link": "https://stackoverflow.com/users/11219510/e2g05-ricky"}, "reply_to_user": {"reputation": 663, "user_id": 9490777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adhamzhon Shukurov", "link": "https://stackoverflow.com/users/9490777/adhamzhon-shukurov"}, "edited": false, "score": 0, "creation_date": 1552911139, "post_id": 55217383, "comment_id": 97177091, "body": "@AdhamzhonShukurov The module is ready, I need to instantiate the module using tcl."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11219510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mROuUYKbiis/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfF_P-DOFaUVohzKbQcvnLKSY91EA/mo/photo.jpg?sz=128", "display_name": "e2g05 Ricky", "link": "https://stackoverflow.com/users/11219510/e2g05-ricky"}, "edited": false, "score": 0, "creation_date": 1552911059, "post_id": 55218256, "comment_id": 97177026, "body": "Sorry about this, if my verilog file is available on a directory, what should I do?"}, {"owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "reply_to_user": {"reputation": 3, "user_id": 11219510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mROuUYKbiis/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfF_P-DOFaUVohzKbQcvnLKSY91EA/mo/photo.jpg?sz=128", "display_name": "e2g05 Ricky", "link": "https://stackoverflow.com/users/11219510/e2g05-ricky"}, "edited": false, "score": 1, "creation_date": 1552916851, "post_id": 55218256, "comment_id": 97180499, "body": "@e2g05Ricky I don&#39;t think I understand your question, but \u201cuse the full pathname\u201d would seem like a sensible option?"}, {"owner": {"reputation": 3, "user_id": 11219510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mROuUYKbiis/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfF_P-DOFaUVohzKbQcvnLKSY91EA/mo/photo.jpg?sz=128", "display_name": "e2g05 Ricky", "link": "https://stackoverflow.com/users/11219510/e2g05-ricky"}, "edited": false, "score": 0, "creation_date": 1553677780, "post_id": 55218256, "comment_id": 97469068, "body": "Is the tcl above able to read many file, editing those file and saved to original named?"}], "tags": [], "owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "is_accepted": true, "score": 1, "last_activity_date": 1552901598, "creation_date": 1552901598, "answer_id": 55218256, "question_id": 55217383, "link": "https://stackoverflow.com/questions/55217383/tcl-script-or-perl/55218256#55218256", "title": "Tcl Script OR Perl?", "body": "<p>If your Verilog file is able to fit comfortably in memory, you can simply do:</p>\n\n<pre><code># Read in the file\nset f [open $verilogfile r]\nset contents [read $f]\nclose $f\n\n# Perform the transform across the whole contents\nregsub -all {assign\\s+(\\w+)\\s*=\\s*(\\w+)\\s*\\+\\s*(\\w+);} $contents \\\n        {KSA_32 U1(.A(\\2), .B(\\3), .Sum(\\1));} contents\n\n# Write the results out to a new file (different filename so you can check the results by hand)\nset f [open $verilogfile.new w]\nputs -nonewline $f $contents\nclose $f\n</code></pre>\n\n<p>The first and third block are standard Tcl patterns for file manipulation. The second is a standard regular expression substitution, which I made by taking what you asked for and applying guesses for what are templates. Note that the literal <code>+</code> needs to be escaped, and spaces are best matched as <code>\\s+</code> or <code>\\s*</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11219510, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mROuUYKbiis/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfF_P-DOFaUVohzKbQcvnLKSY91EA/mo/photo.jpg?sz=128", "display_name": "e2g05 Ricky", "link": "https://stackoverflow.com/users/11219510/e2g05-ricky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55218256, "answer_count": 1, "score": -2, "last_activity_date": 1552915989, "creation_date": 1552898274, "last_edit_date": 1552915989, "question_id": 55217383, "link": "https://stackoverflow.com/questions/55217383/tcl-script-or-perl", "title": "Tcl Script OR Perl?", "body": "<p>I wish to replace the following verilog code by using scripting.</p>\n\n<pre class=\"lang-verilog prettyprint-override\"><code>assign x0 = in0 + in7;\n</code></pre>\n\n<p>I wish to search for the \"+\" sign above and replace the whole line with the line below:</p>\n\n<pre class=\"lang-verilog prettyprint-override\"><code>KSA_32 U1(.A(in0), .B(in7), .Sum(x0));\n</code></pre>\n\n<p>any suggestion and sample script on this?</p>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552892864, "post_id": 55214454, "comment_id": 97167317, "body": "Your example seems incomplete: <code>index.html</code> is missing (I guess the included HTML is <code>salida.html</code>. Furthermore: always use a HTML parser, e.g. <a href=\"https://metacpan.org/pod/HTML::TreeBuilder\" rel=\"nofollow noreferrer\">HTML::TreeBuilder</a> to parse the HTML and then operate on the DOM instead."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552895442, "post_id": 55214454, "comment_id": 97168498, "body": "FYI: <a href=\"https://stackoverflow.com/questions/1732348#1732454\">never use a regex to parse HTML/XML/...</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11218435, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XlhDcN8JX2M/AAAAAAAAAAI/AAAAAAAAACE/ioRLnkDE4lo/photo.jpg?sz=128", "display_name": "KillerBee GSA", "link": "https://stackoverflow.com/users/11218435/killerbee-gsa"}, "edited": false, "score": 0, "creation_date": 1552935117, "post_id": 55216500, "comment_id": 97190977, "body": "that works fine for me, now I&#39;m trying to save the result in the salida.html file. I did this to open the file: open (RES,&quot;&gt;$salida&quot;) || die ($!); and I overwrite it with: print RES $res; Where $res= $root2-&gt;as_HTML(undef, &#39;  &#39;), &quot;\\n&quot;;. I&#39;m doing it fine?"}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 1, "user_id": 11218435, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XlhDcN8JX2M/AAAAAAAAAAI/AAAAAAAAACE/ioRLnkDE4lo/photo.jpg?sz=128", "display_name": "KillerBee GSA", "link": "https://stackoverflow.com/users/11218435/killerbee-gsa"}, "edited": false, "score": 0, "creation_date": 1552942482, "post_id": 55216500, "comment_id": 97194217, "body": "Then you can&#39;t read the file from STDIN, instead you should read from the file directly with <code>-&gt;parse_file(&quot;salida.html&quot;)</code> (the same method also accepts file names), Please do not use the insecure 2-parameter open and old-style filehandles, use <code>open(my $ofh, &#39;&gt;&#39;, $salida); print $ofh $root2-&gt;as_HTML(); close($ofh);</code>"}], "tags": [], "owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "is_accepted": false, "score": 0, "last_activity_date": 1552894596, "creation_date": 1552894596, "answer_id": 55216500, "question_id": 55214454, "link": "https://stackoverflow.com/questions/55214454/how-to-insert-lines-at-specific-location-in-file-using-perl-script/55216500#55216500", "title": "How to Insert lines at specific location in file using perl script", "body": "<p>Always process HTML or XML with an appropriate parser and then implement your processing on the DOM. My solution uses <a href=\"https://metacpan.org/pod/HTML::TreeBuilder\" rel=\"nofollow noreferrer\">HTML::TreeBuilder</a>. As your question doesn't include the contents of <code>index.html</code> I have appended my own to the solution:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\n\nuse HTML::TreeBuilder;\n\n# Extract links from &lt;DATA&gt;\nmy $root1 = HTML::TreeBuilder-&gt;new-&gt;parse_file(\\*DATA)\n    or die \"HTML: $!\\n\";\n\nmy @links = $root1-&gt;look_down(_tag =&gt; 'a');\n\n# Process salida.html from STDIN\nmy $root2 = HTML::TreeBuilder-&gt;new;\n$root2-&gt;ignore_unknown(0);\n$root2-&gt;parse_file(\\*STDIN)\n    or die \"HTML: $!\\n\";\n\n# insert links in correct section\nif (my @nodes = $root2-&gt;look_down(class =&gt; 'contenido')) {\n    $nodes[0]-&gt;push_content(@links);\n}\n\nprint $root2-&gt;as_HTML(undef, '  '), \"\\n\";\n\n# IMPORTANT: must delete manually\n$root2-&gt;delete;\n$root1-&gt;delete;\n\nexit 0;\n\n__DATA__\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;test&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;div&gt;\n      &lt;a href=\"link1.html\"&gt;Link 1&lt;/a&gt;\n      &lt;a href=\"link2.html\"&gt;Link 2&lt;/a&gt;\n    &lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Test run:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl dummy.pl &lt;dummy.html\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"es-mx\"&gt;\n...\n &lt;main class=\"contenido\"&gt; &lt;a href=\"link1.html\"&gt;Link 1&lt;/a&gt;&lt;a href=\"link2.html\"&gt;Link 2&lt;/a&gt;&lt;/main&gt; \n...\n&lt;/html&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11218435, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XlhDcN8JX2M/AAAAAAAAAAI/AAAAAAAAACE/ioRLnkDE4lo/photo.jpg?sz=128", "display_name": "KillerBee GSA", "link": "https://stackoverflow.com/users/11218435/killerbee-gsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552894596, "creation_date": 1552880313, "last_edit_date": 1552892606, "question_id": 55214454, "link": "https://stackoverflow.com/questions/55214454/how-to-insert-lines-at-specific-location-in-file-using-perl-script", "title": "How to Insert lines at specific location in file using perl script", "body": "<p>this is my problem I'm trying to read an HTML file(index.html) then search all links an put it on a second file named salida.html, I read <a href=\"https://stackoverflow.com/questions/ask?title=Insert%20lines%20at%20specific%20location%20in%20file%20using%20perl%20script\">this answer</a>, I read this answer and I tried to do it, but it didn't work for me.\nThis is my perl code:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\nuse 5.010;\nuse Tie::File;\n\nmy $entrada='index.html';\nmy $salida='salida.html';\nopen(A,\"&lt;$entrada\");\nmy @links;  \nforeach my $linea (&lt;A&gt;){\n    print \"Renglon =&gt; $linea\\n\" if $linea =~ m/a href/;\n    #print $B $linea if $linea =~ m/a href/;\n    push @links, $linea if $linea =~ m/a href/;\n}\n\ntie my @resultado, 'Tie::File', 'salida.html' or die \"Nelson\";\nfor (@resultado) {\n    if ($_ =~ m/&lt;main class=\"contenido\"&gt;/){\n        foreach my $found (@links){\n            $_ .= '&lt;br/&gt;'.$found;\n        }\n        last;\n    }\n}\nclose(A);\n</code></pre>\n\n<p>My Perl code runs without problems but in the for of my code I'm trying to write the links that I have in my variable $links in a specific part of my salida.html file:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"es-mx\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n    &lt;title&gt;Resultados de la busqueda&lt;/title&gt;\n    &lt;link rel=\"stylesheet\" href=\"style-salida.css\"&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;div class=\"contenedor\"&gt;\n        &lt;header class=\"header\"&gt;\n            &lt;h2&gt;Resultados de la busqueda&lt;/h2&gt;\n        &lt;/header&gt;\n        *&lt;main class=\"contenido\"&gt;\n\n        &lt;/main&gt;*\n        &lt;footer class=\"footer\"&gt;\n            &lt;h4&gt;\n                Gerardo Saucedo Arevalo - 15092087 - Topicos selectos de tecnologias web - B\u00fasqueda de enlaces dentro de\n                una p\u00e1gina web\n            &lt;/h4&gt;\n        &lt;/footer&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>But my code always add the lines at the end of the file, I ran this code once and it worked perfectly, but then I add some lines and when I tried to run one more time didn't work.\nI restored my file at the moment when it worked but it does not work anymore.\nWhat I'm doing wrong?</p>\n"}, {"tags": ["perl", "inheritance", "overriding", "configuration-files"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 6, "creation_date": 1552814483, "post_id": 55205541, "comment_id": 97147371, "body": "Please rethink whether you really want to use configuration files which absolutely beg to be exploited for malicious purposes... This is not about perl, the same would apply to all scripting languages. Even to compiled languages, though &quot;I will compile the user-edited config file and then run execute the result.&quot; is nicely impressivily illustrating the problem I mean..."}, {"owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "edited": false, "score": 3, "creation_date": 1552815463, "post_id": 55205541, "comment_id": 97147607, "body": "You can write configs as regular perl modules and use custom <code>import</code> to get all needed subroutines and variables automatically. For security consider using <code>eval</code> and <a href=\"https://stackoverflow.com/questions/9144902/perl-safe-eval\">stackoverflow.com/questions/9144902/perl-safe-eval</a>"}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1552819182, "post_id": 55205541, "comment_id": 97148475, "body": "See also <a href=\"https://stackoverflow.com/q/30814892/2173773\">How can I export a list of modules with my own module?</a> and <a href=\"https://stackoverflow.com/q/10196634/2173773\">Importing a .pl file</a>"}], "answers": [{"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1552819764, "post_id": 55206159, "comment_id": 97148612, "body": "<code>do &quot;$RealBin&#47;test-conf&quot; or die $@ || $!;</code>"}, {"owner": {"reputation": 604, "user_id": 5087283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0b2d9685f5d796274901ceadf632d4?s=128&d=identicon&r=PG", "display_name": "Metamorphic", "link": "https://stackoverflow.com/users/5087283/metamorphic"}, "edited": false, "score": 0, "creation_date": 1552890153, "post_id": 55206159, "comment_id": 97166220, "body": "And if I put <code>use strict;</code> at the top of <code>test-conf</code>, then it stops working as intended. Nevertheless this seems like a great solution, which I must have overlooked because of a misplaced desire to (eventually) have <code>use strict;</code> in there. Anyway thank you for the very helpful answer. If someone else has a version that uses inheritance or some other method then I&#39;d be glad to see it as well, of course."}, {"owner": {"reputation": 42833, "user_id": 18914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a20a39ae2ef47ae042a3eddd5b5bd19?s=128&d=identicon&r=PG", "display_name": "Dave Sherohman", "link": "https://stackoverflow.com/users/18914/dave-sherohman"}, "reply_to_user": {"reputation": 604, "user_id": 5087283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0b2d9685f5d796274901ceadf632d4?s=128&d=identicon&r=PG", "display_name": "Metamorphic", "link": "https://stackoverflow.com/users/5087283/metamorphic"}, "edited": false, "score": 0, "creation_date": 1552895817, "post_id": 55206159, "comment_id": 97168698, "body": "@Metamorphic - You can fix the <code>strict</code> violation by adding a second <code>our @tables</code> in <code>test-conf</code>, or by fully-qualifying it as <code>@main::tables</code>, but either of those increases the demands on the user creating the conf file, so they may or may not be suitable for your use case."}, {"owner": {"reputation": 604, "user_id": 5087283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0b2d9685f5d796274901ceadf632d4?s=128&d=identicon&r=PG", "display_name": "Metamorphic", "link": "https://stackoverflow.com/users/5087283/metamorphic"}, "edited": false, "score": 1, "creation_date": 1552912421, "post_id": 55206159, "comment_id": 97177787, "body": "I also noticed that I can access the original subroutine definition using a <code>BEGIN</code> statement in <code>test-conf</code>, as in <code>our $old_print_tables; BEGIN{ $old_print_tables = \\&amp;print_tables; }</code>. Seems to work OK...?"}], "tags": [], "owner": {"reputation": 42833, "user_id": 18914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a20a39ae2ef47ae042a3eddd5b5bd19?s=128&d=identicon&r=PG", "display_name": "Dave Sherohman", "link": "https://stackoverflow.com/users/18914/dave-sherohman"}, "is_accepted": true, "score": 3, "last_activity_date": 1552819358, "creation_date": 1552819358, "answer_id": 55206159, "question_id": 55205541, "link": "https://stackoverflow.com/questions/55205541/how-to-use-perl-as-a-language-for-a-configuration-file/55206159#55206159", "title": "How to use Perl as a language for a configuration file?", "body": "<p>Your description of what you want this \"configuration file\" to do (import subs and variables into the caller's namespace, override subs, classes, inheritance...) sounds suspiciously like a standard Perl module.  So use a standard Perl module.</p>\n\n<p>Note that there is widespread precedent for this approach: The standard <code>cpan</code> command-line client stores its configuration in a module, located at the default path of <code>~/.cpan/CPAN/MyConfig.pm</code> on *nix-type systems.  Granted, <code>cpan</code>'s <code>MyConfig.pm</code> is a very simple example which just sets the hashref <code>$CPAN::Config</code>, but there's no reason it couldn't also do all the other things any module does.</p>\n\n<p>But doing it with <code>do</code> is quite simple.  I suspect you're just overthinking it:</p>\n\n<pre><code>$ cat test-override \n#!/usr/bin/perl\n\nuse warnings;\nuse strict;\n\nour @tables = qw(a b c);\n\nsub print_tables {\n   print join(\", \", @tables), \"\\n\";\n};\n\nprint_tables;\n\ndo \"test-conf\";\n\nprint_tables;\n\nprint \"\\@tables is @tables\\n\";\n\n$ cat test-conf \n@tables = qw(d e f);\n\nsub print_tables {\n  print \"print_tables from test_conf\\n\";\n}\n\n$ ./test-override \na, b, c\nprint_tables from test_conf\n@tables is d e f\n</code></pre>\n\n<p>The important change I made with <code>@tables</code> was to change it from <code>my</code>, which is visible only within the current scope <em>and the current file</em>, to <code>our</code>, which is visible anywhere within the same package (or from other packages if it's qualified with the package name).</p>\n\n<p>But my <code>print_tables</code> from the config file doesn't call the original <code>print_tables</code>, and you're just out of luck on that one.  Because there can only be one <code>&amp;main::print_tables</code>, replacing it completely overwrites the original one, which no longer exists.  If you want to be able to override it and still be able to call the original, you need to put the two declarations into different packages, which kind of implies using OO Perl (so that you'll be able to polymorphically call the right one).</p>\n\n<p>Also note that <code>use</code> has the same lexical scoping as <code>my</code>, which means that your <code>use strict; use warnings;</code> does <strong>not</strong> carry over into the conf file.  You can easily demonstrate this by adding a <code>use warnings;</code> to my version of <code>test-conf</code>, at which point it will then generate the warning <code>Subroutine print_tables redefined</code>.</p>\n"}], "owner": {"reputation": 604, "user_id": 5087283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d0b2d9685f5d796274901ceadf632d4?s=128&d=identicon&r=PG", "display_name": "Metamorphic", "link": "https://stackoverflow.com/users/5087283/metamorphic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 55206159, "answer_count": 1, "score": 1, "last_activity_date": 1552819358, "creation_date": 1552814265, "question_id": 55205541, "link": "https://stackoverflow.com/questions/55205541/how-to-use-perl-as-a-language-for-a-configuration-file", "title": "How to use Perl as a language for a configuration file?", "body": "<p>I have an application where I would like to allow users to specify configuration files in Perl.</p>\n\n<p>What I have in mind is similar to how PKGBUILD is used in Arch: it is a Bash script, which is simply <code>source</code>d from the \"makepkg\" tool. It contains variable and function definitions:</p>\n\n<pre><code>pkgbase=somepkg\npkgname=('somepkg')\npkgver=0.0.1\n...\nprepare() {\n    cd \"${srcdir}/${pkgbase}-${pkgver}\"\n    ...\n}\n</code></pre>\n\n<p>I would like to do something like this in Perl. I guess I'm looking for a Perl version of <code>source</code>, which can read a file, evaluate it, and import all the subroutines and variables into the namespace of the caller. With the Bash version, I could conceivably write a PKGBUILD which sources another PKGBUILD and then overrides one or two variables; I want this kind of \"inheritance\" to be possible in my Perl config files as well.</p>\n\n<p>One problem with Perl's <code>do</code> is that it seems to put the file's variables and subroutines into a separate namespace. Also, I can't figure out how to override true subroutines, only named anonymous ones.</p>\n\n<p>Here's a version that may serve to illustrate what I want to do. It is not very elegant, but it demonstrates overriding both subroutines and variables, as well as calling a previously-defined subroutine:</p>\n\n<pre><code>$ cat test-override\n#!/usr/bin/perl\n\nuse warnings;\nuse strict;\n\nmy @tables = qw(a b c);\n\nmy $print_tables = sub {\n   print join(\", \", @tables), \"\\n\";\n};\n\neval(`cat \"test-conf\"`) or die \"$@\";\n\n&amp;$print_tables();\n\n$ cat test-conf\n@tables = qw(d e f);\n\nmy $old_print_tables = $print_tables;\n$print_tables = sub {\n  warn \"In test-conf \\$print_tables\\n\";\n  &amp;$old_print_tables();\n}\n\n$ ./test-override\nIn test-conf $print_tables\nd, e, f\n</code></pre>\n\n<p>Another way to do this would be to let the configuration file return a hash, with data and subroutines as values. There is also the option of using classes and inheritance. However, I want the configuration files to be as light-weight as possible, syntactically.</p>\n\n<p>The documentation for \"do\" mentions the possibility of using Perl in configuration files, so I know this problem has been considered before. Is there a canonical example of how to do it in a \"user-friendly\" manner?</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1552782649, "post_id": 55201510, "comment_id": 97142618, "body": "I thought <code>&#47;$reg&#47;s</code> should just add <code>&#47;&#47;s</code> to the global flags after interpolation. Anyway, `/$_/s&#39; probably works, have you tried it ?"}, {"owner": {"reputation": 1064, "user_id": 1031776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3fed911ae9175eaf6c4e4ec51de7e6ac?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/1031776/will"}, "edited": false, "score": 0, "creation_date": 1552853989, "post_id": 55201510, "comment_id": 97158892, "body": "I presented the question poorly. In the actual code, the regex is user provided and the text to match is the output of <code>xclip -o</code>.  There, I was having a hard time using /$reg/ directly, hence the qr//. <a href=\"https://github.com/WillForan/plum/blob/master/plum\" rel=\"nofollow noreferrer\">github.com/WillForan/plum/blob/master/plum</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1064, "user_id": 1031776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3fed911ae9175eaf6c4e4ec51de7e6ac?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/1031776/will"}, "is_accepted": true, "score": 1, "last_activity_date": 1552770643, "creation_date": 1552770643, "answer_id": 55201511, "question_id": 55201510, "link": "https://stackoverflow.com/questions/55201510/s-for-multiline-for-variable-regular-expression-qr/55201511#55201511", "title": "`/s` for multiline for variable regular expression `qr//`", "body": "<p>the <code>/s</code> single-string option should be provided at <code>qr//</code> not in the <code>=~ //</code> comparison </p>\n\n<pre><code>echo '([/~]\\S+).*?(\\S+)\\s*$' | \n perl -lne '$reg=qr/$_/s;  # &lt; HERE\n            print \"$1/$2\" \n              if \"~/src\\nfind\\nboards.txt\" =~ /$reg/';\n            #                               NOT HERE^\n</code></pre>\n"}], "owner": {"reputation": 1064, "user_id": 1031776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3fed911ae9175eaf6c4e4ec51de7e6ac?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/1031776/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 55201511, "answer_count": 1, "score": 0, "last_activity_date": 1552914837, "creation_date": 1552770643, "question_id": 55201510, "link": "https://stackoverflow.com/questions/55201510/s-for-multiline-for-variable-regular-expression-qr", "title": "`/s` for multiline for variable regular expression `qr//`", "body": "<p>I'm trying to match and extract the first (path like) word and the very last word in a multiline string (text = shell prompt + command + output). I have a working regular expression</p>\n\n<pre><code>perl -le 'print \"$1/$2\" if \"~/src\\nfind\\nboards.txt\" =~ m`([/~]\\S+).*?(\\S+)\\s*$`s'\n# returns expected ~/src/boards.txt\n</code></pre>\n\n<p>(<a href=\"https://regex101.com/r/uB4kN1/4\" rel=\"nofollow noreferrer\">https://regex101.com/r/uB4kN1/4</a> for nicer illustration)</p>\n\n<p>But I run into problems when I try to use a variable regular expression.</p>\n\n<pre><code>echo '([/~]\\S+).*?(\\S+)\\s*$' | \n  perl -lne '$reg=qr/$_/; \n             print \"$1/$2\" if \"~/src\\nfind\\nboards.txt\" =~ /$reg/s';\n</code></pre>\n"}, {"tags": ["perl", "packaging"], "comments": [{"owner": {"reputation": 3704, "user_id": 1564946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ky57j.jpg?s=128&g=1", "display_name": "pevik", "link": "https://stackoverflow.com/users/1564946/pevik"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552817801, "post_id": 55200583, "comment_id": 97148160, "body": "@ikegami No, it&#39;s not in the case of clusterssh (my fork, which changed shebang <a href=\"https://github.com/pevik/clusterssh/tree/system-perl-in-shebang\" rel=\"nofollow noreferrer\">github.com/pevik/clusterssh/tree/system-perl-in-shebang</a>). Can you post reproducible <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 3704, "user_id": 1564946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ky57j.jpg?s=128&g=1", "display_name": "pevik", "link": "https://stackoverflow.com/users/1564946/pevik"}, "edited": false, "score": 0, "creation_date": 1552837444, "post_id": 55208013, "comment_id": 97153671, "body": "Thanks for info! While Debian <a href=\"https://salsa.debian.org/debian/clusterssh/blob/master/debian/rules\" rel=\"nofollow noreferrer\">might not</a> use <code>.&#47;Build install</code>, <a href=\"https://src.fedoraproject.org/cgit/rpms/clusterssh.git/tree/clusterssh.spec#n100\" rel=\"nofollow noreferrer\">Fedora does</a> and <a href=\"https://build.opensuse.org/package/view_file/X11:Utilities/clusterssh/clusterssh.spec?expand=1\" rel=\"nofollow noreferrer\">openSUSE as well</a>. I&#39;ll test whether it&#39;s caused by <code>.&#47;Build install</code> or not."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 3704, "user_id": 1564946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ky57j.jpg?s=128&g=1", "display_name": "pevik", "link": "https://stackoverflow.com/users/1564946/pevik"}, "edited": false, "score": 0, "creation_date": 1552844487, "post_id": 55208013, "comment_id": 97156006, "body": "<code>find bin -type f -exec perl -i -pe&#39;s&#47;^#!\\S*perl\\S*&#47;#!$^X&#47; if $. == 1; close ARGV if eof;&#39; {} +</code>  (Use the <code>perl</code> to use. GNU tools assumed; adjust as necessary)"}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1552844783, "last_edit_date": 1552844783, "creation_date": 1552832144, "answer_id": 55208013, "question_id": 55200583, "link": "https://stackoverflow.com/questions/55200583/specify-shebang-on-project-using-perl-modulebuild/55208013#55208013", "title": "Specify shebang on project using Perl Module::Build", "body": "<p>It's already called during the building process.</p>\n\n<p>Basically, uninstalled scripts should use <code>#!/usr/bin/perl</code> or <code>#!perl</code>, and the installation process should rewrite that to the point to the <code>perl</code> used to run the installer. That way, a script installed by <code>/usr/bin/perl</code> will use <code>/usr/bin/perl</code>, and a script installed using <code>/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl</code> will use <code>/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl</code>.</p>\n\n<p>(This applies to both the Module::Build installer and the ExtUtils::MakeMaker installer.)</p>\n\n<p>Note that the documentation for <code>fix_shebang_line</code> says it doesn't touch a shebang line of <code>#!/usr/bin/env perl</code> (because it's not recognized as invocation of <code>perl</code>), so simply patching the scripts to use <code>#!/usr/bin/perl</code> instead of <code>#!/usr/bin/env perl</code> does the trick.</p>\n\n<p>With that change, the install-ready staging directory (<code>blib</code>) produced by <code>./Build</code> will contain the edited files.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl -e'CORE::say $^X'\n/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\n\n$ for fn in ccon crsh csftp cssh ctel; do printf '%-6s ' \"$fn:\"; head -n 1 \"bin_PL/$fn\"; done\nccon:  #!/usr/bin/perl\ncrsh:  #!/usr/bin/perl\ncsftp: #!/usr/bin/perl\ncssh:  #!/usr/bin/perl\nctel:  #!/usr/bin/perl\n\n$ perl Build.PL\nCould not get valid metadata. Error is: ERROR: Missing required field 'dist_abstract' for metafile\n\nCould not create MYMETA files\nCreating new 'Build' script for 'App-ClusterSSH' version 'v4.13.203'\n\n$ ./Build\nBuilding App-ClusterSSH\nUsing perl binary: /home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\nUsing perl version v5.26.2\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/cssh\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/csftp\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/ccon\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/crsh\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/ctel\nGenerating: /home/ikegami/tmp/clusterssh/bin_PL/clusterssh_bash_completion.dist\n\n$ for fn in ccon crsh csftp cssh ctel; do printf '%-6s ' \"$fn:\"; head -n 1 \"blib/script/$fn\"; done\nccon:  #!/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\ncrsh:  #!/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\ncsftp: #!/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\ncssh:  #!/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\nctel:  #!/home/ikegami/usr/perlbrew/perls/5.26.2t/bin/perl\n</code></pre>\n\n<p>I didn't bother running <code>./Build install</code>, whose main task is to copy the files from the staging directory into their final locations. Besides, that part will need to be replaced by your package manager anyway (assuming you're simply placing the contents of the <code>blib</code> directory into your package).</p>\n\n<hr>\n\n<p>If you somehow need to do it yourself, you could use the following:</p>\n\n<pre><code>find bin -type f \\\n   -exec perl -i -pe'\n      s/^#!\\S*perl\\S*/#!$^X/ if $. == 1;\n      close ARGV if eof;\n   ' {} +\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>Use the <code>perl</code> you wish the scripts to use.</li>\n<li>GNU tools assumed; adjust as necessary.</li>\n<li><code>close ARGV if eof;</code> resets the line number (<code>$.</code>) for each file. </li>\n<li><code>eof</code> is different than <code>eof()</code>, and only the former will work here.</li>\n<li>The line breaks are optional and may be removed.</li>\n</ul>\n"}], "owner": {"reputation": 3704, "user_id": 1564946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ky57j.jpg?s=128&g=1", "display_name": "pevik", "link": "https://stackoverflow.com/users/1564946/pevik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552844783, "creation_date": 1552763698, "question_id": 55200583, "link": "https://stackoverflow.com/questions/55200583/specify-shebang-on-project-using-perl-modulebuild", "title": "Specify shebang on project using Perl Module::Build", "body": "<p>I'm packaging <a href=\"https://github.com/duncs/clusterssh\" rel=\"nofollow noreferrer\">clusterssh</a> to openSUSE and need to change default shebang from <code>#!/usr/bin/env perl</code> to <code>#!/usr/bin/perl</code>. clusterssh uses <a href=\"https://perldoc.perl.org/5.12.2/Module/Build.html\" rel=\"nofollow noreferrer\">Module::Build</a>.</p>\n\n<p>I'll probably use the patch (<a href=\"https://salsa.debian.org/debian/clusterssh/raw/master/debian/patches/perl_shebang.patch\" rel=\"nofollow noreferrer\">as Debian package do</a>), but I wonder easy usage for <a href=\"https://metacpan.org/pod/Module::Build::API#fix_shebang_line(@files)\" rel=\"nofollow noreferrer\"><code>fix_shebang_line(@files)</code></a> in RPM packaging.</p>\n"}, {"tags": ["python", "bash", "perl", "awk", "command-line"], "comments": [{"owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "reply_to_user": {"reputation": 68617, "user_id": 3776858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/juunm.png?s=128&g=1", "display_name": "Cyrus", "link": "https://stackoverflow.com/users/3776858/cyrus"}, "edited": false, "score": 0, "creation_date": 1552736795, "post_id": 55196197, "comment_id": 97130158, "body": "I&#39;m looking for optimizations as I have to process millions of lines"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1552738920, "post_id": 55196197, "comment_id": 97130725, "body": "Could you explain what it is you are trying to measure? I was having a little trouble grokking the intent from reading your bash code."}, {"owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "edited": false, "score": 0, "creation_date": 1552739173, "post_id": 55196197, "comment_id": 97130791, "body": "the input file contains time stamps in column 2 and 3, column 2 is alarm appeared time, and column 3 is alarm cleared time. the function is calculating the difference and determining if the duration is more than 5 minutes it prints yes, else it prints no."}, {"owner": {"reputation": 384453, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1552743209, "post_id": 55196197, "comment_id": 97131978, "body": "Doing <i>anything</i> millions of times means you should be using something other than <code>bash</code>."}, {"owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "reply_to_user": {"reputation": 384453, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1552745055, "post_id": 55196197, "comment_id": 97132507, "body": "@chepner sure, that&#39;s why I tagged awk as well or anything like Perl/python etc... Will do just fine, but am not much used to of them yet!"}], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 8592975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fea54eef1c73000439a2c38b53d422?s=128&d=identicon&r=PG&f=1", "display_name": "ctac_", "link": "https://stackoverflow.com/users/8592975/ctac"}, "edited": false, "score": 1, "creation_date": 1552757551, "post_id": 55197911, "comment_id": 97136466, "body": "I think mktime is time consuming here for huge file. It&#39;s seems it is a log file from a centralized control system. The field AST is always the same (hope for OP), you don&#39;t catch a alarm appear time from USA and alarm cleared time from France. So what can happen ? The year can change 2018 --&gt; 2019 The month can change Sep --&gt; Oct Only this two case must be handle ! After that : {a=$6$7$8;b=$14$15$16;c=(b-a)&gt;300?&quot;,yes&quot;:&quot;,no&quot;;print $0 c} my two cents."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "reply_to_user": {"reputation": 2285, "user_id": 8592975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fea54eef1c73000439a2c38b53d422?s=128&d=identicon&r=PG&f=1", "display_name": "ctac_", "link": "https://stackoverflow.com/users/8592975/ctac"}, "edited": false, "score": 0, "creation_date": 1552757946, "post_id": 55197911, "comment_id": 97136612, "body": "@ctac_ leap days and leap seconds can/do happen."}, {"owner": {"reputation": 2285, "user_id": 8592975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56fea54eef1c73000439a2c38b53d422?s=128&d=identicon&r=PG&f=1", "display_name": "ctac_", "link": "https://stackoverflow.com/users/8592975/ctac"}, "edited": false, "score": 0, "creation_date": 1552758588, "post_id": 55197911, "comment_id": 97136826, "body": "You are right, don&#39;t think of that but I think it&#39; more speed to handle that rather than call 2 times mktime on each line."}, {"owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "edited": false, "score": 1, "creation_date": 1552759054, "post_id": 55197911, "comment_id": 97136938, "body": "Could be, idk. Leap seconds are obviously far more difficult to handle than leap days but maybe the OP doesn&#39;t care about that. A non-mktime() solution would be portable to other awks too. If it turns out to be an issue I expect the OP will post a followup question."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1552760237, "post_id": 55197911, "comment_id": 97137324, "body": "<code>mktime</code> returns an epoch timestamp, which is the number of non-leap seconds since 1970 UTC. This means you&#39;re already ignoring leap seconds. I don&#39;t consider that a problem unless the file can have <code>23:59:60</code>, but that&#39;s unlikely. As for leap days, those are predictable (years divisible by 4 except those divisible by 100, and years divisible by 400)."}], "tags": [], "owner": {"reputation": 155597, "user_id": 1745001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/99a3ebae89496eb16afe453aae97f5be?s=128&d=identicon&r=PG", "display_name": "Ed Morton", "link": "https://stackoverflow.com/users/1745001/ed-morton"}, "is_accepted": true, "score": 3, "last_activity_date": 1552752931, "last_edit_date": 1552752931, "creation_date": 1552746868, "answer_id": 55197911, "question_id": 55196197, "link": "https://stackoverflow.com/questions/55196197/optimized-way-to-calculate-time-duration-in-bash/55197911#55197911", "title": "Optimized way to calculate time duration in BASH", "body": "<p>With GNU awk for time functions, this will be orders of magnitude faster than your shell loop:</p>\n\n<pre><code>$ cat tst.awk\nBEGIN {\n    FS = \"[, :]\"\n    OFS = \",\"\n\n    split(\"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec\",tmp)\n    for (i in tmp) {\n        mth[tmp[i]] = i\n    }\n    maxSecs = 5 * 60\n}\n{\n    begSecs = mktime($10\" \"mth[$4]\" \"$5\" \"$6\" \"$7\" \"$8)\n    endSecs = mktime($18\" \"mth[$12]\" \"$13\" \"$14\" \"$15\" \"$16)\n    print $0, ( (endSecs - begSecs) &gt; maxSecs ? \"yes\" : \"no\" )\n}\n\n$ awk -f tst.awk file\nD00O0:SOURCE3,Mon Oct 01 16:02:35 AST 2018,Mon Oct 01 16:04:19 AST 2018,no\nD00O0:SOURCE3,Mon Oct 08 08:53:17 AST 2018,Mon Oct 08 08:54:57 AST 2018,no\nD00O1:SOURCE3,Mon Oct 15 09:25:14 AST 2018,Mon Oct 15 09:26:59 AST 2018,no\nD00O1:SOURCE3,Mon Oct 15 16:56:58 AST 2018,Mon Oct 15 17:58:41 AST 2018,yes\nD00O1:SOURCE3,Mon Oct 22 08:56:48 AST 2018,Mon Oct 22 09:58:31 AST 2018,yes\nD00O1:SOURCE3,Sat Oct 06 09:17:42 AST 2018,Sat Oct 06 09:19:24 AST 2018,no\nD00O1:SOURCE3,Sat Oct 13 09:11:05 AST 2018,Sat Oct 13 09:12:47 AST 2018,no\nD00O1:SOURCE3,Sat Oct 20 09:51:40 AST 2018,Sat Oct 20 09:53:23 AST 2018,no\nD00O0:SOURCE3,Sat Oct 27 09:15:32 AST 2018,Sat Oct 27 09:17:11 AST 2018,no\nD00O0:SOURCE3,Sat Sep 29 10:05:58 AST 2018,Sat Sep 29 11:07:43 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 14 08:48:57 AST 2018,Sun Oct 14 09:50:43 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 14 16:04:19 AST 2018,Sun Oct 14 16:06:00 AST 2018,no\nD00O0:SOURCE3,Sun Oct 21 06:17:34 AST 2018,Sun Oct 21 06:19:17 AST 2018,no\nD00O0:SOURCE3,Sun Oct 21 16:15:18 AST 2018,Sun Oct 21 17:17:00 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 28 09:39:09 AST 2018,Sun Oct 28 09:40:47 AST 2018,no\n</code></pre>\n\n<p>Look up the man page to see which time zone it's using vs the time zone specified in your input file and how to adjust that if necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552751921, "post_id": 55198340, "comment_id": 97134771, "body": "Note that this also works correctly if all timestamps are in AST."}, {"owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "edited": false, "score": 0, "creation_date": 1552753809, "post_id": 55198340, "comment_id": 97135383, "body": "DateTime::Format::Strptime module comes built-in with perl or I have to install it? I am seeing this error when running your code: <code>Can&#39;t locate DateTime&#47;Format&#47;Strptime.pm in @INC (you may need to install the DateTime::Format::Strptime module) </code>"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "edited": false, "score": 1, "creation_date": 1552755025, "post_id": 55198340, "comment_id": 97135750, "body": "It needs to be installed. Your package manager should have it. This won&#39;t be as fast. DateTime in particular is a rather heavy --but extremely capable-- module"}, {"owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "edited": false, "score": 0, "creation_date": 1552760713, "post_id": 55198340, "comment_id": 97137473, "body": "you mentioned earlier that there are faster perl solutions available, won&#39;t they be as accurate?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "edited": false, "score": 1, "creation_date": 1552762266, "post_id": 55198340, "comment_id": 97137912, "body": "They would be. I just worked with that with which I&#39;m familiar. My priority was providing a <i>correct</i> solution."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 1, "last_activity_date": 1552750170, "last_edit_date": 1552750170, "creation_date": 1552749557, "answer_id": 55198340, "question_id": 55196197, "link": "https://stackoverflow.com/questions/55196197/optimized-way-to-calculate-time-duration-in-bash/55198340#55198340", "title": "Optimized way to calculate time duration in BASH", "body": "<p>Assumptions:</p>\n\n<ul>\n<li>\"AST\" and \"ADT\" are the only two time zones that can be encountered.</li>\n<li>\"AST\" refers to UTC-4.</li>\n<li>\"ADT\" refers to UTC-3.</li>\n<li>The file is a CSV file.</li>\n</ul>\n\n<p>The solution below has the following features:</p>\n\n<ul>\n<li>It correctly handles events near DST changes.</li>\n<li>It correctly parses a CSV file.</li>\n<li>It correctly generates a CSV file.</li>\n</ul>\n\n<p>None of the existing solutions (including your own) can claim to have the first two features.</p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\nuse warnings;\nuse feature qw( state );\n\nuse DateTime::Format::Strptime qw( );\nuse Text::CSV_XS               qw( );\n\nsub parse_dt_str {\n   my ($dt_str) = @_;\n\n   state $format = DateTime::Format::Strptime-&gt;new(\n      pattern =&gt; \"%a %b %d %H:%M:%S %z %Y\",\n      locale  =&gt; \"en\",\n   );\n\n   $dt_str =~ s/\\b(AST|ADT)\\b/ $1 eq \"AST\" ? \"-0400\" : \"-0300\" /e;\n   return $format-&gt;parse_datetime($dt_str);\n}\n\nmy $csv = Text::CSV_XS-&gt;new({ auto_diag =&gt; 2, binary =&gt; 1, quote_space =&gt; 0 });\nwhile ( my $row = $csv-&gt;getline(\\*ARGV) ) {\n   my $dt1 = parse_dt_str($row-&gt;[1]);\n   my $dt2 = parse_dt_str($row-&gt;[2]);\n   if ($dt1 &amp;&amp; $dt2) {\n      $row-&gt;[3] = $dt2-&gt;epoch - $dt1-&gt;epoch &gt; 5*60 ? \"yes\" : \"no\";\n   } else {\n      $row-&gt;[3] = \"???\";\n   }\n\n   $csv-&gt;say(\\*STDOUT, $row);\n}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 7347387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdedc88a18b2727c53e8ec1bdcc4eba3?s=128&d=identicon&r=PG&f=1", "display_name": "Ibraheem", "link": "https://stackoverflow.com/users/7347387/ibraheem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 55197911, "answer_count": 2, "score": 1, "last_activity_date": 1552752931, "creation_date": 1552735449, "last_edit_date": 1552745492, "question_id": 55196197, "link": "https://stackoverflow.com/questions/55196197/optimized-way-to-calculate-time-duration-in-bash", "title": "Optimized way to calculate time duration in BASH", "body": "<p>I am using below function that I wrote in BASH to calculate time duration and decide if the duration is more than 5 minutes it returns yes,otherwise no. It is working as expected but the files I am processing are huge (millions of lines) and it takes very long time to finish the job. I am looking for some optimized way to do it. </p>\n\n<pre><code>datediff() {\nd2=$(date -d \"$2\" +%s)\nd1=$(date -d \"$3\" +%s)\nsecs=$((d1 - d2))\nimpacted=\"no\"\nif [ $(($secs / 300 )) -gt 0 ]\n  then\n  impacted=\"yes\"\nfi\nprintf \"%s\\n\" \"$impacted\"\n}\n</code></pre>\n\n<p>I am calling this function in a while loop which is reading the input file line by line.</p>\n\n<pre><code>while IFS=',' read -r line;\ndo\n   IFS=',' read source almapear almclear &lt;&lt;&lt; \"$line\"\n   echo $line, $(datediff $source \"$almapear\" \"$almclear\")\ndone &lt; \"$1\" | tee -a output_$1\n</code></pre>\n\n<p>Below is sample input file, which contains source name, alarm appear time and then alarm cleared time:</p>\n\n<pre><code>D00O0:SOURCE3,Mon Oct 01 16:02:35 AST 2018,Mon Oct 01 16:04:19 AST 2018\nD00O0:SOURCE3,Mon Oct 08 08:53:17 AST 2018,Mon Oct 08 08:54:57 AST 2018\nD00O1:SOURCE3,Mon Oct 15 09:25:14 AST 2018,Mon Oct 15 09:26:59 AST 2018\nD00O1:SOURCE3,Mon Oct 15 16:56:58 AST 2018,Mon Oct 15 17:58:41 AST 2018\nD00O1:SOURCE3,Mon Oct 22 08:56:48 AST 2018,Mon Oct 22 09:58:31 AST 2018\nD00O1:SOURCE3,Sat Oct 06 09:17:42 AST 2018,Sat Oct 06 09:19:24 AST 2018\nD00O1:SOURCE3,Sat Oct 13 09:11:05 AST 2018,Sat Oct 13 09:12:47 AST 2018\nD00O1:SOURCE3,Sat Oct 20 09:51:40 AST 2018,Sat Oct 20 09:53:23 AST 2018\nD00O0:SOURCE3,Sat Oct 27 09:15:32 AST 2018,Sat Oct 27 09:17:11 AST 2018\nD00O0:SOURCE3,Sat Sep 29 10:05:58 AST 2018,Sat Sep 29 11:07:43 AST 2018\nD00O0:SOURCE3,Sun Oct 14 08:48:57 AST 2018,Sun Oct 14 09:50:43 AST 2018\nD00O0:SOURCE3,Sun Oct 14 16:04:19 AST 2018,Sun Oct 14 16:06:00 AST 2018\nD00O0:SOURCE3,Sun Oct 21 06:17:34 AST 2018,Sun Oct 21 06:19:17 AST 2018\nD00O0:SOURCE3,Sun Oct 21 16:15:18 AST 2018,Sun Oct 21 17:17:00 AST 2018\nD00O0:SOURCE3,Sun Oct 28 09:39:09 AST 2018,Sun Oct 28 09:40:47 AST 2018\n</code></pre>\n\n<p>Below is the required output:</p>\n\n<pre><code>D00O0:SOURCE3,Mon Oct 01 16:02:35 AST 2018,Mon Oct 01 16:04:19 AST 2018,no\nD00O0:SOURCE3,Mon Oct 08 08:53:17 AST 2018,Mon Oct 08 08:54:57 AST 2018,no\nD00O1:SOURCE3,Mon Oct 15 09:25:14 AST 2018,Mon Oct 15 09:26:59 AST 2018,no\nD00O1:SOURCE3,Mon Oct 15 16:56:58 AST 2018,Mon Oct 15 17:58:41 AST 2018,yes\nD00O1:SOURCE3,Mon Oct 22 08:56:48 AST 2018,Mon Oct 22 09:58:31 AST 2018,yes\nD00O1:SOURCE3,Sat Oct 06 09:17:42 AST 2018,Sat Oct 06 09:19:24 AST 2018,no\nD00O1:SOURCE3,Sat Oct 13 09:11:05 AST 2018,Sat Oct 13 09:12:47 AST 2018,no\nD00O1:SOURCE3,Sat Oct 20 09:51:40 AST 2018,Sat Oct 20 09:53:23 AST 2018,no\nD00O0:SOURCE3,Sat Oct 27 09:15:32 AST 2018,Sat Oct 27 09:17:11 AST 2018,no\nD00O0:SOURCE3,Sat Sep 29 10:05:58 AST 2018,Sat Sep 29 11:07:43 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 14 08:48:57 AST 2018,Sun Oct 14 09:50:43 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 14 16:04:19 AST 2018,Sun Oct 14 16:06:00 AST 2018,no\nD00O0:SOURCE3,Sun Oct 21 06:17:34 AST 2018,Sun Oct 21 06:19:17 AST 2018,no\nD00O0:SOURCE3,Sun Oct 21 16:15:18 AST 2018,Sun Oct 21 17:17:00 AST 2018,yes\nD00O0:SOURCE3,Sun Oct 28 09:39:09 AST 2018,Sun Oct 28 09:40:47 AST 2018,no\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1552695498, "post_id": 55191931, "comment_id": 97122795, "body": "To loop over the indicies of @number, <code>foreach $counter (0..$#number)</code>.  What you have is aliasing $counter to each element in @number in turn (which would work if you used just $counter instead of $numbers[$counter] everywhere in your loop body)"}, {"owner": {"reputation": 21, "user_id": 11211035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f8ac7daec66455661adfbbd6d89a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/11211035/greg"}, "reply_to_user": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1552724491, "post_id": 55191931, "comment_id": 97127295, "body": "Thank you @Dillon. Using foreach <code>foreach $counter (0..$#numbers)</code> solved the problem."}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1552724616, "post_id": 55191931, "comment_id": 97127320, "body": "You may have tagged the wrong person- I merely edited your post for formatting. I think you meant to tag @ysth"}], "answers": [{"comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 2, "creation_date": 1552695624, "post_id": 55192054, "comment_id": 97122817, "body": "or just <code>$sum = List::Util::sum grep $_ % 3 == 0 || $_ % 5 == 0, 1..999</code>"}, {"owner": {"reputation": 21, "user_id": 11211035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f8ac7daec66455661adfbbd6d89a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/11211035/greg"}, "edited": false, "score": 0, "creation_date": 1552726322, "post_id": 55192054, "comment_id": 97127641, "body": "Thank you @Stefan. Much nicer solution than mine. And finally I understand why I had <code>undef</code> in the last element. Much appreciated!"}], "tags": [], "owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "is_accepted": false, "score": 3, "last_activity_date": 1552694998, "last_edit_date": 1552694998, "creation_date": 1552693943, "answer_id": 55192054, "question_id": 55191931, "link": "https://stackoverflow.com/questions/55191931/need-to-use-pop-function-twice-to-remove-last-element-from-the-array-perl/55192054#55192054", "title": "need to use pop function twice to remove last element from the array (perl)", "body": "<p>Let's go through your code:</p>\n\n<ul>\n<li><code>@numbers</code> is an array with the numbers from 1 to 1000\n\n<ul>\n<li>Why do you include 1000 in the list when the exercise says \"less than N\"?</li>\n</ul></li>\n<li>the for loop\n\n<ul>\n<li>assigns each of the numbers to <code>$counter</code>, i.e. 1, 2, ...</li>\n<li>you use <code>$counter</code> as index into <code>@numbers</code>\n\n<ul>\n<li>why do you do that when <code>$counter</code> is already the number you are looking for?</li>\n<li>Perl arrays start at index 0, so you have an off-by-one error</li>\n<li>you never check <code>1</code> because your first number will be <code>$numbers[1] == 2</code> (OK, doesn't cause an incorrect result for the task at hand...)</li>\n<li>you access one element <em>behind</em> the array, i.e. <code>$numbers[1000] == undef</code></li>\n</ul></li>\n<li>calculating with <code>undef</code> will cause a warning</li>\n<li><code>undef % 3 == 0</code> is true, hence...</li>\n</ul></li>\n<li>the first <code>pop()</code> will remove <code>undef</code> (from <code>$counter == 1000</code>)</li>\n<li>the second <code>pop()</code> will remove <code>1000</code> (from <code>$counter == 999</code>)</li>\n<li>then you use <code>eval</code> on a string <code>3 + 5 + 6 + ...</code> a very inefficient way to do a sum :-)</li>\n</ul>\n\n<hr>\n\n<p>Wouldn't it be just a simpler approach to calculate the sum while running over the numbers from 1 to N-1? F.ex.:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nforeach my $arg (@ARGV) {\n    my $sum = 0;\n\n    foreach my $number (1..$arg - 1) {\n        $sum += $number\n            if ($number % 3 == 0) || ($number % 5 == 0);\n    }\n\n    print \"${arg}: ${sum}\\n\";\n}\n\nexit 0;\n</code></pre>\n\n<p>Test run:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ perl dummy.pl 10 100 1000 10000\n10: 23\n100: 2318\n1000: 233168\n10000: 23331668\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11211035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f8ac7daec66455661adfbbd6d89a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/11211035/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552697481, "creation_date": 1552692882, "last_edit_date": 1552697481, "question_id": 55191931, "link": "https://stackoverflow.com/questions/55191931/need-to-use-pop-function-twice-to-remove-last-element-from-the-array-perl", "title": "need to use pop function twice to remove last element from the array (perl)", "body": "<p>I've just started to learn Perl and joined Euler project to practice coding. This is the first exercise I did. The task was: \"If we list all the natural numbers below 10 that are multiples of 3 or 5, we get 3, 5, 6 and 9. The sum of these multiples is 23. Find the sum of all the multiples of 3 or 5 below 1000.\" My solution:</p>\n\n<pre><code>use strict;\nuse warnings;\n\nmy @numbers = (1..1000);\nmy $counter = 0;\nmy @all_array = ();\nmy $total = 0;\n\nforeach $counter (@numbers) {\n    if (($numbers[$counter] % 3 == 0) or ($numbers[$counter] % 5 == 0)) {\n        push (@all_array, $numbers[$counter]);\n    }\n}\n\npop (@all_array);    #after that the last digit is still in place\npop (@all_array);    # only now the number 1000 is removed\n\nmy $tot = eval join '+', @all_array;      #returns correct value\nprint $tot;\n</code></pre>\n\n<p>The final element of the array is 1000. It seems as if it is followed by a space so to remove the number and get the correct result I have to use the pop function twice. The use of local $\"='' changes nothing. Besides, I'm getting a message: Use of uninitialized value within @numbers in modulus (%) at C:\\Users\\Greg\\Documents\\perl\\unt.pl line 10.\nWhat am I doing wrong and how to fix it?</p>\n"}, {"tags": ["perl", "for-loop", "count", "substr"], "comments": [{"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1552688687, "post_id": 55191323, "comment_id": 97121210, "body": "can&#39;t imagine what <code>if ($pos = $ms..($ms + $width))</code> is trying to do.  can you explain?"}, {"owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "reply_to_user": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "edited": false, "score": 0, "creation_date": 1552688978, "post_id": 55191323, "comment_id": 97121291, "body": "I want to separate the counts from within the motif from the background. The $ms (motif start) to ($ms+$width) is the location of the motif."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1552689225, "post_id": 55191426, "comment_id": 97121363, "body": "You&#39;re right. Unfortunately, I still get the empty string error when I correct this."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "reply_to_user": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1552690118, "post_id": 55191426, "comment_id": 97121602, "body": "Added to answer"}, {"owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1552690645, "post_id": 55191426, "comment_id": 97121720, "body": "That makes more sense. I&#39;m still getting the warning (I guess I shouldn&#39;t be calling it an error), and the loop only runs once after changing that piece."}, {"owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "reply_to_user": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1552693297, "post_id": 55191426, "comment_id": 97122342, "body": "Added a couple more problems."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552723966, "post_id": 55191426, "comment_id": 97127189, "body": "In addition to @ysth&#39;s fixes, you should be using hashes instead of whole bunches of similarly named variables, as seen <a href=\"https://pastebin.com/Kv3LmVkz\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "edited": false, "score": 0, "creation_date": 1552757006, "post_id": 55191426, "comment_id": 97136301, "body": "Combining all of these fixes was successful!"}], "tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": true, "score": 3, "last_activity_date": 1552693312, "last_edit_date": 1552693312, "creation_date": 1552688789, "answer_id": 55191426, "question_id": 55191323, "link": "https://stackoverflow.com/questions/55191323/for-loop-only-runs-once-perl-argument-isnt-numeric-in-substr/55191426#55191426", "title": "for loop only runs once PERL, Argument &quot;&quot; isn&#39;t numeric in substr", "body": "<p>This:</p>\n\n<pre><code>for (my $pos = 0..length($dna))\n{\n    my $base = substr($dna, $pos, 1);\n</code></pre>\n\n<p>probably is meant to be <code>0..length($dna)-1</code> instead?</p>\n\n<p>When $pos is the length, the substring is going to be an empty string.</p>\n\n<p>And that's not the proper syntax for a for loop iterating over a range.  It should be</p>\n\n<pre><code>for my $pos (0..length($dna)-1)\n</code></pre>\n\n<p>This:</p>\n\n<pre><code>if ($pos = $ms..($ms + $width))\n</code></pre>\n\n<p>if I understand correctly should be</p>\n\n<pre><code>if ($pos &gt;= $ms &amp;&amp; $pos &lt; $ms + $width)\n</code></pre>\n\n<p>What you have is assigning to $pos the result of a flipflop operation, which is not going to be anything useful.</p>\n\n<p>It looks like this:</p>\n\n<pre><code>my $ms = int(rand(((length($dna)+1)-$width)));\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>my $ms = int(rand(((length($dna))-$width)));\n</code></pre>\n\n<p>E.g. if the $dna length is 10 and width is 3, you want the possible starting offsets to be 0 through 7, not 0 through 8.</p>\n\n<p>And it looks like your counting within the motif should be using the position within the motif, not $pos; this:</p>\n\n<pre><code>            $motA[$pos] = $motA[$pos] + 1;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>            $motA[$pos-$ms] = $motA[$pos-$ms] + 1;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11106342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac62339ecde321913200cd20f836fd2b?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/11106342/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55191426, "answer_count": 1, "score": 0, "last_activity_date": 1552723877, "creation_date": 1552688220, "last_edit_date": 1552695613, "question_id": 55191323, "link": "https://stackoverflow.com/questions/55191323/for-loop-only-runs-once-perl-argument-isnt-numeric-in-substr", "title": "for loop only runs once PERL, Argument &quot;&quot; isn&#39;t numeric in substr", "body": "<p>I have a for loop with nested if, else, and elsif statements within. The for loop runs correctly, but it only runs once for some reason. I am looking to count the A's, C's, G's, and T's in a sequence, but I want to count them in two groups - a motif group and a background group. The motif group counts need to be position specific while the background counts do not. </p>\n\n<p>Here is what is contained in my .dna file (a .txt would work fine):\nAGGCT</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>use strict;\nuse warnings;\n\n#Upload sequence\nprint \"Please enter the filename of the first sequence data: \";\nmy $filename1 = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $filename1;\n\n#Open the file and ignore comment lines\nopen (FILE, '&lt;', $filename1) or die \"Cannot open $filename1.\",$!;\nmy $dna;\nfor (&lt;FILE&gt;)\n{\n    next if /^#/;\n    next if /^&gt;/;\n    $dna .= $_;\n}\nclose FILE;\n\n#Remove white spaces \n$dna =~ s/[\\s\\d]//g;\n$dna =~ /./g;\n\n#User specifies motif width\nprint \"Please enter the motif width:\\n\";\nmy $width = &lt;STDIN&gt;;\n\n#Remove newline from file\nchomp $width;\n#Omitting code for non-negative widths to keep this shorter\n\n#Initialize counts and arrays for motif positions\nmy @motA;\nmy @motC;\nmy @motG;\nmy @motT;\n\n#Define length of motif arrays per width\nfor(0..($width-1))\n{\n    $motA[$_] = 0;\n    $motC[$_] = 0;\n    $motG[$_] = 0;\n    $motT[$_] = 0;\n}\n\n#Initialize background counts\nmy $bgA = 0;\nmy $bgC = 0;\nmy $bgG = 0;\nmy $bgT = 0;\n\n#Generate random start site in the sequence\n#for motif to start from\nmy $ms = int(rand(((length($dna)+1)-$width)));\n\n#Within a motif, count the bases at the positions\nfor (my $pos = 0..(length($dna)-1))\n{\n    my $base = substr($dna, $pos, 1);\n\n    if ($pos = $ms..($ms + $width))\n    {\n        #Add to motif counts    \n        if($base eq 'A')\n        {\n            $motA[$pos-$ms] = $motA[$pos-$ms] + 1;\n        }\n        elsif($base eq 'C')\n        {\n            $motC[$pos-$ms] = $motC[$pos-$ms] + 1;\n        }\n        elsif($base eq 'G')\n        {\n            $motG[$pos-$ms] = $motG[$pos-$ms] + 1;\n        }\n        elsif($base eq 'T')\n        {\n            $motT[$pos-$ms] = $motT[$pos-$ms] + 1;\n        }\n    }\n    else\n    {\n        #Create background counts\n        if ($base eq 'A')\n        {\n            $bgA = $bgA + 1;\n        }\n        elsif ($base eq 'C')\n        {\n            $bgC = $bgC + 1;\n        }\n        elsif ($base eq 'G')\n        {\n            $bgG = $bgG + 1;\n        }\n        elsif ($base eq 'T')\n        {\n            $bgT = $bgT + 1;\n        }\n    }\n}\nprint \"A @motA\\nC @motC\\nG @motG\\nT @motT\\n\\n\";\n\nprint \"bgA = $bgA\\n\nbgC = $bgC\\n\nbgG = $bgG\\n\nbgT = $bgT\";\n</code></pre>\n\n<p>The output looks like this:</p>\n\n<pre><code>Please enter the filename of the first sequence data: sample.dna\nPlease enter the motif width:\n3\nArgument \"\" isn't numeric in substr at line 62, &lt;STDIN&gt; line2.\nA 0 1 0\nC 0 0 0\nG 0 0 0\nT 0 0 0\n\nbgA = 0\nbgC = 0\nbgG = 0\nbgT = 0\n</code></pre>\n\n<p>I know that this is most likely because my $dna or $pos in the line with substr contains the \"\" (empty string?), but I am unsure how to solve this problem. I thought the initialization of $pos took care of that, but that's why I want to ask the masters to see what to do. I THINK that this will solve the for loop problem as well. As always, any and all help is useful. I appreciate it in advance!</p>\n"}, {"tags": ["perl", "ssl", "mariadb", "dbi"], "owner": {"reputation": 881, "user_id": 4452550, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0cffbe865edc0097799ecb052a1be842?s=128&d=identicon&r=PG&f=1", "display_name": "user52366", "link": "https://stackoverflow.com/users/4452550/user52366"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 514, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552680487, "creation_date": 1552680487, "question_id": 55189991, "link": "https://stackoverflow.com/questions/55189991/ssl-connection-works-with-mysql-client-but-not-perl-dbimariadb", "title": "SSL connection works with mysql client but not perl DBI:MariaDB", "body": "<p>I have a MariaDB server set up with self-signed certificates to connect using TLS. This works when I connect with the corresponding client</p>\n\n<pre><code>$ mysql -u xxxx -h xx.xx.xx.xx -p \n\\s shows:\nmysql  Ver 15.1 Distrib 10.1.37-MariaDB, for debian-linux-gnu (x86_64)     \nSSL:   Cipher in use is DHE-RSA-AES256-SHA\n</code></pre>\n\n<p>The .my.cnf contains:</p>\n\n<pre><code>$ cat ~/.my.cnf \n[client]\nssl-cert=/---path-deleted---/client-cert.pem\nssl-key=/---path-deleted---/client-key.pem\n</code></pre>\n\n<p>Problem: I don't manage to connect from a Perl script with these settings. Without SSL, the script works. As soon as I enable SSL in the script (and enforce it on the server), I get:</p>\n\n<pre><code>failed: SSL connection error: ASN: bad other signature confirmation\n</code></pre>\n\n<p>When I check the certificates with openssl, I get</p>\n\n<pre><code>$ openssl verify ca-cert.pem client-cert.pem server-cert.pem \n\nerror 18 at 0 depth lookup: self signed certificate\n</code></pre>\n\n<p>The certificates are indeed self-signed, and I want to keep it that way.</p>\n\n<p>If I use \"mariadb_ssl_verify_server_cert=0\", I get</p>\n\n<pre><code>failed: SSL connection error: Enforcing SSL encryption is not supported without mariadb_ssl_verify_server_cert=1\n</code></pre>\n\n<p>What do I need to change to have a TLS-connection working from Perl? </p>\n\n<p>I copy the lines of code I have in my connect sub for reference. A very similar code used to work on an older system with mysql (not mariadb), using just mysql_ssl=1 IIRC:</p>\n\n<pre><code>$self-&gt;{dsn} = \"DBI:MariaDB:database=$database;host=$db_host;mariadb_ssl=1;\".\n    \"mariadb_ssl_verify_server_cert=1;\".\n    \"mariadb_ssl_ca_file=/---path---/ca-key.pem;\".\n    \"mariadb_ssl_client_key=/---path---/client-key.pem;\".\n    \"mariadb_ssl_client_cert=/---path---/client-cert.pem\";\n$self-&gt;{dbh} = DBI-&gt;connect($self-&gt;{dsn}, $db_user, $db_passwd,\n            {'RaiseError' =&gt; 1, 'PrintError' =&gt; 1, AutoCommit =&gt; 1});\n</code></pre>\n"}, {"tags": ["html", "perl"], "comments": [{"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1552654300, "post_id": 55183008, "comment_id": 97103895, "body": "Where do you populate $installfinish? Do you use plain CGI or something else?"}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "edited": false, "score": 2, "creation_date": 1552668217, "post_id": 55183008, "comment_id": 97112360, "body": "I think you need to make yourself a lot clearer. Please show us an example of exactly the output you want to get."}, {"owner": {"reputation": 3649, "user_id": 10404329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/489c51b790b37922d4e80d59b9873cec?s=128&d=identicon&r=PG", "display_name": "Corion", "link": "https://stackoverflow.com/users/10404329/corion"}, "edited": false, "score": 2, "creation_date": 1552722746, "post_id": 55183008, "comment_id": 97126956, "body": "Don&#39;t print the table if you don&#39;t know whether you want the table. Move the printing of the table into the <code>else</code> branch of the <code>if( $installfinish )</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11208636, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117234034980575/picture?type=large", "display_name": "Croitoru Andrei", "link": "https://stackoverflow.com/users/11208636/croitoru-andrei"}, "edited": false, "score": 0, "creation_date": 1552767011, "post_id": 55200922, "comment_id": 97139212, "body": "thank you but i need to replace it instant after the process is finished not when i click on finish"}], "tags": [], "owner": {"reputation": 1, "user_id": 11169554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c94f078f4096d8831a0617e700c95397?s=128&d=identicon&r=PG", "display_name": "binsh", "link": "https://stackoverflow.com/users/11169554/binsh"}, "is_accepted": false, "score": -1, "last_activity_date": 1552766334, "creation_date": 1552766334, "answer_id": 55200922, "question_id": 55183008, "link": "https://stackoverflow.com/questions/55183008/how-to-replace-html-table-with-perl-button/55200922#55200922", "title": "How to replace html table with Perl Button", "body": "<p>I think it is more of a JS/HTML question. Here is my suggestion.</p>\n\n<pre><code>print &lt;&lt;EOF;\n&lt;script&gt;\nvar replacement = \"&lt;p&gt;This is a replacement&lt;/p&gt;\";\n&lt;/script&gt;\n&lt;input type=submit value='Finish' onClick='document.getElementById(\"tabel\").innerHTML = replacement;'&gt;\n\nEOF\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11208636, "user_type": "registered", "profile_image": "https://graph.facebook.com/2117234034980575/picture?type=large", "display_name": "Croitoru Andrei", "link": "https://stackoverflow.com/users/11208636/croitoru-andrei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552766334, "creation_date": 1552654108, "last_edit_date": 1552656739, "question_id": 55183008, "link": "https://stackoverflow.com/questions/55183008/how-to-replace-html-table-with-perl-button", "title": "How to replace html table with Perl Button", "body": "<p>Hello everyone i am new to Perl and scripting and i have this code:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>print &lt;&lt; \"_END_HTML1_\";\n&lt;div id=\"tabel\"&gt;\n&lt;table style=\"width:10%\"&gt;\n  &lt;tr&gt;\n    &lt;th&gt;&lt;input type=button value=\"Stop\" onclick=\"document.getElementById('dostop').value='ON'; document.getElementById('formHiddenValues').submit();\"/&gt;&lt;/th&gt;\n    &lt;th&gt;&lt;input type=submit value=\"Refresh\" &gt;&lt;/th&gt; \n  &lt;/tr&gt;\n&lt;/table&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;i&gt;This window will be automatically refreshed after 10 seconds ...&lt;/i&gt;&lt;/p&gt;\n_END_HTML1_\n\nsystem(\"cat /srv/www/htdocs/wwwrun-rw/$targetSystem-install_progress.txt 2&gt;/dev/null\");\n\nprint \"&lt;/pre&gt;\\n\";\nif ( \"$installfinish\" eq \"1\" ) {\n    $Params{'currentstep'} = 4;\n    print \"&lt;p&gt;Press Finish to acknowledge the operation result and reset the system state to IDLE.&lt;/p&gt;\";\n    print \"&lt;input type=submit value='Finish' &gt;\\n\";\n }\n</code></pre>\n\n<p>Can anyone show me how to replace that html table, all of it with that 'Finish' button?</p>\n"}, {"tags": ["linux", "perl", "awk", "ssh", "sed"], "comments": [{"owner": {"reputation": 6955, "user_id": 6136214, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0385d5a1c27a6707139e7dc7ad29b6d6?s=128&d=identicon&r=PG&f=1", "display_name": "agc", "link": "https://stackoverflow.com/users/6136214/agc"}, "edited": false, "score": 0, "creation_date": 1552655603, "post_id": 55180243, "comment_id": 97104747, "body": "If one exists, please show an example of a relevant <b><i>in</i></b><i>&quot;elegant <code>awk</code> or <code>sed</code> one-liner&quot;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 314813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217becc9db6667a21f7ee839e6f3767?s=128&d=identicon&r=PG", "display_name": "d2xdt2", "link": "https://stackoverflow.com/users/314813/d2xdt2"}, "is_accepted": true, "score": 1, "last_activity_date": 1552660895, "creation_date": 1552660895, "answer_id": 55185081, "question_id": 55180243, "link": "https://stackoverflow.com/questions/55180243/how-can-i-add-replace-a-command-to-the-end-of-an-ssh-public-key-from-script/55185081#55185081", "title": "How can I add/replace a command to the end of an SSH public key from script?", "body": "<pre><code>#!/usr/bin/perl\n\nuse File::Slurp;\nmy $fqdn = $ARGV[0];\nmy $k = read_file(\"$ARGV[1]\");\nmy @m = split / /, $k;\nmy $c = 'command=\"cd /tank/borg/repos/FQDN; borg serve --restrict-to-path /tank/borg/repos/FQDN\",restrict TYPE KEY';\n\n$c =~ s/FQDN/$fqdn/g;\n$c =~ s/TYPE/$m[0]/g;\n$c =~ s/KEY/$m[1]/g;\n\nprint $c;\n</code></pre>\n\n<p>Forced commands are first in the file, not last.</p>\n"}], "owner": {"reputation": 22388, "user_id": 256439, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/c4b17df9c9b2f33a96eb84f92054f708?s=128&d=identicon&r=PG", "display_name": "Sandra Schlichting", "link": "https://stackoverflow.com/users/256439/sandra-schlichting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 3, "accepted_answer_id": 55185081, "answer_count": 1, "score": 0, "last_activity_date": 1583348192, "creation_date": 1552644844, "last_edit_date": 1583348192, "question_id": 55180243, "link": "https://stackoverflow.com/questions/55180243/how-can-i-add-replace-a-command-to-the-end-of-an-ssh-public-key-from-script", "title": "How can I add/replace a command to the end of an SSH public key from script?", "body": "<p>When restricting which commands an SSH public key may give access to, one would add <code>command=\"something\"</code> at the end of the SSH public key in <code>.ssh/authorized_keys</code>.</p>\n\n<p>In my case, I want to write a Bash script that creates <a href=\"https://borgbackup.readthedocs.io/en/stable/deployment/central-backup-server.html#\" rel=\"nofollow noreferrer\">Borg repositories</a>, and each public key needs to have a restriction such as this</p>\n\n<pre><code>command=\"cd /home/backup/repos/&lt;client fqdn&gt;;\n         borg serve --restrict-to-path /home/backup/repos/&lt;client fqdn&gt;\",\n         restrict &lt;keytype&gt; &lt;key&gt; &lt;host&gt;\n</code></pre>\n\n<p><strong>Question</strong></p>\n\n<p>Is there an official way to do this instead of writing an <code>awk</code> or <code>sed</code> one-liner?</p>\n\n<p>Or is there just an <code>awk</code> or <code>sed</code> solution that is so beautiful, that there isn't a need to an official supported way?</p>\n"}, {"tags": ["string", "perl"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1552640522, "post_id": 55178834, "comment_id": 97095674, "body": "Are you aware of functions like <code>push</code> and <code>unshift</code> for adding elements to the ends of  arrrays? Be a lot simpler... Also, obligatory you&#39;re missing an minimal <b>complete</b> example... <i>I get the line printed ...</i> Where&#39;s that code?"}, {"owner": {"reputation": 198290, "user_id": 1030675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957956ce51706d03f19a4dc85a767bb1?s=128&d=identicon&r=PG", "display_name": "choroba", "link": "https://stackoverflow.com/users/1030675/choroba"}, "edited": false, "score": 0, "creation_date": 1552640615, "post_id": 55178834, "comment_id": 97095740, "body": "Your code doesn&#39;t print any lines. Please share the actual code."}, {"owner": {"reputation": 197, "user_id": 9965855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07fe94a03fb6a97722213a1f40110657?s=128&d=identicon&r=PG&f=1", "display_name": "SLP", "link": "https://stackoverflow.com/users/9965855/slp"}, "edited": false, "score": 0, "creation_date": 1552641177, "post_id": 55178834, "comment_id": 97096030, "body": "The actual code is in the edit"}], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 3, "last_activity_date": 1552641364, "creation_date": 1552641364, "answer_id": 55179140, "question_id": 55178834, "link": "https://stackoverflow.com/questions/55178834/problem-when-trying-to-open-txt-file-with-and/55179140#55179140", "title": "Problem when trying to open txt file with &quot;[&quot; and &quot;]&quot;", "body": "<pre><code>while (my $row = &lt;@lines&gt;) {\n</code></pre>\n\n<p>means</p>\n\n<pre><code>while (my $row = glob(qq&lt;@lines&gt;)) {\n</code></pre>\n\n<p>You should be using</p>\n\n<pre><code>for my $row (@lines) {\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 9965855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07fe94a03fb6a97722213a1f40110657?s=128&d=identicon&r=PG&f=1", "display_name": "SLP", "link": "https://stackoverflow.com/users/9965855/slp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 55179140, "answer_count": 1, "score": 0, "last_activity_date": 1552642435, "creation_date": 1552640232, "last_edit_date": 1552642435, "question_id": 55178834, "link": "https://stackoverflow.com/questions/55178834/problem-when-trying-to-open-txt-file-with-and", "title": "Problem when trying to open txt file with &quot;[&quot; and &quot;]&quot;", "body": "<p>I have a problem when I try to open a .txt file with Perl.</p>\n\n<p>The text is basically:</p>\n\n<pre><code>function(1,1,[5,-5])\n</code></pre>\n\n<p>And I want to print this line. However, it doesn't print anything.</p>\n\n<p>The code I use is the following:</p>\n\n<pre><code>sub open_txt {\n# Open a txt file and return then content in an array\nmy $filename = $_[0];\nmy @lines;\nmy $index_row = 0;\n\nopen(my $fh, '&lt;:encoding(UTF-8)', $filename) or die \"Could not open file '$filename' $!\";\n# open(my $fh, '&lt;:encoding(iso-8859-7)', $filename) or die \"Could not open file '$filename' $!\";\n    while (my $row = &lt;$fh&gt;) {\n        chomp $row;\n        $lines[$index_row] = $row; \n        $index_row = $index_row + 1;\n    }\n\nreturn @lines;\n}\n\nmy $filename = 'test.txt';\nmy @lines = open_txt($filename);\nwhile (my $row = &lt;@lines&gt;) {\n    $index_row = $index_row + 1;\n    print \"[debug] $row\\n\";\n}\n</code></pre>\n\n<p>I get the line printed for these cases:</p>\n\n<p><code>function(1,1,[5,-5)</code> or <code>function(1,1,5,-5])</code> or <code>function(1,1,[])</code> but not for <code>function(1,1,[5,-5])</code> or <code>function(1,1,[,])</code> or <code>function(1,1,[ ])</code>.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["perl", "csv"], "answers": [{"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 2, "last_activity_date": 1552640301, "creation_date": 1552640301, "answer_id": 55178854, "question_id": 55178166, "link": "https://stackoverflow.com/questions/55178166/arrayofarrays-to-csv-file-first-inner-array-is-empty/55178854#55178854", "title": "ArrayOfArrays to csv-file: first inner array is empty?", "body": "<p>Replace</p>\n\n<pre><code>my @csvArray = [];   # Create empty array @cvsArray, then add a ref to an empty array to it.\n</code></pre>\n\n<p>with</p>\n\n<pre><code>my @csvArray = ();   # Create empty array @cvsArray, then empty it.\n</code></pre>\n\n<p>Better yet, simply use the following:</p>\n\n<pre><code>my @csvArray;        # Create empty array @cvsArray.\n</code></pre>\n"}], "owner": {"reputation": 624, "user_id": 10023107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GLme.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/10023107/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55178854, "answer_count": 1, "score": 0, "last_activity_date": 1552640301, "creation_date": 1552637497, "question_id": 55178166, "link": "https://stackoverflow.com/questions/55178166/arrayofarrays-to-csv-file-first-inner-array-is-empty", "title": "ArrayOfArrays to csv-file: first inner array is empty?", "body": "<p>the following code takes an uploaded csv-file, saves it in an Array of Arrays, and then i try to create a new csv-file from this Array of Arrays with Text::CSV_XS.\nI know i could just take the uploaded file and save it with \"move_to\", but this is not what i wanna do.</p>\n\n<p>My Problem here:\nwhen i save the csv-file, the first line and the last line of this csv-file is empty, and i don't understand why. could someone please explain it to me?</p>\n\n<pre><code>package MyApp::Controller::Main;\nuse Mojo::Base 'Mojolicious::Controller';\nuse Text::CSV_XS qw( csv );\nuse Encode;\nuse Cwd;\n\nsub upload {\n    my $self = shift;\n    return $self-&gt;render(text =&gt; 'File is too big.', status =&gt; 200) if $self-&gt;req-&gt;is_limit_exceeded;\n    return $self-&gt;redirect_to('/') unless my $newCsv = $self-&gt;req-&gt;upload('fileToUpload')-&gt;slurp;\n\n    open(my $myFH, '&lt;',\\$newCsv) or die $!;\n    my @lines = readline($myFH);\n    close($myFH);\n    my $checkCsv = Text::CSV_XS-&gt;new({sep_char =&gt; ';', quote_char =&gt; '\"'});\n    my @csvArray = [];\n    # my $arrayIndex = 0; #temp\n    foreach my $line (@lines){\n        $line = decode('UTF-8', $line);\n        $line =~ s/\\N{U+FEFF}//; # remove the BOM\n        $line =~ s/\\s+$//g; # remove \\n\n        if ($checkCsv-&gt;parse($line) and $checkCsv-&gt;fields()){\n            my @fields = $checkCsv-&gt;fields();\n            push(@csvArray, \\@fields);\n        }\n    }\n\n    $self-&gt;app-&gt;log-&gt;debug($self-&gt;dumper(@csvArray));\n\n    my $size = $self-&gt;param('fileToUpload')-&gt;size;\n    my $name = $self-&gt;param('fileToUpload')-&gt;filename;\n    csv (in =&gt; \\@csvArray, sep_char=&gt; \";\", out =&gt; getcwd.'/lib/MyApp/files/'.$name);\n    # $self-&gt;app-&gt;log-&gt;debug(getcwd);\n    my $delay = 3;\n    $self-&gt;stash(delay =&gt; $delay, message =&gt; \"Thanks for uploading $size byte file $name.&lt;br&gt;\n        You will be redirected in $delay seconds\");\n    $self-&gt;render('main/upload');\n}\n</code></pre>\n\n<p>thank you in advance.</p>\n"}, {"tags": ["html", "perl", "iframe", "browser"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1552641811, "post_id": 55177878, "comment_id": 97096414, "body": "That means the program died before it get to return headers to the web server. Unless it was killed by a signal, it would have output something to its STDERR. This is usually logged by the web server. If not, reenable that."}, {"owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552694327, "post_id": 55177878, "comment_id": 97122530, "body": "Thanks. So if I include: open STDERR, &#39;&gt;&amp;STDOUT&#39;; in the program the error will go to a file that I can find on the server? Do you know where that would be?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552712512, "post_id": 55177878, "comment_id": 97125133, "body": "Ow, no. If you do that (soon enough), the error will be sent as the response, which is bad. Do not make any changes to the script. Just check the web server&#39;s error log"}, {"owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552769095, "post_id": 55177878, "comment_id": 97139792, "body": "All I am getting from the error log is &quot;Premature end of script headers&quot;."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552772281, "post_id": 55177878, "comment_id": 97140588, "body": "The two most likely cases are: Your web server doesn&#39;t log the STDERR of CGI programs (as most do by default), or the CGI program was killed by a signal. Both could be diagnosed by replacing the script with a wrapper that performs additional logging."}, {"owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552795619, "post_id": 55177878, "comment_id": 97144305, "body": "Thanks again for your help. Any chance you could point me towards an example of a wrapper performing additional logging?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552856399, "post_id": 55177878, "comment_id": 97159642, "body": "I mean something like <code>#!&#47;bin&#47;sh</code> // <code>command 2&gt;&gt;&#47;var&#47;log&#47;command</code> // <code>echo &quot;Exited with $?&quot; &gt;&gt;&#47;var&#47;log&#47;command</code> Maybe make that last one conditional on <code>$?</code> being non-zero."}, {"owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552879786, "post_id": 55177878, "comment_id": 97164319, "body": "Sorry for my profound ignorance. Are you saying I should write another program that calls the problem one with the code you suggested?"}], "answers": [{"tags": [], "owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "is_accepted": true, "score": 0, "last_activity_date": 1553385195, "creation_date": 1553385195, "answer_id": 55319475, "question_id": 55177878, "link": "https://stackoverflow.com/questions/55177878/why-is-iframe-call-failing/55319475#55319475", "title": "Why is iframe call failing?", "body": "<p>Turns out this was a problem with the Dreamhost server. I have not been able to squeeze the actual fault out of them, other than \"may have been due to a server kernel issue\". But they moved the site to a new server with a later copy of Ubuntu and the problem has disappeared.</p>\n"}], "owner": {"reputation": 173, "user_id": 5478114, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/41edd9b1f1237bf1216b24ad5e1f6178?s=128&d=identicon&r=PG&f=1", "display_name": "Melchester", "link": "https://stackoverflow.com/users/5478114/melchester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 55319475, "answer_count": 1, "score": 0, "last_activity_date": 1553385195, "creation_date": 1552636222, "last_edit_date": 1552693851, "question_id": 55177878, "link": "https://stackoverflow.com/questions/55177878/why-is-iframe-call-failing", "title": "Why is iframe call failing?", "body": "<p>My website uses iframes to call a small perl program which (using the user's ip address) returns the associated country code. This has been working fine for years. Recently the server has been reporting ...</p>\n\n<p><em>[Wed Mar 13 19:16:16 2019] [error] [client 66.102.6.210] Premature end of script headers: VL.PL, referer: <a href=\"https://www.makeyourwill.com/\" rel=\"nofollow noreferrer\">https://www.makeyourwill.com/</a></em></p>\n\n<p>VL.PL is the perl program that returns the visitor's location.</p>\n\n<p>The problem is that I cannot reproduce the error. I have tried using Chrome, Edge, Safari, Firefox and IE. I have tried with ad-blockers. I cannot think of anything else that might affect it.</p>\n\n<p>I have not included any code because I don't think it is relevant, but obviously I can if you would find it helpful.</p>\n"}, {"tags": ["regex", "perl"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552636642, "post_id": 55177398, "comment_id": 97093791, "body": "&quot;<i>but it doesn&#39;t return anything</i>&quot;  -- the regex you show doesn&#39;t care about any specific characters other than parens; it should capture the function name and all of arguments with or without <code>[]</code>.  Then you can parse the arguments in the next step, which is what I would recommend (instead of a single monster regex)"}, {"owner": {"reputation": 197, "user_id": 9965855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07fe94a03fb6a97722213a1f40110657?s=128&d=identicon&r=PG&f=1", "display_name": "SLP", "link": "https://stackoverflow.com/users/9965855/slp"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552638061, "post_id": 55177398, "comment_id": 97094444, "body": "@zdim I wanted to do so, but for the lines where the string contains a &quot;[&quot; or &quot;]&quot;, there is no match. Also more surprising, when there is only &quot;[&quot; or &quot;]&quot;, the match is ok, but when there are both of them I don&#39;t get any match"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 9965855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07fe94a03fb6a97722213a1f40110657?s=128&d=identicon&r=PG&f=1", "display_name": "SLP", "link": "https://stackoverflow.com/users/9965855/slp"}, "edited": false, "score": 0, "creation_date": 1552635741, "post_id": 55177534, "comment_id": 97093398, "body": "Thank you for the explanation, it is very clear. However I should have given more details : my $string syntaxes can be various : name_of_my_function(arg1,arg2,arg3) or name_of_my_function(arg1,arg2,[arg3,arg4]) or name_of_my_function(&quot;arg1&quot;). Also the arguments can be strings or numerical (double or integer)... So your solution doesn&#39;t work for me, but I should have been clearer sorry"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1552636309, "last_edit_date": 1552636309, "creation_date": 1552634690, "answer_id": 55177534, "question_id": 55177398, "link": "https://stackoverflow.com/questions/55177398/perl-problem-with-in-a-regular-expression/55177534#55177534", "title": "Perl - Problem with &quot;]&quot; in a regular expression", "body": "<p>Well, if the number of arguments is variable, that is not that simple to do it with rgex only (arguments will be matched with <code>+</code> quantifier, so they won't be stored in capturing group, which would be easy to extract). Having in mind the above, you could use this pattern <code>(\\w+)\\(((\\w+|\\[(\\w+,?)+\\]),?)+\\)</code></p>\n\n<p>Explanation:</p>\n\n<p><code>(\\w+)</code> - match one or more word characters (name of a function) and store it in first capturing group,</p>\n\n<p><code>(\\w+|\\[(\\w+,?)+\\])</code> - alternation: match <code>\\w+</code> (same as above) or <code>\\[(\\w+,?)+\\]</code>: <code>\\[</code> - match <code>[</code> literally, <code>(\\w+,?)+</code> - match on or more times <code>\\w+,</code> pattern which is one or more word characters followed by one or zero commas (<code>,?</code>), <code>\\]</code> - match <code>]</code> literally,</p>\n\n<p><code>((\\w+|\\[(\\w+,?)+\\]),?)+</code> - match whole above pattern, optionally followed by comma (<code>,?</code>) one or more times. This would match argument list.</p>\n\n<p><code>\\(</code>, <code>\\)</code> 0 match <code>(</code>, <code>)</code> literally</p>\n\n<p>Further processing - extract whats between brackets <code>()</code> in order to extract arguments list programatically - it would be easier that doing it with complex regular expression</p>\n\n<p><a href=\"https://regex101.com/r/wBcJZ0/2\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<p><strong>UPDATE</strong>:</p>\n\n<p>Try pattern: <code>https://regex101.com/r/wBcJZ0/3</code></p>\n\n<p>I omitted explanation, as it is very similair to previous pattern.</p>\n\n<p><a href=\"https://regex101.com/r/wBcJZ0/3\" rel=\"nofollow noreferrer\">Updted demo</a></p>\n"}, {"comments": [{"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553020825, "post_id": 55178407, "comment_id": 97228585, "body": "array @m can be obtained using <code>@m = split(&#47;\\)|\\(&#47;,$s);</code> also right?."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "reply_to_user": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "edited": false, "score": 0, "creation_date": 1553021385, "post_id": 55178407, "comment_id": 97228857, "body": "@stack0114106  Yes, like <code>@p</code> is done at the end.  I used regex for no particular reason (I used that <code>split</code> <a href=\"https://stackoverflow.com/a/54931693/4653379\">recently</a>"}], "tags": [], "owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "is_accepted": true, "score": 4, "last_activity_date": 1552715401, "last_edit_date": 1552715401, "creation_date": 1552638457, "answer_id": 55178407, "question_id": 55177398, "link": "https://stackoverflow.com/questions/55177398/perl-problem-with-in-a-regular-expression/55178407#55178407", "title": "Perl - Problem with &quot;]&quot; in a regular expression", "body": "<p>The regex you show captures the function name, and all other arguments in a string, which is a very reasonble first step.  Then parse the arguments out of that second string.  I expand your <code>$string</code> so to have multiple bracketed lists of arguments, interleaved with non-bracketed ones</p>\n\n<pre><code>perl -wE'\n    $s = \"name_of_my_function(arg1,arg2,[arg3,arg4],arg5,[arg6,arg7])\"; \n    @m = $s =~ /^([^\\(]*)\\(([^\\)]*)\\)/; \n    @p = grep { $_ } split /\\s*,\\s*|\\[(.*?)\\]/, $m[1];\n    for (@p) { \n        if (/,/) { push @arg_list, $_ }\n        else     { push @args, $_ }\n    }\n    say $m[0];\n    say for @args; \n    say for @arg_list\n'\n</code></pre>\n\n<p>This prints</p>\n\n<pre>\nname_of_my_function\narg1\narg2\narg5\narg3,arg4\narg6,arg7\n</pre>\n\n<p>The <code>split</code> is where individual arguments are extracted, as well as bracketed argument list(s), each as a string.  That may return empty elements thus <code>grep { $_ }</code> to filter them out. </p>\n\n<p>Then you can proceed to extract individual arguments from lists that were in brackets, by splitting each string in <code>@arg_list</code> by <code>,</code> again.</p>\n\n<hr>\n\n<p>The main part of the above <em>can</em>, as the problem stands, go in one statement</p>\n\n<pre><code>@p = grep { $_ } split /\\( | \\) | \\[(.*?)\\] |,/x, $s;\n</code></pre>\n\n<p>where I added <code>/x</code> modifier so to be able to space it out for readability. This delivers to <code>@p</code> the function name, individual arguments, and a string with (comma separated) argument list from each <code>[]</code>.</p>\n\n<p>However, I think that it is far more sensible to break this up into several steps.</p>\n"}], "owner": {"reputation": 197, "user_id": 9965855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07fe94a03fb6a97722213a1f40110657?s=128&d=identicon&r=PG&f=1", "display_name": "SLP", "link": "https://stackoverflow.com/users/9965855/slp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 55178407, "answer_count": 2, "score": 1, "last_activity_date": 1552715401, "creation_date": 1552634048, "last_edit_date": 1552634778, "question_id": 55177398, "link": "https://stackoverflow.com/questions/55177398/perl-problem-with-in-a-regular-expression", "title": "Perl - Problem with &quot;]&quot; in a regular expression", "body": "<p>I have a string :</p>\n\n<pre><code>my $string = \"name_of_my_function(arg1,arg2,[arg3,arg4])\";\n</code></pre>\n\n<p>and I want to extract the name of the function \"name_of_my_function\" and the parameters :</p>\n\n<pre><code>$arg1 = \"arg1\"\n$arg2 = \"arg2\"\n@arg_list = (\"arg3\", \"arg4\")\n</code></pre>\n\n<p>the code I use to extract the function is :</p>\n\n<pre><code>$row =~ m/^([^\\(]*)\\(([^\\)]*)\\)/;\n$function = $1;\n</code></pre>\n\n<p>However, it works when the string doesn't have any <code>\"]\"</code>, for example :</p>\n\n<pre><code>my $string = \"name_of_my_function(arg1,arg2,arg3)\";\n</code></pre>\n\n<p>but it doesn't return anything when there is a <code>\"]\"</code></p>\n\n<p>Any idea?</p>\n\n<p>Thanks,</p>\n\n<p>SLP</p>\n"}, {"tags": ["shell", "perl", "scripting"], "comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1552632945, "post_id": 55176820, "comment_id": 97092313, "body": "What problem you are having?"}, {"owner": {"reputation": 3, "user_id": 11107369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4610b4520a3b81e7ad6755869476929?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/11107369/ansh"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552637083, "post_id": 55176820, "comment_id": 97093961, "body": "I was trying to use perl -ne &#39;print $_ x 3&#39; file but it operates on all the lines present in file."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1552640843, "post_id": 55176820, "comment_id": 97095865, "body": "This is something that should have been in your question."}], "answers": [{"tags": [], "owner": {"reputation": 682, "user_id": 1371209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0f4c9897c2b2b0d830e108ff42e37?s=128&d=identicon&r=PG", "display_name": "ahl", "link": "https://stackoverflow.com/users/1371209/ahl"}, "is_accepted": false, "score": 0, "last_activity_date": 1552634547, "last_edit_date": 1552634547, "creation_date": 1552632077, "answer_id": 55176971, "question_id": 55176820, "link": "https://stackoverflow.com/questions/55176820/use-perl-to-repeat-a-line-fixed-no-of-times/55176971#55176971", "title": "use perl to repeat a line fixed no. of times", "body": "<p>Try this piece of code. It may solve your problem:</p>\n\n<pre><code>for (my $i = 0; &lt;&gt;; $i++) {\n        print;\n        if ($i == 1) {\n                print;\n                print;\n                print \"loop\\n\";\n        } elsif ($i == 2) {\n                print \"endloop\\n\";\n        }       \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87649, "user_id": 17389, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/cd06d1314817ce946ab796af8750b56a?s=128&d=identicon&r=PG", "display_name": "ysth", "link": "https://stackoverflow.com/users/17389/ysth"}, "is_accepted": true, "score": 1, "last_activity_date": 1552632443, "last_edit_date": 1552632443, "creation_date": 1552632140, "answer_id": 55176986, "question_id": 55176820, "link": "https://stackoverflow.com/questions/55176820/use-perl-to-repeat-a-line-fixed-no-of-times/55176986#55176986", "title": "use perl to repeat a line fixed no. of times", "body": "<pre><code>perl -wpe'if ($.==2) { $_ x= 3 } elsif ($.==3) { $_ = \"loop\\n${_}endloop\\n\" }' &lt;infile &gt;outfile\n</code></pre>\n\n<p>or to change multiple files in place:</p>\n\n<pre><code>perl -i -wpe'close ARGV if eof; if ($.==2) { $_ x= 3 } elsif ($.==3) { $_ = \"loop\\n${_}endloop\\n\" }' file1 file2 file3 \n</code></pre>\n\n<p>(the close is necessary to restart <code>$.</code>'s line count)</p>\n"}], "owner": {"reputation": 3, "user_id": 11107369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4610b4520a3b81e7ad6755869476929?s=128&d=identicon&r=PG&f=1", "display_name": "ansh", "link": "https://stackoverflow.com/users/11107369/ansh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1552635010, "accepted_answer_id": 55176986, "answer_count": 2, "score": -2, "last_activity_date": 1552656194, "creation_date": 1552631480, "last_edit_date": 1552656194, "question_id": 55176820, "link": "https://stackoverflow.com/questions/55176820/use-perl-to-repeat-a-line-fixed-no-of-times", "closed_reason": "Needs more focus", "title": "use perl to repeat a line fixed no. of times", "body": "<p>I have a file and i want to repeat some a fixed no. of line below it two times  and also to add a loop command just after the second line and end the loop after the second line ends.\nso my file is</p>\n\n<pre><code>a4 b2 c3 e6\na1 b2 c3 d4\ng5 h6 i7 j8\nh9 i10 j11 k12\n</code></pre>\n\n<p>this should become</p>\n\n<pre><code>a4 b2 c3 e6\na1 b2 c3 d4\na1 b2 c3 d4\na1 b2 c3 d4\nloop\ng5 h6 i7 j8\nendloop\nh9 i10 j11 k12\n</code></pre>\n\n<p>I have to do this for 16 files .I am trying to use sed command but it is not working.I am figuring it how to do using perl?</p>\n\n<p>I was trying to use perl -ne 'print $_ x 3' file but it operates on all the lines present in file.    </p>\n\n<p>/<em>edit suggested by ikegami</em>/</p>\n"}, {"tags": ["perl", "environment-variables"], "comments": [{"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 1, "creation_date": 1552630826, "post_id": 55176624, "comment_id": 97091555, "body": "This is very well documented in the online manual.  Did you look at <code>%ENV</code>?"}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552632990, "post_id": 55176624, "comment_id": 97092329, "body": "Don&#39;t use global vars (<code>FH</code>); use lexical vars (<code>my $FH</code>)."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552633021, "post_id": 55176624, "comment_id": 97092336, "body": "Always use <code>use strict; use warnings qw( all );</code>"}], "answers": [{"comments": [{"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 11, "user_id": 7023332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e219a28b4dcf9a50501907ca4a9d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi Vutukuri", "link": "https://stackoverflow.com/users/7023332/swathi-vutukuri"}, "edited": false, "score": 1, "creation_date": 1552664295, "post_id": 55176989, "comment_id": 97110162, "body": "@SwathiVutukuri: If it&#39;s working, then please accept the answer."}], "tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 1, "last_activity_date": 1552632148, "creation_date": 1552632148, "answer_id": 55176989, "question_id": 55176624, "link": "https://stackoverflow.com/questions/55176624/interpolating-env-variables-in-perl/55176989#55176989", "title": "interpolating env variables in perl", "body": "<p>The following is the minimal solution:</p>\n\n<pre><code>$line2 =~ s/\\$(\\w+)/$ENV{$1}/g;\n</code></pre>\n\n<p>Of course, you might want to handle variables that aren't defined more cleanly, and you might want some kind of escape mechanism to prevent the special meaning of <code>$</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 7023332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80e219a28b4dcf9a50501907ca4a9d4e?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi Vutukuri", "link": "https://stackoverflow.com/users/7023332/swathi-vutukuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 55176989, "answer_count": 1, "score": -1, "last_activity_date": 1552632148, "creation_date": 1552630480, "question_id": 55176624, "link": "https://stackoverflow.com/questions/55176624/interpolating-env-variables-in-perl", "title": "interpolating env variables in perl", "body": "<p>How to interpolate a environment variable before assigning to another variable.\nFor e.g. I am reading a line from input file which has environment variables. So I want to assign value of variable. I am not seeing the value of variable . My code is as below.</p>\n\n<pre><code>open (FH , \"&lt;\", \"$ARGV[0]\")\n   while ($line = &lt;FH&gt;)\n$line2 = $line\n}\n\nprint $line; ## prints $abc/ver\nprint $line2; ## prints $abc/ver\n\nvalue of abc environment is username ;  So I am expecting to have $line2 value as below\nprint $line2 ; ## Should print username/ver\n</code></pre>\n"}, {"tags": ["perl"], "comments": [{"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 2, "creation_date": 1552598652, "post_id": 55171843, "comment_id": 97083710, "body": "I don&#39;t understand what output you want -- can you show that, using data from the file you show?  Also, the shown code doesn&#39;t make much sense as it stands -- can you show more, in particular how you read and iterate over lines?"}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552633203, "post_id": 55171843, "comment_id": 97092400, "body": "Thank you for clarifying things.  But: when you say &quot;<i>Using this code gives me</i>&quot; it seems to refer to the code you show, what is not possible since that is very far from correect Perl and won&#39;t compile (on many accounts)."}], "answers": [{"tags": [], "owner": {"reputation": 2936, "user_id": 39791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/661c7cc5565e5bc21fb0fc22c0354fef?s=128&d=identicon&r=PG", "display_name": "Joe McMahon", "link": "https://stackoverflow.com/users/39791/joe-mcmahon"}, "is_accepted": false, "score": 0, "last_activity_date": 1552601471, "creation_date": 1552601471, "answer_id": 55172778, "question_id": 55171843, "link": "https://stackoverflow.com/questions/55171843/how-to-split-lines-in-one-part-of-a-text-file-differently-from-another-perl/55172778#55172778", "title": "How to split lines in one part of a text file differently from another? - Perl", "body": "<p>Something like this should do. What you want to do is detect lines starting with a hash and count them; when you see two in a row, swap the pattern you're using to do the split. </p>\n\n<pre><code>{\n  # Inside a block so only the sub here can see them.\n  my $double_hash_seen;\n  my $splitter = qr/:/;   # First split pattern\n  my $last_was_hash;\n\n  sub split_appropriately {\n    my($line) = @_;\n    if (/^#/) {\n      if ($last_was_hash) {\n        # Double hash, switch modes.\n        $splitter = qr/ /;  # Second split pattern\n        return;             # We don't split hash lines\n      }\n      # Last was not a hash, but this was.\n      $last_was_hash = 1;  # One hash seen.\n      return;              # Don't split the hash line\n    }\n    # This isn't a hash. Turn off \"hash seen\" and split\n    # with appropriate current pattern.\n    $last_was_hash = 0;\n    split $splitter, $line;  # Will stay switched once it changes\n  }\n}\n\nwhile(&lt;DATA&gt;) {\n  my($first, $second) = split_appropriately($_);\n  next unless defined $first;\n  print \"Part 1: $first\\n\";\n  print \"Part 2: $second\\n\";\n}\n__DATA__\n#\nPROPERTY_A: TEXT1\nPROPERTY_B: UNIT1\n#\nPROPERTY_A: TEXT2\nPROPERTY_B: UNIT2\n#\n#\n1 2\n3 4\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "reply_to_user": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552640231, "post_id": 55174928, "comment_id": 97095517, "body": "@zdim.. thanks.. just updated.. I have one more question.. how to print the <code>$&#39;</code> , the right section after a regex match in one-liner solutions.."}, {"owner": {"reputation": 53041, "user_id": 4653379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3953dbedd0dabff5cbc3db9b0835b14?s=128&d=identicon&r=PG&f=1", "display_name": "zdim", "link": "https://stackoverflow.com/users/4653379/zdim"}, "edited": false, "score": 0, "creation_date": 1552719878, "post_id": 55174928, "comment_id": 97126391, "body": "Wow, a good one ... dunno.  Except for using its <a href=\"https://perldoc.perl.org/perlvar.html#%24&#39;\" rel=\"nofollow noreferrer\">&quot;english&quot; name</a>  <code>perl -MEnglish -wE&#39;$_=q(abc); &#47;.&#47;; say $POSTMATCH&#39;</code>.  In Perls earlier than (..X?) this incurred performance penalty while <code>${^POSTMATCH}</code> does the same with no penalty.  But I think that there is no penalty in any case anymore. (Using <code>&quot;</code> as script delimiter was either way too messy or didn&#39;t work)"}], "tags": [], "owner": {"reputation": 7646, "user_id": 6867048, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b939fdb5809fed8097c38bdf4370747b?s=128&d=identicon&r=PG&f=1", "display_name": "stack0114106", "link": "https://stackoverflow.com/users/6867048/stack0114106"}, "is_accepted": false, "score": 1, "last_activity_date": 1552640156, "last_edit_date": 1552640156, "creation_date": 1552618752, "answer_id": 55174928, "question_id": 55171843, "link": "https://stackoverflow.com/questions/55171843/how-to-split-lines-in-one-part-of-a-text-file-differently-from-another-perl/55174928#55174928", "title": "How to split lines in one part of a text file differently from another? - Perl", "body": "<p>You can try command line Perl</p>\n\n<pre><code>perl -F: -ane ' if(not /^\\d+/) { $x.=$F[1] if not /^#/ } else { $y.=$_ } \n    END { $x=~s/\\s*(\\S+)\\s*(\\S+)\\s*(\\S+)\\s*(\\S+)/$1 $3\\n$2 $4/gs; print $x,$y }' file\n</code></pre>\n\n<p>with your given inputs:</p>\n\n<pre><code>$ cat marPar.txt\n#\nPROPERTY_A: TEXT1\nPROPERTY_B: UNIT1\n#\nPROPERTY_A: TEXT2\nPROPERTY_B: UNIT2\n#\n#\n1 2\n3 4\n\n$ perl -F: -ane ' if(not /^\\d+/) { $x.=$F[1] if not /^#/ } else { $y.=$_ } \n      END { $x=~s/\\s*(\\S+)\\s*(\\S+)\\s*(\\S+)\\s*(\\S+)/$1 $3\\n$2 $4/gs; print $x,$y }' marPar.txt\nTEXT1 TEXT2\nUNIT1 UNIT2\n1 2\n3 4\n\n$\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11204715, "user_type": "registered", "profile_image": "https://graph.facebook.com/2397097736975837/picture?type=large", "display_name": "marPar", "link": "https://stackoverflow.com/users/11204715/marpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1552640156, "creation_date": 1552596898, "last_edit_date": 1552600378, "question_id": 55171843, "link": "https://stackoverflow.com/questions/55171843/how-to-split-lines-in-one-part-of-a-text-file-differently-from-another-perl", "title": "How to split lines in one part of a text file differently from another? - Perl", "body": "<p>I\u2019m very new to coding. </p>\n\n<p>I have data in a text file formatted as follows:</p>\n\n<pre><code>#\nPROPERTY_A: TEXT1\nPROPERTY_B: UNIT1\n#\nPROPERTY_A: TEXT2\nPROPERTY_B: UNIT2\n#\n#\n1 2\n3 4\n</code></pre>\n\n<p>I want to output it as a table like so:</p>\n\n<pre><code>TEXT1 TEXT2\nUNIT1 UNIT2\n1     2\n3     4\n</code></pre>\n\n<p>I understand how to read the text file into an array of lines and then how to use split() to parse each line into and array of strings. I want to write the data into a table with the properties as the headers of each column so I will need to split using \u201c: \u201c until I read 2 consecutive lines with a hash on then change to using \u201c \u201c to split.</p>\n\n<p>Using this code gives me an infinite loop that doesn\u2019t return any value even through both individual splits work fine.</p>\n\n<pre><code>my $dataAsText = SomeFunction-&gt;Run($imputDocument);\nfor (my $ln = 0; &lt; $dataAsText-&gt;Lines-&gt;Count; ++$ln;)\nmy $line = $dataAsText-&gt;Lines($ln)\ndo {\n   my @words = split ($line, \u2018: \u2018, 2);\n   # then pass @words[1] to the first or second row of each column\n} until ($line eq \u2018#\u2019 &amp;&amp; $line + 1 eq \u2018#\u2019);\n   my @words = split ($line, \u2018 \u2018);\n   # then pass each @words values to its corresponding column\n}\n</code></pre>\n\n<p>How would I write a piece of code to check for 2 consecutive lines with hash symbols then change how the lines are split before they\u2019re sent to the arrays?</p>\n\n<p>Just to clarify the final data document may have hundreds of thousands of lines to read, this is an example structure.</p>\n"}, {"tags": ["perl", "gtk3"], "comments": [{"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1552587744, "post_id": 55168126, "comment_id": 97078424, "body": "I am not sure if these are the correct arguments in Gtk3: <code>my ($closure, $data) = @_</code> for the callback. I will check it out.."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "edited": false, "score": 0, "creation_date": 1552588885, "post_id": 55168126, "comment_id": 97078953, "body": "According to the <a href=\"https://metacpan.org/pod/Cairo\" rel=\"nofollow noreferrer\">documention</a> the callback should be of type <code>Cairo::WriteFunc</code> and take arguments <code>my ($callback_data, $data) = @_</code> so it seems like you are getting the correct <code>$data</code> argument, maybe the problem is the call syntax of <code>$loader-&gt;write($data)</code> then?"}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "edited": false, "score": 0, "creation_date": 1552638946, "post_id": 55172867, "comment_id": 97094845, "body": "Yes, it certainly works! By the way, can you guess how to capture a portion of the canvas? I tried: <code>my $bounds = GooCanvas2::CanvasBounds-&gt;new(200, 200, 100, 100); $canvas-&gt;render($cr, $bounds, 1);</code> but that seems to be the wrong format."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "edited": false, "score": 0, "creation_date": 1552678162, "post_id": 55172867, "comment_id": 97117237, "body": "I think the 3rd and 4th parameters are the coordinates of the right and bottom edge, see <a href=\"https://developer.gnome.org/goocanvas2/stable/goocanvas2-GooCanvas-Types.html#GooCanvasBounds\" rel=\"nofollow noreferrer\">the documentation</a>, and not the width and height. Even if I changed that to <code>$bounds = GooCanvas2::CanvasBounds-&gt;new(50, 50, 250, 250)</code> it still gave me a blank png file, so I think there is bug somewhere. I also tested the same code written in pure C and it worked fine, so the problem seems to be in the perl wrapper functions.."}, {"owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "reply_to_user": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "edited": false, "score": 0, "creation_date": 1552726391, "post_id": 55172867, "comment_id": 97127654, "body": "@lesrol See my updated answer for the correct syntax!"}, {"owner": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "edited": false, "score": 0, "creation_date": 1552733688, "post_id": 55172867, "comment_id": 97129369, "body": "So, if we capture a square at coordinates x=50, y=50, it&#39;s added to the Cairo::ImageSurface also at x=50, y=50. If we want a PNG file that&#39;s the same size as the captured square, we will be disappointed. I tried &#39;$cr-&gt;translate(-50, -50); $canvas-&gt;render($cr, $bounds, 1);&#39;, but apparently that&#39;s not the correct method."}, {"owner": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "edited": false, "score": 1, "creation_date": 1552898007, "post_id": 55172867, "comment_id": 97169725, "body": "Thanks again! Games::Axmud appreciates all of your efforts :)"}], "tags": [], "owner": {"reputation": 32176, "user_id": 2173773, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/M8yh6.jpg?s=128&g=1", "display_name": "H&#229;kon H&#230;gland", "link": "https://stackoverflow.com/users/2173773/h%c3%a5kon-h%c3%a6gland"}, "is_accepted": true, "score": 1, "last_activity_date": 1552753067, "last_edit_date": 1552753067, "creation_date": 1552601986, "answer_id": 55172867, "question_id": 55168126, "link": "https://stackoverflow.com/questions/55168126/save-goocanvas2-to-png-file/55172867#55172867", "title": "Save GooCanvas2 to PNG file", "body": "<blockquote>\n  <p><strong>* unhandled exception in callback:\n  *</strong>   `need' is not a valid cairo_status_t value; valid values are: success, no-memory, [...] at goopng2.pl line 90.\n  ***  ignoring\n   at /usr/share/perl5/Gtk3.pm line 546.</p>\n</blockquote>\n\n<p>By running the debugger on your code I could see that <code>$loader-&gt;write($data)</code> raised an exception: </p>\n\n<pre><code>need an array ref to convert to GArray\n</code></pre>\n\n<p>and <code>write_to_png_stream()</code> was not expecting this type of exception and truncated the message to the first word <code>\"need\"</code> as you can see from Glib error message at the top: <code>`need' is not a valid cairo_status_t value ...</code></p>\n\n<p>By some trial and error I found that I could pass the <code>$buffer</code> argument as an array of characters and not as a perl string:</p>\n\n<pre><code>sub write_png_clicked {\n    my ($but, $canvas) = @_;\n    print \"Write PNG...\\n\";\n\n    my $surface = Cairo::ImageSurface-&gt;create ('rgb24', 1000, 1000);\n    my $cr = Cairo::Context-&gt;create($surface);\n    $cr-&gt;rectangle( 0, 0, 1000, 1000 );\n    $cr-&gt;set_source_rgb( 1, 1, 1 );\n    $cr-&gt;fill;\n    $canvas-&gt;render($cr, undef, 1);\n    my $loader = Gtk3::Gdk::PixbufLoader-&gt;new;\n    $surface-&gt;write_to_png_stream (\n        sub {\n            my ($loader, $buffer) = @_;\n            $loader-&gt;write([map ord, split //, $buffer]);\n            return TRUE;\n        }, $loader\n    );\n    $loader-&gt;close;\n    my $pixbuf = $loader-&gt;get_pixbuf;\n\n    print $pixbuf-&gt;get_bits_per_sample(),\"\\n\";\n    print $pixbuf-&gt;get_colorspace(),\"\\n\";\n\n    $pixbuf-&gt;save (\"test.png\", 'png');\n    print \"done png\\n\";\n    $pixbuf-&gt;save (\"test.jpg\", 'jpeg', quality =&gt; 100); \n    print \"done jpg\\n\";\n    return TRUE;\n}\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<p>To save only a part of the canvas you can pass a <a href=\"https://developer.gnome.org/goocanvas2/stable/goocanvas2-GooCanvas-Types.html#GooCanvasBounds\" rel=\"nofollow noreferrer\">GooCanvasBounds</a> parameter to the <code>render()</code> method:</p>\n\n<pre><code>my $bounds = GooCanvas2::CanvasBounds-&gt;new();\n$bounds-&gt;x1(50);\n$bounds-&gt;x2(250);\n$bounds-&gt;y1(50);\n$bounds-&gt;y2(250);\n$canvas-&gt;render($cr, $bounds, 1);\n</code></pre>\n\n<p><strong>Edit 2</strong>:</p>\n\n<p>To capture a region at a specific position and a specific width and height:</p>\n\n<pre><code>my $img_width = 200;\nmy $img_height = 200;\nmy $img_x0 = 100;\nmy $img_y0 = 100;\nmy $surface = Cairo::ImageSurface-&gt;create ('rgb24', $img_width, $img_height);\n$cr-&gt;translate(-$img_x0,-$img_y0);\n$canvas-&gt;render($cr, undef, 1);\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 6920800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8aad840893bf8dddaa9bae758c57b78?s=128&d=identicon&r=PG&f=1", "display_name": "lesrol", "link": "https://stackoverflow.com/users/6920800/lesrol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55172867, "answer_count": 1, "score": 2, "last_activity_date": 1552753067, "creation_date": 1552582514, "question_id": 55168126, "link": "https://stackoverflow.com/questions/55168126/save-goocanvas2-to-png-file", "title": "Save GooCanvas2 to PNG file", "body": "<p>After drawing with GooCanvas2, I'm trying to take a 'screenshot' of the canvas and save it to a .PNG file.</p>\n\n<p><a href=\"https://www.perlmonks.org/?node_id=700052\" rel=\"nofollow noreferrer\">This script</a> provides a very nice example using Gtk2/GooCanvas, but having converted that script to Gtk3/GooCanvas2, I get an error that I don't understand:</p>\n\n<pre><code>Write PNG...\n*** unhandled exception in callback:\n***   `need' is not a valid cairo_status_t value; valid values are: success, no-memory, invalid-restore, invalid-pop-group, no-current-point, invalid-matrix, invalid-status, null-pointer, invalid-string, invalid-path-data, read-error, write-error, surface-finished, surface-type-mismatch, pattern-type-mismatch, invalid-content, invalid-format, invalid-visual, file-not-found, invalid-dash, invalid-dsc-comment, invalid-index, clip-not-representable, temp-file-error, invalid-stride, font-type-mismatch, user-font-immutable, user-font-error, negative-count, invalid-clusters, invalid-slant, invalid-weight at goopng2.pl line 90.\n***  ignoring at /usr/share/perl5/Gtk3.pm line 546.\n</code></pre>\n\n<p>The error is generated by Gtk3::Gdk::PixbufLoader->write(). I have not modified that function at all:</p>\n\n<pre><code>$surface-&gt;write_to_png_stream (sub {\n    my ($closure, $data) = @_;\n    $loader-&gt;write($data);\n});\n</code></pre>\n\n<p>And this is the converted script:</p>\n\n<pre><code>#!/usr/bin/perl -w\nuse strict;\n\nuse warnings;\nuse GooCanvas2;\nuse Gtk3 '-init';\nuse Glib qw(TRUE FALSE);\n\nmy $window = Gtk3::Window-&gt;new('toplevel');\n$window-&gt;signal_connect('delete_event' =&gt; sub { Gtk3-&gt;main_quit; });\n$window-&gt;set_default_size(640, 600);\n\n\nmy $vbox = Gtk3::VBox-&gt;new;\n$vbox-&gt;set_border_width(4);\n$vbox-&gt;show;\n$window-&gt;add($vbox);\n\nmy $swin = Gtk3::ScrolledWindow-&gt;new;\n$swin-&gt;set_shadow_type('in');\n$vbox-&gt;pack_start($swin, 1, 1, 0); \n\nmy $canvas = GooCanvas2::Canvas-&gt;new();\n$canvas-&gt;set_size_request(600, 450);\n$canvas-&gt;set_bounds(0, 0, 1000, 1000);\n$swin-&gt;add($canvas);\n\nmy $root = $canvas-&gt;get_root_item();\n\nmy $rect = GooCanvas2::CanvasRect-&gt;new(\n    parent =&gt; $root,\n    'x' =&gt; 100,\n    'y' =&gt; 100,\n    'width' =&gt; 400,\n    'height' =&gt; 400,\n    'line-width' =&gt; 10,\n    'radius-x' =&gt; 20,\n    'radius-y' =&gt; 10,\n    'stroke-color' =&gt; 'yellow',\n    'fill-color' =&gt; 'red'\n);\n\nmy $text = GooCanvas2::CanvasText-&gt;new(\n    'parent' =&gt; $root,\n    'text' =&gt; \"Hello World\",\n    'x' =&gt; 300,\n    'y' =&gt; 300,\n    'width' =&gt; -1,\n    'anchor' =&gt; 'center',\n    'font' =&gt; 'Sans 24',\n);\n$text-&gt;rotate(45, 300, 300);\n\n# Create PNG                                                                          \nmy $sb = Gtk3::Button-&gt;new_with_label('Write PNG and JPG');                                       \n$vbox-&gt;pack_start($sb, FALSE, FALSE, 0);                                               \n$sb-&gt;show;                                                                             \n$sb-&gt;signal_connect(\"clicked\", \\&amp;write_png_clicked, $canvas);                          \n\n$window-&gt;show_all();\nGtk3-&gt;main;\n\nsub write_png_clicked {\n    my ($but, $canvas) = @_;\n    print \"Write PNG...\\n\";\n\n    my $surface = Cairo::ImageSurface-&gt;create ('rgb24', 1000, 1000);\n    # also argb32 is available\n    # my $surface = Cairo::ImageSurface-&gt;create ('argb32', 1000, 1000);\n\n    my $cr = Cairo::Context-&gt;create($surface);\n\n    # make a background rectangle filled white so saved file looks same as screen\n    # otherwise a black background may appear, it's like pdf, if it isn't\n    # drawn , it will be a black background, It won't automagically pick up\n    # a white background on a canvas\n    $cr-&gt;rectangle( 0, 0, 1000, 1000 );\n    $cr-&gt;set_source_rgb( 1, 1, 1 );\n    $cr-&gt;fill;\n\n    $canvas-&gt;render($cr, undef, 1);\n\n    # this works, but see below for way to use pixbuf and jpg\n    #    my $status = $surface-&gt;write_to_png (\"$0.png\");\n    #    print \"$status\\n\";\n\n    my $loader = Gtk3::Gdk::PixbufLoader-&gt;new;\n        $surface-&gt;write_to_png_stream (sub {\n        my ($closure, $data) = @_;\n        $loader-&gt;write($data);\n    });\n    $loader-&gt;close;\n    my $pixbuf = $loader-&gt;get_pixbuf;\n\n    print $pixbuf-&gt;get_bits_per_sample(),\"\\n\";\n    print $pixbuf-&gt;get_colorspace(),\"\\n\";\n\n    $pixbuf-&gt;save (\"$0.png\", 'png');\n    print \"done png\\n\";\n    $pixbuf-&gt;save (\"$0.jpg\", 'jpeg', quality =&gt; 100); \n    print \"done jpg\\n\";\n\n    return TRUE;\n}\n</code></pre>\n"}, {"tags": ["perl", "file-handling"], "answers": [{"tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": true, "score": 0, "last_activity_date": 1552574147, "creation_date": 1552574147, "answer_id": 55165224, "question_id": 55164673, "link": "https://stackoverflow.com/questions/55164673/perl-script-to-modify-one-file-taking-values-from-second-file/55165224#55165224", "title": "Perl script to modify one file taking values from second file", "body": "<p>You should read <code>File1.txt</code> before iterating over <code>@blockList</code>.\nSomething like this:</p>\n\n<pre><code>...\nmy @template = load_template(); \nmy @blockList = load_block_list();\n...\nforeach my $Element (@blockList) {\n    foreach my $Orig_line (@template) {\n...\n</code></pre>\n\n<p><code>load_template</code> should be similar to <code>load_block_list</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 6209446, "user_type": "registered", "profile_image": "https://graph.facebook.com/1692235050997638/picture?type=large", "display_name": "Ayush Chauhan", "link": "https://stackoverflow.com/users/6209446/ayush-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 55165224, "answer_count": 1, "score": -1, "last_activity_date": 1552574741, "creation_date": 1552572635, "last_edit_date": 1552574741, "question_id": 55164673, "link": "https://stackoverflow.com/questions/55164673/perl-script-to-modify-one-file-taking-values-from-second-file", "title": "Perl script to modify one file taking values from second file", "body": "<p>I've written a Perl Script which processes two files, File 1 contains some text in which 'ABC' needs to be replaced with the list of values present in 2nd text file.  </p>\n\n<p>File1.txt :</p>\n\n<pre><code>Name     -&gt; ABC\n\nRecord   -&gt; Exists\n\nPresence -&gt; Existing_ABC\n</code></pre>\n\n<p>File2.txt :</p>\n\n<pre><code>John\n\nClaude\n\nKepler\n\nShane\n\nAustin\n</code></pre>\n\n<p>I want to replace 'ABC' from File1 with John then the original File1 should be taken again and 'ABC' should get replaced with Claude and merged with the first iteration and so on in the similar way till the last entry of the File2.\nSo, presently the script is giving the output for only one value 'John' it doesn't take other values from the list.</p>\n\n<p>Final Output.txt file should be like:</p>\n\n<pre><code>Name     -&gt; John\n\nRecord   -&gt; Exists\n\nPresence -&gt; Existing_John\n\n\nName     -&gt; Claude\n\nRecord   -&gt; Exists\n\nPresence -&gt; Existing_Claude\n\n.\n\n.\n\n.\n\n.\n.\n\n\n(#till Austin)\n</code></pre>\n\n<p>Please find me the mistake in my script and Thanks in advance:-></p>\n\n<pre><code>#!/usr/bin/perl\n\nuse strict;\n\nuse warnings;\n\nmy @blockList   =  load_block_list();\n\nmy $rules_file  =  'File1.txt';\n\nmy $out_file    =  'out.txt';  \n\nopen( my $rules,  '&lt;',  $rules_file  );\n\nopen( my $out,    '&gt;',  $out_file  );\n\nmy $Orig_line;\n\nmy $new_line;\n\nmy $key;\n\n\nforeach my $Element (@blockList) {\n\n    while($Orig_line=&lt;$rules&gt;) {\n\n        chomp($Orig_line);\n\n        $new_line = $Orig_line;\n\n        if($Orig_line =~ m/ABC/) {\n            $new_line =~ s/ABC/$Element/;\n        }\n\n        print {$out} \"$new_line\\n\";\n\n    }\n}\n\nsub load_block_list\n{\n    my $block_list = \"File2.txt\";\n\n    open(DAT, $block_list) || die(\"Could not open file $block_list!\");\n    my @lines=&lt;DAT&gt;;\n    close(DAT);\n\n    my @retVal = ();\n    foreach my $line (@lines) {\n        $line =~ s/[\\r\\n]+//g;\n        push(@retVal,$line),\n    }\n    return @retVal;\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "perl", "optimization", "language-specifications", "code-elimination"], "comments": [{"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1552583694, "post_id": 55164649, "comment_id": 97076175, "body": "Huh? <code>perlperf</code> is about tips and tricks to improve user code. It has nothing to say about any internal optimizations made by the perl compiler."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 0, "creation_date": 1552601873, "post_id": 55164649, "comment_id": 97084768, "body": "Regarding &quot;the result would be discarded&quot;, in Perl this is just void context and any function can be called in that way. Your example won&#39;t necessarily apply void context because it will be called in whatever context dies_ok calls the surrounding function (the last statement evaluated is the implicit return value of a function), but you can put a dummy return value afterward so the statement is always in void context: <code>$obj-&gt;accessor; 1;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 3, "creation_date": 1552576541, "post_id": 55165842, "comment_id": 97071411, "body": "It would be nice to have stronger references/justifications to your answer than just &quot;AFAIK&quot;."}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 2, "creation_date": 1552584392, "post_id": 55165842, "comment_id": 97076612, "body": "There are millions of lines of Perl code with function calls that don&#39;t use the return value. I am very comfortable endorsing Ujin734&#39;s view that Perl will never optimize them away."}, {"owner": {"reputation": 8718, "user_id": 5848200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8072aaf76dcb4fe5027964252f16382?s=128&d=identicon&r=PG", "display_name": "Grinnz", "link": "https://stackoverflow.com/users/5848200/grinnz"}, "edited": false, "score": 1, "creation_date": 1552601634, "post_id": 55165842, "comment_id": 97084689, "body": "It would be a bug if anything with possible side effects was optimized away."}], "tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": true, "score": 1, "last_activity_date": 1552606614, "last_edit_date": 1552606614, "creation_date": 1552575805, "answer_id": 55165842, "question_id": 55164649, "link": "https://stackoverflow.com/questions/55164649/does-the-perl-compiler-need-to-be-told-not-to-optimize-away-function-calls-with/55165842#55165842", "title": "Does the Perl compiler need to be told not to optimize away function calls with ignored return values?", "body": "<p>Perl doesn't ever optimize away sub calls, and sub calls with side effects shouldn't be optimised away in any language.</p>\n\n<p><code>undef $obj-&gt;accessor</code> means something similar to <code>$obj-&gt;accessor = undef</code> </p>\n"}], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55165842, "answer_count": 1, "score": 1, "last_activity_date": 1552606614, "creation_date": 1552572569, "question_id": 55164649, "link": "https://stackoverflow.com/questions/55164649/does-the-perl-compiler-need-to-be-told-not-to-optimize-away-function-calls-with", "title": "Does the Perl compiler need to be told not to optimize away function calls with ignored return values?", "body": "<p>I am writing new Perl 5 module <a href=\"https://github.com/cxw42/Class-Tiny-ConstrainedAccessor\" rel=\"nofollow noreferrer\">Class::Tiny::ConstrainedAccessor</a> to check type constraints when you touch object attributes, either by setting or by getting a default value.  I am writing the unit tests and want to run the accessors for the latter case.  However, I am concerned that Perl may optimize away my accessor-function call since the return value is discarded.  Will it?  If so, can I tell it not to?  Is the corresponding behaviour documented?  If the answer is as simple as \"don't worry about it,\" that's good enough, but a reference to the docs would be appreciated :) .</p>\n\n<p>The following MCVE succeeds when I run it on my Perl 5.26.2 x64 Cygwin.  However, I don't know if that is guaranteed, or if it just happens to work now and may change someday.</p>\n\n<pre><code>use 5.006; use strict; use warnings; use Test::More; use Test::Exception;\n\ndies_ok {   # One I know works\n    my $obj = Klass-&gt;new;   # Default value of \"attribute\" is invalid\n    diag $obj-&gt;accessor;    # Dies, because the default is invalid\n} 'Bad default dies';\n\ndies_ok {\n    my $obj = Klass-&gt;new;\n    $obj-&gt;accessor;         # &lt;&lt;&lt; THE QUESTION --- Will this always run?\n} 'Dies even without diag';\n\ndone_testing();\n\n{   package Klass;\n    sub new { my $class = shift; bless {@_}, $class }\n    sub check { shift; die 'oops' if @_ and $_[0] eq 'bad' }\n    sub default { 'bad' }\n    sub accessor {\n        my $self = shift;\n        if(@_) { $self-&gt;check($_[0]); return $self-&gt;{attribute} = $_[0] }   # W\n        elsif(exists $self-&gt;{attribute}) { return $self-&gt;{attribute} }      # R\n        else {  \n            # Request to read the attribute, but no value is assigned yet.\n            # Use the default.\n            $self-&gt;check($self-&gt;default);    # &lt;&lt;&lt;---- What I want to exercise\n            return $self-&gt;{attribute} = $self-&gt;default;\n        }\n    } #accessor()\n} #Klass\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/q/54600066/2877364\">This question</a> deals with variables, but not functions.  <a href=\"https://perldoc.perl.org/perlperf.html\" rel=\"nofollow noreferrer\">perlperf</a> says that Perl will optimize away various things, but other than <code>()</code>-prototyped functions, it's not clear to me what.</p>\n\n<p>In JavaScript, I would say <code>void obj.accessor();</code>, and then I would know for sure it would run but the result would be discarded.  However, I can't use <code>undef $obj-&gt;accessor;</code> for a similar effect; compilation legitimately fails with <code>Can't modify non-lvalue subroutine call of &amp;Klass::accessor</code>.</p>\n"}, {"tags": ["perl", "if-statement", "operators", "conditional-statements"], "answers": [{"comments": [{"owner": {"reputation": 4423, "user_id": 1049905, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/db7fea9520c5c53e6490fdcb574f614f?s=128&d=identicon&r=PG&f=1", "display_name": "Bluz", "link": "https://stackoverflow.com/users/1049905/bluz"}, "edited": false, "score": 0, "creation_date": 1552571866, "post_id": 55163031, "comment_id": 97067863, "body": "I down voted that answer because you&#39;re assuming I don&#39;t know the difference between AND or OR, and that I am trying to get a status that is both active and inactive which is not the case."}, {"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "reply_to_user": {"reputation": 4423, "user_id": 1049905, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/db7fea9520c5c53e6490fdcb574f614f?s=128&d=identicon&r=PG&f=1", "display_name": "Bluz", "link": "https://stackoverflow.com/users/1049905/bluz"}, "edited": false, "score": 3, "creation_date": 1552575286, "post_id": 55163031, "comment_id": 97070454, "body": "@Bluz Well, you actually used an <code>||</code> instead of a <code>&amp;&amp;</code>... I mean, this isn&#39;t a big deal: it has happened to pretty much everybody. But this answer is correct, and there is definitely no justification for downvoting it."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1552607286, "post_id": 55163031, "comment_id": 97086211, "body": "Please don&#39;t use <code>unless</code> for anything but trivial checks; having to distribute an implicit negation confuses too many people."}], "tags": [], "owner": {"reputation": 3905, "user_id": 9602863, "user_type": "registered", "profile_image": "https://graph.facebook.com/1743384949051322/picture?type=large", "display_name": "UjinT34", "link": "https://stackoverflow.com/users/9602863/ujint34"}, "is_accepted": false, "score": 2, "last_activity_date": 1552567846, "creation_date": 1552567846, "answer_id": 55163031, "question_id": 55162763, "link": "https://stackoverflow.com/questions/55162763/perl-string-if-or-comparison-operator/55163031#55163031", "title": "Perl string if/or comparison operator", "body": "<p><code>$new_status</code> can't be equal to <code>active</code> and <code>inactive</code> at the same time, so condition is always true. You probably need <code>&amp;&amp;</code> instead of <code>||</code></p>\n\n<p>Choose any option that looks more intuitive to you:</p>\n\n<pre><code># option 1\nif ( ($new_status ne \"active\") &amp;&amp; ($new_status ne \"inactive\") )\n...\n# option 2\nunless ( ($new_status eq \"active\") || ($new_status eq \"inactive\") )\n...\n#option 3\nmy %VALID_STATUS = (\n    'active' =&gt; 1,\n    'inactive' =&gt; 1,\n);\nif (!$VALID_STATUS{$new_status})\n...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1552607197, "post_id": 55164340, "comment_id": 97086187, "body": "Please don&#39;t recommend the use of <code>not</code>/<code>or</code>/<code>and</code> outside of flow control (<code>or die</code>, <code>or last</code>, <code>or return</code>, etc). It leads to errors such as the one I had to fix in your answer."}, {"owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "reply_to_user": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552627658, "post_id": 55164340, "comment_id": 97090629, "body": "@ikegami: Damn. You&#39;re right. Ignoring my own best practice there. Sorry about that."}], "tags": [], "owner": {"reputation": 62184, "user_id": 7231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b76985f3985e35492e25880493d045?s=128&d=identicon&r=PG", "display_name": "Dave Cross", "link": "https://stackoverflow.com/users/7231/dave-cross"}, "is_accepted": false, "score": 2, "last_activity_date": 1552607112, "last_edit_date": 1552607112, "creation_date": 1552571709, "answer_id": 55164340, "question_id": 55162763, "link": "https://stackoverflow.com/questions/55162763/perl-string-if-or-comparison-operator/55164340#55164340", "title": "Perl string if/or comparison operator", "body": "<pre><code>if ( ($new_status ne \"active\") || ($new_status ne \"inactive\") )\n{\n  die \"Status must be active/inactive.\";\n}\n</code></pre>\n\n<p>Let's work through the logic.</p>\n\n<ol>\n<li>I type something random (let's use <code>random</code>). <code>random</code> isn't \"active\" and isn't \"inactive\", so your <code>if</code> clause becomes <code>if (true or true)</code> - which is true.</li>\n<li>I type <code>active</code>. That's false on the first check and true on the second check, so you get <code>if (false or true)</code> - which is true.</li>\n<li>I type <code>inactive</code>. That's true on the first check and false on the second, so you get <code>if (true or false)</code> - which is true.</li>\n</ol>\n\n<p>There is nothing you can enter that makes your <code>if</code> statement false.</p>\n\n<p>Your problem that you don't want to join your two clauses with <code>or</code>, you should use <code>and</code> instead.</p>\n\n<p>(And take a tip from this old programmer - using <code>and</code> and <code>or</code> instead of <code>&amp;&amp;</code> and <code>||</code> for flow control will be far less confusing.)</p>\n\n<p><strong>Update:</strong> All in all, there are too many negatives in your code and you're confusing yourself. In your answer, you (silently!) change the <code>if</code> to an <code>unless</code>, thereby making the code even harder to follow for a maintenance programmer.</p>\n\n<p>I'd write it like this:</p>\n\n<pre><code>my $valid = $new_status eq 'active' || $new_status eq 'inactive';\nif (not $valid) {\n   die \"...\";\n}\n</code></pre>\n\n<p>Or like this:</p>\n\n<pre><code>use List::Util 'any';\n\nif (not any { $new_status eq $_ } qw[active inactive] ) {\n  die \"...\";\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3472, "user_id": 4990392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89acc35f0339a9c7e6ae36443a23e2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Dada", "link": "https://stackoverflow.com/users/4990392/dada"}, "edited": false, "score": 1, "creation_date": 1552575191, "post_id": 55164488, "comment_id": 97070381, "body": "And you replace the <code>if</code> with an <code>unless</code>, that&#39;s definitely not a detail."}, {"owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 0, "creation_date": 1552609045, "post_id": 55164488, "comment_id": 97086590, "body": "Actually, they made they made three relevant changes: if\u2192unless, ne\u2192eq, ne\u2192eq (The change in formatting is not relevant.)"}], "tags": [], "owner": {"reputation": 4423, "user_id": 1049905, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/db7fea9520c5c53e6490fdcb574f614f?s=128&d=identicon&r=PG&f=1", "display_name": "Bluz", "link": "https://stackoverflow.com/users/1049905/bluz"}, "is_accepted": true, "score": -5, "last_activity_date": 1552572104, "creation_date": 1552572104, "answer_id": 55164488, "question_id": 55162763, "link": "https://stackoverflow.com/questions/55162763/perl-string-if-or-comparison-operator/55164488#55164488", "title": "Perl string if/or comparison operator", "body": "<p>So I found the answer to my question.</p>\n\n<p>The issue is with formatting.</p>\n\n<p>I added:</p>\n\n<pre><code>print Dumper $new_status;\n</code></pre>\n\n<p>in my code and the output was:</p>\n\n<pre><code>$VAR1 = 'active\n';\n</code></pre>\n\n<p>So I added a :</p>\n\n<pre><code>chomp $new_status;\n</code></pre>\n\n<p>and now its working perfectly.</p>\n\n<pre><code>$VAR1 = 'active';\n</code></pre>\n\n<p>Final code:</p>\n\n<pre><code># Get new_status\nprint STDERR \"Please enter status value (active/inactive): \";\nReadMode(1);\nmy $new_status = ReadLine(0);\nReadMode(0);\nprint STDERR \"\\n\";\n\nchomp $new_status;\n\nunless ( ($new_status eq \"active\") || ($new_status eq \"inactive\") )\n{\n  die \"Status must be active/inactive.\";\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 320771, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 2, "last_activity_date": 1552608665, "last_edit_date": 1552608665, "creation_date": 1552607696, "answer_id": 55173688, "question_id": 55162763, "link": "https://stackoverflow.com/questions/55162763/perl-string-if-or-comparison-operator/55173688#55173688", "title": "Perl string if/or comparison operator", "body": "<p>You only want to display the error message if <code>$new_status</code> isn't <code>active</code> <em>AND</em> if <code>$new_status</code> isn't <code>inactive</code>, so</p>\n\n<pre><code>if ( $new_status ne \"active\" || $new_status ne \"inactive\" )\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if ( $new_status ne \"active\" &amp;&amp; $new_status ne \"inactive\" )\n</code></pre>\n\n<hr>\n\n<p>We can prove this. Remember <a href=\"https://en.wikipedia.org/wiki/De_Morgan%27s_laws\" rel=\"nofollow noreferrer\">De Morgan's laws</a>.</p>\n\n<ul>\n<li><code>!( A || B )</code> is equivalent to <code>!A &amp;&amp; !B</code>.</li>\n<li><code>!( A &amp;&amp; B )</code> is equivalent to <code>!A || !B</code>.</li>\n</ul>\n\n<p>So,</p>\n\n<ul>\n<li>Valid input if <code>$new_status eq 'active' || $new_status eq 'inactive'</code></li>\n<li>Invalid input if <code>!( $new_status eq 'active' || $new_status eq 'inactive' )</code></li>\n<li>Invalid input if <code>!( $new_status eq 'active' ) &amp;&amp; !( $new_status eq 'inactive' )</code></li>\n<li>Invalid input if <code>$new_status ne 'active' &amp;&amp; $new_status ne 'inactive'</code></li>\n</ul>\n\n<hr>\n\n<p>You will need to become accustomed to seeing the following:</p>\n\n<pre><code>if ( $new_status ne \"active\" &amp;&amp; $new_status ne \"inactive\" ) {\n   die(\"Status must be active/inactive.\\n\");\n}\n</code></pre>\n\n<p>But you might prefer to use an assertive style of coding instead.</p>\n\n<pre><code>$new_status eq \"active\" || $new_status eq \"inactive\"    # Thing that should be true.\n   or die(\"Status must be active/inactive.\\n\");         # Or what to do when it isn't.\n</code></pre>\n"}], "owner": {"reputation": 4423, "user_id": 1049905, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/db7fea9520c5c53e6490fdcb574f614f?s=128&d=identicon&r=PG&f=1", "display_name": "Bluz", "link": "https://stackoverflow.com/users/1049905/bluz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "accepted_answer_id": 55164488, "answer_count": 4, "score": -3, "last_activity_date": 1552608665, "creation_date": 1552567130, "question_id": 55162763, "link": "https://stackoverflow.com/questions/55162763/perl-string-if-or-comparison-operator", "title": "Perl string if/or comparison operator", "body": "<p>Why is the following code:</p>\n\n<pre><code># Get new_status\nprint STDERR \"Please enter status value (active/inactive): \";\nReadMode(1);\nmy $new_status = ReadLine(0);\nReadMode(0);\nprint STDERR \"\\n\";\n\nif ( ($new_status ne \"active\") || ($new_status ne \"inactive\") )\n{\n  die \"Status must be active/inactive.\";\n}\n</code></pre>\n\n<p>will always return \"Status must be active/inactive.\" no matter what I type? (active, inactive, or anything else, or even just press enter.)</p>\n\n<p>The code appears to be valid:</p>\n\n<ul>\n<li>I clearly separate both statement with brackets </li>\n<li>I use the string\noperator \"ne\" in both cases </li>\n<li>I use the OR operator ||</li>\n</ul>\n\n<p>There's obviously something about Perl operators I am not fully grasping. \nWhat am I doing wrong?</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["perl", "sockets", "sendto"], "comments": [{"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 1, "creation_date": 1552566478, "post_id": 55161627, "comment_id": 97063952, "body": "Can you at least add the code that shows how you construct <code>$dest</code>?"}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552572505, "post_id": 55161627, "comment_id": 97068333, "body": "An observation: if you use <code>Peer*</code> to create an <code>IO::Socket::INET</code> socket then <code>connect()</code> is called. This seems to affect the behaviour of <code>send()</code>, i.e. it no longer passes on the <code>TO</code> parameter to <code>sendto()</code>. I would suggest to study the Perl source code to discover the reason why."}, {"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "reply_to_user": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552572662, "post_id": 55161627, "comment_id": 97068443, "body": "Good point, but strictly speaking <code>connect()</code> does not make sense for UDP. At least it&#39;s poor documentation on the Perl side."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552573018, "post_id": 55161627, "comment_id": 97068717, "body": "F.ex. <a href=\"https://github.com/Perl/perl5/blob/blead/dist/IO/lib/IO/Socket.pm#L276\" rel=\"nofollow noreferrer\">IO::Socket::send()</a> ignores <code>$peer</code> when <code>peername($sock)</code> returns a peer address. That will be the peer address set by <code>connect()</code>."}, {"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "reply_to_user": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552573576, "post_id": 55161627, "comment_id": 97069177, "body": "As said before: The documentation is incomplete; it says: &quot;On unconnected sockets, you must specify a destination to send to, in which case it does a sendto(2) syscall.&quot; That logical: You need a destination address. But my assumption was that a third (forth) argument will automatically call <code>sendto()</code> with that parameter, temporarily overriding the socket&#39;s peer address. Upvote my question anyone?"}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552578884, "post_id": 55161627, "comment_id": 97073103, "body": "You are quoting from the documentation of <code>CORE::send()</code>, which behaves exactly like <a href=\"https://github.com/Perl/perl5/blob/blead/pp_sys.c#L2007\" rel=\"nofollow noreferrer\">the documentation describes</a>. But your question describes the behaviour of <code>IO::Socket::send()</code> which is an <a href=\"https://github.com/Perl/perl5/blob/blead/dist/IO/lib/IO/Socket.pm#L276\" rel=\"nofollow noreferrer\">OO wrapper</a> around <code>CORE::send()</code>"}, {"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "reply_to_user": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "edited": false, "score": 0, "creation_date": 1552775624, "post_id": 55161627, "comment_id": 97141382, "body": "@Stefan Becker: I failed to find the corresponding documentation: <code>IO::Socket::INET</code> definitely doesn&#39;t document it."}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 0, "creation_date": 1552610299, "post_id": 55165521, "comment_id": 97086871, "body": "So I would call the IO::Socket version &quot;poorly documented object-oriented confusion&quot; ;-) Thanks for the solution! Why didn&#39;t they use <code>my $r = defined($peer) ? send($sock, $_[1], $flags, $peer) : send($sock, $_[1], $flags);</code>?"}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 0, "creation_date": 1552629650, "post_id": 55165521, "comment_id": 97091190, "body": "That won&#39;t help because the <code>IO::Socket::send()</code> implementation starts with <code>my $peer = $_[3] || $sock-&gt;peername;</code>. With your suggestion the 3-parameter variant of <code>CORE::send()</code> would only be used for unconnected sockets, i.e. it would always fail :-("}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 1, "creation_date": 1552636041, "post_id": 55165521, "comment_id": 97093542, "body": "FYI: I wrote a comment on <a href=\"https://github.com/Dual-Life/IO/issues/17#issuecomment-473189242\" rel=\"nofollow noreferrer\">GitHub Dual-Life/IO PR#17</a>."}, {"owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "reply_to_user": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "edited": false, "score": 0, "creation_date": 1552818733, "post_id": 55165521, "comment_id": 97148363, "body": "FYI: I&#39;ve created <a href=\"https://rt.perl.org/Ticket/Display.html?id=133936\" rel=\"nofollow noreferrer\">RT Ticket #133936</a>"}], "tags": [], "owner": {"reputation": 5181, "user_id": 8866606, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ao_wuU1YCUE/AAAAAAAAAAI/AAAAAAAAAtc/Nc6ExTtKE_A/photo.jpg?sz=128", "display_name": "Stefan Becker", "link": "https://stackoverflow.com/users/8866606/stefan-becker"}, "is_accepted": true, "score": 2, "last_activity_date": 1552676533, "last_edit_date": 1552676533, "creation_date": 1552574940, "answer_id": 55165521, "question_id": 55161627, "link": "https://stackoverflow.com/questions/55161627/why-does-sendto-via-perl-socket-send-ignore-the-peer-address/55165521#55165521", "title": "Why does sendto() via Perl Socket-&gt;send() ignore the peer address?", "body": "<p>If you use <code>Peer*</code> when creating an <code>IO::Socket::INET</code> then <code>connect()</code> will be called, which sets the peername of the socket. On such a socket you'll never have to specify the remote socket address, because it has a default one.</p>\n\n<p><a href=\"https://github.com/Perl/perl5/blob/blead/dist/IO/lib/IO/Socket.pm#L276\" rel=\"nofollow noreferrer\">IO::Socket::send()</a> has a \"feature\": it ignores the <code>TO</code> parameter when the socket has a valid peername:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code> my $r = defined(getpeername($sock))\n     ? send($sock, $_[1], $flags)\n     : send($sock, $_[1], $flags, $peer);\n</code></pre>\n\n<p>That change was introduced in <a href=\"https://metacpan.org/changes/distribution/IO#L430\" rel=\"nofollow noreferrer\">IO 1.12</a>, which unfortunately predates the history of the current <a href=\"https://github.com/Dual-Life/IO\" rel=\"nofollow noreferrer\">git repository</a>:</p>\n\n<blockquote>\n  <p>Modified IO::Socket::send so not to pass 4 arguments to send\n   if the socket is connected</p>\n</blockquote>\n\n<p>If you don't like this behaviour, you'll have to use raw <code>CORE::send()</code> instead, i.e.:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>#!/usr/bin/perl\nuse warnings;\nuse strict;\n\nuse IO::Socket::INET;\nuse Socket qw(pack_sockaddr_in);\n\nmy $client = IO::Socket::INET-&gt;new(\n    PeerAddr  =&gt; '127.0.0.1',\n    PeerPort  =&gt; 2000,\n    Proto      =&gt; 'udp',\n) or die \"client socket: $!\\n\";\n\nmy $addr = pack_sockaddr_in(2000, inet_aton('127.0.0.1'));\n\n$client-&gt;send('ABCD', 0)\n    or die \"IO::Socket::send() no addr: $!\\n\";\n$client-&gt;send('ABCD', 0, $addr)\n    or die \"IO::Socket::send() with addr: $!\\n\";\nsend($client, 'ABCD', 0, $addr)\n    or die \"send() with addr: $!\\n\";\n\nexit 0;\n</code></pre>\n\n<p>Test run:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ strace -e sendto,connect,socket perl dummy.pl\nsocket(AF_INET, SOCK_DGRAM|SOCK_CLOEXEC, IPPROTO_UDP) = 4\nconnect(4, {sa_family=AF_INET, sin_port=htons(2000), sin_addr=inet_addr(\"127.0.0.1\")}, 16) = 0\nsendto(4, \"ABCD\", 4, 0, NULL, 0)        = 4\nsendto(4, \"ABCD\", 4, 0, NULL, 0)        = 4\nsendto(4, \"ABCD\", 4, 0, {sa_family=AF_INET, sin_port=htons(2000), sin_addr=inet_addr(\"127.0.0.1\")}, 16) = 4\n</code></pre>\n\n<p>The strace from my Linux machine indicates that <code>send()</code> is mapped to <code>sendto()</code>, because the Perl code does call <a href=\"https://github.com/Perl/perl5/blob/blead/pp_sys.c#L2007\" rel=\"nofollow noreferrer\">send() and sendto()</a>.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong> I've created the <a href=\"https://rt.perl.org/Ticket/Display.html?id=133936\" rel=\"nofollow noreferrer\">upstream ticket #133936</a>.</p>\n"}], "owner": {"reputation": 1856, "user_id": 6607497, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/f0a0b03f5bbd44186399f4b0aea38049?s=128&d=identicon&r=PG&f=1", "display_name": "U. Windl", "link": "https://stackoverflow.com/users/6607497/u-windl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 55165521, "answer_count": 1, "score": 1, "last_activity_date": 1552676533, "creation_date": 1552563705, "last_edit_date": 1552567436, "question_id": 55161627, "link": "https://stackoverflow.com/questions/55161627/why-does-sendto-via-perl-socket-send-ignore-the-peer-address", "title": "Why does sendto() via Perl Socket-&gt;send() ignore the peer address?", "body": "<p>I have a program (too complex to present here) that uses an UDP socket created by <code>IO::Socket::INET-&gt;new()</code> with both, <code>Local...</code> and <code>Peer...</code> address and port.  So expectation is that a plain <code>$sock-&gt;send($data, $flags)</code> will send <code>$data</code> to the peer address specified when creating the socket. That seems to work.</p>\n\n<p>However when I try to send an individual packet to a different destination by using <code>$sock-&gt;send($data, $flags, $dest)</code>, <code>$dest</code> seems to be ignored (and the packet is being sdent to the socket's peer address).  I added lots of debug messages, and the parameter <code>$dest</code> is passed correctly to <code>send</code>, but <code>strace</code> shows that <code>sendto()</code> is called with <code>NULL</code> for <code>sockaddr</code> and <code>0</code> for <code>socklen</code>.</p>\n\n<p><code>perldoc -f send</code> doesn't help me. So why is the destination address ignored?</p>\n\n<p>As requested, here's the (somewhat extra verbose) send_packet code:</p>\n\n<pre><code>$RE_saddr = qr/^(.+):(\\d+)$/;\n\nsub send_packet($$;$)\n{\n    my ($sock, $packet, $dest) = @_;\n    my @params = ($packet, 0);\n\n    if (defined($dest)) {\n        if (my ($addr, $port) = $dest =~ $RE_saddr) {\n            if (my $addr_bin = inet_aton($addr)) {\n                if (defined($dest = sockaddr_in($port, $addr_bin))) {\n                    push(@params, $dest);\n                } else {\n                    warn \"bad address or socket for $addr:$port\";\n                }\n            } else {\n                warn \"bad address $addr\";\n            }\n        } else {\n            warn \"bad destination address $dest\";\n        }\n    }\n    return 1\n        if ($sock-&gt;send(@params));\n    return undef;\n}\n</code></pre>\n\n<p>So obviously the destination is passed as \"<em>host</em> <strong>:</strong> <em>port</em>\" (one string without blanks (blanks are due to markup deficits here)).</p>\n"}, {"tags": ["shell", "perl"], "answers": [{"tags": [], "owner": {"reputation": 2954, "user_id": 235961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e403d928f09096477fd2b4f3c00560?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/235961/pradeep"}, "is_accepted": true, "score": 3, "last_activity_date": 1552566423, "last_edit_date": 1552566423, "creation_date": 1552545744, "answer_id": 55156412, "question_id": 55156376, "link": "https://stackoverflow.com/questions/55156376/convert-perl-script-to-shell-script-stdin-and-chomp/55156412#55156412", "title": "Convert perl script to shell script: &lt;STDIN&gt; and chomp", "body": "<p>Just this:</p>\n\n<pre><code>read resp\n</code></pre>\n\n<p>In Perl <a href=\"https://perldoc.perl.org/functions/chomp.html\" rel=\"nofollow noreferrer\">chomp</a> function is used to remove newline from the input.<br>\nThe shell removes the newline automatically.</p>\n"}], "owner": {"reputation": 18, "user_id": 8408819, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fbsaF.jpg?s=128&g=1", "display_name": "Joker", "link": "https://stackoverflow.com/users/8408819/joker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 55156412, "answer_count": 1, "score": 0, "last_activity_date": 1552566423, "creation_date": 1552545610, "question_id": 55156376, "link": "https://stackoverflow.com/questions/55156376/convert-perl-script-to-shell-script-stdin-and-chomp", "title": "Convert perl script to shell script: &lt;STDIN&gt; and chomp", "body": "<p>Perl script line:    </p>\n\n<pre><code>my $resp=&lt;STDIN&gt;;\nchomp($resp);\n</code></pre>\n\n<p>Im trying to convert perl script to shell script... Just got stuck with this 2 lines... Please help me...</p>\n"}]